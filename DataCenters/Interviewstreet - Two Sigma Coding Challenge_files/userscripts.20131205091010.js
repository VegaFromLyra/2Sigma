function readCookie(a){a+="=";for(var b=document.cookie.split(";"),c=0;c<b.length;c++){for(var d=b[c];d.charAt(0)==" ";)d=d.substring(1,d.length);if(d.indexOf(a)==0)return d.substring(a.length,d.length)}return null}function createCookie(a,b,c){if(c){var d=new Date;d.setTime(d.getTime()+c*864E5);c="; expires="+d.toGMTString()}else c="";document.cookie=a+"="+b+c+"; path=/"}var tzoffset=(new Date).getTimezoneOffset();readCookie("tzone")==null&&createCookie("tzone",tzoffset,1E3);
function validateEmail(a){return/^([\w-]+(?:\.[\w-]+)*)@((?:[\w-]+\.)*\w[\w-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$/i.test(a)}function getCaret(a){if(a.selectionStart)return a.selectionStart;else if(document.selection){a.focus();var b=document.selection.createRange();if(b==null)return 0;a=a.createTextRange();var c=a.duplicate();a.moveToBookmark(b.getBookmark());c.setEndPoint("EndToStart",a);return c.text.length}return 0};(function(a){var b=/^\s*|\s*$/g,c="B".replace(/A(.)|B/,"$1")==="$1",d={majorVersion:"3",minorVersion:"4.4",releaseDate:"2011-08-04",_init:function(){function e(o){if(o.src&&/tiny_mce(|_gzip|_jquery|_prototype|_full)(_dev|_src)?.js/.test(o.src)){if(/_(src|dev)\.js/g.test(o.src))f.suffix="_src";if((m=o.src.indexOf("?"))!=-1)f.query=o.src.substring(m+1);f.baseURL=o.src.substring(0,o.src.lastIndexOf("/"));if(l&&f.baseURL.indexOf("://")==-1&&f.baseURL.indexOf("/")!==0)f.baseURL=l+f.baseURL;return f.baseURL}return null}
var f=this,g=document,h=navigator,k=h.userAgent,l,m,p;f.isOpera=a.opera&&opera.buildNumber;f.isWebKit=/WebKit/.test(k);f.isIE=!f.isWebKit&&!f.isOpera&&/MSIE/gi.test(k)&&/Explorer/gi.test(h.appName);f.isIE6=f.isIE&&/MSIE [56]/.test(k);f.isIE7=f.isIE&&/MSIE [7]/.test(k);f.isIE8=f.isIE&&/MSIE [8]/.test(k);f.isIE9=f.isIE&&/MSIE [9]/.test(k);f.isGecko=!f.isWebKit&&/Gecko/.test(k);f.isMac=k.indexOf("Mac")!=-1;f.isAir=/adobeair/i.test(k);f.isIDevice=/(iPad|iPhone)/.test(k);f.isIOS5=f.isIDevice&&k.match(/AppleWebKit\/(\d*)/)[1]>=
534;if(a.tinyMCEPreInit){f.suffix=tinyMCEPreInit.suffix;f.baseURL=tinyMCEPreInit.base;f.query=tinyMCEPreInit.query}else{f.suffix="";k=g.getElementsByTagName("base");for(h=0;h<k.length;h++)if(p=k[h].href){if(/^https?:\/\/[^\/]+$/.test(p))p+="/";l=p?p.match(/.*\//)[0]:""}k=g.getElementsByTagName("script");for(h=0;h<k.length;h++)if(e(k[h]))return;if(g=g.getElementsByTagName("head")[0]){k=g.getElementsByTagName("script");for(h=0;h<k.length;h++)if(e(k[h]))break}}},is:function(e,f){if(!f)return e!==void 0;
if(f=="array"&&e.hasOwnProperty&&e instanceof Array)return true;return typeof e==f},makeMap:function(e,f,g){e=e||[];if(typeof e=="string")e=e.split(f||",");g=g||{};for(f=e.length;f--;)g[e[f]]={};return g},each:function(e,f,g){var h,k;if(!e)return 0;g=g||e;if(e.length!==void 0){h=0;for(k=e.length;h<k;h++)if(f.call(g,e[h],h,e)===false)return 0}else for(h in e)if(e.hasOwnProperty(h))if(f.call(g,e[h],h,e)===false)return 0;return 1},map:function(e,f){var g=[];d.each(e,function(h){g.push(f(h))});return g},
grep:function(e,f){var g=[];d.each(e,function(h){if(!f||f(h))g.push(h)});return g},inArray:function(e,f){var g,h;if(e){g=0;for(h=e.length;g<h;g++)if(e[g]===f)return g}return-1},extend:function(e,f){var g,h,k=arguments;g=1;for(h=k.length;g<h;g++){f=k[g];d.each(f,function(l,m){if(l!==void 0)e[m]=l})}return e},trim:function(e){return(e?""+e:"").replace(b,"")},create:function(e,f,g){var h,k,l,m,p,o=0;e=/^((static) )?([\w.]+)(:([\w.]+))?/.exec(e);l=e[3].match(/(^|\.)(\w+)$/i)[2];k=this.createNS(e[3].replace(/\.\w+$/,
""),g);if(!k[l])if(e[2]=="static"){k[l]=f;if(this.onCreate)this.onCreate(e[2],e[3],k[l])}else{if(!f[l]){f[l]=function(){};o=1}k[l]=f[l];this.extend(k[l].prototype,f);if(e[5]){h=this.resolve(e[5]).prototype;m=e[5].match(/\.(\w+)$/i)[1];p=k[l];k[l]=o?function(){return h[m].apply(this,arguments)}:function(){this.parent=h[m];return p.apply(this,arguments)};k[l].prototype[l]=k[l];this.each(h,function(n,s){k[l].prototype[s]=h[s]});this.each(f,function(n,s){if(h[s])k[l].prototype[s]=function(){this.parent=
h[s];return n.apply(this,arguments)};else if(s!=l)k[l].prototype[s]=n})}this.each(f["static"],function(n,s){k[l][s]=n});if(this.onCreate)this.onCreate(e[2],e[3],k[l].prototype)}},walk:function(e,f,g,h){h=h||this;if(e){if(g)e=e[g];d.each(e,function(k,l){if(f.call(h,k,l,g)===false)return false;d.walk(k,f,g,h)})}},createNS:function(e,f){var g,h;f=f||a;e=e.split(".");for(g=0;g<e.length;g++){h=e[g];f[h]||(f[h]={});f=f[h]}return f},resolve:function(e,f){var g,h;f=f||a;e=e.split(".");g=0;for(h=e.length;g<
h;g++){f=f[e[g]];if(!f)break}return f},addUnload:function(e,f){var g=this;e={func:e,scope:f||this};if(g.unloads)g.unloads.push(e);else{var h=function(){var l=g.unloads,m,p;if(l){for(p in l)(m=l[p])&&m.func&&m.func.call(m.scope,1);if(a.detachEvent){a.detachEvent("onbeforeunload",k);a.detachEvent("onunload",h)}else a.removeEventListener&&a.removeEventListener("unload",h,false);g.unloads=w=h=0;a.CollectGarbage&&CollectGarbage()}},k=function(){var l=document;if(l.readyState=="interactive"){var m=function(){l.detachEvent("onstop",
m);h&&h();l=0};l&&l.attachEvent("onstop",m);a.setTimeout(function(){l&&l.detachEvent("onstop",m)},0)}};if(a.attachEvent){a.attachEvent("onunload",h);a.attachEvent("onbeforeunload",k)}else a.addEventListener&&a.addEventListener("unload",h,false);g.unloads=[e]}return e},removeUnload:function(e){var f=this.unloads,g=null;d.each(f,function(h,k){if(h&&h.func==e){f.splice(k,1);g=e;return false}});return g},explode:function(e,f){return e?d.map(e.split(f||","),d.trim):e},_addVer:function(e){var f;if(!this.query)return e;
f=(e.indexOf("?")==-1?"?":"&")+this.query;if(e.indexOf("#")==-1)return e+f;return e.replace("#",f+"#")},_replace:function(e,f,g){if(c)return g.replace(e,function(){var h=f,k=arguments,l;for(l=0;l<k.length-2;l++)h=k[l]===void 0?h.replace(RegExp("\\$"+l,"g"),""):h.replace(RegExp("\\$"+l,"g"),k[l]);return h});return g.replace(e,f)}};d._init();a.tinymce=a.tinyMCE=d})(window);
tinymce.create("tinymce.util.Dispatcher",{scope:null,listeners:null,Dispatcher:function(a){this.scope=a||this;this.listeners=[]},add:function(a,b){this.listeners.push({cb:a,scope:b||this.scope});return a},addToTop:function(a,b){this.listeners.unshift({cb:a,scope:b||this.scope});return a},remove:function(a){var b=this.listeners,c=null;tinymce.each(b,function(d,e){if(a==d.cb){c=a;b.splice(e,1);return false}});return c},dispatch:function(){var a,b=arguments,c,d=this.listeners;for(c=0;c<d.length;c++){a=
d[c];a=a.cb.apply(a.scope,b);if(a===false)break}return a}});
(function(){var a=tinymce.each;tinymce.create("tinymce.util.URI",{URI:function(b,c){var d=this,e;b=tinymce.trim(b);c=d.settings=c||{};if(/^(mailto|tel|news|javascript|about|data):/i.test(b)||/^\s*#/.test(b))d.source=b;else{if(b.indexOf("/")===0&&b.indexOf("//")!==0)b=(c.base_uri?c.base_uri.protocol||"http":"http")+"://mce_host"+b;if(!/^[\w-]*:?\/\//.test(b)){e=c.base_uri?c.base_uri.path:(new tinymce.util.URI(location.href)).directory;b=(c.base_uri&&c.base_uri.protocol||"http")+"://mce_host"+d.toAbsPath(e,
b)}b=b.replace(/@@/g,"(mce_at)");b=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/.exec(b);a(["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],function(f,g){var h=b[g];if(h)h=h.replace(/\(mce_at\)/g,"@@");d[f]=h});if(e=c.base_uri){if(!d.protocol)d.protocol=e.protocol;if(!d.userInfo)d.userInfo=
e.userInfo;if(!d.port&&d.host=="mce_host")d.port=e.port;if(!d.host||d.host=="mce_host")d.host=e.host;d.source=""}}},setPath:function(b){b=/^(.*?)\/?(\w+)?$/.exec(b);this.path=b[0];this.directory=b[1];this.file=b[2];this.source="";this.getURI()},toRelative:function(b){var c;if(b==="./")return b;b=new tinymce.util.URI(b,{base_uri:this});if(b.host!="mce_host"&&this.host!=b.host&&b.host||this.port!=b.port||this.protocol!=b.protocol)return b.getURI();c=this.toRelPath(this.path,b.path);if(b.query)c+="?"+
b.query;if(b.anchor)c+="#"+b.anchor;return c},toAbsolute:function(b,c){b=new tinymce.util.URI(b,{base_uri:this});return b.getURI(this.host==b.host&&this.protocol==b.protocol?c:0)},toRelPath:function(b,c){var d,e=0,f="",g,h;b=b.substring(0,b.lastIndexOf("/"));b=b.split("/");d=c.split("/");if(b.length>=d.length){g=0;for(h=b.length;g<h;g++)if(g>=d.length||b[g]!=d[g]){e=g+1;break}}if(b.length<d.length){g=0;for(h=d.length;g<h;g++)if(g>=b.length||b[g]!=d[g]){e=g+1;break}}if(e==1)return c;g=0;for(h=b.length-
(e-1);g<h;g++)f+="../";g=e-1;for(h=d.length;g<h;g++)f+=g!=e-1?"/"+d[g]:d[g];return f},toAbsPath:function(b,c){var d,e=0,f=[],g;g=/\/$/.test(c)?"/":"";b=b.split("/");c=c.split("/");a(b,function(h){h&&f.push(h)});b=f;d=c.length-1;for(f=[];d>=0;d--)if(!(c[d].length==0||c[d]=="."))if(c[d]=="..")e++;else if(e>0)e--;else f.push(c[d]);d=b.length-e;d=d<=0?f.reverse().join("/"):b.slice(0,d).join("/")+"/"+f.reverse().join("/");if(d.indexOf("/")!==0)d="/"+d;if(g&&d.lastIndexOf("/")!==d.length-1)d+=g;return d},
getURI:function(b){var c;if(!this.source||b){c="";if(!b){if(this.protocol)c+=this.protocol+"://";if(this.userInfo)c+=this.userInfo+"@";if(this.host)c+=this.host;if(this.port)c+=":"+this.port}if(this.path)c+=this.path;if(this.query)c+="?"+this.query;if(this.anchor)c+="#"+this.anchor;this.source=c}return this.source}})})();
(function(){var a=tinymce.each;tinymce.create("static tinymce.util.Cookie",{getHash:function(b){b=this.get(b);var c;b&&a(b.split("&"),function(d){d=d.split("=");c=c||{};c[unescape(d[0])]=unescape(d[1])});return c},setHash:function(b,c,d,e,f,g){var h="";a(c,function(k,l){h+=(!h?"":"&")+escape(l)+"="+escape(k)});this.set(b,h,d,e,f,g)},get:function(b){var c=document.cookie,d=b+"=",e;if(c){e=c.indexOf("; "+d);if(e==-1){e=c.indexOf(d);if(e!=0)return null}else e+=2;b=c.indexOf(";",e);if(b==-1)b=c.length;
return unescape(c.substring(e+d.length,b))}},set:function(b,c,d,e,f,g){document.cookie=b+"="+escape(c)+(d?"; expires="+d.toGMTString():"")+(e?"; path="+escape(e):"")+(f?"; domain="+f:"")+(g?"; secure":"")},remove:function(b,c){var d=new Date;d.setTime(d.getTime()-1E3);this.set(b,"",d,c,d)}})})();
(function(){function a(b,c){var d,e,f;c=c||'"';if(b==null)return"null";f=typeof b;if(f=="string"){e="\u0008b\tt\nn\u000cf\rr\"\"''\\\\";return c+b.replace(/([\u0080-\uFFFF\x00-\x1f\"\'\\])/g,function(g,h){if(c==='"'&&g==="'")return g;d=e.indexOf(h);if(d+1)return"\\"+e.charAt(d+1);g=h.charCodeAt().toString(16);return"\\u"+"0000".substring(g.length)+g})+c}if(f=="object"){if(b.hasOwnProperty&&b instanceof Array){d=0;for(e="[";d<b.length;d++)e+=(d>0?",":"")+a(b[d],c);return e+"]"}e="{";for(d in b)e+=
typeof b[d]!="function"?(e.length>1?","+c:c)+d+c+":"+a(b[d],c):"";return e+"}"}return""+b}tinymce.util.JSON={serialize:a,parse:function(b){try{return eval("("+b+")")}catch(c){}}}})();
tinymce.create("static tinymce.util.XHR",{send:function(a){function b(g){c=0;try{c=new ActiveXObject(g)}catch(h){}return c}var c,d=window,e=0;a.scope=a.scope||this;a.success_scope=a.success_scope||a.scope;a.error_scope=a.error_scope||a.scope;a.async=a.async===false?false:true;a.data=a.data||"";if(c=d.XMLHttpRequest?new XMLHttpRequest:b("Microsoft.XMLHTTP")||b("Msxml2.XMLHTTP")){c.overrideMimeType&&c.overrideMimeType(a.content_type);c.open(a.type||(a.data?"POST":"GET"),a.url,a.async);a.content_type&&
c.setRequestHeader("Content-Type",a.content_type);c.setRequestHeader("X-Requested-With","XMLHttpRequest");c.send(a.data);var f=function(){if(!a.async||c.readyState==4||e++>1E4){if(a.success&&e<1E4&&c.status==200)a.success.call(a.success_scope,""+c.responseText,c,a);else if(a.error)a.error.call(a.error_scope,e>1E4?"TIMED_OUT":"GENERAL",c,a);c=null}else d.setTimeout(f,10)};if(!a.async)return f();d.setTimeout(f,10)}}});
(function(){var a=tinymce.extend,b=tinymce.util.JSON,c=tinymce.util.XHR;tinymce.create("tinymce.util.JSONRequest",{JSONRequest:function(d){this.settings=a({},d);this.count=0},send:function(d){var e=d.error,f=d.success;d=a(this.settings,d);d.success=function(g,h){g=b.parse(g);if(typeof g=="undefined")g={error:"JSON Parse error."};g.error?e.call(d.error_scope||d.scope,g.error,h):f.call(d.success_scope||d.scope,g.result)};d.error=function(g,h){if(e)e.call(d.error_scope||d.scope,g,h)};d.data=b.serialize({id:d.id||
"c"+this.count++,method:d.method,params:d.params});d.content_type="application/json";c.send(d)},"static":{sendRPC:function(d){return(new tinymce.util.JSONRequest).send(d)}}})})();(function(a){a.VK={DELETE:46,BACKSPACE:8}})(tinymce);
(function(a){function b(c){var d=c.dom,e=c.selection,f=a.VK;c.onKeyUp.add(function(g,h){if(h.keyCode==f.DELETE||h.keyCode==f.BACKSPACE){for(var k=e.getRng().startContainer;!d.isBlock(k);)k=k.parentNode;k=d.select("span.Apple-style-span",k);d.remove(k,true)}})}a.create("tinymce.util.Quirks",{Quirks:function(c){a.isWebKit&&b(c)}})})(tinymce);
(function(a){function b(m,p){var o,n,s,t={};if(m){m=m.split(",");p=p||10;for(o=0;o<m.length;o+=2){n=String.fromCharCode(parseInt(m[o],p));if(!d[n]){s="&"+m[o+1]+";";t[n]=s;t[s]=n}}return t}}var c,d,e,f=/[&<>\"\u007E-\uD7FF]|[\uD800-\uDBFF][\uDC00-\uDFFF]/g,g=/[<>&\u007E-\uD7FF]|[\uD800-\uDBFF][\uDC00-\uDFFF]/g,h=/[<>&\"\']/g,k=/&(#x|#)?([\w]+);/g,l={128:"\u20ac",130:"\u201a",131:"\u0192",132:"\u201e",133:"\u2026",134:"\u2020",135:"\u2021",136:"\u02c6",137:"\u2030",138:"\u0160",139:"\u2039",140:"\u0152",
142:"\u017d",145:"\u2018",146:"\u2019",147:"\u201c",148:"\u201d",149:"\u2022",150:"\u2013",151:"\u2014",152:"\u02dc",153:"\u2122",154:"\u0161",155:"\u203a",156:"\u0153",158:"\u017e",159:"\u0178"};d={'"':"&quot;","'":"&#39;","<":"&lt;",">":"&gt;","&":"&amp;"};e={"&lt;":"<","&gt;":">","&amp;":"&","&quot;":'"',"&apos;":"'"};c=b("50,nbsp,51,iexcl,52,cent,53,pound,54,curren,55,yen,56,brvbar,57,sect,58,uml,59,copy,5a,ordf,5b,laquo,5c,not,5d,shy,5e,reg,5f,macr,5g,deg,5h,plusmn,5i,sup2,5j,sup3,5k,acute,5l,micro,5m,para,5n,middot,5o,cedil,5p,sup1,5q,ordm,5r,raquo,5s,frac14,5t,frac12,5u,frac34,5v,iquest,60,Agrave,61,Aacute,62,Acirc,63,Atilde,64,Auml,65,Aring,66,AElig,67,Ccedil,68,Egrave,69,Eacute,6a,Ecirc,6b,Euml,6c,Igrave,6d,Iacute,6e,Icirc,6f,Iuml,6g,ETH,6h,Ntilde,6i,Ograve,6j,Oacute,6k,Ocirc,6l,Otilde,6m,Ouml,6n,times,6o,Oslash,6p,Ugrave,6q,Uacute,6r,Ucirc,6s,Uuml,6t,Yacute,6u,THORN,6v,szlig,70,agrave,71,aacute,72,acirc,73,atilde,74,auml,75,aring,76,aelig,77,ccedil,78,egrave,79,eacute,7a,ecirc,7b,euml,7c,igrave,7d,iacute,7e,icirc,7f,iuml,7g,eth,7h,ntilde,7i,ograve,7j,oacute,7k,ocirc,7l,otilde,7m,ouml,7n,divide,7o,oslash,7p,ugrave,7q,uacute,7r,ucirc,7s,uuml,7t,yacute,7u,thorn,7v,yuml,ci,fnof,sh,Alpha,si,Beta,sj,Gamma,sk,Delta,sl,Epsilon,sm,Zeta,sn,Eta,so,Theta,sp,Iota,sq,Kappa,sr,Lambda,ss,Mu,st,Nu,su,Xi,sv,Omicron,t0,Pi,t1,Rho,t3,Sigma,t4,Tau,t5,Upsilon,t6,Phi,t7,Chi,t8,Psi,t9,Omega,th,alpha,ti,beta,tj,gamma,tk,delta,tl,epsilon,tm,zeta,tn,eta,to,theta,tp,iota,tq,kappa,tr,lambda,ts,mu,tt,nu,tu,xi,tv,omicron,u0,pi,u1,rho,u2,sigmaf,u3,sigma,u4,tau,u5,upsilon,u6,phi,u7,chi,u8,psi,u9,omega,uh,thetasym,ui,upsih,um,piv,812,bull,816,hellip,81i,prime,81j,Prime,81u,oline,824,frasl,88o,weierp,88h,image,88s,real,892,trade,89l,alefsym,8cg,larr,8ch,uarr,8ci,rarr,8cj,darr,8ck,harr,8dl,crarr,8eg,lArr,8eh,uArr,8ei,rArr,8ej,dArr,8ek,hArr,8g0,forall,8g2,part,8g3,exist,8g5,empty,8g7,nabla,8g8,isin,8g9,notin,8gb,ni,8gf,prod,8gh,sum,8gi,minus,8gn,lowast,8gq,radic,8gt,prop,8gu,infin,8h0,ang,8h7,and,8h8,or,8h9,cap,8ha,cup,8hb,int,8hk,there4,8hs,sim,8i5,cong,8i8,asymp,8j0,ne,8j1,equiv,8j4,le,8j5,ge,8k2,sub,8k3,sup,8k4,nsub,8k6,sube,8k7,supe,8kl,oplus,8kn,otimes,8l5,perp,8m5,sdot,8o8,lceil,8o9,rceil,8oa,lfloor,8ob,rfloor,8p9,lang,8pa,rang,9ea,loz,9j0,spades,9j3,clubs,9j5,hearts,9j6,diams,ai,OElig,aj,oelig,b0,Scaron,b1,scaron,bo,Yuml,m6,circ,ms,tilde,802,ensp,803,emsp,809,thinsp,80c,zwnj,80d,zwj,80e,lrm,80f,rlm,80j,ndash,80k,mdash,80o,lsquo,80p,rsquo,80q,sbquo,80s,ldquo,80t,rdquo,80u,bdquo,810,dagger,811,Dagger,81g,permil,81p,lsaquo,81q,rsaquo,85c,euro",
32);a.html=a.html||{};a.html.Entities={encodeRaw:function(m,p){return m.replace(p?f:g,function(o){return d[o]||o})},encodeAllRaw:function(m){return(""+m).replace(h,function(p){return d[p]||p})},encodeNumeric:function(m,p){return m.replace(p?f:g,function(o){if(o.length>1)return"&#"+((o.charCodeAt(0)-55296)*1024+(o.charCodeAt(1)-56320)+65536)+";";return d[o]||"&#"+o.charCodeAt(0)+";"})},encodeNamed:function(m,p,o){o=o||c;return m.replace(p?f:g,function(n){return d[n]||o[n]||n})},getEncodeFunc:function(m,
p){function o(t,q){return t.replace(q?f:g,function(r){return d[r]||p[r]||"&#"+r.charCodeAt(0)+";"||r})}function n(t,q){return s.encodeNamed(t,q,p)}var s=a.html.Entities;p=b(p)||c;m=a.makeMap(m.replace(/\+/g,","));if(m.named&&m.numeric)return o;if(m.named){if(p)return n;return s.encodeNamed}if(m.numeric)return s.encodeNumeric;return s.encodeRaw},decode:function(m){return m.replace(k,function(p,o,n){if(o){n=parseInt(n,o.length===2?16:10);if(n>65535){n-=65536;return String.fromCharCode(55296+(n>>10),
56320+(n&1023))}else return l[n]||String.fromCharCode(n)}if(!(o=e[p]))if(!(o=c[p])){o=document.createElement("div");o.innerHTML=p;o=o.textContent||o.innerText||p}return o})}}})(tinymce);
tinymce.html.Styles=function(a,b){function c(m,p,o,n){function s(t){t=parseInt(t).toString(16);return t.length>1?t:"0"+t}return"#"+s(p)+s(o)+s(n)}var d=/rgb\s*\(\s*([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+)\s*\)/gi,e=/(?:url(?:(?:\(\s*\"([^\"]+)\"\s*\))|(?:\(\s*\'([^\']+)\'\s*\))|(?:\(\s*([^)\s]+)\s*\))))|(?:\'([^\']+)\')|(?:\"([^\"]+)\")/gi,f=/\s*([^:]+):\s*([^;]+);?/g,g=/\s+$/,h,k={},l;a=a||{};l="\\\" \\' \\; \\: ; : \ufeff".split(" ");for(h=0;h<l.length;h++){k[l[h]]="\ufeff"+h;k["\ufeff"+h]=l[h]}return{toHex:function(m){return m.replace(d,
c)},parse:function(m){function p(y,z){var I,ga;if(I=q[y+"-top"+z]){ga=q[y+"-right"+z];if(I==ga){I=q[y+"-bottom"+z];if(ga==I){ga=q[y+"-left"+z];if(I==ga){q[y+z]=ga;delete q[y+"-top"+z];delete q[y+"-right"+z];delete q[y+"-bottom"+z];delete q[y+"-left"+z]}}}}}function o(y){var z=q[y],I;if(!(!z||z.indexOf(" ")<0)){z=z.split(" ");for(I=z.length;I--;)if(z[I]!==z[0])return false;q[y]=z[0];return true}}function n(y,z,I,ga){if(o(z))if(o(I))if(o(ga)){q[y]=q[z]+" "+q[I]+" "+q[ga];delete q[z];delete q[I];delete q[ga]}}
function s(y){A=true;return k[y]}function t(y,z){if(A)y=y.replace(/\uFEFF[0-9]/g,function(I){return k[I]});z||(y=y.replace(/\\([\'\";:])/g,"$1"));return y}var q={},r,u,x,A,H=a.url_converter,D=a.url_converter_scope||this;if(m){for(m=m.replace(/\\[\"\';:\uFEFF]/g,s).replace(/\"[^\"]+\"|\'[^\']+\'/g,function(y){return y.replace(/[;:]/g,s)});r=f.exec(m);){u=r[1].replace(g,"").toLowerCase();x=r[2].replace(g,"");if(u&&x.length>0){if(u==="font-weight"&&x==="700")x="bold";else if(u==="color"||u==="background-color")x=
x.toLowerCase();x=x.replace(d,c);x=x.replace(e,function(y,z,I,ga,E,C){if(E=E||C){E=t(E);return"'"+E.replace(/\'/g,"\\'")+"'"}z=t(z||I||ga);if(H)z=H.call(D,z,"style");return"url('"+z.replace(/\'/g,"\\'")+"')"});q[u]=A?t(x,true):x}f.lastIndex=r.index+r[0].length}p("border","");p("border","-width");p("border","-color");p("border","-style");p("padding","");p("margin","");n("border","border-width","border-style","border-color");q.border==="medium none"&&delete q.border}return q},serialize:function(m,p){function o(q){var r,
u,x,A;if(r=b.styles[q]){u=0;for(x=r.length;u<x;u++){q=r[u];A=m[q];if(A!==void 0&&A.length>0)n+=(n.length>0?" ":"")+q+": "+A+";"}}}var n="",s,t;if(p&&b&&b.styles){o("*");o(p)}else for(s in m){t=m[s];if(t!==void 0&&t.length>0)n+=(n.length>0?" ":"")+s+": "+t+";"}return n}}};
(function(a){function b(o,n){return o.split(n||",")}var c={},d,e,f,g,h={},k,l,m=a.makeMap,p=a.each;e="h1,h2,h3,h4,h5,h6,hr,p,div,address,pre,form,table,tbody,thead,tfoot,th,tr,td,li,ol,ul,caption,blockquote,center,dl,dt,dd,dir,fieldset,noscript,menu,isindex,samp,header,footer,article,section,hgroup";e=m(e,",",m(e.toUpperCase()));c=function(o,n){function s(r){return r.replace(/[A-Z]+/g,function(u){return s(o[u])})}var t,q={};for(t in o)if(o.hasOwnProperty(t))o[t]=s(o[t]);s(n).replace(/#/g,"#text").replace(/(\w+)\[([^\]]+)\]\[([^\]]*)\]/g,
function(r,u,x,A){x=b(x,"|");q[u]={attributes:m(x),attributesOrder:x,children:m(A,"|",{"#comment":{}})}});return q}({Z:"H|K|N|O|P",Y:"X|form|R|Q",ZG:"E|span|width|align|char|charoff|valign",X:"p|T|div|U|W|isindex|fieldset|table",ZF:"E|align|char|charoff|valign",W:"pre|hr|blockquote|address|center|noframes",ZE:"abbr|axis|headers|scope|rowspan|colspan|align|char|charoff|valign|nowrap|bgcolor|width|height",ZD:"[E][S]",U:"ul|ol|dl|menu|dir",ZC:"p|Y|div|U|W|table|br|span|bdo|object|applet|img|map|K|N|Q",
T:"h1|h2|h3|h4|h5|h6",ZB:"X|S|Q",S:"R|P",ZA:"a|G|J|M|O|P",R:"a|H|K|N|O",Q:"noscript|P",P:"ins|del|script",O:"input|select|textarea|label|button",N:"M|L",M:"em|strong|dfn|code|q|samp|kbd|var|cite|abbr|acronym",L:"sub|sup",K:"J|I",J:"tt|i|b|u|s|strike",I:"big|small|font|basefont",H:"G|F",G:"br|span|bdo",F:"object|applet|img|map|iframe",E:"A|B|C",D:"accesskey|tabindex|onfocus|onblur",C:"onclick|ondblclick|onmousedown|onmouseup|onmouseover|onmousemove|onmouseout|onkeypress|onkeydown|onkeyup",B:"lang|xml:lang|dir",
A:"id|class|style|title"},"script[id|charset|type|language|src|defer|xml:space][]style[B|id|type|media|title|xml:space][]object[E|declare|classid|codebase|data|type|codetype|archive|standby|width|height|usemap|name|tabindex|align|border|hspace|vspace][#|param|Y]param[id|name|value|valuetype|type][]p[E|align][#|S]a[E|D|charset|type|name|href|hreflang|rel|rev|shape|coords|target][#|Z]br[A|clear][]span[E][#|S]bdo[A|C|B][#|S]applet[A|codebase|archive|code|object|alt|name|width|height|align|hspace|vspace][#|param|Y]h1[E|align][#|S]img[E|src|alt|name|longdesc|width|height|usemap|ismap|align|border|hspace|vspace][]map[B|C|A|name][X|form|Q|area]h2[E|align][#|S]iframe[A|longdesc|name|src|frameborder|marginwidth|marginheight|scrolling|align|width|height][#|Y]h3[E|align][#|S]tt[E][#|S]i[E][#|S]b[E][#|S]u[E][#|S]s[E][#|S]strike[E][#|S]big[E][#|S]small[E][#|S]font[A|B|size|color|face][#|S]basefont[id|size|color|face][]em[E][#|S]strong[E][#|S]dfn[E][#|S]code[E][#|S]q[E|cite][#|S]samp[E][#|S]kbd[E][#|S]var[E][#|S]cite[E][#|S]abbr[E][#|S]acronym[E][#|S]sub[E][#|S]sup[E][#|S]input[E|D|type|name|value|checked|disabled|readonly|size|maxlength|src|alt|usemap|onselect|onchange|accept|align][]select[E|name|size|multiple|disabled|tabindex|onfocus|onblur|onchange][optgroup|option]optgroup[E|disabled|label][option]option[E|selected|disabled|label|value][]textarea[E|D|name|rows|cols|disabled|readonly|onselect|onchange][]label[E|for|accesskey|onfocus|onblur][#|S]button[E|D|name|value|type|disabled][#|p|T|div|U|W|table|G|object|applet|img|map|K|N|Q]h4[E|align][#|S]ins[E|cite|datetime][#|Y]h5[E|align][#|S]del[E|cite|datetime][#|Y]h6[E|align][#|S]div[E|align][#|Y]ul[E|type|compact][li]li[E|type|value][#|Y]ol[E|type|compact|start][li]dl[E|compact][dt|dd]dt[E][#|S]dd[E][#|Y]menu[E|compact][li]dir[E|compact][li]pre[E|width|xml:space][#|ZA]hr[E|align|noshade|size|width][]blockquote[E|cite][#|Y]address[E][#|S|p]center[E][#|Y]noframes[E][#|Y]isindex[A|B|prompt][]fieldset[E][#|legend|Y]legend[E|accesskey|align][#|S]table[E|summary|width|border|frame|rules|cellspacing|cellpadding|align|bgcolor][caption|col|colgroup|thead|tfoot|tbody|tr]caption[E|align][#|S]col[ZG][]colgroup[ZG][col]thead[ZF][tr]tr[ZF|bgcolor][th|td]th[E|ZE][#|Y]form[E|action|method|name|enctype|onsubmit|onreset|accept|accept-charset|target][#|X|R|Q]noscript[E][#|Y]td[E|ZE][#|Y]tfoot[ZF][tr]tbody[ZF][tr]area[E|D|shape|coords|href|nohref|alt|target][]base[id|href|target][]body[E|onload|onunload|background|bgcolor|text|link|vlink|alink][#|Y]");
d=m("checked,compact,declare,defer,disabled,ismap,multiple,nohref,noresize,noshade,nowrap,readonly,selected,autoplay,loop,controls");f=m("area,base,basefont,br,col,frame,hr,img,input,isindex,link,meta,param,embed,source");g=a.extend(m("td,th,iframe,video,audio,object"),f);k=m("pre,script,style,textarea");l=m("colgroup,dd,dt,li,options,p,td,tfoot,th,thead,tr");a.html.Schema=function(o){function n(D){var y,z,I,ga,E,C,O,U,W,Y,v,B,M,J,L,T,ka,F,G=/^([#+-])?([^\[\/]+)(?:\/([^\[]+))?(?:\[([^\]]+)\])?$/,
N=/^([!\-])?(\w+::\w+|[^=:<]+)?(?:([=:<])(.*))?$/,P=/[*?+]/;if(D){D=b(D);if(u["@"]){T=u["@"].attributes;ka=u["@"].attributesOrder}y=0;for(z=D.length;y<z;y++)if(E=G.exec(D[y])){J=E[1];W=E[2];L=E[3];U=E[4];B={};M=[];C={attributes:B,attributesOrder:M};if(J==="#")C.paddEmpty=true;if(J==="-")C.removeEmpty=true;if(T){for(F in T)B[F]=T[F];M.push.apply(M,ka)}if(U){U=b(U,"|");I=0;for(ga=U.length;I<ga;I++)if(E=N.exec(U[I])){O={};v=E[1];Y=E[2].replace(/::/g,":");J=E[3];E=E[4];if(v==="!"){C.attributesRequired=
C.attributesRequired||[];C.attributesRequired.push(Y);O.required=true}if(v==="-"){delete B[Y];M.splice(a.inArray(M,Y),1)}else{if(J){if(J==="="){C.attributesDefault=C.attributesDefault||[];C.attributesDefault.push({name:Y,value:E});O.defaultValue=E}if(J===":"){C.attributesForced=C.attributesForced||[];C.attributesForced.push({name:Y,value:E});O.forcedValue=E}if(J==="<")O.validValues=m(E,"?")}if(P.test(Y)){C.attributePatterns=C.attributePatterns||[];O.pattern=RegExp("^"+Y.replace(/([?+*])/g,".$1")+
"$");C.attributePatterns.push(O)}else{B[Y]||M.push(Y);B[Y]=O}}}}if(!T&&W=="@"){T=B;ka=M}if(L){C.outputName=W;u[L]=C}if(P.test(W)){C.pattern=RegExp("^"+W.replace(/([?+*])/g,".$1")+"$");A.push(C)}else u[W]=C}}}function s(D){u={};A=[];n(D);p(c,function(y,z){x[z]=y.children})}function t(D){var y=/^(~)?(.+)$/;D&&p(b(D),function(z){z=y.exec(z);var I=z[1]==="~",ga=I?"span":"div",E=z[2];x[E]=x[ga];h[E]=ga;I||(e[E]={});p(x,function(C){if(C[ga])C[E]=C[ga]})})}function q(D){var y=/^([+\-]?)(\w+)\[([^\]]+)\]$/;
D&&p(b(D),function(z){z=y.exec(z);var I,ga;if(z){I=(ga=z[1])?x[z[2]]:x[z[2]]={"#comment":{}};I=x[z[2]];p(b(z[3],"|"),function(E){if(ga==="-")delete I[E];else I[E]={}})}})}function r(D){var y=u[D],z;if(y)return y;for(z=A.length;z--;){y=A[z];if(y.pattern.test(D))return y}}var u={},x={},A=[],H;o=o||{};if(o.verify_html===false)o.valid_elements="*[*]";if(o.valid_styles){H={};p(o.valid_styles,function(D,y){H[y]=a.explode(D)})}if(o.valid_elements)s(o.valid_elements);else{p(c,function(D,y){u[y]={attributes:D.attributes,
attributesOrder:D.attributesOrder};x[y]=D.children});p(b("strong/b,em/i"),function(D){D=b(D,"/");u[D[1]].outputName=D[0]});u.img.attributesDefault=[{name:"alt",value:""}];p(b("ol,ul,sub,sup,blockquote,span,font,a,table,tbody,tr"),function(D){u[D].removeEmpty=true});p(b("p,h1,h2,h3,h4,h5,h6,th,td,pre,div,address,caption"),function(D){u[D].paddEmpty=true})}t(o.custom_elements);q(o.valid_children);n(o.extended_valid_elements);q("+ol[ul|ol],+ul[ul|ol]");r("span")||n("span[!data-mce-type|*]");o.invalid_elements&&
a.each(a.explode(o.invalid_elements),function(D){u[D]&&delete u[D]});this.children=x;this.styles=H;this.getBoolAttrs=function(){return d};this.getBlockElements=function(){return e};this.getShortEndedElements=function(){return f};this.getSelfClosingElements=function(){return l};this.getNonEmptyElements=function(){return g};this.getWhiteSpaceElements=function(){return k};this.isValidChild=function(D,y){var z=x[D];return!!(z&&z[y])};this.getElementRule=r;this.getCustomElements=function(){return h};this.addValidElements=
n;this.setValidElements=s;this.addCustomElements=t;this.addValidChildren=q};a.html.Schema.boolAttrMap=d;a.html.Schema.blockElementsMap=e})(tinymce);
(function(a){a.html.SaxParser=function(b,c){var d=this,e=function(){};b=b||{};d.schema=c=c||new a.html.Schema;if(b.fix_self_closing!==false)b.fix_self_closing=true;a.each("comment cdata text start end pi doctype".split(" "),function(f){if(f)d[f]=b[f]||e});d.parse=function(f){function g(L){var T,ka;for(T=o.length;T--;)if(o[T].name===L)break;if(T>=0){for(ka=o.length-1;ka>=T;ka--){L=o[ka];L.valid&&h.end(L.name)}o.length=T}}var h=this,k,l=0,m,p,o=[],n,s,t,q,r,u,x,A,H,D,y,z,I,ga,E,C,O,U,W,Y,v,B=0,M=a.html.Entities.decode,
J;W=RegExp("<(?:(?:!--([\\w\\W]*?)--\>)|(?:!\\[CDATA\\[([\\w\\W]*?)\\]\\]>)|(?:!DOCTYPE([\\w\\W]*?)>)|(?:\\?([^\\s\\/<>]+) ?([\\w\\W]*?)[?/]>)|(?:\\/([^>]+)>)|(?:([^\\s\\/<>]+)\\s*((?:[^\"'>]+(?:(?:\"[^\"]*\")|(?:'[^']*')|[^>]*))*)>))","g");Y=/([\w:\-]+)(?:\s*=\s*(?:(?:\"((?:\\.|[^\"])*)\")|(?:\'((?:\\.|[^\'])*)\')|([^>\s]+)))?/g;v={script:/<\/script[^>]*>/gi,style:/<\/style[^>]*>/gi,noscript:/<\/noscript[^>]*>/gi};u=c.getShortEndedElements();U=c.getSelfClosingElements();x=c.getBoolAttrs();A=b.validate;
r=b.remove_internals;for(J=b.fix_self_closing;k=W.exec(f);){l<k.index&&h.text(M(f.substr(l,k.index-l)));if(m=k[6])g(m.toLowerCase());else if(m=k[7]){m=m.toLowerCase();l=m in u;J&&U[m]&&o.length>0&&o[o.length-1].name===m&&g(m);if(!A||(H=c.getElementRule(m))){D=true;if(A){I=H.attributes;ga=H.attributePatterns}if(z=k[8]){if((q=z.indexOf("data-mce-type")!==-1)&&r)D=false;n=[];n.map={};z.replace(Y,function(L,T,ka,F,G){T=T.toLowerCase();ka=T in x?T:M(ka||F||G||"");if(A&&!q&&T.indexOf("data-")!==0){L=I[T];
if(!L&&ga){for(F=ga.length;F--;){L=ga[F];if(L.pattern.test(T))break}if(F===-1)L=null}if(!L)return;if(L.validValues&&!(ka in L.validValues))return}n.map[T]=ka;n.push({name:T,value:ka})})}else{n=[];n.map={}}if(A&&!q){E=H.attributesRequired;C=H.attributesDefault;if(O=H.attributesForced)for(p=O.length;p--;){y=O[p];t=y.name;y=y.value;if(y==="{$uid}")y="mce_"+B++;n.map[t]=y;n.push({name:t,value:y})}if(C)for(p=C.length;p--;){y=C[p];t=y.name;if(!(t in n.map)){y=y.value;if(y==="{$uid}")y="mce_"+B++;n.map[t]=
y;n.push({name:t,value:y})}}if(E){for(p=E.length;p--;)if(E[p]in n.map)break;if(p===-1)D=false}if(n.map["data-mce-bogus"])D=false}D&&h.start(m,n,l)}else D=false;if(p=v[m]){p.lastIndex=l=k.index+k[0].length;if(k=p.exec(f)){if(D)s=f.substr(l,k.index-l);l=k.index+k[0].length}else{s=f.substr(l);l=f.length}D&&s.length>0&&h.text(s,true);D&&h.end(m);W.lastIndex=l;continue}if(!l)if(!z||z.indexOf("/")!=z.length-1)o.push({name:m,valid:D});else D&&h.end(m)}else if(m=k[1])h.comment(m);else if(m=k[2])h.cdata(m);
else if(m=k[3])h.doctype(m);else if(m=k[4])h.pi(m,k[5]);l=k.index+k[0].length}l<f.length&&h.text(M(f.substr(l)));for(p=o.length-1;p>=0;p--){m=o[p];m.valid&&h.end(m.name)}}}})(tinymce);
(function(a){function b(f,g,h){var k;k=h?"lastChild":"firstChild";h=h?"prev":"next";if(f[k])return f[k];if(f!==g){if(k=f[h])return k;for(f=f.parent;f&&f!==g;f=f.parent)if(k=f[h])return k}}function c(f,g){this.name=f;this.type=g;if(g===1){this.attributes=[];this.attributes.map={}}}var d=/^[ \t\r\n]*$/,e={"#text":3,"#comment":8,"#cdata":4,"#pi":7,"#doctype":10,"#document-fragment":11};a.extend(c.prototype,{replace:function(f){f.parent&&f.remove();this.insert(f,this);this.remove();return this},attr:function(f,
g){var h,k;if(typeof f!=="string"){for(k in f)this.attr(k,f[k]);return this}if(h=this.attributes)if(g!==void 0){if(g===null){if(f in h.map){delete h.map[f];for(k=h.length;k--;)if(h[k].name===f){h.splice(k,1);break}}return this}if(f in h.map)for(k=h.length;k--;){if(h[k].name===f){h[k].value=g;break}}else h.push({name:f,value:g});h.map[f]=g;return this}else return h.map[f]},clone:function(){var f=new c(this.name,this.type),g,h,k,l,m;if(k=this.attributes){m=[];m.map={};g=0;for(h=k.length;g<h;g++){l=
k[g];if(l.name!=="id"){m[m.length]={name:l.name,value:l.value};m.map[l.name]=l.value}}f.attributes=m}f.value=this.value;f.shortEnded=this.shortEnded;return f},wrap:function(f){this.parent.insert(f,this);f.append(this);return this},unwrap:function(){var f,g;for(f=this.firstChild;f;){g=f.next;this.insert(f,this,true);f=g}this.remove()},remove:function(){var f=this.parent,g=this.next,h=this.prev;if(f){if(f.firstChild===this){if(f.firstChild=g)g.prev=null}else h.next=g;if(f.lastChild===this){if(f.lastChild=
h)h.next=null}else g.prev=h;this.parent=this.next=this.prev=null}return this},append:function(f){var g;f.parent&&f.remove();if(g=this.lastChild){g.next=f;f.prev=g;this.lastChild=f}else this.lastChild=this.firstChild=f;f.parent=this;return f},insert:function(f,g,h){var k;f.parent&&f.remove();k=g.parent||this;if(h){if(g===k.firstChild)k.firstChild=f;else g.prev.next=f;f.prev=g.prev;f.next=g;g.prev=f}else{if(g===k.lastChild)k.lastChild=f;else g.next.prev=f;f.next=g.next;f.prev=g;g.next=f}f.parent=k;
return f},getAll:function(f){var g,h=[];for(g=this.firstChild;g;g=b(g,this))g.name===f&&h.push(g);return h},empty:function(){var f,g,h;if(this.firstChild){f=[];for(h=this.firstChild;h;h=b(h,this))f.push(h);for(g=f.length;g--;){h=f[g];h.parent=h.firstChild=h.lastChild=h.next=h.prev=null}}this.firstChild=this.lastChild=null;return this},isEmpty:function(f){var g=this.firstChild,h,k;if(g){do{if(g.type===1){if(g.attributes.map["data-mce-bogus"])continue;if(f[g.name])return false;for(h=g.attributes.length;h--;){k=
g.attributes[h].name;if(k==="name"||k.indexOf("data-")===0)return false}}if(g.type===3&&!d.test(g.value))return false}while(g=b(g,this))}return true},walk:function(f){return b(this,null,f)}});a.extend(c,{create:function(f,g){var h,k;h=new c(f,e[f]||1);if(g)for(k in g)h.attr(k,g[k]);return h}});a.html.Node=c})(tinymce);
(function(a){var b=a.html.Node;a.html.DomParser=function(c,d){function e(m){var p,o,n,s,t,q,r,u,x,A,H;A=a.makeMap("tr,td,th,tbody,thead,tfoot,table");x=d.getNonEmptyElements();for(p=0;p<m.length;p++){o=m[p];if(o.parent){s=[o];for(n=o.parent;n&&!d.isValidChild(n.name,o.name)&&!A[n.name];n=n.parent)s.push(n);if(n&&s.length>1){s.reverse();t=q=f.filterNode(s[0].clone());for(u=0;u<s.length-1;u++){if(d.isValidChild(q.name,s[u].name)){r=f.filterNode(s[u].clone());q.append(r)}else r=q;for(q=s[u].firstChild;q&&
q!=s[u+1];){H=q.next;r.append(q);q=H}q=r}if(t.isEmpty(x))n.insert(o,s[0],true);else{n.insert(t,s[0],true);n.insert(o,t)}n=s[0];if(n.isEmpty(x)||n.firstChild===n.lastChild&&n.firstChild.name==="br")n.empty().remove()}else if(o.parent)if(o.name==="li")if((n=o.prev)&&(n.name==="ul"||n.name==="ul"))n.append(o);else(n=o.next)&&(n.name==="ul"||n.name==="ul")?n.insert(o,n.firstChild,true):o.wrap(f.filterNode(new b("ul",1)));else if(d.isValidChild(o.parent.name,"div")&&d.isValidChild("div",o.name))o.wrap(f.filterNode(new b("div",
1)));else o.name==="style"||o.name==="script"?o.empty().remove():o.unwrap()}}}var f=this,g={},h=[],k={},l={};c=c||{};c.validate="validate"in c?c.validate:true;c.root_name=c.root_name||"body";f.schema=d=d||new a.html.Schema;f.filterNode=function(m){var p,o,n;if(o in g)if(n=k[o])n.push(m);else k[o]=[m];for(p=h.length;p--;){o=h[p].name;if(o in m.attributes.map)if(n=l[o])n.push(m);else l[o]=[m]}return m};f.addNodeFilter=function(m,p){a.each(a.explode(m),function(o){var n=g[o];n||(g[o]=n=[]);n.push(p)})};
f.addAttributeFilter=function(m,p){a.each(a.explode(m),function(o){var n;for(n=0;n<h.length;n++)if(h[n].name===o){h[n].callbacks.push(p);return}h.push({name:o,callbacks:[p]})})};f.parse=function(m,p){function o(){for(var v=q.firstChild,B,M;v;){B=v.next;if(v.type==3||v.type==1&&v.name!=="p"&&!z[v.name]&&!v.attr("data-mce-type")){if(!M){M=n(Y,1);q.insert(M,v)}M.append(v)}else M=null;v=B}}function n(v,B){var M=new b(v,B),J;if(v in g)if(J=k[v])J.push(M);else k[v]=[M];return M}function s(v){var B;for(v=
v.prev;v&&v.type===3;){B=v.value.replace(E,"");if(B.length>0){v.value=B;v=v.prev}else{B=v.prev;v.remove();v=B}}}var t,q,r,u,x,A,H,D,y,z,I,ga=[],E,C,O,U,W,Y;p=p||{};k={};l={};z=a.extend(a.makeMap("script,style,head,html,body,title,meta,param"),d.getBlockElements());W=d.getNonEmptyElements();U=d.children;y=c.validate;Y="forced_root_block"in p?p.forced_root_block:c.forced_root_block;O=d.getWhiteSpaceElements();I=/^[ \t\r\n]+/;E=/[ \t\r\n]+$/;C=/[ \t\r\n]+/g;t=new a.html.SaxParser({validate:y,fix_self_closing:!y,
cdata:function(v){r.append(n("#cdata",4)).value=v},text:function(v,B){var M;if(!O[r.name]){v=v.replace(C," ");if(r.lastChild&&z[r.lastChild.name])v=v.replace(I,"")}if(v.length!==0){M=n("#text",3);M.raw=!!B;r.append(M).value=v}},comment:function(v){r.append(n("#comment",8)).value=v},pi:function(v,B){r.append(n(v,7)).value=B;s(r)},doctype:function(v){r.append(n("#doctype",10)).value=v;s(r)},start:function(v,B,M){var J,L,T;if(J=y?d.getElementRule(v):{}){J=n(J.outputName||v,1);J.attributes=B;J.shortEnded=
M;r.append(J);(L=U[r.name])&&U[J.name]&&!L[J.name]&&ga.push(J);for(L=h.length;L--;){T=h[L].name;if(T in B.map)if(D=l[T])D.push(J);else l[T]=[J]}z[v]&&s(J);M||(r=J)}},end:function(v){var B,M;if(B=y?d.getElementRule(v):{}){if(z[v]){if(!O[r.name]){for(v=r.firstChild;v&&v.type===3;){M=v.value.replace(I,"");if(M.length>0){v.value=M;v=v.next}else{M=v.next;v.remove();v=M}}for(v=r.lastChild;v&&v.type===3;){M=v.value.replace(E,"");if(M.length>0){v.value=M;v=v.prev}else{M=v.prev;v.remove();v=M}}}if((v=r.prev)&&
v.type===3){M=v.value.replace(I,"");if(M.length>0)v.value=M;else v.remove()}}if(B.removeEmpty||B.paddEmpty)if(r.isEmpty(W))if(B.paddEmpty)r.empty().append(new b("#text","3")).value="\u00a0";else if(!r.attributes.map.name){B=r.parent;r.empty().remove();r=B;return}r=r.parent}}},d);q=r=new b(p.context||c.root_name,11);t.parse(m);if(y&&ga.length)if(p.context)p.invalid=true;else e(ga);Y&&q.name=="body"&&o();if(!p.invalid){for(H in k){D=g[H];t=k[H];for(A=t.length;A--;)t[A].parent||t.splice(A,1);u=0;for(x=
D.length;u<x;u++)D[u](t,H,p)}u=0;for(x=h.length;u<x;u++){D=h[u];if(D.name in l){t=l[D.name];for(A=t.length;A--;)t[A].parent||t.splice(A,1);A=0;for(H=D.callbacks.length;A<H;A++)D.callbacks[A](t,D.name,p)}}}return q};c.remove_trailing_brs&&f.addNodeFilter("br",function(m){var p,o=m.length,n,s=d.getBlockElements(),t=d.getNonEmptyElements(),q,r,u;s.body=1;for(p=0;p<o;p++){n=m[p];q=n.parent;if(s[n.parent.name]&&n===q.lastChild){for(r=n.prev;r;){u=r.name;if(u!=="span"||r.attr("data-mce-type")!=="bookmark"){if(u!==
"br")break;if(u==="br"){n=null;break}}r=r.prev}if(n){n.remove();if(q.isEmpty(t)){elementRule=d.getElementRule(q.name);if(elementRule.removeEmpty)q.remove();else if(elementRule.paddEmpty)q.empty().append(new a.html.Node("#text",3)).value="\u00a0"}}}}})}})(tinymce);
tinymce.html.Writer=function(a){var b=[],c,d,e,f,g;a=a||{};c=a.indent;d=tinymce.makeMap(a.indent_before||"");e=tinymce.makeMap(a.indent_after||"");f=tinymce.html.Entities.getEncodeFunc(a.entity_encoding||"raw",a.entities);g=a.element_format=="html";return{start:function(h,k,l){var m,p,o;if(c&&d[h]&&b.length>0){m=b[b.length-1];m.length>0&&m!=="\n"&&b.push("\n")}b.push("<",h);if(k){m=0;for(p=k.length;m<p;m++){o=k[m];b.push(" ",o.name,'="',f(o.value,true),'"')}}b[b.length]=!l||g?">":" />";if(l&&c&&e[h]&&
b.length>0){m=b[b.length-1];m.length>0&&m!=="\n"&&b.push("\n")}},end:function(h){b.push("</",h,">");if(c&&e[h]&&b.length>0){h=b[b.length-1];h.length>0&&h!=="\n"&&b.push("\n")}},text:function(h,k){if(h.length>0)b[b.length]=k?h:f(h)},cdata:function(h){b.push("<![CDATA[",h,"]]\>")},comment:function(h){b.push("<\!--",h,"--\>")},pi:function(h,k){k?b.push("<?",h," ",k,"?>"):b.push("<?",h,"?>");c&&b.push("\n")},doctype:function(h){b.push("<!DOCTYPE",h,">",c?"\n":"")},reset:function(){b.length=0},getContent:function(){return b.join("").replace(/\n$/,
"")}}};
(function(a){a.html.Serializer=function(b,c){var d=new a.html.Writer(b);b=b||{};b.validate="validate"in b?b.validate:true;this.schema=c=c||new a.html.Schema;this.writer=d;this.serialize=function(e){function f(k){var l=g[k.type],m,p,o,n,s,t,q,r;if(l)l(k);else{l=k.name;m=k.shortEnded;p=k.attributes;if(h&&p&&p.length>1){s=[];s.map={};r=c.getElementRule(k.name);t=0;for(q=r.attributesOrder.length;t<q;t++){o=r.attributesOrder[t];if(o in p.map){n=p.map[o];s.map[o]=n;s.push({name:o,value:n})}}t=0;for(q=p.length;t<
q;t++){o=p[t].name;if(!(o in s.map)){n=p.map[o];s.map[o]=n;s.push({name:o,value:n})}}p=s}d.start(k.name,p,m);if(!m){if(k=k.firstChild){do f(k);while(k=k.next)}d.end(l)}}}var g,h;h=b.validate;g={3:function(k){d.text(k.value,k.raw)},8:function(k){d.comment(k.value)},7:function(k){d.pi(k.name,k.value)},10:function(k){d.doctype(k.value)},4:function(k){d.cdata(k.value)},11:function(k){if(k=k.firstChild){do f(k);while(k=k.next)}}};d.reset();if(e.type==1&&!b.inner)f(e);else g[11](e);return d.getContent()}}})(tinymce);
(function(a){var b=a.each,c=a.is,d=a.isWebKit,e=a.isIE,f=a.html.Entities,g=/^([a-z0-9],?)+$/i,h=a.html.Schema.blockElementsMap,k=/^[ \t\r\n]*$/;a.create("tinymce.dom.DOMUtils",{doc:null,root:null,files:null,pixelStyles:/^(top|left|bottom|right|width|height|borderWidth)$/,props:{"for":"htmlFor","class":"className",className:"className",checked:"checked",disabled:"disabled",maxlength:"maxLength",readonly:"readOnly",selected:"selected",value:"value",id:"id",name:"name",type:"type"},DOMUtils:function(l,
m){var p;this.doc=l;this.win=window;this.files={};this.cssFlicker=false;this.counter=0;this.stdMode=!a.isIE||l.documentMode>=8;this.boxModel=!a.isIE||l.compatMode=="CSS1Compat"||this.stdMode;this.hasOuterHTML="outerHTML"in l.createElement("a");this.settings=m=a.extend({keep_values:false,hex_colors:1},m);this.schema=m.schema;this.styles=new a.html.Styles({url_converter:m.url_converter,url_converter_scope:m.url_converter_scope},m.schema);if(a.isIE6)try{l.execCommand("BackgroundImageCache",false,true)}catch(o){this.cssFlicker=
true}if(e&&m.schema){"abbr article aside audio canvas details figcaption figure footer header hgroup mark menu meter nav output progress section summary time video".replace(/\w+/g,function(n){l.createElement(n)});for(p in m.schema.getCustomElements())l.createElement(p)}a.addUnload(this.destroy,this)},getRoot:function(){var l=this.settings;return l&&this.get(l.root_element)||this.doc.body},getViewPort:function(l){var m;l=!l?this.win:l;m=l.document;m=this.boxModel?m.documentElement:m.body;return{x:l.pageXOffset||
m.scrollLeft,y:l.pageYOffset||m.scrollTop,w:l.innerWidth||m.clientWidth,h:l.innerHeight||m.clientHeight}},getRect:function(l){var m;l=this.get(l);m=this.getPos(l);l=this.getSize(l);return{x:m.x,y:m.y,w:l.w,h:l.h}},getSize:function(l){var m,p;l=this.get(l);m=this.getStyle(l,"width");p=this.getStyle(l,"height");if(m.indexOf("px")===-1)m=0;if(p.indexOf("px")===-1)p=0;return{w:parseInt(m)||l.offsetWidth||l.clientWidth,h:parseInt(p)||l.offsetHeight||l.clientHeight}},getParent:function(l,m,p){return this.getParents(l,
m,p,false)},getParents:function(l,m,p,o){var n=this,s,t=n.settings,q=[];l=n.get(l);o=o===undefined;if(t.strict_root)p=p||n.getRoot();if(c(m,"string")){s=m;m=m==="*"?function(r){return r.nodeType==1}:function(r){return n.is(r,s)}}for(;l;){if(l==p||!l.nodeType||l.nodeType===9)break;if(!m||m(l))if(o)q.push(l);else return l;l=l.parentNode}return o?q:null},get:function(l){var m;if(l&&this.doc&&typeof l=="string"){m=l;if((l=this.doc.getElementById(l))&&l.id!==m)return this.doc.getElementsByName(m)[1]}return l},
getNext:function(l,m){return this._findSib(l,m,"nextSibling")},getPrev:function(l,m){return this._findSib(l,m,"previousSibling")},select:function(l,m){return a.dom.Sizzle(l,this.get(m)||this.get(this.settings.root_element)||this.doc,[])},is:function(l,m){var p;if(l.length===undefined){if(m==="*")return l.nodeType==1;if(g.test(m)){m=m.toLowerCase().split(/,/);l=l.nodeName.toLowerCase();for(p=m.length-1;p>=0;p--)if(m[p]==l)return true;return false}}return a.dom.Sizzle.matches(m,l.nodeType?[l]:l).length>
0},add:function(l,m,p,o,n){var s=this;return this.run(l,function(t){var q;q=c(m,"string")?s.doc.createElement(m):m;s.setAttribs(q,p);if(o)o.nodeType?q.appendChild(o):s.setHTML(q,o);return!n?t.appendChild(q):q})},create:function(l,m,p){return this.add(this.doc.createElement(l),l,m,p,1)},createHTML:function(l,m,p){var o="",n;o+="<"+l;for(n in m)if(m.hasOwnProperty(n))o+=" "+n+'="'+this.encode(m[n])+'"';if(typeof p!="undefined")return o+">"+p+"</"+l+">";return o+" />"},remove:function(l,m){return this.run(l,
function(p){var o,n=p.parentNode;if(!n)return null;if(m)for(;o=p.firstChild;)!a.isIE||o.nodeType!==3||o.nodeValue?n.insertBefore(o,p):p.removeChild(o);return n.removeChild(p)})},setStyle:function(l,m,p){var o=this;return o.run(l,function(n){var s;s=n.style;m=m.replace(/-(\D)/g,function(t,q){return q.toUpperCase()});if(o.pixelStyles.test(m)&&(a.is(p,"number")||/^[\-0-9\.]+$/.test(p)))p+="px";switch(m){case "opacity":if(e){s.filter=p===""?"":"alpha(opacity="+p*100+")";if(!l.currentStyle||!l.currentStyle.hasLayout)s.display=
"inline-block"}s[m]=s["-moz-opacity"]=s["-khtml-opacity"]=p||"";break;case "float":e?s.styleFloat=p:s.cssFloat=p;break;default:s[m]=p||""}o.settings.update_styles&&o.setAttrib(n,"data-mce-style")})},getStyle:function(l,m,p){if(l=this.get(l)){if(this.doc.defaultView&&p){m=m.replace(/[A-Z]/g,function(n){return"-"+n});try{return this.doc.defaultView.getComputedStyle(l,null).getPropertyValue(m)}catch(o){return null}}m=m.replace(/-(\D)/g,function(n,s){return s.toUpperCase()});if(m=="float")m=e?"styleFloat":
"cssFloat";if(l.currentStyle&&p)return l.currentStyle[m];return l.style?l.style[m]:undefined}},setStyles:function(l,m){var p=this,o=p.settings,n;n=o.update_styles;o.update_styles=0;b(m,function(s,t){p.setStyle(l,t,s)});o.update_styles=n;o.update_styles&&p.setAttrib(l,o.cssText)},removeAllAttribs:function(l){return this.run(l,function(m){var p,o=m.attributes;for(p=o.length-1;p>=0;p--)m.removeAttributeNode(o.item(p))})},setAttrib:function(l,m,p){var o=this;if(l&&m){if(o.settings.strict)m=m.toLowerCase();
return this.run(l,function(n){var s=o.settings;switch(m){case "style":if(!c(p,"string")){b(p,function(t,q){o.setStyle(n,q,t)});return}if(s.keep_values)p&&!o._isRes(p)?n.setAttribute("data-mce-style",p,2):n.removeAttribute("data-mce-style",2);n.style.cssText=p;break;case "class":n.className=p||"";break;case "src":case "href":if(s.keep_values){if(s.url_converter)p=s.url_converter.call(s.url_converter_scope||o,p,m,n);o.setAttrib(n,"data-mce-"+m,p,2)}break;case "shape":n.setAttribute("data-mce-style",
p)}c(p)&&p!==null&&p.length!==0?n.setAttribute(m,""+p,2):n.removeAttribute(m,2)})}},setAttribs:function(l,m){var p=this;return this.run(l,function(o){b(m,function(n,s){p.setAttrib(o,s,n)})})},getAttrib:function(l,m,p){var o;l=this.get(l);if(!l||l.nodeType!==1)return p===void 0?false:p;c(p)||(p="");if(/^(src|href|style|coords|shape)$/.test(m))if(o=l.getAttribute("data-mce-"+m))return o;if(e&&this.props[m])o=(o=l[this.props[m]])&&o.nodeValue?o.nodeValue:o;o||(o=l.getAttribute(m,2));if(/^(checked|compact|declare|defer|disabled|ismap|multiple|nohref|noshade|nowrap|readonly|selected)$/.test(m)){if(l[this.props[m]]===
true&&o==="")return m;return o?m:""}if(l.nodeName==="FORM"&&l.getAttributeNode(m))return l.getAttributeNode(m).nodeValue;if(m==="style")if(o=o||l.style.cssText){o=this.serializeStyle(this.parseStyle(o),l.nodeName);this.settings.keep_values&&!this._isRes(o)&&l.setAttribute("data-mce-style",o)}if(d&&m==="class"&&o)o=o.replace(/(apple|webkit)\-[a-z\-]+/gi,"");if(e)switch(m){case "rowspan":case "colspan":if(o===1)o="";break;case "size":if(o==="+0"||o===20||o===0)o="";break;case "width":case "height":case "vspace":case "checked":case "disabled":case "readonly":if(o===
0)o="";break;case "hspace":if(o===-1)o="";break;case "maxlength":case "tabindex":if(o===32768||o===2147483647||o==="32768")o="";break;case "multiple":case "compact":case "noshade":case "nowrap":if(o===65535)return m;return p;case "shape":o=o.toLowerCase();break;default:if(m.indexOf("on")===0&&o)o=a._replace(/^function\s+\w+\(\)\s+\{\s+(.*)\s+\}$/,"$1",""+o)}return o!==void 0&&o!==null&&o!==""?""+o:p},getPos:function(l,m){var p=0,o=0,n=this.doc;l=this.get(l);m=m||n.body;if(l){if(l.getBoundingClientRect){l=
l.getBoundingClientRect();o=this.boxModel?n.documentElement:n.body;p=l.left+(n.documentElement.scrollLeft||n.body.scrollLeft)-o.clientTop;o=l.top+(n.documentElement.scrollTop||n.body.scrollTop)-o.clientLeft;return{x:p,y:o}}for(n=l;n&&n!=m&&n.nodeType;){p+=n.offsetLeft||0;o+=n.offsetTop||0;n=n.offsetParent}for(n=l.parentNode;n&&n!=m&&n.nodeType;){p-=n.scrollLeft||0;o-=n.scrollTop||0;n=n.parentNode}}return{x:p,y:o}},parseStyle:function(l){return this.styles.parse(l)},serializeStyle:function(l,m){return this.styles.serialize(l,
m)},loadCSS:function(l){var m=this,p=m.doc,o;l||(l="");o=m.select("head")[0];b(l.split(","),function(n){var s;if(!m.files[n]){m.files[n]=true;s=m.create("link",{rel:"stylesheet",href:a._addVer(n)});if(e&&p.documentMode&&p.recalc)s.onload=function(){p.recalc&&p.recalc();s.onload=null};o.appendChild(s)}})},addClass:function(l,m){return this.run(l,function(p){var o;if(!m)return 0;if(this.hasClass(p,m))return p.className;o=this.removeClass(p,m);return p.className=(o!=""?o+" ":"")+m})},removeClass:function(l,
m){var p=this,o;return p.run(l,function(n){var s;if(p.hasClass(n,m)){o||(o=RegExp("(^|\\s+)"+m+"(\\s+|$)","g"));s=n.className.replace(o," ");s=a.trim(s!=" "?s:"");n.className=s;if(!s){n.removeAttribute("class");n.removeAttribute("className")}return s}return n.className})},hasClass:function(l,m){l=this.get(l);if(!l||!m)return false;return(" "+l.className+" ").indexOf(" "+m+" ")!==-1},show:function(l){return this.setStyle(l,"display","block")},hide:function(l){return this.setStyle(l,"display","none")},
isHidden:function(l){l=this.get(l);return!l||l.style.display=="none"||this.getStyle(l,"display")=="none"},uniqueId:function(l){return(!l?"mce_":l)+this.counter++},setHTML:function(l,m){var p=this;return p.run(l,function(o){if(e){for(;o.firstChild;)o.removeChild(o.firstChild);try{o.innerHTML="<br />"+m;o.removeChild(o.firstChild)}catch(n){o=p.create("div");o.innerHTML="<br />"+m;b(o.childNodes,function(s,t){t&&o.appendChild(s)})}}else o.innerHTML=m;return m})},getOuterHTML:function(l){var m;l=this.get(l);
if(!l)return null;if(l.nodeType===1&&this.hasOuterHTML)return l.outerHTML;m=(l.ownerDocument||this.doc).createElement("body");m.appendChild(l.cloneNode(true));return m.innerHTML},setOuterHTML:function(l,m,p){function o(s,t,q){q=q.createElement("body");q.innerHTML=t;for(t=q.lastChild;t;){n.insertAfter(t.cloneNode(true),s);t=t.previousSibling}n.remove(s)}var n=this;return this.run(l,function(s){s=n.get(s);if(s.nodeType==1){p=p||s.ownerDocument||n.doc;if(e)try{if(e&&s.nodeType==1)s.outerHTML=m;else o(s,
m,p)}catch(t){o(s,m,p)}else o(s,m,p)}})},decode:f.decode,encode:f.encodeAllRaw,insertAfter:function(l,m){m=this.get(m);return this.run(l,function(p){var o,n;o=m.parentNode;(n=m.nextSibling)?o.insertBefore(p,n):o.appendChild(p);return p})},isBlock:function(l){var m=l.nodeType;if(m)return!!(m===1&&h[l.nodeName]);return!!h[l]},replace:function(l,m,p){if(c(m,"array"))l=l.cloneNode(true);return this.run(m,function(o){p&&b(a.grep(o.childNodes),function(n){l.appendChild(n)});return o.parentNode.replaceChild(l,
o)})},rename:function(l,m){var p=this,o;if(l.nodeName!=m.toUpperCase()){o=p.create(m);b(p.getAttribs(l),function(n){p.setAttrib(o,n.nodeName,p.getAttrib(l,n.nodeName))});p.replace(o,l,1)}return o||l},findCommonAncestor:function(l,m){for(var p=l,o;p;){for(o=m;o&&p!=o;)o=o.parentNode;if(p==o)break;p=p.parentNode}if(!p&&l.ownerDocument)return l.ownerDocument.documentElement;return p},toHex:function(l){function m(o){o=parseInt(o).toString(16);return o.length>1?o:"0"+o}var p=/^\s*rgb\s*?\(\s*?([0-9]+)\s*?,\s*?([0-9]+)\s*?,\s*?([0-9]+)\s*?\)\s*$/i.exec(l);
if(p)l="#"+m(p[1])+m(p[2])+m(p[3]);return l},getClasses:function(){function l(t){b(t.imports,function(q){l(q)});b(t.cssRules||t.rules,function(q){switch(q.type||1){case 1:q.selectorText&&b(q.selectorText.split(","),function(r){r=r.replace(/^\s*|\s*$|^\s\./g,"");if(!(/\.mce/.test(r)||!/\.[\w\-]+$/.test(r))){n=r;r=a._replace(/.*\.([a-z0-9_\-]+).*/i,"$1",r);if(!(o&&!(r=o(r,n))))if(!p[r]){m.push({"class":r});p[r]=1}}});break;case 3:l(q.styleSheet)}})}var m=[],p={},o=this.settings.class_filter,n;if(this.classes)return this.classes;
try{b(this.doc.styleSheets,l)}catch(s){}if(m.length>0)this.classes=m;return m},run:function(l,m,p){var o=this,n;if(o.doc&&typeof l==="string")l=o.get(l);if(!l)return false;p=p||this;if(!l.nodeType&&(l.length||l.length===0)){n=[];b(l,function(s,t){if(s){if(typeof s=="string")s=o.doc.getElementById(s);n.push(m.call(p,s,t))}});return n}return m.call(p,l)},getAttribs:function(l){var m;l=this.get(l);if(!l)return[];if(e){m=[];if(l.nodeName=="OBJECT")return l.attributes;l.nodeName==="OPTION"&&this.getAttrib(l,
"selected")&&m.push({specified:1,nodeName:"selected"});l.cloneNode(false).outerHTML.replace(/<\/?[\w:\-]+ ?|=[\"][^\"]+\"|=\'[^\']+\'|=[\w\-]+|>/gi,"").replace(/[\w:\-]+/gi,function(p){m.push({specified:1,nodeName:p})});return m}return l.attributes},isEmpty:function(l,m){var p,o,n,s;if(l=l.firstChild){n=new a.dom.TreeWalker(l);m=m||this.schema?this.schema.getNonEmptyElements():null;do{o=l.nodeType;if(o===1){if(l.getAttribute("data-mce-bogus"))continue;if(m&&m[l.nodeName.toLowerCase()])return false;
this.getAttribs(l);for(p=l.attributes.length;p--;){s=l.attributes[p].nodeName;if(s==="name"||s==="data-mce-bookmark")return false}}if(o===3&&!k.test(l.nodeValue))return false}while(l=n.next())}return true},destroy:function(l){this.events&&this.events.destroy();this.win=this.doc=this.root=this.events=null;l||a.removeUnload(this.destroy)},createRng:function(){var l=this.doc;return l.createRange?l.createRange():new a.dom.Range(this)},nodeIndex:function(l,m){var p=0,o,n;if(l){o=l.nodeType;for(l=l.previousSibling;l;l=
l.previousSibling){n=l.nodeType;if(m&&n==3)if(n==o||!l.nodeValue.length)continue;p++;o=n}}return p},split:function(l,m,p){function o(r){var u,x=r.childNodes,A=r.nodeType;if(!(A==1&&r.getAttribute("data-mce-type")=="bookmark")){for(u=x.length-1;u>=0;u--)o(x[u]);if(A!=9){if(A==3&&r.nodeValue.length>0){if(!n.isBlock(r.parentNode)||a.trim(r.nodeValue).length>0)return}else if(A==1){x=r.childNodes;x.length==1&&x[0]&&x[0].nodeType==1&&x[0].getAttribute("data-mce-type")=="bookmark"&&r.parentNode.insertBefore(x[0],
r);if(x.length||/^(br|hr|input|img)$/i.test(r.nodeName))return}n.remove(r)}return r}}var n=this,s=n.createRng(),t,q;if(l&&m){s.setStart(l.parentNode,n.nodeIndex(l));s.setEnd(m.parentNode,n.nodeIndex(m));t=s.extractContents();s=n.createRng();s.setStart(m.parentNode,n.nodeIndex(m)+1);s.setEnd(l.parentNode,n.nodeIndex(l)+1);s=s.extractContents();q=l.parentNode;q.insertBefore(o(t),l);p?q.replaceChild(p,m):q.insertBefore(m,l);q.insertBefore(o(s),l);n.remove(l);return p||m}},bind:function(l,m,p,o){if(!this.events)this.events=
new a.dom.EventUtils;return this.events.add(l,m,p,o||this)},unbind:function(l,m,p){if(!this.events)this.events=new a.dom.EventUtils;return this.events.remove(l,m,p)},_findSib:function(l,m,p){var o=this,n=m;if(l){if(c(n,"string"))n=function(s){return o.is(s,m)};for(l=l[p];l;l=l[p])if(n(l))return l}return null},_isRes:function(l){return/^(top|left|bottom|right|width|height)/i.test(l)||/;\s*(top|left|bottom|right|width|height)/i.test(l)}});a.DOM=new a.dom.DOMUtils(document,{process_html:0})})(tinymce);
(function(a){function b(c){function d(C,O){l(A,C,O)}function e(C,O){l(H,C,O)}function f(C){d(C.parentNode,E(C))}function g(C){e(C.parentNode,E(C)+1)}function h(C,O){var U;if(C.nodeType==3)return C;if(O<0)return C;for(U=C.firstChild;U&&O>0;){--O;U=U.nextSibling}if(U)return U;return C}function k(C,O,U,W){var Y,v;if(C==U){if(O==W)return 0;if(O<W)return-1;return 1}for(Y=U;Y&&Y.parentNode!=C;)Y=Y.parentNode;if(Y){v=0;for(U=C.firstChild;U!=Y&&v<O;){v++;U=U.nextSibling}if(O<=v)return-1;return 1}for(Y=C;Y&&
Y.parentNode!=U;)Y=Y.parentNode;if(Y){v=0;for(U=U.firstChild;U!=Y&&v<W;){v++;U=U.nextSibling}if(v<W)return-1;return 1}for(O=c.findCommonAncestor(C,U);C&&C.parentNode!=O;)C=C.parentNode;C||(C=O);for(W=U;W&&W.parentNode!=O;)W=W.parentNode;W||(W=O);if(C==W)return 0;for(U=O.firstChild;U;){if(U==C)return-1;if(U==W)return 1;U=U.nextSibling}}function l(C,O,U){if(C){q[y]=O;q[D]=U}else{q[z]=O;q[I]=U}for(O=q[z];O.parentNode;)O=O.parentNode;for(U=q[y];U.parentNode;)U=U.parentNode;if(U==O)k(q[y],q[D],q[z],q[I])>
0&&q.collapse(C);else q.collapse(C);q.collapsed=q[y]==q[z]&&q[D]==q[I];q.commonAncestorContainer=c.findCommonAncestor(q[y],q[z])}function m(C){var O,U=0,W=0,Y;if(q[y]==q[z])return p(C);O=q[z];for(Y=O.parentNode;Y;O=Y,Y=Y.parentNode){if(Y==q[y]){var v=O;O=void 0;Y=void 0;U=void 0;W=void 0;Y=void 0;if(C!=x)O=r.createDocumentFragment();Y=o(v,C);O&&O.appendChild(Y);U=E(v)-q[D];if(!(U<=0))for(Y=v.previousSibling;U>0;){W=Y.previousSibling;Y=t(Y,C);O&&O.insertBefore(Y,O.firstChild);--U;Y=W}if(C!=u){q.setEndBefore(v);
q.collapse(H)}C=O;return C}++U}O=q[y];for(Y=O.parentNode;Y;O=Y,Y=Y.parentNode){if(Y==q[z]){v=O;O=void 0;U=void 0;Y=void 0;U=void 0;W=void 0;Y=void 0;if(C!=x)O=r.createDocumentFragment();Y=n(v,C);O&&O.appendChild(Y);U=E(v);++U;U=q[I]-U;for(Y=v.nextSibling;U>0;){W=Y.nextSibling;Y=t(Y,C);O&&O.appendChild(Y);--U;Y=W}if(C!=u){q.setStartAfter(v);q.collapse(A)}return O}++W}W-=U;for(O=q[y];W>0;){O=O.parentNode;W--}for(U=q[z];W<0;){U=U.parentNode;W++}W=O.parentNode;for(Y=U.parentNode;W!=Y;W=W.parentNode,Y=
Y.parentNode){O=W;U=Y}var B;if(C!=x)v=r.createDocumentFragment();B=n(O,C);v&&v.appendChild(B);W=E(O);Y=E(U);++W;W=Y-W;for(B=O.nextSibling;W>0;){Y=B.nextSibling;B=t(B,C);v&&v.appendChild(B);B=Y;--W}B=o(U,C);v&&v.appendChild(B);if(C!=u){q.setStartAfter(O);q.collapse(A)}return v}function p(C){var O,U,W,Y;if(C!=x)O=r.createDocumentFragment();if(q[D]==q[I])return O;if(q[y].nodeType==3){U=q[y].nodeValue;U=U.substring(q[D],q[I]);if(C!=u){q[y].deleteData(q[D],q[I]-q[D]);q.collapse(A)}if(C==x)return;O.appendChild(r.createTextNode(U));
return O}W=h(q[y],q[D]);for(U=q[I]-q[D];U>0;){Y=W.nextSibling;W=t(W,C);O&&O.appendChild(W);--U;W=Y}C!=u&&q.collapse(A);return O}function o(C,O){var U=h(q[z],q[I]-1),W,Y,v,B=U!=q[z];if(U==C)return s(U,B,H,O);W=U.parentNode;for(Y=s(W,H,H,O);W;){for(;U;){v=U.previousSibling;U=s(U,B,H,O);O!=x&&Y.insertBefore(U,Y.firstChild);B=A;U=v}if(W==C)return Y;U=W.previousSibling;W=W.parentNode;v=s(W,H,H,O);O!=x&&v.appendChild(Y);Y=v}}function n(C,O){var U=h(q[y],q[D]),W=U!=q[y],Y,v,B;if(U==C)return s(U,W,A,O);Y=
U.parentNode;for(v=s(Y,H,A,O);Y;){for(;U;){B=U.nextSibling;U=s(U,W,A,O);O!=x&&v.appendChild(U);W=A;U=B}if(Y==C)return v;U=Y.nextSibling;Y=Y.parentNode;B=s(Y,H,A,O);O!=x&&B.appendChild(v);v=B}}function s(C,O,U,W){var Y;if(O)return t(C,W);if(C.nodeType==3){O=C.nodeValue;if(U){Y=q[D];U=O.substring(Y);O=O.substring(0,Y)}else{Y=q[I];U=O.substring(0,Y);O=O.substring(Y)}if(W!=u)C.nodeValue=O;if(W==x)return;C=C.cloneNode(H);C.nodeValue=U;return C}if(W!=x)return C.cloneNode(H)}function t(C,O){if(O!=x)return O==
u?C.cloneNode(A):C;C.parentNode.removeChild(C)}var q=this,r=c.doc,u=1,x=2,A=true,H=false,D="startOffset",y="startContainer",z="endContainer",I="endOffset",ga=tinymce.extend,E=c.nodeIndex;ga(q,{startContainer:r,startOffset:0,endContainer:r,endOffset:0,collapsed:A,commonAncestorContainer:r,START_TO_START:0,START_TO_END:1,END_TO_END:2,END_TO_START:3,setStart:d,setEnd:e,setStartBefore:f,setStartAfter:function(C){d(C.parentNode,E(C)+1)},setEndBefore:function(C){e(C.parentNode,E(C))},setEndAfter:g,collapse:function(C){if(C){q[z]=
q[y];q[I]=q[D]}else{q[y]=q[z];q[D]=q[I]}q.collapsed=A},selectNode:function(C){f(C);g(C)},selectNodeContents:function(C){d(C,0);e(C,C.nodeType===1?C.childNodes.length:C.nodeValue.length)},compareBoundaryPoints:function(C,O){var U=q[y],W=q[D],Y=q[z],v=q[I],B=O.startContainer,M=O.startOffset,J=O.endContainer,L=O.endOffset;if(C===0)return k(U,W,B,M);if(C===1)return k(Y,v,B,M);if(C===2)return k(Y,v,J,L);if(C===3)return k(U,W,J,L)},deleteContents:function(){m(x)},extractContents:function(){return m(0)},
cloneContents:function(){return m(u)},insertNode:function(C){var O=this[y],U=this[D],W;if((O.nodeType===3||O.nodeType===4)&&O.nodeValue)if(U)if(U>=O.nodeValue.length)c.insertAfter(C,O);else{U=O.splitText(U);O.parentNode.insertBefore(C,U)}else O.parentNode.insertBefore(C,O);else{if(O.childNodes.length>0)W=O.childNodes[U];W?O.insertBefore(C,W):O.appendChild(C)}},surroundContents:function(C){var O=q.extractContents();q.insertNode(C);C.appendChild(O);q.selectNode(C)},cloneRange:function(){return ga(new b(c),
{startContainer:q[y],startOffset:q[D],endContainer:q[z],endOffset:q[I],collapsed:q.collapsed,commonAncestorContainer:q.commonAncestorContainer})}})}a.Range=b})(tinymce.dom);
(function(){tinymce.dom.TridentSelection=function(a){function b(f,g){var h,k=0,l,m,p,o,n,s,t=-1,q;h=f.duplicate();h.collapse(g);q=h.parentElement();if(q.ownerDocument===a.dom.doc){for(;q.contentEditable==="false";)q=q.parentNode;if(!q.hasChildNodes())return{node:q,inside:1};p=q.children;for(l=p.length-1;k<=l;){s=Math.floor((k+l)/2);o=p[s];h.moveToElementText(o);t=h.compareEndPoints(g?"StartToStart":"EndToEnd",f);if(t>0)l=s-1;else if(t<0)k=s+1;else return{node:o}}if(t<0){if(o)h.collapse(false);else{h.moveToElementText(q);
h.collapse(true);o=q;m=true}h.setEndPoint(g?"EndToStart":"EndToEnd",f);if(h.compareEndPoints(g?"StartToStart":"StartToEnd",f)>0){h=f.duplicate();h.collapse(g);for(n=-1;q==h.parentElement();){if(h.move("character",-1)==0)break;n++}}n=n||h.text.replace("\r\n"," ").length}else{h.collapse(true);h.setEndPoint(g?"StartToStart":"StartToEnd",f);n=h.text.replace("\r\n"," ").length}return{node:o,position:t,offset:n,inside:m}}}var c=this,d=a.dom,e=true;this.getBookmark=function(f){function g(m){var p,o,n,s,
t=[];p=m.parentNode;for(o=d.getRoot().parentNode;p!=o;){n=p.children;for(s=n.length;s--;)if(m===n[s]){t.push(s);break}m=p;p=p.parentNode}return t}function h(m){if(m=b(k,m))return{position:m.position,offset:m.offset,indexes:g(m.node),inside:m.inside}}var k=a.getRng(),l={};if(f===2)if(k.item)l.start={ctrl:true,indexes:g(k.item(0))};else{l.start=h(true);if(!a.isCollapsed())l.end=h()}return l};this.moveToBookmark=function(f){function g(m){var p,o,n,s;p=d.getRoot();for(o=m.length-1;o>=0;o--){s=p.children;
n=m[o];if(n<=s.length-1)p=s[n]}return p}function h(m){var p=f[m?"start":"end"],o,n;if(p){o=p.position>0;n=l.createTextRange();n.moveToElementText(g(p.indexes));offset=p.offset;if(offset!==void 0){n.collapse(p.inside||o);n.moveStart("character",o?-offset:offset)}else n.collapse(m);k.setEndPoint(m?"StartToStart":"EndToStart",n);m&&k.collapse(true)}}var k,l=d.doc.body;if(f.start){if(f.start.ctrl){k=l.createControlRange();k.addElement(g(f.start.indexes))}else{k=l.createTextRange();h(true);h()}k.select()}};
this.addRange=function(f){function g(q){var r,u,x,A,H;x=d.create("a");r=q?l:p;u=q?m:o;A=h.duplicate();if(r==n||r==n.documentElement){r=s;u=0}if(r.nodeType==3){r.parentNode.insertBefore(x,r);A.moveToElementText(x);A.moveStart("character",u);d.remove(x);h.setEndPoint(q?"StartToStart":"EndToEnd",A)}else{H=r.childNodes;if(H.length){u>=H.length?d.insertAfter(x,H[H.length-1]):r.insertBefore(x,H[u]);A.moveToElementText(x)}else{x=n.createTextNode("\ufeff");r.appendChild(x);A.moveToElementText(x.parentNode);
A.collapse(e)}h.setEndPoint(q?"StartToStart":"EndToEnd",A);d.remove(x)}}var h,k,l,m,p,o,n=a.dom.doc,s=n.body;l=f.startContainer;m=f.startOffset;p=f.endContainer;o=f.endOffset;h=s.createTextRange();if(l==p&&l.nodeType==1&&m==o-1)if(m==o-1)try{k=s.createControlRange();k.addElement(l.childNodes[m]);k.select();return}catch(t){}g(true);g();h.select()};this.getRangeAt=function(){function f(n){var s=b(g,n),t,q,r=0,u;t=s.node;q=s.offset;if(s.inside&&!t.hasChildNodes())h[n?"setStart":"setEnd"](t,0);else if(q===
void 0)h[n?"setStartBefore":"setEndAfter"](t);else{if(s.position<0){s=s.inside?t.firstChild:t.nextSibling;if(!s){h[n?"setStartAfter":"setEndAfter"](t);return}if(!q){if(s.nodeType==3)h[n?"setStart":"setEnd"](s,0);else h[n?"setStartBefore":"setEndBefore"](s);return}for(;s;){u=s.nodeValue;r+=u.length;if(r>=q){t=s;r-=q;r=u.length-r;break}s=s.nextSibling}}else{s=t.previousSibling;if(!s)return h[n?"setStartBefore":"setEndBefore"](t);if(!q){if(t.nodeType==3)h[n?"setStart":"setEnd"](s,t.nodeValue.length);
else h[n?"setStartAfter":"setEndAfter"](s);return}for(;s;){r+=s.nodeValue.length;if(r>=q){t=s;r-=q;break}s=s.previousSibling}}h[n?"setStart":"setEnd"](t,r)}}var g=a.getRng(),h=d.createRng(),k,l,m,p;k=g.item?g.item(0):g.parentElement();if(k.ownerDocument!=d.doc)return h;l=a.isCollapsed();if(g.item){h.setStart(k.parentNode,d.nodeIndex(k));h.setEnd(h.startContainer,h.startOffset+1);return h}try{f(true);l||f()}catch(o){if(o.number==-2147024809){p=c.getBookmark(2);m=g.duplicate();m.collapse(true);k=m.parentElement();
if(!l){m=g.duplicate();m.collapse(false);m=m.parentElement();m.innerHTML=m.innerHTML}k.innerHTML=k.innerHTML;c.moveToBookmark(p);g=a.getRng();f(true);l||f()}else throw o;}return h}}})();
(function(){function a(q,r,u,x,A,H){A=0;for(var D=x.length;A<D;A++){var y=x[A];if(y){y=y[q];for(var z=false;y;){if(y.sizcache===u){z=x[y.sizset];break}if(y.nodeType===1&&!H){y.sizcache=u;y.sizset=A}if(y.nodeName.toLowerCase()===r){z=y;break}y=y[q]}x[A]=z}}}function b(q,r,u,x,A,H){A=0;for(var D=x.length;A<D;A++){var y=x[A];if(y){y=y[q];for(var z=false;y;){if(y.sizcache===u){z=x[y.sizset];break}if(y.nodeType===1){if(!H){y.sizcache=u;y.sizset=A}if(typeof r!=="string"){if(y===r){z=true;break}}else if(h.filter(r,
[y]).length>0){z=y;break}}y=y[q]}x[A]=z}}}var c=/((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^\[\]]*\]|['"][^'"]*['"]|[^\[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*)/g,d=0,e=Object.prototype.toString,f=false,g=true;[0,0].sort(function(){g=false;return 0});var h=function(q,r,u,x){u=u||[];var A=r=r||document;if(r.nodeType!==1&&r.nodeType!==9)return[];if(!q||typeof q!=="string")return u;var H=[],D,y,z,I,ga=true,E=h.isXML(r),C=q,O;do{c.exec("");if(D=c.exec(C)){C=D[3];H.push(D[1]);if(D[2]){I=
D[3];break}}}while(D);if(H.length>1&&l.exec(q))if(H.length===2&&k.relative[H[0]])y=t(H[0]+H[1],r);else for(y=k.relative[H[0]]?[r]:h(H.shift(),r);H.length;){q=H.shift();if(k.relative[q])q+=H.shift();y=t(q,y)}else{if(!x&&H.length>1&&r.nodeType===9&&!E&&k.match.ID.test(H[0])&&!k.match.ID.test(H[H.length-1])){D=h.find(H.shift(),r,E);r=D.expr?h.filter(D.expr,D.set)[0]:D.set[0]}if(r){D=x?{expr:H.pop(),set:o(x)}:h.find(H.pop(),H.length===1&&(H[0]==="~"||H[0]==="+")&&r.parentNode?r.parentNode:r,E);y=D.expr?
h.filter(D.expr,D.set):D.set;if(H.length>0)z=o(y);else ga=false;for(;H.length;){D=O=H.pop();if(k.relative[O])D=H.pop();else O="";if(D==null)D=r;k.relative[O](z,D,E)}}else z=[]}z||(z=y);z||h.error(O||q);if(e.call(z)==="[object Array]")if(ga)if(r&&r.nodeType===1)for(q=0;z[q]!=null;q++){if(z[q]&&(z[q]===true||z[q].nodeType===1&&h.contains(r,z[q])))u.push(y[q])}else for(q=0;z[q]!=null;q++)z[q]&&z[q].nodeType===1&&u.push(y[q]);else u.push.apply(u,z);else o(z,u);if(I){h(I,A,u,x);h.uniqueSort(u)}return u};
h.uniqueSort=function(q){if(s){f=g;q.sort(s);if(f)for(var r=1;r<q.length;r++)q[r]===q[r-1]&&q.splice(r--,1)}return q};h.matches=function(q,r){return h(q,null,null,r)};h.find=function(q,r,u){var x;if(!q)return[];for(var A=0,H=k.order.length;A<H;A++){var D=k.order[A],y;if(y=k.leftMatch[D].exec(q)){var z=y[1];y.splice(1,1);if(z.substr(z.length-1)!=="\\"){y[1]=(y[1]||"").replace(/\\/g,"");x=k.find[D](y,r,u);if(x!=null){q=q.replace(k.match[D],"");break}}}}x||(x=r.getElementsByTagName("*"));return{set:x,
expr:q}};h.filter=function(q,r,u,x){for(var A=q,H=[],D=r,y,z,I=r&&r[0]&&h.isXML(r[0]);q&&r.length;){for(var ga in k.filter)if((y=k.leftMatch[ga].exec(q))!=null&&y[2]){var E=k.filter[ga],C,O;O=y[1];z=false;y.splice(1,1);if(O.substr(O.length-1)!=="\\"){if(D===H)H=[];if(k.preFilter[ga])if(y=k.preFilter[ga](y,D,u,H,x,I)){if(y===true)continue}else z=C=true;if(y)for(var U=0;(O=D[U])!=null;U++)if(O){C=E(O,y,U,D);var W=x^!!C;if(u&&C!=null)if(W)z=true;else D[U]=false;else if(W){H.push(O);z=true}}if(C!==undefined){u||
(D=H);q=q.replace(k.match[ga],"");if(!z)return[];break}}}if(q===A)if(z==null)h.error(q);else break;A=q}return D};h.error=function(q){throw"Syntax error, unrecognized expression: "+q;};var k=h.selectors={order:["ID","NAME","TAG"],match:{ID:/#((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,CLASS:/\.((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,NAME:/\[name=['"]*((?:[\w\u00c0-\uFFFF\-]|\\.)+)['"]*\]/,ATTR:/\[\s*((?:[\w\u00c0-\uFFFF\-]|\\.)+)\s*(?:(\S?=)\s*(['"]*)(.*?)\3|)\s*\]/,TAG:/^((?:[\w\u00c0-\uFFFF\*\-]|\\.)+)/,CHILD:/:(only|nth|last|first)-child(?:\((even|odd|[\dn+\-]*)\))?/,
POS:/:(nth|eq|gt|lt|first|last|even|odd)(?:\((\d*)\))?(?=[^\-]|$)/,PSEUDO:/:((?:[\w\u00c0-\uFFFF\-]|\\.)+)(?:\((['"]?)((?:\([^\)]+\)|[^\(\)]*)+)\2\))?/},leftMatch:{},attrMap:{"class":"className","for":"htmlFor"},attrHandle:{href:function(q){return q.getAttribute("href")}},relative:{"+":function(q,r){var u=typeof r==="string",x=u&&!/\W/.test(r);u=u&&!x;if(x)r=r.toLowerCase();x=0;for(var A=q.length,H;x<A;x++)if(H=q[x]){for(;(H=H.previousSibling)&&H.nodeType!==1;);q[x]=u||H&&H.nodeName.toLowerCase()===
r?H||false:H===r}u&&h.filter(r,q,true)},">":function(q,r){var u=typeof r==="string",x,A=0,H=q.length;if(u&&!/\W/.test(r))for(r=r.toLowerCase();A<H;A++){if(x=q[A]){u=x.parentNode;q[A]=u.nodeName.toLowerCase()===r?u:false}}else{for(;A<H;A++)if(x=q[A])q[A]=u?x.parentNode:x.parentNode===r;u&&h.filter(r,q,true)}},"":function(q,r,u){var x=d++,A=b,H;if(typeof r==="string"&&!/\W/.test(r)){H=r=r.toLowerCase();A=a}A("parentNode",r,x,q,H,u)},"~":function(q,r,u){var x=d++,A=b,H;if(typeof r==="string"&&!/\W/.test(r)){H=
r=r.toLowerCase();A=a}A("previousSibling",r,x,q,H,u)}},find:{ID:function(q,r,u){if(typeof r.getElementById!=="undefined"&&!u)return(q=r.getElementById(q[1]))?[q]:[]},NAME:function(q,r){if(typeof r.getElementsByName!=="undefined"){for(var u=[],x=r.getElementsByName(q[1]),A=0,H=x.length;A<H;A++)x[A].getAttribute("name")===q[1]&&u.push(x[A]);return u.length===0?null:u}},TAG:function(q,r){return r.getElementsByTagName(q[1])}},preFilter:{CLASS:function(q,r,u,x,A,H){q=" "+q[1].replace(/\\/g,"")+" ";if(H)return q;
H=0;for(var D;(D=r[H])!=null;H++)if(D)if(A^(D.className&&(" "+D.className+" ").replace(/[\t\n]/g," ").indexOf(q)>=0))u||x.push(D);else if(u)r[H]=false;return false},ID:function(q){return q[1].replace(/\\/g,"")},TAG:function(q){return q[1].toLowerCase()},CHILD:function(q){if(q[1]==="nth"){var r=/(-?)(\d*)n((?:\+|-)?\d*)/.exec(q[2]==="even"&&"2n"||q[2]==="odd"&&"2n+1"||!/\D/.test(q[2])&&"0n+"+q[2]||q[2]);q[2]=r[1]+(r[2]||1)-0;q[3]=r[3]-0}q[0]=d++;return q},ATTR:function(q,r,u,x,A,H){r=q[1].replace(/\\/g,
"");if(!H&&k.attrMap[r])q[1]=k.attrMap[r];if(q[2]==="~=")q[4]=" "+q[4]+" ";return q},PSEUDO:function(q,r,u,x,A){if(q[1]==="not")if((c.exec(q[3])||"").length>1||/^\w/.test(q[3]))q[3]=h(q[3],null,null,r);else{q=h.filter(q[3],r,u,true^A);u||x.push.apply(x,q);return false}else if(k.match.POS.test(q[0])||k.match.CHILD.test(q[0]))return true;return q},POS:function(q){q.unshift(true);return q}},filters:{enabled:function(q){return q.disabled===false&&q.type!=="hidden"},disabled:function(q){return q.disabled===
true},checked:function(q){return q.checked===true},selected:function(q){return q.selected===true},parent:function(q){return!!q.firstChild},empty:function(q){return!q.firstChild},has:function(q,r,u){return!!h(u[3],q).length},header:function(q){return/h\d/i.test(q.nodeName)},text:function(q){return"text"===q.type},radio:function(q){return"radio"===q.type},checkbox:function(q){return"checkbox"===q.type},file:function(q){return"file"===q.type},password:function(q){return"password"===q.type},submit:function(q){return"submit"===
q.type},image:function(q){return"image"===q.type},reset:function(q){return"reset"===q.type},button:function(q){return"button"===q.type||q.nodeName.toLowerCase()==="button"},input:function(q){return/input|select|textarea|button/i.test(q.nodeName)}},setFilters:{first:function(q,r){return r===0},last:function(q,r,u,x){return r===x.length-1},even:function(q,r){return r%2===0},odd:function(q,r){return r%2===1},lt:function(q,r,u){return r<u[3]-0},gt:function(q,r,u){return r>u[3]-0},nth:function(q,r,u){return u[3]-
0===r},eq:function(q,r,u){return u[3]-0===r}},filter:{PSEUDO:function(q,r,u,x){var A=r[1],H=k.filters[A];if(H)return H(q,u,r,x);else if(A==="contains")return(q.textContent||q.innerText||h.getText([q])||"").indexOf(r[3])>=0;else if(A==="not"){r=r[3];u=0;for(x=r.length;u<x;u++)if(r[u]===q)return false;return true}else h.error("Syntax error, unrecognized expression: "+A)},CHILD:function(q,r){var u=r[1],x=q;switch(u){case "only":case "first":for(;x=x.previousSibling;)if(x.nodeType===1)return false;if(u===
"first")return true;x=q;case "last":for(;x=x.nextSibling;)if(x.nodeType===1)return false;return true;case "nth":u=r[2];var A=r[3];if(u===1&&A===0)return true;var H=r[0],D=q.parentNode;if(D&&(D.sizcache!==H||!q.nodeIndex)){var y=0;for(x=D.firstChild;x;x=x.nextSibling)if(x.nodeType===1)x.nodeIndex=++y;D.sizcache=H}x=q.nodeIndex-A;return u===0?x===0:x%u===0&&x/u>=0}},ID:function(q,r){return q.nodeType===1&&q.getAttribute("id")===r},TAG:function(q,r){return r==="*"&&q.nodeType===1||q.nodeName.toLowerCase()===
r},CLASS:function(q,r){return(" "+(q.className||q.getAttribute("class"))+" ").indexOf(r)>-1},ATTR:function(q,r){var u=r[1];u=k.attrHandle[u]?k.attrHandle[u](q):q[u]!=null?q[u]:q.getAttribute(u);var x=u+"",A=r[2],H=r[4];return u==null?A==="!=":A==="="?x===H:A==="*="?x.indexOf(H)>=0:A==="~="?(" "+x+" ").indexOf(H)>=0:!H?x&&u!==false:A==="!="?x!==H:A==="^="?x.indexOf(H)===0:A==="$="?x.substr(x.length-H.length)===H:A==="|="?x===H||x.substr(0,H.length+1)===H+"-":false},POS:function(q,r,u,x){var A=k.setFilters[r[2]];
if(A)return A(q,u,r,x)}}},l=k.match.POS,m=function(q,r){return"\\"+(r-0+1)},p;for(p in k.match){k.match[p]=RegExp(k.match[p].source+/(?![^\[]*\])(?![^\(]*\))/.source);k.leftMatch[p]=RegExp(/(^(?:.|\r|\n)*?)/.source+k.match[p].source.replace(/\\(\d+)/g,m))}var o=function(q,r){q=Array.prototype.slice.call(q,0);if(r){r.push.apply(r,q);return r}return q};try{Array.prototype.slice.call(document.documentElement.childNodes,0)}catch(n){o=function(q,r){var u=r||[],x=0;if(e.call(q)==="[object Array]")Array.prototype.push.apply(u,
q);else if(typeof q.length==="number")for(var A=q.length;x<A;x++)u.push(q[x]);else for(;q[x];x++)u.push(q[x]);return u}}var s;if(document.documentElement.compareDocumentPosition)s=function(q,r){if(!q.compareDocumentPosition||!r.compareDocumentPosition){if(q==r)f=true;return q.compareDocumentPosition?-1:1}var u=q.compareDocumentPosition(r)&4?-1:q===r?0:1;if(u===0)f=true;return u};else if("sourceIndex"in document.documentElement)s=function(q,r){if(!q.sourceIndex||!r.sourceIndex){if(q==r)f=true;return q.sourceIndex?
-1:1}var u=q.sourceIndex-r.sourceIndex;if(u===0)f=true;return u};else if(document.createRange)s=function(q,r){if(!q.ownerDocument||!r.ownerDocument){if(q==r)f=true;return q.ownerDocument?-1:1}var u=q.ownerDocument.createRange(),x=r.ownerDocument.createRange();u.setStart(q,0);u.setEnd(q,0);x.setStart(r,0);x.setEnd(r,0);u=u.compareBoundaryPoints(Range.START_TO_END,x);if(u===0)f=true;return u};h.getText=function(q){for(var r="",u,x=0;q[x];x++){u=q[x];if(u.nodeType===3||u.nodeType===4)r+=u.nodeValue;
else if(u.nodeType!==8)r+=h.getText(u.childNodes)}return r};(function(){var q=document.createElement("div"),r="script"+(new Date).getTime();q.innerHTML="<a name='"+r+"'/>";var u=document.documentElement;u.insertBefore(q,u.firstChild);if(document.getElementById(r)){k.find.ID=function(x,A,H){if(typeof A.getElementById!=="undefined"&&!H)return(A=A.getElementById(x[1]))?A.id===x[1]||typeof A.getAttributeNode!=="undefined"&&A.getAttributeNode("id").nodeValue===x[1]?[A]:undefined:[]};k.filter.ID=function(x,
A){var H=typeof x.getAttributeNode!=="undefined"&&x.getAttributeNode("id");return x.nodeType===1&&H&&H.nodeValue===A}}u.removeChild(q);u=q=null})();(function(){var q=document.createElement("div");q.appendChild(document.createComment(""));if(q.getElementsByTagName("*").length>0)k.find.TAG=function(r,u){var x=u.getElementsByTagName(r[1]);if(r[1]==="*"){for(var A=[],H=0;x[H];H++)x[H].nodeType===1&&A.push(x[H]);x=A}return x};q.innerHTML="<a href='#'></a>";if(q.firstChild&&typeof q.firstChild.getAttribute!==
"undefined"&&q.firstChild.getAttribute("href")!=="#")k.attrHandle.href=function(r){return r.getAttribute("href",2)};q=null})();document.querySelectorAll&&function(){var q=h,r=document.createElement("div");r.innerHTML="<p class='TEST'></p>";if(!(r.querySelectorAll&&r.querySelectorAll(".TEST").length===0)){h=function(x,A,H,D){A=A||document;if(!D&&A.nodeType===9&&!h.isXML(A))try{return o(A.querySelectorAll(x),H)}catch(y){}return q(x,A,H,D)};for(var u in q)h[u]=q[u];r=null}}();(function(){var q=document.createElement("div");
q.innerHTML="<div class='test e'></div><div class='test'></div>";if(!(!q.getElementsByClassName||q.getElementsByClassName("e").length===0)){q.lastChild.className="e";if(q.getElementsByClassName("e").length!==1){k.order.splice(1,0,"CLASS");k.find.CLASS=function(r,u,x){if(typeof u.getElementsByClassName!=="undefined"&&!x)return u.getElementsByClassName(r[1])};q=null}}})();h.contains=document.compareDocumentPosition?function(q,r){return!!(q.compareDocumentPosition(r)&16)}:function(q,r){return q!==r&&
(q.contains?q.contains(r):true)};h.isXML=function(q){return(q=(q?q.ownerDocument||q:0).documentElement)?q.nodeName!=="HTML":false};var t=function(q,r){for(var u=[],x="",A,H=r.nodeType?[r]:r;A=k.match.PSEUDO.exec(q);){x+=A[0];q=q.replace(k.match.PSEUDO,"")}q=k.relative[q]?q+"*":q;A=0;for(var D=H.length;A<D;A++)h(q,H[A],u);return h.filter(x,u)};window.tinymce.dom.Sizzle=h})();
(function(a){var b=a.each,c=a.DOM,d=a.isIE,e;a.create("tinymce.dom.EventUtils",{EventUtils:function(){this.inits=[];this.events=[]},add:function(f,g,h,k){var l,m=this,p=m.events,o;if(g instanceof Array){o=[];b(g,function(n){o.push(m.add(f,n,h,k))});return o}if(f&&f.hasOwnProperty&&f instanceof Array){o=[];b(f,function(n){n=c.get(n);o.push(m.add(n,g,h,k))});return o}if(f=c.get(f)){l=function(n){if(!m.disabled){if((n=n||window.event)&&d){if(!n.target)n.target=n.srcElement;a.extend(n,m._stoppers)}if(!k)return h(n);
return h.call(k,n)}};if(g=="unload"){a.unloads.unshift({func:l});return l}if(g=="init"){m.domLoaded?l():m.inits.push(l);return l}p.push({obj:f,name:g,func:h,cfunc:l,scope:k});m._add(f,g,l);return h}},remove:function(f,g,h){var k=this,l=k.events,m=false,p;if(f&&f.hasOwnProperty&&f instanceof Array){p=[];b(f,function(o){o=c.get(o);p.push(k.remove(o,g,h))});return p}f=c.get(f);b(l,function(o,n){if(o.obj==f&&o.name==g&&(!h||o.func==h||o.cfunc==h)){l.splice(n,1);k._remove(f,g,o.cfunc);m=true;return false}});
return m},clear:function(f){var g=this.events,h,k;if(f){f=c.get(f);for(h=g.length-1;h>=0;h--){k=g[h];if(k.obj===f){this._remove(k.obj,k.name,k.cfunc);k.obj=k.cfunc=null;g.splice(h,1)}}}},cancel:function(f){if(!f)return false;this.stop(f);return this.prevent(f)},stop:function(f){if(f.stopPropagation)f.stopPropagation();else f.cancelBubble=true;return false},prevent:function(f){if(f.preventDefault)f.preventDefault();else f.returnValue=false;return false},destroy:function(){var f=this;b(f.events,function(g){f._remove(g.obj,
g.name,g.cfunc);g.obj=g.cfunc=null});f.events=[];f=null},_add:function(f,g,h){if(f.attachEvent)f.attachEvent("on"+g,h);else if(f.addEventListener)f.addEventListener(g,h,false);else f["on"+g]=h},_remove:function(f,g,h){if(f)try{if(f.detachEvent)f.detachEvent("on"+g,h);else if(f.removeEventListener)f.removeEventListener(g,h,false);else f["on"+g]=null}catch(k){}},_pageInit:function(){if(!this.domLoaded){this.domLoaded=true;b(this.inits,function(f){f()});this.inits=[]}},_wait:function(f){var g=this,h=
f.document;if(f.tinyMCE_GZ&&tinyMCE_GZ.loaded)g.domLoaded=1;else{if(h.attachEvent){h.attachEvent("onreadystatechange",function(){if(h.readyState==="complete"){h.detachEvent("onreadystatechange",arguments.callee);g._pageInit(f)}});h.documentElement.doScroll&&f==f.top&&function(){if(!g.domLoaded){try{h.documentElement.doScroll("left")}catch(k){setTimeout(arguments.callee,0);return}g._pageInit(f)}}()}else h.addEventListener&&g._add(f,"DOMContentLoaded",function(){g._pageInit(f)});g._add(f,"load",function(){g._pageInit(f)})}},
_stoppers:{preventDefault:function(){this.returnValue=false},stopPropagation:function(){this.cancelBubble=true}}});e=a.dom.Event=new a.dom.EventUtils;e._wait(window);a.addUnload(function(){e.destroy()})})(tinymce);
(function(a){a.dom.Element=function(b,c){var d=this,e;d.settings=c=c||{};d.id=b;d.dom=e=c.dom||a.DOM;a.isIE||e.get(d.id);a.each("getPos,getRect,getParent,add,setStyle,getStyle,setStyles,setAttrib,setAttribs,getAttrib,addClass,removeClass,hasClass,getOuterHTML,setOuterHTML,remove,show,hide,isHidden,setHTML,get".split(/,/),function(f){d[f]=function(){var g=[b],h;for(h=0;h<arguments.length;h++)g.push(arguments[h]);g=e[f].apply(e,g);d.update(f);return g}});a.extend(d,{on:function(f,g,h){return a.dom.Event.add(d.id,
f,g,h)},getXY:function(){return{x:parseInt(d.getStyle("left")),y:parseInt(d.getStyle("top"))}},getSize:function(){var f=e.get(d.id);return{w:parseInt(d.getStyle("width")||f.clientWidth),h:parseInt(d.getStyle("height")||f.clientHeight)}},moveTo:function(f,g){d.setStyles({left:f,top:g})},moveBy:function(f,g){var h=d.getXY();d.moveTo(h.x+f,h.y+g)},resizeTo:function(f,g){d.setStyles({width:f,height:g})},resizeBy:function(f,g){var h=d.getSize();d.resizeTo(h.w+f,h.h+g)},update:function(f){if(a.isIE6&&c.blocker){f=
f||"";if(!(f.indexOf("get")===0||f.indexOf("has")===0||f.indexOf("is")===0))if(f=="remove")e.remove(d.blocker);else{if(d.blocker)f=e.get(d.blocker);else{d.blocker=e.uniqueId();f=e.add(c.container||e.getRoot(),"iframe",{id:d.blocker,style:"position:absolute;",frameBorder:0,src:'javascript:""'});e.setStyle(f,"opacity",0)}e.setStyles(f,{left:d.getStyle("left",1),top:d.getStyle("top",1),width:d.getStyle("width",1),height:d.getStyle("height",1),display:d.getStyle("display",1),zIndex:parseInt(d.getStyle("zIndex",
1)||0)-1})}}}})}})(tinymce);
(function(a){var b=a.is,c=a.isIE,d=a.each;a.create("tinymce.dom.Selection",{Selection:function(e,f,g){var h=this;h.dom=e;h.win=f;h.serializer=g;d(["onBeforeSetContent","onBeforeGetContent","onSetContent","onGetContent"],function(k){h[k]=new a.util.Dispatcher(h)});if(!h.win.getSelection)h.tridentSel=new a.dom.TridentSelection(h);a.isIE&&e.boxModel&&this._fixIESelection();a.addUnload(h.destroy,h)},setCursorLocation:function(e,f){var g=this.dom.createRng();g.setStart(e,f);g.setEnd(e,f);this.setRng(g);
this.collapse(false)},getContent:function(e){var f=this.getRng(),g=this.dom.create("body"),h=this.getSel(),k,l;e=e||{};k=l="";e.get=true;e.format=e.format||"html";e.forced_root_block="";this.onBeforeGetContent.dispatch(this,e);if(e.format=="text")return this.isCollapsed()?"":f.text||(h.toString?h.toString():"");if(f.cloneContents)(f=f.cloneContents())&&g.appendChild(f);else g.innerHTML=b(f.item)||b(f.htmlText)?f.item?f.item(0).outerHTML:f.htmlText:f.toString();if(/^\s/.test(g.innerHTML))k=" ";if(/\s+$/.test(g.innerHTML))l=
" ";e.getInner=true;e.content=this.isCollapsed()?"":k+this.serializer.serialize(g,e)+l;this.onGetContent.dispatch(this,e);return e.content},setContent:function(e,f){var g=this.getRng(),h,k=this.win.document,l;f=f||{format:"html"};f.set=true;f.content=e;f.no_events||this.onBeforeSetContent.dispatch(this,f);e=f.content;if(g.insertNode){e+='<span id="__caret">_</span>';if(g.startContainer==k&&g.endContainer==k)k.body.innerHTML=e;else{g.deleteContents();if(k.body.childNodes.length==0)k.body.innerHTML=
e;else if(g.createContextualFragment)g.insertNode(g.createContextualFragment(e));else{h=k.createDocumentFragment();l=k.createElement("div");h.appendChild(l);l.outerHTML=e;g.insertNode(h)}}h=this.dom.get("__caret");g=k.createRange();g.setStartBefore(h);g.setEndBefore(h);this.setRng(g);this.dom.remove("__caret");try{this.setRng(g)}catch(m){}}else{if(g.item){k.execCommand("Delete",false,null);g=this.getRng()}g.pasteHTML(e)}f.no_events||this.onSetContent.dispatch(this,f)},getStart:function(){var e=this.getRng(),
f,g;if(e.duplicate||e.item){if(e.item)return e.item(0);f=e.duplicate();f.collapse(1);f=f.parentElement();for(e=g=e.parentElement();g=g.parentNode;)if(g==f){f=e;break}}else{f=e.startContainer;if(f.nodeType==1&&f.hasChildNodes())f=f.childNodes[Math.min(f.childNodes.length-1,e.startOffset)];if(f&&f.nodeType==3)return f.parentNode}return f},getEnd:function(){var e=this.getRng(),f;if(e.duplicate||e.item){if(e.item)return e.item(0);e=e.duplicate();e.collapse(0);if((f=e.parentElement())&&f.nodeName=="BODY")return f.lastChild||
f}else{f=e.endContainer;e=e.endOffset;if(f.nodeType==1&&f.hasChildNodes())f=f.childNodes[e>0?e-1:e];if(f&&f.nodeType==3)return f.parentNode}return f},getBookmark:function(e,f){function g(t,q){var r=0;d(k.select(t),function(u,x){if(u==q)r=x});return r}var h=this,k=h.dom,l,m,p,o,n;if(e==2){if(h.tridentSel)return h.tridentSel.getBookmark(e);return function(){function t(x,A){var H=x[A?"startContainer":"endContainer"],D=x[A?"startOffset":"endOffset"],y=[],z,I=0;if(H.nodeType==3){if(f)for(z=H.previousSibling;z&&
z.nodeType==3;z=z.previousSibling)D+=z.nodeValue.length;y.push(D)}else{z=H.childNodes;if(D>=z.length&&z.length){I=1;D=Math.max(0,z.length-1)}y.push(h.dom.nodeIndex(z[D],f)+I)}for(;H&&H!=r;H=H.parentNode)y.push(h.dom.nodeIndex(H,f));return y}var q=h.getRng(true),r=k.getRoot(),u={};u.start=t(q,true);if(!h.isCollapsed())u.end=t(q);return u}()}if(e)return{rng:h.getRng()};l=h.getRng();p=k.uniqueId();o=tinyMCE.activeEditor.selection.isCollapsed();if(l.duplicate||l.item)if(l.item){n=l.item(0);m=n.nodeName;
return{name:m,index:g(m,n)}}else{m=l.duplicate();try{l.collapse();l.pasteHTML('<span data-mce-type="bookmark" id="'+p+'_start" style="overflow:hidden;line-height:0px">\ufeff</span>');if(!o){m.collapse(false);l.moveToElementText(m.parentElement());l.compareEndPoints("StartToEnd",m)==0&&m.move("character",-1);m.pasteHTML('<span data-mce-type="bookmark" id="'+p+'_end" style="overflow:hidden;line-height:0px">\ufeff</span>')}}catch(s){return null}}else{n=h.getNode();m=n.nodeName;if(m=="IMG")return{name:m,
index:g(m,n)};m=l.cloneRange();if(!o){m.collapse(false);m.insertNode(k.create("span",{"data-mce-type":"bookmark",id:p+"_end",style:"overflow:hidden;line-height:0px"},"\ufeff"))}l.collapse(true);l.insertNode(k.create("span",{"data-mce-type":"bookmark",id:p+"_start",style:"overflow:hidden;line-height:0px"},"\ufeff"))}h.moveToBookmark({id:p,keep:1});return{id:p}},moveToBookmark:function(e){var f=this.dom,g,h,k,l,m,p;if(e)if(e.start){g=f.createRng();h=f.getRoot();var o=function(s){var t=e[s?"start":"end"],
q,r,u;if(t){u=t[0];r=h;for(q=t.length-1;q>=1;q--){r=r.childNodes;if(t[q]>r.length-1)return;r=r[t[q]]}if(r.nodeType===3)u=Math.min(t[0],r.nodeValue.length);if(r.nodeType===1)u=Math.min(t[0],r.childNodes.length);s?g.setStart(r,u):g.setEnd(r,u)}return true};if(this.tridentSel)return this.tridentSel.moveToBookmark(e);o(true)&&o()&&this.setRng(g)}else if(e.id){o=function(s){var t=f.get(e.id+"_"+s),q,r,u;u=e.keep;if(t){q=t.parentNode;if(s=="start"){if(u){q=t.firstChild;r=1}else r=f.nodeIndex(t);k=l=q;m=
p=r}else{if(u){q=t.firstChild;r=1}else r=f.nodeIndex(t);l=q;p=r}if(!u){u=t.previousSibling;q=t.nextSibling;for(d(a.grep(t.childNodes),function(x){if(x.nodeType==3)x.nodeValue=x.nodeValue.replace(/\uFEFF/g,"")});t=f.get(e.id+"_"+s);)f.remove(t,1);if(u&&q&&u.nodeType==q.nodeType&&u.nodeType==3&&!a.isOpera){r=u.nodeValue.length;u.appendData(q.nodeValue);f.remove(q);if(s=="start"){k=l=u;m=p=r}else{l=u;p=r}}}}};var n=function(s){if(f.isBlock(s)&&!s.innerHTML)s.innerHTML=!c?'<br data-mce-bogus="1" />':
" ";return s};o("start");o("end");if(k){g=f.createRng();g.setStart(n(k),m);g.setEnd(n(l),p);this.setRng(g)}}else if(e.name)this.select(f.select(e.name)[e.index]);else e.rng&&this.setRng(e.rng)},select:function(e,f){var g=this.dom,h=g.createRng();if(e){g=g.nodeIndex(e);h.setStart(e.parentNode,g);h.setEnd(e.parentNode,g+1);if(f){g=function(k,l){var m=new a.dom.TreeWalker(k,k);do{if(k.nodeType==3&&a.trim(k.nodeValue).length!=0){l?h.setStart(k,0):h.setEnd(k,k.nodeValue.length);break}if(k.nodeName=="BR"){l?
h.setStartBefore(k):h.setEndBefore(k);break}}while(k=l?m.next():m.prev())};g(e,1);g(e)}this.setRng(h)}return e},isCollapsed:function(){var e=this.getRng(),f=this.getSel();if(!e||e.item)return false;if(e.compareEndPoints)return e.compareEndPoints("StartToEnd",e)===0;return!f||e.collapsed},collapse:function(e){var f=this.getRng(),g;if(f.item){g=f.item(0);f=this.win.document.body.createTextRange();f.moveToElementText(g)}f.collapse(!!e);this.setRng(f)},getSel:function(){var e=this.win;return e.getSelection?
e.getSelection():e.document.selection},getRng:function(e){var f,g,h=this.win.document;if(e&&this.tridentSel)return this.tridentSel.getRangeAt(0);try{if(f=this.getSel())g=f.rangeCount>0?f.getRangeAt(0):f.createRange?f.createRange():h.createRange()}catch(k){}if(a.isIE&&g&&g.setStart&&h.selection.createRange().item){e=h.selection.createRange().item(0);g=h.createRange();g.setStartBefore(e);g.setEndAfter(e)}g||(g=h.createRange?h.createRange():h.body.createTextRange());if(this.selectedRange&&this.explicitRange)if(g.compareBoundaryPoints(g.START_TO_START,
this.selectedRange)===0&&g.compareBoundaryPoints(g.END_TO_END,this.selectedRange)===0)g=this.explicitRange;else this.explicitRange=this.selectedRange=null;return g},setRng:function(e){var f;if(this.tridentSel)if(e.cloneRange)this.tridentSel.addRange(e);else try{e.select()}catch(g){}else if(f=this.getSel()){this.explicitRange=e;try{f.removeAllRanges()}catch(h){}f.addRange(e);this.selectedRange=f.getRangeAt(0)}},setNode:function(e){this.setContent(this.dom.getOuterHTML(e));return e},getNode:function(){var e=
this.getRng();this.getSel();var f,g=e.startContainer,h=e.endContainer;if(!e)return this.dom.getRoot();if(e.setStart){f=e.commonAncestorContainer;if(!e.collapsed){if(e.startContainer==e.endContainer)if(e.endOffset-e.startOffset<2)if(e.startContainer.hasChildNodes())f=e.startContainer.childNodes[e.startOffset];if(g.nodeType===3&&h.nodeType===3){var k=function(l,m){for(var p=l;l&&l.nodeType===3&&l.length===0;)l=m?l.nextSibling:l.previousSibling;return l||p};g=g.length===e.startOffset?k(g.nextSibling,
true):g.parentNode;h=e.endOffset===0?k(h.previousSibling,false):h.parentNode;if(g&&g===h)return g}}if(f&&f.nodeType==3)return f.parentNode;return f}return e.item?e.item(0):e.parentElement()},getSelectedBlocks:function(e,f){var g=this.dom,h,k,l,m=[];h=g.getParent(e||this.getStart(),g.isBlock);k=g.getParent(f||this.getEnd(),g.isBlock);h&&m.push(h);if(h&&k&&h!=k)for(l=h;(l=l.nextSibling)&&l!=k;)g.isBlock(l)&&m.push(l);k&&h!=k&&m.push(k);return m},normalize:function(){function e(k){var l,m,p,o=f.dom;
p=o.getRoot();var n;l=g[(k?"start":"end")+"Container"];m=g[(k?"start":"end")+"Offset"];if(l.nodeType===9){l=l.body;m=0}if(l===p)if(l.hasChildNodes()){l=l.childNodes[Math.min(!k&&m>0?m-1:m,l.childNodes.length-1)];m=0;n=l;p=new a.dom.TreeWalker(l,p);do{if(n.nodeType===3){m=k?0:n.nodeValue.length-1;l=n;break}if(n.nodeName==="BR"){m=o.nodeIndex(n);l=n.parentNode;break}}while(n=k?p.next():p.prev());h=true}if(h)g["set"+(k?"Start":"End")](l,m)}var f=this,g,h;if(!a.isIE){g=f.getRng();e(true);g.collapsed&&
e();h&&f.setRng(g)}},destroy:function(e){this.win=null;e||a.removeUnload(this.destroy)},_fixIESelection:function(){function e(n,s){var t=l.createTextRange();try{t.moveToPoint(n,s)}catch(q){t=null}return t}function f(n){if(n.button){if(n=e(n.x,n.y)){n.compareEndPoints("StartToStart",p)>0?n.setEndPoint("StartToStart",p):n.setEndPoint("EndToEnd",p);n.select()}}else g()}function g(){var n=k.selection.createRange();p&&!n.item&&n.compareEndPoints("StartToEnd",n)===0&&p.select();h.unbind(k,"mouseup",g);
h.unbind(k,"mousemove",f);p=m=0}var h=this.dom,k=h.doc,l=k.body,m,p,o;k.documentElement.unselectable=true;h.bind(k,["mousedown","contextmenu"],function(n){if(n.target.nodeName==="HTML"){m&&g();o=k.documentElement;if(!(o.scrollHeight>o.clientHeight)){m=1;if(p=e(n.x,n.y)){h.bind(k,"mouseup",g);h.bind(k,"mousemove",f);h.win.focus();p.select()}}}})}})})(tinymce);
(function(a){a.dom.Serializer=function(b,c,d){var e,f,g=a.isIE,h=a.each,k;if(!b.apply_source_formatting)b.indent=false;b.remove_trailing_brs=true;c=c||a.DOM;d=d||new a.html.Schema(b);b.entity_encoding=b.entity_encoding||"named";e=new a.util.Dispatcher(self);f=new a.util.Dispatcher(self);k=new a.html.DomParser(b,d);k.addAttributeFilter("src,href,style",function(l,m){for(var p=l.length,o,n,s="data-mce-"+m,t=b.url_converter,q=b.url_converter_scope;p--;){o=l[p];n=o.attributes.map[s];if(n!==void 0){o.attr(m,
n.length>0?n:null);o.attr(s,null)}else{n=o.attributes.map[m];if(m==="style")n=c.serializeStyle(c.parseStyle(n),o.name);else if(t)n=t.call(q,n,m,o.name);o.attr(m,n.length>0?n:null)}}});k.addAttributeFilter("class",function(l){for(var m=l.length,p,o;m--;){p=l[m];o=p.attr("class").replace(/\s*mce(Item\w+|Selected)\s*/g,"");p.attr("class",o.length>0?o:null)}});k.addAttributeFilter("data-mce-type",function(l,m,p){m=l.length;for(var o;m--;){o=l[m];o.attributes.map["data-mce-type"]==="bookmark"&&!p.cleanup&&
o.remove()}});k.addNodeFilter("script,style",function(l,m){function p(t){return t.replace(/(<\!--\[CDATA\[|\]\]--\>)/g,"\n").replace(/^[\r\n]*|[\r\n]*$/g,"").replace(/^\s*(\/\/\s*<\!--|\/\/\s*<!\[CDATA\[|<\!--|<!\[CDATA\[)[\r\n]*/g,"").replace(/\s*(\/\/\s*\]\]>|\/\/\s*--\>|\]\]>|--\>|\]\]--\>)\s*$/g,"")}for(var o=l.length,n,s;o--;){n=l[o];s=n.firstChild?n.firstChild.value:"";if(m==="script"){n.attr("type",(n.attr("type")||"text/javascript").replace(/^mce\-/,""));if(s.length>0)n.firstChild.value="// <![CDATA[\n"+
p(s)+"\n// ]]\>"}else if(s.length>0)n.firstChild.value="<\!--\n"+p(s)+"\n--\>"}});k.addNodeFilter("#comment",function(l){for(var m=l.length,p;m--;){p=l[m];if(p.value.indexOf("[CDATA[")===0){p.name="#cdata";p.type=4;p.value=p.value.replace(/^\[CDATA\[|\]\]$/g,"")}else if(p.value.indexOf("mce:protected ")===0){p.name="#text";p.type=3;p.raw=true;p.value=unescape(p.value).substr(14)}}});k.addNodeFilter("xml:namespace,input",function(l,m){for(var p=l.length,o;p--;){o=l[p];if(o.type===7)o.remove();else o.type===
1&&m==="input"&&!("type"in o.attributes.map)&&o.attr("type","text")}});b.fix_list_elements&&k.addNodeFilter("ul,ol",function(l){for(var m=l.length,p,o;m--;){p=l[m];o=p.parent;if(o.name==="ul"||o.name==="ol")p.prev&&p.prev.name==="li"&&p.prev.append(p)}});k.addAttributeFilter("data-mce-src,data-mce-href,data-mce-style",function(l,m){for(var p=l.length;p--;)l[p].attr(m,null)});return{schema:d,addNodeFilter:k.addNodeFilter,addAttributeFilter:k.addAttributeFilter,onPreProcess:e,onPostProcess:f,serialize:function(l,
m){var p,o,n;if(g&&c.select("script,style,select").length>0){p=l.innerHTML;l=l.cloneNode(false);c.setHTML(l,p)}else l=l.cloneNode(true);p=l.ownerDocument.implementation;if(p.createHTMLDocument){o=p.createHTMLDocument("");h(l.nodeName=="BODY"?l.childNodes:[l],function(s){o.body.appendChild(o.importNode(s,true))});l=l.nodeName!="BODY"?o.body.firstChild:o.body;n=c.doc;c.doc=o}m=m||{};m.format=m.format||"html";if(!m.no_events){m.node=l;e.dispatch(self,m)}p=new a.html.Serializer(b,d);m.content=p.serialize(k.parse(m.getInner?
l.innerHTML:a.trim(c.getOuterHTML(l),m),m));if(!m.cleanup)m.content=m.content.replace(/\uFEFF/g,"");m.no_events||f.dispatch(self,m);if(n)c.doc=n;m.node=null;return m.content},addRules:function(l){d.addValidElements(l)},setRules:function(l){d.setValidElements(l)}}}})(tinymce);
(function(a){a.dom.ScriptLoader=function(){function b(h,k){function l(){p.remove(t);if(o)o.onreadystatechange=o.onload=o=null;k()}function m(){typeof console!=="undefined"&&console.log&&console.log("Failed to load: "+h)}var p=a.DOM,o,n,s,t;t=p.uniqueId();if(a.isIE6){n=new a.util.URI(h);s=location;if(n.host==s.hostname&&n.port==s.port&&n.protocol+":"==s.protocol&&n.protocol.toLowerCase()!="file"){a.util.XHR.send({url:a._addVer(n.getURI()),success:function(q){var r=p.create("script",{type:"text/javascript"});
r.text=q;document.getElementsByTagName("head")[0].appendChild(r);p.remove(r);l()},error:m});return}}o=p.create("script",{id:t,type:"text/javascript",src:a._addVer(h)});if(!a.isIE)o.onload=l;o.onerror=m;if(!a.isOpera)o.onreadystatechange=function(){var q=o.readyState;if(q=="complete"||q=="loaded")l()};(document.getElementsByTagName("head")[0]||document.body).appendChild(o)}var c={},d=[],e={},f=[],g=0;this.isDone=function(h){return c[h]==2};this.markDone=function(h){c[h]=2};this.add=this.load=function(h,
k,l){if(c[h]==void 0){d.push(h);c[h]=0}if(k){e[h]||(e[h]=[]);e[h].push({func:k,scope:l||this})}};this.loadQueue=function(h,k){this.loadScripts(d,h,k)};this.loadScripts=function(h,k,l){function m(o){a.each(e[o],function(n){n.func.call(n.scope)});e[o]=void 0}var p;f.push({func:k,scope:l||this});p=function(){var o=a.grep(h);h.length=0;a.each(o,function(n){if(c[n]==2)m(n);else if(c[n]!=1){c[n]=1;g++;b(n,function(){c[n]=2;g--;m(n);p()})}});if(!g){a.each(f,function(n){n.func.call(n.scope)});f.length=0}};
p()}};a.ScriptLoader=new a.dom.ScriptLoader})(tinymce);tinymce.dom.TreeWalker=function(a,b){function c(e,f,g,h){if(e){if(!h&&e[f])return e[f];if(e!=b){if(f=e[g])return f;for(e=e.parentNode;e&&e!=b;e=e.parentNode)if(f=e[g])return f}}}var d=a;this.current=function(){return d};this.next=function(e){return d=c(d,"firstChild","nextSibling",e)};this.prev=function(e){return d=c(d,"lastChild","previousSibling",e)}};
(function(a){a.dom.RangeUtils=function(b){this.walk=function(c,d){function e(t,q,r){for(var u=[];t&&t!=r;t=t[q])u.push(t);return u}function f(t,q){do{if(t.parentNode==q)return t;t=t.parentNode}while(t)}function g(t,q,r){var u=r?"nextSibling":"previousSibling";p=t;for(o=p.parentNode;p&&p!=q;p=o){o=p.parentNode;n=e(p==t?p:p[u],u);if(n.length){r||n.reverse();d(n)}}}var h=c.startContainer,k=c.startOffset,l=c.endContainer,m=c.endOffset,p,o,n,s;s=b.select("td.mceSelected,th.mceSelected");if(s.length>0)a.each(s,
function(t){d([t])});else{if(h.nodeType==1&&h.hasChildNodes())h=h.childNodes[k];if(l.nodeType==1&&l.hasChildNodes())l=l.childNodes[Math.min(m-1,l.childNodes.length-1)];m=b.findCommonAncestor(h,l);if(h==l)return d([h]);for(p=h;p;p=p.parentNode){if(p==l)return g(h,m,true);if(p==m)break}for(p=l;p;p=p.parentNode){if(p==h)return g(l,m);if(p==m)break}k=f(h,m)||h;m=f(l,m)||l;g(h,k,true);n=e(k==h?k:k.nextSibling,"nextSibling",m==l?m.nextSibling:m);n.length&&d(n);g(l,m)}}};a.dom.RangeUtils.compareRanges=function(b,
c){if(b&&c)if(b.item||b.duplicate){if(b.item&&c.item&&b.item(0)===c.item(0))return true;if(b.isEqual&&c.isEqual&&c.isEqual(b))return true}else return b.startContainer==c.startContainer&&b.startOffset==c.startOffset;return false}})(tinymce);
(function(a){var b=a.dom.Event,c=a.each;a.create("tinymce.ui.KeyboardNavigation",{KeyboardNavigation:function(d,e){var f=this,g=d.root,h=d.items,k=d.enableUpDown,l=d.enableLeftRight||!d.enableUpDown,m=d.excludeFromTabOrder,p,o,n,s,t;e=e||a.DOM;p=function(q){t=q.target.id};o=function(q){e.setAttrib(q.target.id,"tabindex","-1")};s=function(){var q=e.get(t);e.setAttrib(q,"tabindex","0");q.focus()};f.focus=function(){e.get(t).focus()};f.destroy=function(){c(h,function(q){e.unbind(e.get(q.id),"focus",
p);e.unbind(e.get(q.id),"blur",o)});e.unbind(e.get(g),"focus",s);e.unbind(e.get(g),"keydown",n);h=e=g=f.focus=p=o=n=s=null;f.destroy=function(){}};f.moveFocus=function(q,r){var u=-1,x;if(t){c(h,function(A,H){if(A.id===t){u=H;return false}});u+=q;if(u<0)u=h.length-1;else if(u>=h.length)u=0;x=h[u];e.setAttrib(t,"tabindex","-1");e.setAttrib(x.id,"tabindex","0");e.get(x.id).focus();if(d.actOnFocus)d.onAction(x.id);r&&b.cancel(r)}};n=function(q){switch(q.keyCode){case 37:l&&f.moveFocus(-1);break;case 39:l&&
f.moveFocus(1);break;case 38:k&&f.moveFocus(-1);break;case 40:k&&f.moveFocus(1);break;case 27:if(d.onCancel){d.onCancel();b.cancel(q)}break;case 14:case 13:case 32:if(d.onAction){d.onAction(t);b.cancel(q)}}};c(h,function(q,r){var u;if(!q.id)q.id=e.uniqueId("_mce_item_");if(m){e.bind(q.id,"blur",o);u="-1"}else u=r===0?"0":"-1";e.setAttrib(q.id,"tabindex",u);e.bind(e.get(q.id),"focus",p)});if(h[0])t=h[0].id;e.setAttrib(g,"tabindex","-1");e.bind(e.get(g),"focus",s);e.bind(e.get(g),"keydown",n)}})})(tinymce);
(function(a){var b=a.DOM,c=a.is;a.create("tinymce.ui.Control",{Control:function(d,e,f){this.id=d;this.settings=e=e||{};this.rendered=false;this.onRender=new a.util.Dispatcher(this);this.classPrefix="";this.scope=e.scope||this;this.active=this.disabled=0;this.editor=f},setAriaProperty:function(d,e){var f=b.get(this.id+"_aria")||b.get(this.id);f&&b.setAttrib(f,"aria-"+d,!!e)},focus:function(){b.get(this.id).focus()},setDisabled:function(d){if(d!=this.disabled){this.setAriaProperty("disabled",d);this.setState("Disabled",
d);this.setState("Enabled",!d);this.disabled=d}},isDisabled:function(){return this.disabled},setActive:function(d){if(d!=this.active){this.setState("Active",d);this.active=d;this.setAriaProperty("pressed",d)}},isActive:function(){return this.active},setState:function(d,e){var f=b.get(this.id);d=this.classPrefix+d;e?b.addClass(f,d):b.removeClass(f,d)},isRendered:function(){return this.rendered},renderHTML:function(){},renderTo:function(d){b.setHTML(d,this.renderHTML())},postRender:function(){var d;
if(c(this.disabled)){d=this.disabled;this.disabled=-1;this.setDisabled(d)}if(c(this.active)){d=this.active;this.active=-1;this.setActive(d)}},remove:function(){b.remove(this.id);this.destroy()},destroy:function(){a.dom.Event.clear(this.id)}})})(tinymce);tinymce.create("tinymce.ui.Container:tinymce.ui.Control",{Container:function(a,b,c){this.parent(a,b,c);this.controls=[];this.lookup={}},add:function(a){this.lookup[a.id]=a;this.controls.push(a);return a},get:function(a){return this.lookup[a]}});
tinymce.create("tinymce.ui.Separator:tinymce.ui.Control",{Separator:function(a,b){this.parent(a,b);this.classPrefix="mceSeparator";this.setDisabled(true)},renderHTML:function(){return tinymce.DOM.createHTML("span",{"class":this.classPrefix,role:"separator","aria-orientation":"vertical",tabindex:"-1"})}});
(function(a){var b=a.is;a.create("tinymce.ui.MenuItem:tinymce.ui.Control",{MenuItem:function(c,d){this.parent(c,d);this.classPrefix="mceMenuItem"},setSelected:function(c){this.setState("Selected",c);this.setAriaProperty("checked",!!c);this.selected=c},isSelected:function(){return this.selected},postRender:function(){this.parent();b(this.selected)&&this.setSelected(this.selected)}})})(tinymce);
(function(a){var b=a.DOM,c=a.walk;a.create("tinymce.ui.Menu:tinymce.ui.MenuItem",{Menu:function(d,e){this.parent(d,e);this.items={};this.collapsed=false;this.menuCount=0;this.onAddItem=new a.util.Dispatcher(this)},expand:function(d){d&&c(this,function(e){e.expand&&e.expand()},"items",this);this.collapsed=false},collapse:function(d){d&&c(this,function(e){e.collapse&&e.collapse()},"items",this);this.collapsed=true},isCollapsed:function(){return this.collapsed},add:function(d){d.settings||(d=new a.ui.MenuItem(d.id||
b.uniqueId(),d));this.onAddItem.dispatch(this,d);return this.items[d.id]=d},addSeparator:function(){return this.add({separator:true})},addMenu:function(d){d.collapse||(d=this.createMenu(d));this.menuCount++;return this.add(d)},hasMenus:function(){return this.menuCount!==0},remove:function(d){delete this.items[d.id]},removeAll:function(){c(this,function(d){d.removeAll?d.removeAll():d.remove();d.destroy()},"items",this);this.items={}},createMenu:function(d){d=new a.ui.Menu(d.id||b.uniqueId(),d);d.onAddItem.add(this.onAddItem.dispatch,
this.onAddItem);return d}})})(tinymce);
(function(a){var b=a.is,c=a.DOM,d=a.each,e=a.dom.Event,f=a.dom.Element;a.create("tinymce.ui.DropMenu:tinymce.ui.Menu",{DropMenu:function(g,h){h=h||{};h.container=h.container||c.doc.body;h.offset_x=h.offset_x||0;h.offset_y=h.offset_y||0;h.vp_offset_x=h.vp_offset_x||0;h.vp_offset_y=h.vp_offset_y||0;if(b(h.icons)&&!h.icons)h["class"]+=" mceNoIcons";this.parent(g,h);this.onShowMenu=new a.util.Dispatcher(this);this.onHideMenu=new a.util.Dispatcher(this);this.classPrefix="mceMenu"},createMenu:function(g){var h=
this.settings;g.container=g.container||h.container;g.parent=this;g.constrain=g.constrain||h.constrain;g["class"]=g["class"]||h["class"];g.vp_offset_x=g.vp_offset_x||h.vp_offset_x;g.vp_offset_y=g.vp_offset_y||h.vp_offset_y;g.keyboard_focus=h.keyboard_focus;g=new a.ui.DropMenu(g.id||c.uniqueId(),g);g.onAddItem.add(this.onAddItem.dispatch,this.onAddItem);return g},focus:function(){this.keyboardNav&&this.keyboardNav.focus()},update:function(){var g=this.settings,h=c.get("menu_"+this.id+"_tbl"),k=c.get("menu_"+
this.id+"_co"),l,m;l=g.max_width?Math.min(h.clientWidth,g.max_width):h.clientWidth;m=g.max_height?Math.min(h.clientHeight,g.max_height):h.clientHeight;c.boxModel?this.element.setStyles({width:l,height:m}):this.element.setStyles({width:l+2,height:m+2});g.max_width&&c.setStyle(k,"width",l);if(g.max_height){c.setStyle(k,"height",m);h.clientHeight<g.max_height&&c.setStyle(k,"overflow","hidden")}},showMenu:function(g,h,k){var l=this,m=l.settings,p,o=c.getViewPort(),n,s,t,q,r=l.classPrefix;l.collapse(1);
if(!l.isMenuVisible){if(l.rendered)p=c.get("menu_"+l.id);else{p=c.add(l.settings.container,l.renderNode());d(l.items,function(u){u.postRender()});l.element=new f("menu_"+l.id,{blocker:1,container:m.container})}a.isOpera||c.setStyles(p,{left:-65535,top:-65535});c.show(p);l.update();g+=m.offset_x||0;h+=m.offset_y||0;o.w-=4;o.h-=4;if(m.constrain){n=p.clientWidth-2;s=p.clientHeight-2;t=o.x+o.w;o=o.y+o.h;if(g+m.vp_offset_x+n>t)g=k?k-n:Math.max(0,t-m.vp_offset_x-n);if(h+m.vp_offset_y+s>o)h=Math.max(0,o-
m.vp_offset_y-s)}c.setStyles(p,{left:g,top:h});l.element.update();l.isMenuVisible=1;l.mouseClickFunc=e.add(p,"click",function(u){var x;if((u=u.target)&&(u=c.getParent(u,"tr"))&&!c.hasClass(u,r+"ItemSub")){x=l.items[u.id];if(!x.isDisabled()){for(q=l;q;){q.hideMenu&&q.hideMenu();q=q.settings.parent}if(x.settings.onclick)x.settings.onclick(u);return e.cancel(u)}}});if(l.hasMenus())l.mouseOverFunc=e.add(p,"mouseover",function(u){var x;if((u=u.target)&&(u=c.getParent(u,"tr"))){x=l.items[u.id];l.lastMenu&&
l.lastMenu.collapse(1);if(!x.isDisabled())if(u&&c.hasClass(u,r+"ItemSub")){u=c.getRect(u);x.showMenu(u.x+u.w-2,u.y-2,u.x);l.lastMenu=x;c.addClass(c.get(x.id).firstChild,r+"ItemActive")}}});e.add(p,"keydown",l._keyHandler,l);l.onShowMenu.dispatch(l);m.keyboard_focus&&l._setupKeyboardNav()}},hideMenu:function(g){var h=c.get("menu_"+this.id);if(this.isMenuVisible){this.keyboardNav&&this.keyboardNav.destroy();e.remove(h,"mouseover",this.mouseOverFunc);e.remove(h,"click",this.mouseClickFunc);e.remove(h,
"keydown",this._keyHandler);c.hide(h);this.isMenuVisible=0;g||this.collapse(1);this.element&&this.element.hide();if(g=c.get(this.id))c.removeClass(g.firstChild,this.classPrefix+"ItemActive");this.onHideMenu.dispatch(this)}},add:function(g){var h;g=this.parent(g);if(this.isRendered&&(h=c.get("menu_"+this.id)))this._add(c.select("tbody",h)[0],g);return g},collapse:function(g){this.parent(g);this.hideMenu(1)},remove:function(g){c.remove(g.id);this.destroy();return this.parent(g)},destroy:function(){var g=
c.get("menu_"+this.id);this.keyboardNav&&this.keyboardNav.destroy();e.remove(g,"mouseover",this.mouseOverFunc);e.remove(c.select("a",g),"focus",this.mouseOverFunc);e.remove(g,"click",this.mouseClickFunc);e.remove(g,"keydown",this._keyHandler);this.element&&this.element.remove();c.remove(g)},renderNode:function(){var g=this,h=g.settings,k,l,m;m=c.create("div",{role:"listbox",id:"menu_"+g.id,"class":h["class"],style:"position:absolute;left:0;top:0;z-index:200000;outline:0"});g.settings.parent&&c.setAttrib(m,
"aria-parent","menu_"+g.settings.parent.id);l=c.add(m,"div",{role:"presentation",id:"menu_"+g.id+"_co","class":g.classPrefix+(h["class"]?" "+h["class"]:"")});g.element=new f("menu_"+g.id,{blocker:1,container:h.container});h.menu_line&&c.add(l,"span",{"class":g.classPrefix+"Line"});h=c.add(l,"table",{role:"presentation",id:"menu_"+g.id+"_tbl",border:0,cellPadding:0,cellSpacing:0});k=c.add(h,"tbody");d(g.items,function(p){g._add(k,p)});g.rendered=true;return m},_setupKeyboardNav:function(){var g,h,
k=this;g=c.select("#menu_"+k.id)[0];h=c.select("a[role=option]","menu_"+k.id);h.splice(0,0,g);k.keyboardNav=new a.ui.KeyboardNavigation({root:"menu_"+k.id,items:h,onCancel:function(){k.hideMenu()},enableUpDown:true});g.focus()},_keyHandler:function(g){switch(g.keyCode){case 37:if(this.settings.parent){this.hideMenu();this.settings.parent.focus();e.cancel(g)}break;case 39:this.mouseOverFunc&&this.mouseOverFunc(g)}},_add:function(g,h){var k,l=h.settings,m,p,o,n=this.classPrefix;if(l.separator){p=c.add(g,
"tr",{id:h.id,"class":n+"ItemSeparator"});c.add(p,"td",{"class":n+"ItemSeparator"});if(k=p.previousSibling)c.addClass(k,"mceLast")}else{k=p=c.add(g,"tr",{id:h.id,"class":n+"Item "+n+"ItemEnabled"});k=o=c.add(k,l.titleItem?"th":"td");k=m=c.add(k,"a",{id:h.id+"_aria",role:l.titleItem?"presentation":"option",href:"javascript:;",onclick:"return false;",onmousedown:"return false;"});if(l.parent){c.setAttrib(m,"aria-haspopup","true");c.setAttrib(m,"aria-owns","menu_"+h.id)}c.addClass(o,l["class"]);m=c.add(k,
"span",{"class":"mceIcon"+(l.icon?" mce_"+l.icon:"")});l.icon_src&&c.add(m,"img",{src:l.icon_src});k=c.add(k,l.element||"span",{"class":"mceText",title:h.settings.title},h.settings.title);h.settings.style&&c.setAttrib(k,"style",h.settings.style);g.childNodes.length==1&&c.addClass(p,"mceFirst");if((k=p.previousSibling)&&c.hasClass(k,n+"ItemSeparator"))c.addClass(p,"mceFirst");h.collapse&&c.addClass(p,n+"ItemSub");if(k=p.previousSibling)c.removeClass(k,"mceLast");c.addClass(p,"mceLast")}}})})(tinymce);
(function(a){var b=a.DOM;a.create("tinymce.ui.Button:tinymce.ui.Control",{Button:function(c,d,e){this.parent(c,d,e);this.classPrefix="mceButton"},renderHTML:function(){var c=this.classPrefix,d=this.settings,e,f;f=b.encode(d.label||"");e='<a role="button" id="'+this.id+'" href="javascript:;" class="'+c+" "+c+"Enabled "+d["class"]+(f?" "+c+"Labeled":"")+'" onmousedown="return false;" onclick="return false;" aria-labelledby="'+this.id+'_voice" title="'+b.encode(d.title)+'">';e+=d.image&&!(this.editor&&
this.editor.forcedHighContrastMode)?'<img class="mceIcon" src="'+d.image+'" alt="'+b.encode(d.title)+'" />'+f:'<span class="mceIcon '+d["class"]+'"></span>'+(f?'<span class="'+c+'Label">'+f+"</span>":"");e+='<span class="mceVoiceLabel mceIconOnly" style="display: none;" id="'+this.id+'_voice">'+d.title+"</span>";e+="</a>";return e},postRender:function(){var c=this,d=c.settings;a.dom.Event.add(c.id,"click",function(e){if(!c.isDisabled())return d.onclick.call(d.scope,e)})}})})(tinymce);
(function(a){var b=a.DOM,c=a.dom.Event,d=a.each,e=a.util.Dispatcher;a.create("tinymce.ui.ListBox:tinymce.ui.Control",{ListBox:function(f,g,h){this.parent(f,g,h);this.items=[];this.onChange=new e(this);this.onPostRender=new e(this);this.onAdd=new e(this);this.onRenderMenu=new a.util.Dispatcher(this);this.classPrefix="mceListBox"},select:function(f){var g=this,h,k;if(f==undefined)return g.selectByIndex(-1);k=f&&f.call?f:function(l){return l==f};if(f!=g.selectedValue){d(g.items,function(l,m){if(k(l.value)){h=
1;g.selectByIndex(m);return false}});h||g.selectByIndex(-1)}},selectByIndex:function(f){var g,h;if(f!=this.selectedIndex){g=b.get(this.id+"_text");if(h=this.items[f]){this.selectedValue=h.value;this.selectedIndex=f;b.setHTML(g,b.encode(h.title));b.removeClass(g,"mceTitle");b.setAttrib(this.id,"aria-valuenow",h.title)}else{b.setHTML(g,b.encode(this.settings.title));b.addClass(g,"mceTitle");this.selectedValue=this.selectedIndex=null;b.setAttrib(this.id,"aria-valuenow",this.settings.title)}}},add:function(f,
g,h){h=h||{};h=a.extend(h,{title:f,value:g});this.items.push(h);this.onAdd.dispatch(this,h)},getLength:function(){return this.items.length},renderHTML:function(){var f="";f=this.settings;var g=this.classPrefix;f='<span role="button" aria-haspopup="true" aria-labelledby="'+this.id+'_text" aria-describedby="'+this.id+'_voiceDesc"><table role="presentation" tabindex="0" id="'+this.id+'" cellpadding="0" cellspacing="0" class="'+g+" "+g+"Enabled"+(f["class"]?" "+f["class"]:"")+'"><tbody><tr>';f+="<td>"+
b.createHTML("span",{id:this.id+"_voiceDesc","class":"voiceLabel",style:"display:none;"},this.settings.title);f+=b.createHTML("a",{id:this.id+"_text",tabindex:-1,href:"javascript:;","class":"mceText",onclick:"return false;",onmousedown:"return false;"},b.encode(this.settings.title))+"</td>";f+="<td>"+b.createHTML("a",{id:this.id+"_open",tabindex:-1,href:"javascript:;","class":"mceOpen",onclick:"return false;",onmousedown:"return false;"},'<span><span style="display:none;" class="mceIconOnly" aria-hidden="true">\u25bc</span></span>')+
"</td>";f+="</tr></tbody></table></span>";return f},showMenu:function(){var f=this,g,h=b.get(this.id),k;if(!(f.isDisabled()||f.items.length==0)){if(f.menu&&f.menu.isMenuVisible)return f.hideMenu();if(!f.isMenuRendered){f.renderMenu();f.isMenuRendered=true}g=b.getPos(h);k=f.menu;k.settings.offset_x=g.x;k.settings.offset_y=g.y;k.settings.keyboard_focus=!a.isOpera;f.oldID&&k.items[f.oldID].setSelected(0);d(f.items,function(l){if(l.value===f.selectedValue){k.items[l.id].setSelected(1);f.oldID=l.id}});
k.showMenu(0,h.clientHeight);c.add(b.doc,"mousedown",f.hideMenu,f);b.addClass(f.id,f.classPrefix+"Selected")}},hideMenu:function(f){if(this.menu&&this.menu.isMenuVisible){b.removeClass(this.id,this.classPrefix+"Selected");if(!(f&&f.type=="mousedown"&&(f.target.id==this.id+"_text"||f.target.id==this.id+"_open")))if(!f||!b.getParent(f.target,".mceMenu")){b.removeClass(this.id,this.classPrefix+"Selected");c.remove(b.doc,"mousedown",this.hideMenu,this);this.menu.hideMenu()}}},renderMenu:function(){var f=
this,g;g=f.settings.control_manager.createDropMenu(f.id+"_menu",{menu_line:1,"class":f.classPrefix+"Menu mceNoIcons",max_width:150,max_height:150});g.onHideMenu.add(function(){f.hideMenu();f.focus()});g.add({title:f.settings.title,"class":"mceMenuItemTitle",onclick:function(){f.settings.onselect("")!==false&&f.select("")}});d(f.items,function(h){if(h.value===undefined)g.add({title:h.title,"class":"mceMenuItemTitle",onclick:function(){f.settings.onselect("")!==false&&f.select("")}});else{h.id=b.uniqueId();
h.onclick=function(){f.settings.onselect(h.value)!==false&&f.select(h.value)};g.add(h)}});f.onRenderMenu.dispatch(f,g);f.menu=g},postRender:function(){var f=this,g=f.classPrefix;c.add(f.id,"click",f.showMenu,f);c.add(f.id,"keydown",function(h){if(h.keyCode==32){f.showMenu(h);c.cancel(h)}});c.add(f.id,"focus",function(){if(!f._focused){f.keyDownHandler=c.add(f.id,"keydown",function(h){if(h.keyCode==40){f.showMenu();c.cancel(h)}});f.keyPressHandler=c.add(f.id,"keypress",function(h){var k;if(h.keyCode==
13){k=f.selectedValue;f.selectedValue=null;c.cancel(h);f.settings.onselect(k)}})}f._focused=1});c.add(f.id,"blur",function(){c.remove(f.id,"keydown",f.keyDownHandler);c.remove(f.id,"keypress",f.keyPressHandler);f._focused=0});if(a.isIE6||!b.boxModel){c.add(f.id,"mouseover",function(){b.hasClass(f.id,g+"Disabled")||b.addClass(f.id,g+"Hover")});c.add(f.id,"mouseout",function(){b.hasClass(f.id,g+"Disabled")||b.removeClass(f.id,g+"Hover")})}f.onPostRender.dispatch(f,b.get(f.id))},destroy:function(){this.parent();
c.clear(this.id+"_text");c.clear(this.id+"_open")}})})(tinymce);
(function(a){var b=a.DOM,c=a.dom.Event,d=a.each;a.create("tinymce.ui.NativeListBox:tinymce.ui.ListBox",{NativeListBox:function(e,f){this.parent(e,f);this.classPrefix="mceNativeListBox"},setDisabled:function(e){b.get(this.id).disabled=e;this.setAriaProperty("disabled",e)},isDisabled:function(){return b.get(this.id).disabled},select:function(e){var f=this,g,h;if(e==undefined)return f.selectByIndex(-1);h=e&&e.call?e:function(k){return k==e};if(e!=f.selectedValue){d(f.items,function(k,l){if(h(k.value)){g=
1;f.selectByIndex(l);return false}});g||f.selectByIndex(-1)}},selectByIndex:function(e){b.get(this.id).selectedIndex=e+1;this.selectedValue=this.items[e]?this.items[e].value:null},add:function(e,f,g){g=g||{};g.value=f;this.isRendered()&&b.add(b.get(this.id),"option",g,e);e={title:e,value:f,attribs:g};this.items.push(e);this.onAdd.dispatch(this,e)},getLength:function(){return this.items.length},renderHTML:function(){var e;e=b.createHTML("option",{value:""},"-- "+this.settings.title+" --");d(this.items,
function(f){e+=b.createHTML("option",{value:f.value},f.title)});e=b.createHTML("select",{id:this.id,"class":"mceNativeListBox","aria-labelledby":this.id+"_aria"},e);e+=b.createHTML("span",{id:this.id+"_aria",style:"display: none"},this.settings.title);return e},postRender:function(){function e(h){if((h=f.items[h.target.selectedIndex-1])&&(h=h.value)){f.onChange.dispatch(f,h);if(f.settings.onselect)f.settings.onselect(h)}}var f=this,g=true;f.rendered=true;c.add(f.id,"change",e);c.add(f.id,"keydown",
function(h){var k;c.remove(f.id,"change",void 0);g=false;k=c.add(f.id,"blur",function(){if(!g){g=true;c.add(f.id,"change",e);c.remove(f.id,"blur",k)}});if(h.keyCode==13||h.keyCode==32){e(h);return c.cancel(h)}});f.onPostRender.dispatch(f,b.get(f.id))}})})(tinymce);
(function(a){var b=a.DOM,c=a.dom.Event;a.create("tinymce.ui.MenuButton:tinymce.ui.Button",{MenuButton:function(d,e,f){this.parent(d,e,f);this.onRenderMenu=new a.util.Dispatcher(this);e.menu_container=e.menu_container||b.doc.body},showMenu:function(){var d,e=b.get(this.id),f;if(!this.isDisabled()){if(!this.isMenuRendered){this.renderMenu();this.isMenuRendered=true}if(this.isMenuVisible)return this.hideMenu();b.getPos(this.settings.menu_container);d=b.getPos(e);f=this.menu;f.settings.offset_x=d.x;f.settings.offset_y=
d.y;f.settings.vp_offset_x=d.x;f.settings.vp_offset_y=d.y;f.settings.keyboard_focus=this._focused;f.showMenu(0,e.clientHeight);c.add(b.doc,"mousedown",this.hideMenu,this);this.setState("Selected",1);this.isMenuVisible=1}},renderMenu:function(){var d=this,e;e=d.settings.control_manager.createDropMenu(d.id+"_menu",{menu_line:1,"class":this.classPrefix+"Menu",icons:d.settings.icons});e.onHideMenu.add(function(){d.hideMenu();d.focus()});d.onRenderMenu.dispatch(d,e);d.menu=e},hideMenu:function(d){var e=
this;if(!(d&&d.type=="mousedown"&&b.getParent(d.target,function(f){return f.id===e.id||f.id===e.id+"_open"}))){if(!d||!b.getParent(d.target,".mceMenu")){e.setState("Selected",0);c.remove(b.doc,"mousedown",e.hideMenu,e);e.menu&&e.menu.hideMenu()}e.isMenuVisible=0}},postRender:function(){var d=this,e=d.settings;c.add(d.id,"click",function(){if(!d.isDisabled()){if(e.onclick)e.onclick(d.value);d.showMenu()}})}})})(tinymce);
(function(a){var b=a.DOM,c=a.dom.Event;a.create("tinymce.ui.SplitButton:tinymce.ui.MenuButton",{SplitButton:function(d,e,f){this.parent(d,e,f);this.classPrefix="mceSplitButton"},renderHTML:function(){var d,e=this.settings,f;d="<tbody><tr>";f=e.image?b.createHTML("img ",{src:e.image,role:"presentation","class":"mceAction "+e["class"]}):b.createHTML("span",{"class":"mceAction "+e["class"]},"");f+=b.createHTML("span",{"class":"mceVoiceLabel mceIconOnly",id:this.id+"_voice",style:"display:none;"},e.title);
d+="<td >"+b.createHTML("a",{role:"button",id:this.id+"_action",tabindex:"-1",href:"javascript:;","class":"mceAction "+e["class"],onclick:"return false;",onmousedown:"return false;",title:e.title},f)+"</td>";f=b.createHTML("span",{"class":"mceOpen "+e["class"]},'<span style="display:none;" class="mceIconOnly" aria-hidden="true">\u25bc</span>');d+="<td >"+b.createHTML("a",{role:"button",id:this.id+"_open",tabindex:"-1",href:"javascript:;","class":"mceOpen "+e["class"],onclick:"return false;",onmousedown:"return false;",
title:e.title},f)+"</td>";d+="</tr></tbody>";d=b.createHTML("table",{id:this.id,role:"presentation",tabindex:"0","class":"mceSplitButton mceSplitButtonEnabled "+e["class"],cellpadding:"0",cellspacing:"0",title:e.title},d);return b.createHTML("span",{role:"button","aria-labelledby":this.id+"_voice","aria-haspopup":"true"},d)},postRender:function(){var d=this,e=d.settings,f;if(e.onclick){f=function(g){if(!d.isDisabled()){e.onclick(d.value);c.cancel(g)}};c.add(d.id+"_action","click",f);c.add(d.id,["click",
"keydown"],function(g){if((g.keyCode===32||g.keyCode===13||g.keyCode===14)&&!g.altKey&&!g.ctrlKey&&!g.metaKey){f();c.cancel(g)}else if(g.type==="click"||g.keyCode===40){d.showMenu();c.cancel(g)}})}c.add(d.id+"_open","click",function(g){d.showMenu();c.cancel(g)});c.add([d.id,d.id+"_open"],"focus",function(){d._focused=1});c.add([d.id,d.id+"_open"],"blur",function(){d._focused=0});if(a.isIE6||!b.boxModel){c.add(d.id,"mouseover",function(){b.hasClass(d.id,"mceSplitButtonDisabled")||b.addClass(d.id,"mceSplitButtonHover")});
c.add(d.id,"mouseout",function(){b.hasClass(d.id,"mceSplitButtonDisabled")||b.removeClass(d.id,"mceSplitButtonHover")})}},destroy:function(){this.parent();c.clear(this.id+"_action");c.clear(this.id+"_open");c.clear(this.id)}})})(tinymce);
(function(a){var b=a.DOM,c=a.dom.Event,d=a.is,e=a.each;a.create("tinymce.ui.ColorSplitButton:tinymce.ui.SplitButton",{ColorSplitButton:function(f,g,h){this.parent(f,g,h);this.settings=g=a.extend({colors:"000000,993300,333300,003300,003366,000080,333399,333333,800000,FF6600,808000,008000,008080,0000FF,666699,808080,FF0000,FF9900,99CC00,339966,33CCCC,3366FF,800080,999999,FF00FF,FFCC00,FFFF00,00FF00,00FFFF,00CCFF,993366,C0C0C0,FF99CC,FFCC99,FFFF99,CCFFCC,CCFFFF,99CCFF,CC99FF,FFFFFF",grid_width:8,default_color:"#888888"},
this.settings);this.onShowMenu=new a.util.Dispatcher(this);this.onHideMenu=new a.util.Dispatcher(this);this.value=g.default_color},showMenu:function(){var f=this,g,h;if(!f.isDisabled()){if(!f.isMenuRendered){f.renderMenu();f.isMenuRendered=true}if(f.isMenuVisible)return f.hideMenu();g=b.get(f.id);b.show(f.id+"_menu");b.addClass(g,"mceSplitButtonSelected");h=b.getPos(g);b.setStyles(f.id+"_menu",{left:h.x,top:h.y+g.clientHeight,zIndex:2E5});g=0;c.add(b.doc,"mousedown",f.hideMenu,f);f.onShowMenu.dispatch(f);
if(f._focused){f._keyHandler=c.add(f.id+"_menu","keydown",function(k){k.keyCode==27&&f.hideMenu()});b.select("a",f.id+"_menu")[0].focus()}f.isMenuVisible=1}},hideMenu:function(f){var g=this;if(g.isMenuVisible)if(!(f&&f.type=="mousedown"&&b.getParent(f.target,function(h){return h.id===g.id+"_open"}))){if(!f||!b.getParent(f.target,".mceSplitButtonMenu")){b.removeClass(g.id,"mceSplitButtonSelected");c.remove(b.doc,"mousedown",g.hideMenu,g);c.remove(g.id+"_menu","keydown",g._keyHandler);b.hide(g.id+"_menu")}g.isMenuVisible=
0}},renderMenu:function(){var f=this,g,h=0,k=f.settings,l,m,p,o,n;o=b.add(k.menu_container,"div",{role:"listbox",id:f.id+"_menu","class":k.menu_class+" "+k["class"],style:"position:absolute;left:0;top:-1000px;"});g=b.add(o,"div",{"class":k["class"]+" mceSplitButtonMenu"});b.add(g,"span",{"class":"mceMenuLine"});l=b.add(g,"table",{role:"presentation","class":"mceColorSplitMenu"});m=b.add(l,"tbody");h=0;e(d(k.colors,"array")?k.colors:k.colors.split(","),function(s){s=s.replace(/^#/,"");if(!h--){p=b.add(m,
"tr");h=k.grid_width-1}l=b.add(p,"td");l=b.add(l,"a",{role:"option",href:"javascript:;",style:{backgroundColor:"#"+s},title:f.editor.getLang("colors."+s,s),"data-mce-color":"#"+s});if(f.editor.forcedHighContrastMode){l=b.add(l,"canvas",{width:16,height:16,"aria-hidden":"true"});if(l.getContext&&(n=l.getContext("2d"))){n.fillStyle="#"+s;n.fillRect(0,0,16,16)}else b.remove(l)}});if(k.more_colors_func){l=b.add(m,"tr");l=b.add(l,"td",{colspan:k.grid_width,"class":"mceMoreColors"});l=b.add(l,"a",{role:"option",
id:f.id+"_more",href:"javascript:;",onclick:"return false;","class":"mceMoreColors"},k.more_colors_title);c.add(l,"click",function(s){k.more_colors_func.call(k.more_colors_scope||this);return c.cancel(s)})}b.addClass(g,"mceColorSplitMenu");new a.ui.KeyboardNavigation({root:f.id+"_menu",items:b.select("a",f.id+"_menu"),onCancel:function(){f.hideMenu();f.focus()}});c.add(f.id+"_menu","mousedown",function(s){return c.cancel(s)});c.add(f.id+"_menu","click",function(s){var t;if((s=b.getParent(s.target,
"a",m))&&s.nodeName.toLowerCase()=="a"&&(t=s.getAttribute("data-mce-color")))f.setColor(t);return c.cancel(s)});return o},setColor:function(f){this.displayColor(f);this.hideMenu();this.settings.onselect(f)},displayColor:function(f){b.setStyle(this.id+"_preview","backgroundColor",f);this.value=f},postRender:function(){var f=this.id;this.parent();b.add(f+"_action","div",{id:f+"_preview","class":"mceColorPreview"});b.setStyle(this.id+"_preview","backgroundColor",this.value)},destroy:function(){this.parent();
c.clear(this.id+"_menu");c.clear(this.id+"_more");b.remove(this.id+"_menu")}})})(tinymce);
(function(a){var b=a.DOM,c=a.each,d=a.dom.Event;a.create("tinymce.ui.ToolbarGroup:tinymce.ui.Container",{renderHTML:function(){var e=[],f=this.controls,g=a.each,h=this.settings;e.push('<div id="'+this.id+'" role="group" aria-labelledby="'+this.id+'_voice">');e.push("<span role='application'>");e.push('<span id="'+this.id+'_voice" class="mceVoiceLabel" style="display:none;">'+b.encode(h.name)+"</span>");g(f,function(k){e.push(k.renderHTML())});e.push("</span>");e.push("</div>");return e.join("")},
focus:function(){this.keyNav.focus()},postRender:function(){var e=this,f=[];c(e.controls,function(g){c(g.controls,function(h){h.id&&f.push(h)})});e.keyNav=new a.ui.KeyboardNavigation({root:e.id,items:f,onCancel:function(){e.editor.focus()},excludeFromTabOrder:!e.settings.tab_focus_toolbar})},destroy:function(){this.parent();this.keyNav.destroy();d.clear(this.id)}})})(tinymce);
(function(a){var b=a.DOM;a.create("tinymce.ui.Toolbar:tinymce.ui.Container",{renderHTML:function(){var c="",d,e,f=this.settings,g,h,k,l;l=this.controls;for(g=0;g<l.length;g++){e=l[g];h=l[g-1];k=l[g+1];if(g===0){d="mceToolbarStart";if(e.Button)d+=" mceToolbarStartButton";else if(e.SplitButton)d+=" mceToolbarStartSplitButton";else if(e.ListBox)d+=" mceToolbarStartListBox";c+=b.createHTML("td",{"class":d},b.createHTML("span",null,"<\!-- IE --\>"))}if(h&&e.ListBox)if(h.Button||h.SplitButton)c+=b.createHTML("td",
{"class":"mceToolbarEnd"},b.createHTML("span",null,"<\!-- IE --\>"));c+=b.stdMode?'<td style="position: relative">'+e.renderHTML()+"</td>":"<td>"+e.renderHTML()+"</td>";if(k&&e.ListBox)if(k.Button||k.SplitButton)c+=b.createHTML("td",{"class":"mceToolbarStart"},b.createHTML("span",null,"<\!-- IE --\>"))}d="mceToolbarEnd";if(e.Button)d+=" mceToolbarEndButton";else if(e.SplitButton)d+=" mceToolbarEndSplitButton";else if(e.ListBox)d+=" mceToolbarEndListBox";c+=b.createHTML("td",{"class":d},b.createHTML("span",
null,"<\!-- IE --\>"));return b.createHTML("table",{id:this.id,"class":"mceToolbar"+(f["class"]?" "+f["class"]:""),cellpadding:"0",cellspacing:"0",align:this.settings.align||"",role:"presentation",tabindex:"-1"},"<tbody><tr>"+c+"</tr></tbody>")}})})(tinymce);
(function(a){var b=a.util.Dispatcher;a.create("tinymce.AddOnManager",{AddOnManager:function(){this.items=[];this.urls={};this.lookup={};this.onAdd=new b(this)},get:function(c){if(this.lookup[c])return this.lookup[c].instance},dependencies:function(c){var d;if(this.lookup[c])d=this.lookup[c].dependencies;return d||[]},requireLangPack:function(c){var d=a.settings;d&&d.language&&d.language_load!==false&&a.ScriptLoader.add(this.urls[c]+"/langs/"+d.language+".js")},add:function(c,d,e){this.items.push(d);
this.lookup[c]={instance:d,dependencies:e};this.onAdd.dispatch(this,c,d);return d},createUrl:function(c,d){return typeof d==="object"?d:{prefix:c.prefix,resource:d,suffix:c.suffix}},addComponents:function(c,d){var e=this.urls[c];a.each(d,function(f){a.ScriptLoader.add(e+"/"+f)})},load:function(c,d,e,f){function g(){var l=h.dependencies(c);a.each(l,function(m){m=h.createUrl(d,m);h.load(m.resource,m,undefined,undefined)});if(e)f?e.call(f):e.call(a.ScriptLoader)}var h=this,k=d;if(!h.urls[c]){if(typeof d===
"object")k=d.prefix+d.resource+d.suffix;if(k.indexOf("/")!=0&&k.indexOf("://")==-1)k=a.baseURL+"/"+k;h.urls[c]=k.substring(0,k.lastIndexOf("/"));h.lookup[c]?g():a.ScriptLoader.add(k,g,f)}}});a.PluginManager=new a.AddOnManager;a.ThemeManager=new a.AddOnManager})(tinymce);
(function(a){var b=a.each,c=a.extend,d=a.DOM,e=a.dom.Event,f=a.explode,g=a.util.Dispatcher,h=0;a.documentBaseURL=window.location.href.replace(/[\?#].*$/,"").replace(/[\/\\][^\/]+$/,"");/[\/\\]$/.test(a.documentBaseURL)||(a.documentBaseURL+="/");a.baseURL=(new a.util.URI(a.documentBaseURL)).toAbsolute(a.baseURL);a.baseURI=new a.util.URI(a.baseURL);a.onBeforeUnload=new g(a);e.add(window,"beforeunload",function(k){a.onBeforeUnload.dispatch(a,k)});a.onAddEditor=new g(a);a.onRemoveEditor=new g(a);a.EditorManager=
c(a,{editors:[],i18n:{},activeEditor:null,init:function(k){function l(s,t,q){var r=s[t];if(r){if(a.is(r,"string")){q=(q=r.replace(/\.\w+$/,""))?a.resolve(q):0;r=a.resolve(r)}return r.apply(q||this,Array.prototype.slice.call(arguments,2))}}var m=this,p,o=[],n;k=c({theme:"simple",language:"en"},k);m.settings=k;e.add(document,"init",function(){var s,t;l(k,"onpageload");switch(k.mode){case "exact":s=k.elements||"";s.length>0&&b(f(s),function(q){if(d.get(q)){n=new a.Editor(q,k);o.push(n);n.render(1)}else b(document.forms,
function(r){b(r.elements,function(u){if(u.name===q){q="mce_editor_"+h++;d.setAttrib(u,"id",q);n=new a.Editor(q,k);o.push(n);n.render(1)}})})});break;case "textareas":case "specific_textareas":b(d.select("textarea"),function(q){if(!(k.editor_deselector&&(k.editor_deselector.constructor===RegExp?k.editor_deselector.test(q.className):d.hasClass(q,k.editor_deselector))))if(!k.editor_selector||(k.editor_selector.constructor===RegExp?k.editor_selector.test(q.className):d.hasClass(q,k.editor_selector))){p=
d.get(q.name);if(!q.id&&!p)q.id=q.name;if(!q.id||m.get(q.id))q.id=d.uniqueId();n=new a.Editor(q.id,k);o.push(n);n.render(1)}})}if(k.oninit){s=t=0;b(o,function(q){t++;if(q.initialized)s++;else q.onInit.add(function(){s++;s==t&&l(k,"oninit")});s==t&&l(k,"oninit")})}})},get:function(k){if(k===void 0)return this.editors;return this.editors[k]},getInstanceById:function(k){return this.get(k)},add:function(k){var l=this.editors;l[k.id]=k;l.push(k);this._setActive(k);this.onAddEditor.dispatch(this,k);return k},
remove:function(k){var l,m=this.editors;if(!m[k.id])return null;delete m[k.id];for(l=0;l<m.length;l++)if(m[l]==k){m.splice(l,1);break}this.activeEditor==k&&this._setActive(m[0]);k.destroy();this.onRemoveEditor.dispatch(this,k);return k},execCommand:function(k,l,m){var p=this.get(m),o;switch(k){case "mceFocus":p.focus();return true;case "mceAddEditor":case "mceAddControl":this.get(m)||(new a.Editor(m,this.settings)).render();return true;case "mceAddFrameControl":o=m.window;o.tinyMCE=tinyMCE;o.tinymce=
a;a.DOM.doc=o.document;a.DOM.win=o;p=new a.Editor(m.element_id,m);p.render();if(a.isIE){var n=function(){p.destroy();o.detachEvent("onunload",n);o=o.tinyMCE=o.tinymce=null};o.attachEvent("onunload",n)}m.page_window=null;return true;case "mceRemoveEditor":case "mceRemoveControl":p&&p.remove();return true;case "mceToggleEditor":if(!p){this.execCommand("mceAddControl",0,m);return true}p.isHidden()?p.show():p.hide();return true}if(this.activeEditor)return this.activeEditor.execCommand(k,l,m);return false},
execInstanceCommand:function(k,l,m,p){if(k=this.get(k))return k.execCommand(l,m,p);return false},triggerSave:function(){b(this.editors,function(k){k.save()})},addI18n:function(k,l){var m=this.i18n;a.is(k,"string")?b(l,function(p,o){m[k+"."+o]=p}):b(k,function(p,o){b(p,function(n,s){b(n,function(t,q){if(s==="common")m[o+"."+q]=t;else m[o+"."+s+"."+q]=t})})})},_setActive:function(k){this.selectedInstance=this.activeEditor=k}})})(tinymce);
(function(a){var b=a.DOM,c=a.dom.Event,d=a.extend,e=a.util.Dispatcher,f=a.each,g=a.isGecko,h=a.isIE,k=a.is,l=a.ThemeManager,m=a.PluginManager,p=a.explode;a.create("tinymce.Editor",{Editor:function(o,n){var s=this;s.id=s.editorId=o;s.execCommands={};s.queryStateCommands={};s.queryValueCommands={};s.isNotDirty=false;s.plugins={};f(["onPreInit","onBeforeRenderUI","onPostRender","onInit","onRemove","onActivate","onDeactivate","onClick","onEvent","onMouseUp","onMouseDown","onDblClick","onKeyDown","onKeyUp",
"onKeyPress","onContextMenu","onSubmit","onReset","onPaste","onPreProcess","onPostProcess","onBeforeSetContent","onBeforeGetContent","onSetContent","onGetContent","onLoadContent","onSaveContent","onNodeChange","onChange","onBeforeExecCommand","onExecCommand","onUndo","onRedo","onVisualAid","onSetProgressState"],function(t){s[t]=new e(s)});s.settings=n=d({id:o,language:"en",docs_language:"en",theme:"simple",skin:"default",delta_width:0,delta_height:0,popup_css:"",plugins:"",document_base_url:a.documentBaseURL,
add_form_submit_trigger:1,submit_patch:1,add_unload_trigger:1,convert_urls:1,relative_urls:1,remove_script_host:1,table_inline_editing:0,object_resizing:1,cleanup:1,accessibility_focus:1,custom_shortcuts:1,custom_undo_redo_keyboard_shortcuts:1,custom_undo_redo_restore_selection:1,custom_undo_redo:1,doctype:a.isIE6?'<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">':"<!DOCTYPE>",visual_table_class:"mceItemTable",visual:1,font_size_style_values:"xx-small,x-small,small,medium,large,x-large,xx-large",
apply_source_formatting:1,directionality:"ltr",forced_root_block:"p",hidden_input:1,padd_empty_editor:1,render_ui:1,init_theme:1,force_p_newlines:1,indentation:"30px",keep_styles:1,fix_table_elements:1,inline_styles:1,convert_fonts_to_spans:true,indent:"simple",indent_before:"p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,ul,li,area,table,thead,tfoot,tbody,tr",indent_after:"p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,ul,li,area,table,thead,tfoot,tbody,tr",validate:true,
entity_encoding:"named",url_converter:s.convertURL,url_converter_scope:s,ie7_compat:true},n);s.documentBaseURI=new a.util.URI(n.document_base_url||a.documentBaseURL,{base_uri:tinyMCE.baseURI});s.baseURI=a.baseURI;s.contentCSS=[];s.execCallback("setup",s)},render:function(){var o=this,n=o.settings,s=o.id,t=a.ScriptLoader;if(c.domLoaded){tinyMCE.settings=n;if(o.getElement())if(!(a.isIDevice&&!a.isIOS5)){!/TEXTAREA|INPUT/i.test(o.getElement().nodeName)&&n.hidden_input&&b.getParent(s,"form")&&b.insertAfter(b.create("input",
{type:"hidden",name:s}),s);if(a.WindowManager)o.windowManager=new a.WindowManager(o);n.encoding=="xml"&&o.onGetContent.add(function(q,r){if(r.save)r.content=b.encode(r.content)});n.add_form_submit_trigger&&o.onSubmit.addToTop(function(){if(o.initialized){o.save();o.isNotDirty=1}});if(n.add_unload_trigger)o._beforeUnload=tinyMCE.onBeforeUnload.add(function(){o.initialized&&!o.destroyed&&!o.isHidden()&&o.save({format:"raw",no_events:true})});a.addUnload(o.destroy,o);n.submit_patch&&o.onBeforeRenderUI.add(function(){var q=
o.getElement().form;if(q)if(!q._mceOldSubmit){if(!q.submit.nodeType&&!q.submit.length){o.formElement=q;q._mceOldSubmit=q.submit;q.submit=function(){a.triggerSave();o.isNotDirty=1;return o.formElement._mceOldSubmit(o.formElement)}}q=null}});(function(){n.language&&n.language_load!==false&&t.add(a.baseURL+"/langs/"+n.language+".js");n.theme&&n.theme.charAt(0)!="-"&&!l.urls[n.theme]&&l.load(n.theme,"themes/"+n.theme+"/editor_template"+a.suffix+".js");f(p(n.plugins),function(q){if(q&&!m.urls[q])if(q.charAt(0)==
"-"){q=q.substr(1,q.length);q=m.dependencies(q);f(q,function(r){r=m.createUrl({prefix:"plugins/",resource:r,suffix:"/editor_plugin"+a.suffix+".js"},r);m.load(r.resource,r)})}else q!="safari"&&m.load(q,{prefix:"plugins/",resource:q,suffix:"/editor_plugin"+a.suffix+".js"})});t.loadQueue(function(){o.removed||o.init()})})()}}else c.add(document,"init",function(){o.render()})},init:function(){function o(D){var y=m.get(D),z=m.urls[D]||a.documentBaseURL.replace(/\/$/,"");if(y&&a.inArray(H,D)===-1){f(m.dependencies(D),
function(I){o(I)});y=new y(n,z);n.plugins[D]=y;if(y.init){y.init(n,z);H.push(D)}}}var n=this,s=n.settings,t,q,r=n.getElement(),u,x,A,H=[];a.add(n);s.aria_label=s.aria_label||b.getAttrib(r,"aria-label",n.getLang("aria.rich_text_area"));if(s.theme){s.theme=s.theme.replace(/-/,"");u=l.get(s.theme);n.theme=new u;if(n.theme.init&&s.init_theme)n.theme.init(n,l.urls[s.theme]||a.documentBaseURL.replace(/\/$/,""))}f(p(s.plugins.replace(/\-/g,"")),o);if(s.popup_css!==false)s.popup_css=s.popup_css?n.documentBaseURI.toAbsolute(s.popup_css):
n.baseURI.toAbsolute("themes/"+s.theme+"/skins/"+s.skin+"/dialog.css");if(s.popup_css_add)s.popup_css+=","+n.documentBaseURI.toAbsolute(s.popup_css_add);n.controlManager=new a.ControlManager(n);if(s.custom_undo_redo){n.onBeforeExecCommand.add(function(D,y,z,I,ga){if(y!="Undo"&&y!="Redo"&&y!="mceRepaint"&&(!ga||!ga.skip_undo))n.undoManager.beforeChange()});n.onExecCommand.add(function(D,y,z,I,ga){if(y!="Undo"&&y!="Redo"&&y!="mceRepaint"&&(!ga||!ga.skip_undo))n.undoManager.add()})}n.onExecCommand.add(function(D,
y){/^(FontName|FontSize)$/.test(y)||n.nodeChanged()});if(g){A=function(D,y){if(!y||!y.initial)n.execCommand("mceRepaint")};n.onUndo.add(A);n.onRedo.add(A);n.onSetContent.add(A)}n.onBeforeRenderUI.dispatch(n,n.controlManager);if(s.render_ui){t=s.width||r.style.width||r.offsetWidth;q=s.height||r.style.height||r.offsetHeight;n.orgDisplay=r.style.display;A=/^[0-9\.]+(|px)$/i;if(A.test(""+t))t=Math.max(parseInt(t)+(u.deltaWidth||0),100);if(A.test(""+q))q=Math.max(parseInt(q)+(u.deltaHeight||0),100);u=
n.theme.renderUI({targetNode:r,width:t,height:q,deltaWidth:s.delta_width,deltaHeight:s.delta_height});n.editorContainer=u.editorContainer}if(document.domain&&location.hostname!=document.domain)a.relaxedDomain=document.domain;b.setStyles(u.sizeContainer||u.editorContainer,{width:t,height:q});s.content_css&&a.each(p(s.content_css),function(D){n.contentCSS.push(n.documentBaseURI.toAbsolute(D))});q=(u.iframeHeight||q)+(typeof q=="number"?u.deltaHeight||0:"");if(q<100)q=100;n.iframeHTML=s.doctype+'<html><head xmlns="http://www.w3.org/1999/xhtml">';
if(s.document_base_url!=a.documentBaseURL)n.iframeHTML+='<base href="'+n.documentBaseURI.getURI()+'" />';n.iframeHTML+=s.ie7_compat?'<meta http-equiv="X-UA-Compatible" content="IE=7" />':'<meta http-equiv="X-UA-Compatible" content="IE=edge" />';n.iframeHTML+='<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />';if(!g||!/Firefox\/2/.test(navigator.userAgent)){for(t=0;t<n.contentCSS.length;t++)n.iframeHTML+='<link type="text/css" rel="stylesheet" href="'+n.contentCSS[t]+'" />';n.contentCSS=
[]}t=s.body_id||"tinymce";if(t.indexOf("=")!=-1){t=n.getParam("body_id","","hash");t=t[n.id]||t}r=s.body_class||"";if(r.indexOf("=")!=-1){r=n.getParam("body_class","","hash");r=r[n.id]||""}n.iframeHTML+='</head><body id="'+t+'" class="mceContentBody '+r+'"></body></html>';if(a.relaxedDomain&&(h||a.isOpera&&parseFloat(opera.version())<11))x='javascript:(function(){document.open();document.domain="'+document.domain+'";var ed = window.parent.tinyMCE.get("'+n.id+'");document.write(ed.iframeHTML);document.close();ed.setupIframe();})()';
b.add(u.iframeContainer,"iframe",{id:n.id+"_ifr",src:x||'javascript:""',frameBorder:"0",allowTransparency:"true",title:s.aria_label,style:{width:"100%",height:q}});n.contentAreaContainer=u.iframeContainer;b.get(u.editorContainer).style.display=n.orgDisplay;b.get(n.id).style.display="none";b.setAttrib(n.id,"aria-hidden",true);if(!a.relaxedDomain||!x)n.setupIframe();r=u=null},setupIframe:function(o){var n=this,s=n.settings;b.get(n.id);var t=n.getDoc();if((!h||!a.relaxedDomain)&&!o){g&&!s.readonly&&
n.getWin().addEventListener("DOMContentLoaded",function(){window.setTimeout(function(){var r=n.getBody();r.innerHTML="<br>";if(r.contentEditable!==void 0){r.contentEditable=false;r.contentEditable=true;n.onMouseDown.add(function(u,x){if(x.target.nodeName==="HTML"){r.contentEditable=false;r.contentEditable=true;t.designMode="on";window.setTimeout(function(){t.designMode="off";n.getBody().focus()},1)}})}else t.designMode="on";n.setupIframe(true)},1)},false);t.open();t.write(n.iframeHTML);t.close();
if(a.relaxedDomain)t.domain=a.relaxedDomain;if(g&&!s.readonly)return}o=n.getBody();o.disabled=true;if(!g&&!s.readonly)o.contentEditable=true;o.disabled=false;n.schema=new a.html.Schema(s);n.dom=new a.dom.DOMUtils(n.getDoc(),{keep_values:true,url_converter:n.convertURL,url_converter_scope:n,hex_colors:s.force_hex_style_colors,class_filter:s.class_filter,update_styles:1,fix_ie_paragraphs:1,schema:n.schema});n.parser=new a.html.DomParser(s,n.schema);n.settings.allow_html_in_named_anchor||n.parser.addAttributeFilter("name",
function(r){for(var u=r.length,x,A,H,D;u--;){D=r[u];if(D.name==="a"&&D.firstChild){H=D.parent;x=D.lastChild;do{A=x.prev;H.insert(x,D);x=A}while(x)}}});n.parser.addAttributeFilter("src,href,style",function(r,u){for(var x=r.length,A,H=n.dom,D,y;x--;){A=r[x];D=A.attr(u);y="data-mce-"+u;A.attributes.map[y]||(u==="style"?A.attr(y,H.serializeStyle(H.parseStyle(D),A.name)):A.attr(y,n.convertURL(D,u,A.name)))}});n.parser.addNodeFilter("script",function(r){for(var u=r.length;u--;)r[u].attr("type","mce-text/javascript")});
n.parser.addNodeFilter("#cdata",function(r){for(var u=r.length,x;u--;){x=r[u];x.type=8;x.name="#comment";x.value="[CDATA["+x.value+"]]"}});n.parser.addNodeFilter("p,h1,h2,h3,h4,h5,h6,div",function(r){for(var u=r.length,x,A=n.schema.getNonEmptyElements();u--;){x=r[u];if(x.isEmpty(A))x.empty().append(new a.html.Node("br",1)).shortEnded=true}});n.serializer=new a.dom.Serializer(s,n.dom,n.schema);n.selection=new a.dom.Selection(n.dom,n.getWin(),n.serializer);n.formatter=new a.Formatter(this);n.formatter.register({alignleft:[{selector:"p,h1,h2,h3,h4,h5,h6,td,th,div,ul,ol,li",
styles:{textAlign:"left"}},{selector:"img,table",collapsed:false,styles:{"float":"left"}}],aligncenter:[{selector:"p,h1,h2,h3,h4,h5,h6,td,th,div,ul,ol,li",styles:{textAlign:"center"}},{selector:"img",collapsed:false,styles:{display:"block",marginLeft:"auto",marginRight:"auto"}},{selector:"table",collapsed:false,styles:{marginLeft:"auto",marginRight:"auto"}}],alignright:[{selector:"p,h1,h2,h3,h4,h5,h6,td,th,div,ul,ol,li",styles:{textAlign:"right"}},{selector:"img,table",collapsed:false,styles:{"float":"right"}}],
alignfull:[{selector:"p,h1,h2,h3,h4,h5,h6,td,th,div,ul,ol,li",styles:{textAlign:"justify"}}],bold:[{inline:"strong",remove:"all"},{inline:"span",styles:{fontWeight:"bold"}},{inline:"b",remove:"all"}],italic:[{inline:"em",remove:"all"},{inline:"span",styles:{fontStyle:"italic"}},{inline:"i",remove:"all"}],underline:[{inline:"span",styles:{textDecoration:"underline"},exact:true},{inline:"u",remove:"all"}],strikethrough:[{inline:"span",styles:{textDecoration:"line-through"},exact:true},{inline:"strike",
remove:"all"}],forecolor:{inline:"span",styles:{color:"%value"},wrap_links:false},hilitecolor:{inline:"span",styles:{backgroundColor:"%value"},wrap_links:false},fontname:{inline:"span",styles:{fontFamily:"%value"}},fontsize:{inline:"span",styles:{fontSize:"%value"}},fontsize_class:{inline:"span",attributes:{"class":"%value"}},blockquote:{block:"blockquote",wrapper:1,remove:"all"},subscript:{inline:"sub"},superscript:{inline:"sup"},removeformat:[{selector:"b,strong,em,i,font,u,strike",remove:"all",
split:true,expand:false,block_expand:true,deep:true},{selector:"span",attributes:["style","class"],remove:"empty",split:true,expand:false,deep:true},{selector:"*",attributes:["style","class"],split:false,expand:false,deep:true}]});f("p h1 h2 h3 h4 h5 h6 div address pre div code dt dd samp".split(/\s/),function(r){n.formatter.register(r,{block:r,remove:"all"})});n.formatter.register(n.settings.formats);n.undoManager=new a.UndoManager(n);n.undoManager.onAdd.add(function(r,u){if(r.hasUndo())return n.onChange.dispatch(n,
u,r)});n.undoManager.onUndo.add(function(r,u){return n.onUndo.dispatch(n,u,r)});n.undoManager.onRedo.add(function(r,u){return n.onRedo.dispatch(n,u,r)});n.forceBlocks=new a.ForceBlocks(n,{forced_root_block:s.forced_root_block});n.editorCommands=new a.EditorCommands(n);n.serializer.onPreProcess.add(function(r,u){return n.onPreProcess.dispatch(n,u,r)});n.serializer.onPostProcess.add(function(r,u){return n.onPostProcess.dispatch(n,u,r)});n.onPreInit.dispatch(n);if(!s.gecko_spellcheck)n.getBody().spellcheck=
0;s.readonly||n._addEvents();n.controlManager.onPostRender.dispatch(n,n.controlManager);n.onPostRender.dispatch(n);n.quirks=new a.util.Quirks(this);if(s.directionality)n.getBody().dir=s.directionality;if(s.nowrap)n.getBody().style.whiteSpace="nowrap";s.handle_node_change_callback&&n.onNodeChange.add(function(r,u,x){n.execCallback("handle_node_change_callback",n.id,x,-1,-1,true,n.selection.isCollapsed())});s.save_callback&&n.onSaveContent.add(function(r,u){var x=n.execCallback("save_callback",n.id,
u.content,n.getBody());if(x)u.content=x});s.onchange_callback&&n.onChange.add(function(r,u){n.execCallback("onchange_callback",n,u)});s.protect&&n.onBeforeSetContent.add(function(r,u){s.protect&&f(s.protect,function(x){u.content=u.content.replace(x,function(A){return"<\!--mce:protected "+escape(A)+"--\>"})})});s.convert_newlines_to_brs&&n.onBeforeSetContent.add(function(r,u){if(u.initial)u.content=u.content.replace(/\r?\n/g,"<br />")});s.preformatted&&n.onPostProcess.add(function(r,u){u.content=u.content.replace(/^\s*<pre.*?>/,
"");u.content=u.content.replace(/<\/pre>\s*$/,"");if(u.set)u.content='<pre class="mceItemHidden">'+u.content+"</pre>"});if(s.verify_css_classes)n.serializer.attribValueFilter=function(r,u){var x,A;if(r=="class"){if(!n.classesRE){A=n.dom.getClasses();if(A.length>0){x="";f(A,function(H){x+=(x?"|":"")+H["class"]});n.classesRE=RegExp("("+x+")","gi")}}return!n.classesRE||/(\bmceItem\w+\b|\bmceTemp\w+\b)/g.test(u)||n.classesRE.test(u)?u:""}return u};if(s.cleanup_callback){n.onBeforeSetContent.add(function(r,
u){u.content=n.execCallback("cleanup_callback","insert_to_editor",u.content,u)});n.onPreProcess.add(function(r,u){u.set&&n.execCallback("cleanup_callback","insert_to_editor_dom",u.node,u);u.get&&n.execCallback("cleanup_callback","get_from_editor_dom",u.node,u)});n.onPostProcess.add(function(r,u){if(u.set)u.content=n.execCallback("cleanup_callback","insert_to_editor",u.content,u);if(u.get)u.content=n.execCallback("cleanup_callback","get_from_editor",u.content,u)})}s.save_callback&&n.onGetContent.add(function(r,
u){if(u.save)u.content=n.execCallback("save_callback",n.id,u.content,n.getBody())});s.handle_event_callback&&n.onEvent.add(function(r,u,x){n.execCallback("handle_event_callback",u,r,x)===false&&c.cancel(u)});n.onSetContent.add(function(){n.addVisual(n.getBody())});s.padd_empty_editor&&n.onPostProcess.add(function(r,u){u.content=u.content.replace(/^(<p[^>]*>(&nbsp;|&#160;|\s|\u00a0|)<\/p>[\r\n]*|<br \/>[\r\n]*)$/,"")});if(g){var q=function(r){f(r.dom.select("a"),function(u){var x=u.parentNode;r.dom.isBlock(x)&&
x.lastChild===u&&r.dom.add(x,"br",{"data-mce-bogus":1})})};n.onExecCommand.add(function(r,u){u==="CreateLink"&&q(r)});n.onSetContent.add(n.selection.onSetContent.add(q))}n.load({initial:true,format:"html"});n.startContent=n.getContent({format:"raw"});n.undoManager.add();n.initialized=true;n.onInit.dispatch(n);n.execCallback("setupcontent_callback",n.id,n.getBody(),n.getDoc());n.execCallback("init_instance_callback",n);n.focus(true);n.nodeChanged({initial:1});f(n.contentCSS,function(r){n.dom.loadCSS(r)});
s.auto_focus&&setTimeout(function(){var r=a.get(s.auto_focus);r.selection.select(r.getBody(),1);r.selection.collapse(1);r.getBody().focus();r.getWin().focus()},100)},focus:function(o){var n;n=this.selection;var s=this.settings.content_editable,t,q=this.getDoc();if(!o){o=n.getRng();if(o.item)t=o.item(0);n.normalize();s||this.getWin().focus();a.isGecko&&this.getBody().focus();if(t&&t.ownerDocument==q){o=q.body.createControlRange();o.addElement(t);o.select()}}if(a.activeEditor!=this){if((n=a.activeEditor)!=
null)n.onDeactivate.dispatch(n,this);this.onActivate.dispatch(this,n)}a._setActive(this)},execCallback:function(o){var n=this.settings[o],s;if(n){if(this.callbackLookup&&(s=this.callbackLookup[o])){n=s.func;s=s.scope}if(k(n,"string")){s=(s=n.replace(/\.\w+$/,""))?a.resolve(s):0;n=a.resolve(n);this.callbackLookup=this.callbackLookup||{};this.callbackLookup[o]={func:n,scope:s}}return n.apply(s||this,Array.prototype.slice.call(arguments,1))}},translate:function(o){var n=this.settings.language||"en",
s=a.i18n;if(!o)return"";return s[n+"."+o]||o.replace(/{\#([^}]+)\}/g,function(t,q){return s[n+"."+q]||"{#"+q+"}"})},getLang:function(o,n){return a.i18n[(this.settings.language||"en")+"."+o]||(k(n)?n:"{#"+o+"}")},getParam:function(o,n,s){var t=a.trim;o=k(this.settings[o])?this.settings[o]:n;var q;if(s==="hash"){q={};if(k(o,"string"))f(o.indexOf("=")>0?o.split(/[;,](?![^=;,]*(?:[;,]|$))/):o.split(","),function(r){r=r.split("=");if(r.length>1)q[t(r[0])]=t(r[1]);else q[t(r[0])]=t(r)});else q=o;return q}return o},
nodeChanged:function(o){var n=this.selection,s=n.getStart()||this.getBody();if(this.initialized){o=o||{};s=h&&s.ownerDocument!=this.getDoc()?this.getBody():s;o.parents=[];this.dom.getParent(s,function(t){if(t.nodeName=="BODY")return true;o.parents.push(t)});this.onNodeChange.dispatch(this,o?o.controlManager||this.controlManager:this.controlManager,s,n.isCollapsed(),o)}},addButton:function(o,n){this.buttons=this.buttons||{};this.buttons[o]=n},addCommand:function(o,n,s){this.execCommands[o]={func:n,
scope:s||this}},addQueryStateHandler:function(o,n,s){this.queryStateCommands[o]={func:n,scope:s||this}},addQueryValueHandler:function(o,n,s){this.queryValueCommands[o]={func:n,scope:s||this}},addShortcut:function(o,n,s,t){var q=this,r;if(!q.settings.custom_shortcuts)return false;q.shortcuts=q.shortcuts||{};if(k(s,"string")){r=s;s=function(){q.execCommand(r,false,null)}}if(k(s,"object")){r=s;s=function(){q.execCommand(r[0],r[1],r[2])}}f(p(o),function(u){var x={func:s,scope:t||this,desc:n,alt:false,
ctrl:false,shift:false};f(p(u,"+"),function(A){switch(A){case "alt":case "ctrl":case "shift":x[A]=true;break;default:x.charCode=A.charCodeAt(0);x.keyCode=A.toUpperCase().charCodeAt(0)}});q.shortcuts[(x.ctrl?"ctrl":"")+","+(x.alt?"alt":"")+","+(x.shift?"shift":"")+","+x.keyCode]=x});return true},execCommand:function(o,n,s,t){var q=this,r=0,u;if(!/^(mceAddUndoLevel|mceEndUndoLevel|mceBeginUndoLevel|mceRepaint|SelectAll)$/.test(o)&&(!t||!t.skip_focus))q.focus();u={};q.onBeforeExecCommand.dispatch(q,
o,n,s,u);if(u.terminate)return false;if(q.execCallback("execcommand_callback",q.id,q.selection.getNode(),o,n,s)){q.onExecCommand.dispatch(q,o,n,s,t);return true}if(u=q.execCommands[o]){u=u.func.call(u.scope,n,s);if(u!==true){q.onExecCommand.dispatch(q,o,n,s,t);return u}}f(q.plugins,function(x){if(x.execCommand&&x.execCommand(o,n,s)){q.onExecCommand.dispatch(q,o,n,s,t);r=1;return false}});if(r)return true;if(q.theme&&q.theme.execCommand&&q.theme.execCommand(o,n,s)){q.onExecCommand.dispatch(q,o,n,s,
t);return true}if(q.editorCommands.execCommand(o,n,s)){q.onExecCommand.dispatch(q,o,n,s,t);return true}q.getDoc().execCommand(o,n,s);q.onExecCommand.dispatch(q,o,n,s,t)},queryCommandState:function(o){var n;if(!this._isHidden()){if(n=this.queryStateCommands[o]){n=n.func.call(n.scope);if(n!==true)return n}n=this.editorCommands.queryCommandState(o);if(n!==-1)return n;try{return this.getDoc().queryCommandState(o)}catch(s){}}},queryCommandValue:function(o){var n;if(!this._isHidden()){if(n=this.queryValueCommands[o]){n=
n.func.call(n.scope);if(n!==true)return n}n=this.editorCommands.queryCommandValue(o);if(k(n))return n;try{return this.getDoc().queryCommandValue(o)}catch(s){}}},show:function(){b.show(this.getContainer());b.hide(this.id);this.load()},hide:function(){var o=this.getDoc();h&&o&&o.execCommand("SelectAll");this.save();b.hide(this.getContainer());b.setStyle(this.id,"display",this.orgDisplay)},isHidden:function(){return!b.isHidden(this.id)},setProgressState:function(o,n,s){this.onSetProgressState.dispatch(this,
o,n,s);return o},load:function(o){var n=this.getElement(),s;if(n){o=o||{};o.load=true;s=this.setContent(k(n.value)?n.value:n.innerHTML,o);o.element=n;o.no_events||this.onLoadContent.dispatch(this,o);o.element=null;return s}},save:function(o){var n=this,s=n.getElement(),t;if(s&&n.initialized){o=o||{};o.save=true;if(!o.no_events){n.undoManager.typing=false;n.undoManager.add()}o.element=s;t=o.content=n.getContent(o);o.no_events||n.onSaveContent.dispatch(n,o);t=o.content;if(/TEXTAREA|INPUT/i.test(s.nodeName))s.value=
t;else{s.innerHTML=t;if(s=b.getParent(n.id,"form"))f(s.elements,function(q){if(q.name==n.id){q.value=t;return false}})}o.element=s=null;return t}},setContent:function(o,n){var s=this.getBody(),t;n=n||{};n.format=n.format||"html";n.set=true;n.content=o;n.no_events||this.onBeforeSetContent.dispatch(this,n);o=n.content;if(!a.isIE&&(o.length===0||/^\s+$/.test(o))){t=this.settings.forced_root_block;s.innerHTML=t?"<"+t+'><br data-mce-bogus="1"></'+t+">":'<br data-mce-bogus="1">';this.selection.select(s,
true);this.selection.collapse(true)}else{if(n.format!=="raw")o=(new a.html.Serializer({},this.schema)).serialize(this.parser.parse(o));n.content=a.trim(o);this.dom.setHTML(s,n.content);n.no_events||this.onSetContent.dispatch(this,n);this.selection.normalize();return n.content}},getContent:function(o){var n;o=o||{};o.format=o.format||"html";o.get=true;o.no_events||this.onBeforeGetContent.dispatch(this,o);n=o.format=="raw"?this.getBody().innerHTML:this.serializer.serialize(this.getBody(),o);o.content=
a.trim(n);o.no_events||this.onGetContent.dispatch(this,o);return o.content},isDirty:function(){return a.trim(this.startContent)!=a.trim(this.getContent({format:"raw",no_events:1}))&&!this.isNotDirty},getContainer:function(){if(!this.container)this.container=b.get(this.editorContainer||this.id+"_parent");return this.container},getContentAreaContainer:function(){return this.contentAreaContainer},getElement:function(){return b.get(this.settings.content_element||this.id)},getWin:function(){var o;if(!this.contentWindow)if(o=
b.get(this.id+"_ifr"))this.contentWindow=o.contentWindow;return this.contentWindow},getDoc:function(){var o;if(!this.contentDocument)if(o=this.getWin())this.contentDocument=o.document;return this.contentDocument},getBody:function(){return this.bodyElement||this.getDoc().body},convertURL:function(o,n,s){var t=this.settings;if(t.urlconverter_callback)return this.execCallback("urlconverter_callback",o,s,true,n);if(!t.convert_urls||s&&s.nodeName=="LINK"||o.indexOf("file:")===0)return o;if(t.relative_urls)return this.documentBaseURI.toRelative(o);
return o=this.documentBaseURI.toAbsolute(o,t.remove_script_host)},addVisual:function(o){var n=this,s=n.settings;o=o||n.getBody();if(!k(n.hasVisual))n.hasVisual=s.visual;f(n.dom.select("table,a",o),function(t){var q;switch(t.nodeName){case "TABLE":q=n.dom.getAttrib(t,"border");if(!q||q=="0")n.hasVisual?n.dom.addClass(t,s.visual_table_class):n.dom.removeClass(t,s.visual_table_class);break;case "A":if(q=n.dom.getAttrib(t,"name"))n.hasVisual?n.dom.addClass(t,"mceItemAnchor"):n.dom.removeClass(t,"mceItemAnchor")}});
n.onVisualAid.dispatch(n,o,n.hasVisual)},remove:function(){var o=this.getContainer();this.removed=1;this.hide();this.execCallback("remove_instance_callback",this);this.onRemove.dispatch(this);this.onExecCommand.listeners=[];a.remove(this);b.remove(o)},destroy:function(o){if(!this.destroyed){if(!o){a.removeUnload(this.destroy);tinyMCE.onBeforeUnload.remove(this._beforeUnload);this.theme&&this.theme.destroy&&this.theme.destroy();this.controlManager.destroy();this.selection.destroy();this.dom.destroy();
if(!this.settings.content_editable){c.clear(this.getWin());c.clear(this.getDoc())}c.clear(this.getBody());c.clear(this.formElement)}if(this.formElement){this.formElement.submit=this.formElement._mceOldSubmit;this.formElement._mceOldSubmit=null}this.contentAreaContainer=this.formElement=this.container=this.settings.content_element=this.bodyElement=this.contentDocument=this.contentWindow=null;if(this.selection)this.selection=this.selection.win=this.selection.dom=this.selection.dom.doc=null;this.destroyed=
1}},_addEvents:function(){function o(D,y){if(!n.removed)if(n.onEvent.dispatch(n,D,y)!==false)n[r[D.fakeType||D.type]].dispatch(n,D,y)}var n=this,s,t=n.settings,q=n.dom,r={mouseup:"onMouseUp",mousedown:"onMouseDown",click:"onClick",keyup:"onKeyUp",keydown:"onKeyDown",keypress:"onKeyPress",submit:"onSubmit",reset:"onReset",contextmenu:"onContextMenu",dblclick:"onDblClick",paste:"onPaste"};f(r,function(D,y){switch(y){case "contextmenu":q.bind(n.getDoc(),y,o);break;case "paste":q.bind(n.getBody(),y,function(z){o(z)});
break;case "submit":case "reset":q.bind(n.getElement().form||b.getParent(n.id,"form"),y,o);break;default:q.bind(t.content_editable?n.getBody():n.getDoc(),y,o)}});q.bind(t.content_editable?n.getBody():g?n.getDoc():n.getWin(),"focus",function(){n.focus(true)});a.isGecko&&q.bind(n.getDoc(),"DOMNodeInserted",function(D){var y;D=D.target;if(D.nodeType===1&&D.nodeName==="IMG"&&(y=D.getAttribute("data-mce-src")))D.src=n.documentBaseURI.toAbsolute(y)});if(g){s=function(){var D=this.getDoc(),y=this.settings;
if(g&&!y.readonly){if(this._isHidden())try{if(!y.content_editable){D.body.contentEditable=false;D.body.contentEditable=true}}catch(z){}try{D.execCommand("styleWithCSS",0,false)}catch(I){if(!this._isHidden())try{D.execCommand("useCSS",0,true)}catch(ga){}}if(!y.table_inline_editing)try{D.execCommand("enableInlineTableEditing",false,false)}catch(E){}if(!y.object_resizing)try{D.execCommand("enableObjectResizing",false,false)}catch(C){}}};n.onBeforeExecCommand.add(s);n.onMouseDown.add(s)}n.onClick.add(function(D,
y){y=y.target;a.isWebKit&&y.nodeName=="IMG"&&n.selection.getSel().setBaseAndExtent(y,0,y,1);y.nodeName=="A"&&q.hasClass(y,"mceItemAnchor")&&n.selection.select(y);n.nodeChanged()});n.onMouseUp.add(n.nodeChanged);n.onKeyUp.add(function(D,y){var z=y.keyCode;if(z>=33&&z<=36||z>=37&&z<=40||z==13||z==45||z==46||z==8||a.isMac&&(z==91||z==93)||y.ctrlKey)n.nodeChanged()});n.onKeyDown.add(function(D,y){if(y.keyCode==8){for(var z=D.selection.getRng().startContainer,I=D.selection.getRng().startOffset;z&&z.nodeType&&
z.nodeType!=1&&z.parentNode;)z=z.parentNode;if(z&&z.parentNode&&z.parentNode.tagName==="BLOCKQUOTE"&&z.parentNode.firstChild==z&&I==0){D.formatter.toggle("blockquote",null,z.parentNode);I=D.selection.getRng();I.setStart(z,0);I.setEnd(z,0);D.selection.setRng(I);D.selection.collapse(false)}}});n.onReset.add(function(){n.setContent(n.startContent,{format:"raw"})});if(t.custom_shortcuts){if(t.custom_undo_redo_keyboard_shortcuts){n.addShortcut("ctrl+z",n.getLang("undo_desc"),"Undo");n.addShortcut("ctrl+y",
n.getLang("redo_desc"),"Redo")}n.addShortcut("ctrl+b",n.getLang("bold_desc"),"Bold");n.addShortcut("ctrl+i",n.getLang("italic_desc"),"Italic");n.addShortcut("ctrl+u",n.getLang("underline_desc"),"Underline");for(s=1;s<=6;s++)n.addShortcut("ctrl+"+s,"",["FormatBlock",false,"h"+s]);n.addShortcut("ctrl+7","",["FormatBlock",false,"p"]);n.addShortcut("ctrl+8","",["FormatBlock",false,"div"]);n.addShortcut("ctrl+9","",["FormatBlock",false,"address"]);var u=function(D){var y=null;if(!D.altKey&&!D.ctrlKey&&
!D.metaKey)return y;f(n.shortcuts,function(z){if(!(a.isMac&&z.ctrl!=D.metaKey))if(!(!a.isMac&&z.ctrl!=D.ctrlKey))if(z.alt==D.altKey)if(z.shift==D.shiftKey)if(D.keyCode==z.keyCode||D.charCode&&D.charCode==z.charCode){y=z;return false}});return y};n.onKeyUp.add(function(D,y){if(u(y))return c.cancel(y)});n.onKeyPress.add(function(D,y){if(u(y))return c.cancel(y)});n.onKeyDown.add(function(D,y){var z=u(y);if(z){z.func.call(z.scope);return c.cancel(y)}})}a.isIE&&q.bind(n.getDoc(),"controlselect",function(D){var y=
n.resizeInfo;D=D.target;if(D.nodeName==="IMG"){y&&q.unbind(y.node,y.ev,y.cb);if(q.hasClass(D,"mceItemNoResize")){ev="resizestart";y=q.bind(D,"resizestart",c.cancel,c)}else{ev="resizeend";y=q.bind(D,ev,function(z){var I;z=z.target;if(I=q.getStyle(z,"width")){q.setAttrib(z,"width",I.replace(/[^0-9%]+/g,""));q.setStyle(z,"width","")}if(I=q.getStyle(z,"height")){q.setAttrib(z,"height",I.replace(/[^0-9%]+/g,""));q.setStyle(z,"height","")}})}y=n.resizeInfo={node:D,ev:ev,cb:y}}});a.isOpera&&n.onClick.add(function(D,
y){c.prevent(y)});if(t.custom_undo_redo){var x=function(){n.undoManager.typing=false;n.undoManager.add()};q.bind(n.getDoc(),"focusout",function(){!n.removed&&n.undoManager.typing&&x()});n.dom.bind(n.dom.getRoot(),"dragend",function(){x()});n.onKeyUp.add(function(D,y){var z=y.keyCode;if(z>=33&&z<=36||z>=37&&z<=40||z==13||z==45||y.ctrlKey)x()});n.onKeyDown.add(function(D,y){var z=y.keyCode,I;if(z==8)if((I=n.getDoc().selection)&&I.createRange&&I.createRange().item){n.undoManager.beforeChange();D.dom.remove(I.createRange().item(0));
x();return c.cancel(y)}if(z>=33&&z<=36||z>=37&&z<=40||z==13||z==45){a.isIE&&z==13&&n.undoManager.beforeChange();n.undoManager.typing&&x()}else if((z<16||z>20)&&z!=224&&z!=91&&!n.undoManager.typing){n.undoManager.beforeChange();n.undoManager.typing=true;n.undoManager.add()}});n.onMouseDown.add(function(){n.undoManager.typing&&x()})}a.isWebKit&&q.bind(n.getDoc(),"selectionchange",function(){if(n.selectionTimer){window.clearTimeout(n.selectionTimer);n.selectionTimer=0}n.selectionTimer=window.setTimeout(function(){n.nodeChanged()},
50)});if(a.isGecko){var A=function(){var D=n.dom.getAttribs(n.selection.getStart().cloneNode(false));return function(){var y=n.selection.getStart();if(y!==n.getBody()){n.dom.removeAllAttribs(y);f(D,function(z){y.setAttributeNode(z.cloneNode(true))})}}},H=function(){var D=n.selection;return!D.isCollapsed()&&D.getStart()!=D.getEnd()};n.onKeyPress.add(function(D,y){var z;if((y.keyCode==8||y.keyCode==46)&&H()){z=A();n.getDoc().execCommand("delete",false,null);z();return c.cancel(y)}});n.dom.bind(n.getDoc(),
"cut",function(){var D;if(H()){D=A();n.onKeyUp.addToTop(c.cancel,c);setTimeout(function(){D();n.onKeyUp.remove(c.cancel,c)},0)}})}},_isHidden:function(){var o;if(!g)return 0;o=this.selection.getSel();return!o||!o.rangeCount||o.rangeCount==0}})})(tinymce);
(function(a){var b=a.each,c=true,d=false;a.EditorCommands=function(e){function f(t,q,r){var u;t=t.toLowerCase();if(u=o.exec[t]){u(t,q,r);return c}return d}function g(t){var q;t=t.toLowerCase();if(q=o.state[t])return q(t);return-1}function h(t,q){q=q||"exec";b(t,function(r,u){b(u.toLowerCase().split(","),function(x){o[q][x]=r})})}function k(t,q,r){if(q===void 0)q=d;if(r===void 0)r=null;return e.getDoc().execCommand(t,q,r)}function l(t,q){e.formatter.toggle(t,q?{value:q}:void 0)}var m=e.dom,p=e.selection,
o={state:{},exec:{},value:{}},n=e.settings,s;a.extend(this,{execCommand:f,queryCommandState:g,queryCommandValue:function(t){var q;t=t.toLowerCase();if(q=o.value[t])return q(t);return d},addCommands:h});h({"mceResetDesignMode,mceBeginUndoLevel":function(){},"mceEndUndoLevel,mceAddUndoLevel":function(){e.undoManager.add()},"Cut,Copy,Paste":function(t){var q=e.getDoc(),r;try{k(t)}catch(u){r=c}if(r||!q.queryCommandSupported(t))a.isGecko?e.windowManager.confirm(e.getLang("clipboard_msg"),function(x){x&&
open("http://www.mozilla.org/editor/midasdemo/securityprefs.html","_blank")}):e.windowManager.alert(e.getLang("clipboard_no_support"))},unlink:function(t){p.isCollapsed()&&p.select(p.getNode());k(t);p.collapse(d)},"JustifyLeft,JustifyCenter,JustifyRight,JustifyFull":function(t){var q=t.substring(7);b("left,center,right,full".split(","),function(r){q!=r&&e.formatter.remove("align"+r)});l("align"+q);f("mceRepaint")},"InsertUnorderedList,InsertOrderedList":function(t){var q;k(t);if(t=m.getParent(p.getNode(),
"ol,ul")){q=t.parentNode;if(/^(H[1-6]|P|ADDRESS|PRE)$/.test(q.nodeName)){s=p.getBookmark(void 0);m.split(q,t);p.moveToBookmark(s)}}},"Bold,Italic,Underline,Strikethrough,Superscript,Subscript":function(t){l(t)},"ForeColor,HiliteColor,FontName":function(t,q,r){l(t,r)},FontSize:function(t,q,r){var u;if(r>=1&&r<=7){u=a.explode(n.font_size_style_values);r=(q=a.explode(n.font_size_classes))?q[r-1]||r:u[r-1]||r}l(t,r)},RemoveFormat:function(t){e.formatter.remove(t)},mceBlockQuote:function(){l("blockquote")},
FormatBlock:function(t,q,r){return l(r||"p")},mceCleanup:function(){var t=p.getBookmark();e.setContent(e.getContent({cleanup:c}),{cleanup:c});p.moveToBookmark(t)},mceRemoveNode:function(t,q,r){t=r||p.getNode();if(t!=e.getBody()){s=p.getBookmark(void 0);e.dom.remove(t,c);p.moveToBookmark(s)}},mceSelectNodeDepth:function(t,q,r){var u=0;m.getParent(p.getNode(),function(x){if(x.nodeType==1&&u++==r){p.select(x);return d}},e.getBody())},mceSelectNode:function(t,q,r){p.select(r)},mceInsertContent:function(t,
q,r){var u,x,A,H,D;u=e.parser;x=new a.html.Serializer({},e.schema);t={content:r,format:"html"};p.onBeforeSetContent.dispatch(p,t);r=t.content;if(r.indexOf("{$caret}")==-1)r+="{$caret}";r=r.replace(/\{\$caret\}/,'<span id="mce_marker" data-mce-type="bookmark">\ufeff</span>');p.isCollapsed()||e.getDoc().execCommand("Delete",false,null);A=p.getNode();t={context:A.nodeName.toLowerCase()};D=u.parse(r,t);q=D.lastChild;if(q.attr("id")=="mce_marker"){r=q;for(q=q.prev;q;q=q.walk(true))if(q.type==3||!m.isBlock(q.name)){q.parent.insert(r,
q,q.name==="br");break}}if(t.invalid){p.setContent('<span id="mce_marker" data-mce-type="bookmark">\ufeff</span>');A=e.selection.getNode();H=e.getBody();if(A.nodeType==9)A=q=H;else q=A;for(;q!==H;){A=q;q=q.parentNode}r=A==H?H.innerHTML:m.getOuterHTML(A);r=x.serialize(u.parse(r.replace(/<span (id="mce_marker"|id=mce_marker).+?<\/span>/i,function(){return x.serialize(D)})));A==H?m.setHTML(H,r):m.setOuterHTML(A,r)}else{r=x.serialize(D);q=A.firstChild;u=A.lastChild;!q||q===u&&q.nodeName==="BR"?m.setHTML(A,
r):p.setContent(r)}r=m.get("mce_marker");q=m.getRect(r);A=m.getViewPort(e.getWin());if(q.y+q.h>A.y+A.h||q.y<A.y||q.x>A.x+A.w||q.x<A.x){u=a.isIE?e.getDoc().documentElement:e.getBody();u.scrollLeft=q.x;u.scrollTop=q.y-A.h+25}A=m.createRng();if((q=r.previousSibling)&&q.nodeType==3)A.setStart(q,q.nodeValue.length);else{A.setStartBefore(r);A.setEndBefore(r)}m.remove(r);p.setRng(A);p.onSetContent.dispatch(p,t);e.addVisual()},mceInsertRawHTML:function(t,q,r){p.setContent("tiny_mce_marker");e.setContent(e.getContent().replace(/tiny_mce_marker/g,
function(){return r}))},mceSetContent:function(t,q,r){e.setContent(r)},"Indent,Outdent":function(t){var q,r,u;q=n.indentation;r=/[a-z%]+$/i.exec(q);q=parseInt(q);!g("InsertUnorderedList")&&!g("InsertOrderedList")?b(p.getSelectedBlocks(),function(x){if(t=="outdent"){u=Math.max(0,parseInt(x.style.paddingLeft||0)-q);m.setStyle(x,"paddingLeft",u?u+r:"")}else m.setStyle(x,"paddingLeft",parseInt(x.style.paddingLeft||0)+q+r)}):k(t)},mceRepaint:function(){if(a.isGecko)try{s=p.getBookmark(c);p.getSel()&&p.getSel().selectAllChildren(e.getBody());
p.collapse(c);p.moveToBookmark(s)}catch(t){}},mceToggleFormat:function(t,q,r){e.formatter.toggle(r)},InsertHorizontalRule:function(){e.execCommand("mceInsertContent",false,"<hr />")},mceToggleVisualAid:function(){e.hasVisual=!e.hasVisual;e.addVisual()},mceReplaceContent:function(t,q,r){e.execCommand("mceInsertContent",false,r.replace(/\{\$selection\}/g,p.getContent({format:"text"})))},mceInsertLink:function(t,q,r){t=m.getParent(p.getNode(),"a");var u,x,A;if(a.is(r,"string"))r={href:r};r.href=r.href.replace(" ",
"%20");if(t)r.href?m.setAttribs(t,r):e.dom.remove(t,c);else{if(a.isWebKit)if(u=m.getParent(p.getNode(),"img")){x=u.style.cssText;A=u.className;u.style.cssText=null;u.className=null}k("CreateLink",d,"javascript:mctmp(0);");if(x)u.style.cssText=x;if(A)u.className=A;b(m.select("a[href='javascript:mctmp(0);']"),function(H){m.setAttribs(H,r)})}},selectAll:function(){var t=m.getRoot(),q=m.createRng();q.setStart(t,0);q.setEnd(t,t.childNodes.length);e.selection.setRng(q)}});h({"JustifyLeft,JustifyCenter,JustifyRight,JustifyFull":function(t){t=
"align"+t.substring(7);return e.formatter.match(t)},"Bold,Italic,Underline,Strikethrough,Superscript,Subscript":function(t){return e.formatter.match(t)},mceBlockQuote:function(){return e.formatter.match("blockquote")},Outdent:function(){var t;if(n.inline_styles){if((t=m.getParent(p.getStart(),m.isBlock))&&parseInt(t.style.paddingLeft)>0)return c;if((t=m.getParent(p.getEnd(),m.isBlock))&&parseInt(t.style.paddingLeft)>0)return c}return g("InsertUnorderedList")||g("InsertOrderedList")||!n.inline_styles&&
!!m.getParent(p.getNode(),"BLOCKQUOTE")},"InsertUnorderedList,InsertOrderedList":function(t){return m.getParent(p.getNode(),t=="insertunorderedlist"?"UL":"OL")}},"state");h({"FontSize,FontName":function(t){var q=0,r;if(r=m.getParent(p.getNode(),"span"))q=t=="fontsize"?r.style.fontSize:r.style.fontFamily.replace(/, /g,",").replace(/[\'\"]/g,"").toLowerCase();return q}},"value");n.custom_undo_redo&&h({Undo:function(){e.undoManager.undo()},Redo:function(){e.undoManager.redo()}})}})(tinymce);
(function(a){var b=a.util.Dispatcher;a.UndoManager=function(c){var d,e=0,f=[],g;return d={typing:false,onAdd:new b(d),onUndo:new b(d),onRedo:new b(d),beforeChange:function(){g=c.selection.getBookmark(2,true)},add:function(h){var k;k=c.settings;var l;h=h||{};h.content=a.trim(c.getContent({format:"raw",no_events:1}));if((l=f[e])&&l.content==h.content)return null;if(f[e])f[e].beforeBookmark=g;if(k.custom_undo_redo_levels)if(f.length>k.custom_undo_redo_levels){for(k=0;k<f.length-1;k++)f[k]=f[k+1];f.length--;
e=f.length}h.bookmark=c.selection.getBookmark(2,true);if(e<f.length-1)f.length=e+1;f.push(h);e=f.length-1;d.onAdd.dispatch(d,h);c.isNotDirty=0;return h},undo:function(){var h;if(d.typing){d.add();d.typing=false}if(e>0){h=f[--e];c.setContent(h.content,{format:"raw"});c.selection.moveToBookmark(h.beforeBookmark);d.onUndo.dispatch(d,h)}return h},redo:function(){var h;if(e<f.length-1){h=f[++e];c.setContent(h.content,{format:"raw"});c.selection.moveToBookmark(h.bookmark);d.onRedo.dispatch(d,h)}return h},
clear:function(){f=[];e=0;d.typing=false},hasUndo:function(){return e>0||this.typing},hasRedo:function(){return e<f.length-1&&!this.typing}}}})(tinymce);
(function(a){function b(l,m){var p=m.ownerDocument.createRange();p.setStart(l.endContainer,l.endOffset);p.setEndAfter(m);return p.cloneContents().textContent.length==0}function c(l,m,p){var o;if(m.isEmpty(p)){o=m.getParent(p,"ul,ol");if(!m.getParent(o.parentNode,"ul,ol")){m.split(o,p);o=m.create("p",0,'<br data-mce-bogus="1" />');m.replace(o,p);l.select(o,1)}return k}return h}var d=a.dom.Event,e=a.isIE,f=a.isGecko,g=a.isOpera,h=true,k=false;a.create("tinymce.ForceBlocks",{ForceBlocks:function(l){var m=
l.settings,p;this.editor=l;this.dom=l.dom;p=(m.forced_root_block||"p").toLowerCase();m.element=p.toUpperCase();l.onPreInit.add(this.setup,this)},setup:function(){var l=this,m=l.editor,p=m.settings,o=m.dom,n=m.selection,s=m.schema.getBlockElements();if(p.forced_root_block){var t=function(){var q=n.getStart(),r=m.getBody(),u,x,A,H,D,y,z;if(!(!q||q.nodeType!==1)){for(;q!=r;){if(s[q.nodeName])return;q=q.parentNode}u=n.getRng();if(u.setStart){x=u.startContainer;A=u.startOffset;H=u.endContainer;D=u.endOffset}else{if(u.item){u=
m.getDoc().body.createTextRange();u.moveToElementText(u.item(0))}tmpRng=u.duplicate();tmpRng.collapse(true);A=tmpRng.move("character",-16777215)*-1;if(!tmpRng.collapsed){tmpRng=u.duplicate();tmpRng.collapse(false);D=tmpRng.move("character",-16777215)*-1-A}}for(q=r.firstChild;q;)if(q.nodeType===3||q.nodeType==1&&!s[q.nodeName]){if(!y){y=o.create(p.forced_root_block);q.parentNode.insertBefore(y,q)}z=q;q=q.nextSibling;y.appendChild(z)}else{y=null;q=q.nextSibling}if(u.setStart){u.setStart(x,A);u.setEnd(H,
D);n.setRng(u)}else try{u=m.getDoc().body.createTextRange();u.moveToElementText(r);u.collapse(true);u.moveStart("character",A);D>0&&u.moveEnd("character",D);u.select()}catch(I){}m.nodeChanged()}};m.onKeyUp.add(t);m.onClick.add(t)}p.force_br_newlines&&e&&m.onKeyPress.add(function(q,r){var u;if(r.keyCode==13&&n.getNode().nodeName!="LI"){n.setContent('<br id="__" /> ',{format:"raw"});u=o.get("__");u.removeAttribute("id");n.select(u);n.collapse();return d.cancel(r)}});if(p.force_p_newlines){if(e){a.addUnload(function(){l._previousFormats=
0});m.onKeyPress.add(function(q,r){l._previousFormats=0;if(r.keyCode==13&&!r.shiftKey&&q.selection.isCollapsed()&&p.keep_styles){var u;var x=q.selection.getStart(),A,H,D;do if(/^(SPAN|STRONG|B|EM|I|FONT|STRIKE|U)$/.test(x.nodeName)){if(A){H=x.cloneNode(false);H.appendChild(A);A=H}else A=D=x.cloneNode(false);A.removeAttribute("id")}while(x=x.parentNode);if(A)u={wrapper:A,inner:D};l._previousFormats=u}});m.onKeyUp.add(function(q,r){if(r.keyCode==13&&!r.shiftKey){var u=q.selection.getStart(),x=l._previousFormats;
if(!u.hasChildNodes()&&x)if((u=o.getParent(u,o.isBlock))&&u.nodeName!="LI"){u.innerHTML="";if(l._previousFormats){u.appendChild(x.wrapper);x.inner.innerHTML="\ufeff"}else u.innerHTML="\ufeff";n.select(u,1);n.collapse(true);q.getDoc().execCommand("Delete",false,null);l._previousFormats=0}}})}else m.onKeyPress.add(function(q,r){r.keyCode==13&&!r.shiftKey&&!l.insertPara(r)&&d.cancel(r)});f&&m.onKeyDown.add(function(q,r){if((r.keyCode==8||r.keyCode==46)&&!r.shiftKey)l.backspaceDelete(r,r.keyCode==8)})}a.isWebKit&&
m.onKeyPress.add(function(q,r){if(r.keyCode==13&&(r.shiftKey||p.force_br_newlines&&!o.getParent(n.getNode(),"h1,h2,h3,h4,h5,h6,ol,ul"))){var u=n.getRng(),x,A=o.create("div",null," "),H=o.getViewPort(q.getWin()).h;u.insertNode(x=o.create("br"));u.setStartAfter(x);u.setEndAfter(x);n.setRng(u);if(n.getSel().focusNode==x.previousSibling){n.select(o.insertAfter(o.doc.createTextNode("\u00a0"),x));n.collapse(h)}o.insertAfter(A,x);u=o.getPos(A).y;o.remove(A);u>H&&q.getWin().scrollTo(0,u);d.cancel(r)}});if(e)if(p.element!=
"P"){m.onKeyPress.add(function(){l.lastElm=n.getNode().nodeName});m.onKeyUp.add(function(q,r){var u;u=n.getNode();if(q.getBody().childNodes.length===1&&u.nodeName=="P"){u=o.rename(u,p.element);n.select(u);n.collapse();q.nodeChanged()}else if(r.keyCode==13&&!r.shiftKey&&l.lastElm!="P")if(u=o.getParent(u,"p")){o.rename(u,p.element);q.nodeChanged()}})}},getParentBlock:function(l){var m=this.dom;return m.getParent(l,m.isBlock)},insertPara:function(){function l(U,W){var Y=[],v,B;U.innerHTML="";if(n.keep_styles){B=
W;do if(/^(SPAN|STRONG|B|EM|I|FONT|STRIKE|U)$/.test(B.nodeName)){v=B.cloneNode(k);p.setAttrib(v,"id","");Y.push(v)}while(B=B.parentNode)}if(Y.length>0){B=Y.length-1;for(v=U;B>=0;B--)v=v.appendChild(Y[B]);Y[0].innerHTML=g?"\u00a0":"<br />";return Y[0]}else U.innerHTML=g?"\u00a0":"<br />"}var m=this.editor,p=m.dom,o=m.getDoc(),n=m.settings,s=m.selection.getSel(),t=s.getRangeAt(0),q=o.body,r,u,x,A,H,D,y,z,I,ga,E,C=p.getViewPort(m.getWin());m.undoManager.beforeChange();r=o.createRange();r.setStart(s.anchorNode,
s.anchorOffset);r.collapse(h);u=o.createRange();u.setStart(s.focusNode,s.focusOffset);u.collapse(h);A=(x=r.compareBoundaryPoints(r.START_TO_END,u)<0)?s.anchorNode:s.focusNode;H=x?s.anchorOffset:s.focusOffset;D=x?s.focusNode:s.anchorNode;s=x?s.focusOffset:s.anchorOffset;if(A===D&&/^(TD|TH)$/.test(A.nodeName)){A.firstChild.nodeName=="BR"&&p.remove(A.firstChild);if(A.childNodes.length==0)m.dom.add(A,n.element,null,"<br />");else{E=A.innerHTML;A.innerHTML="";m.dom.add(A,n.element,null,E)}z=m.dom.add(A,
n.element,null,"<br />");t=o.createRange();t.selectNodeContents(z);t.collapse(1);m.selection.setRng(t);return k}if(A==q&&D==q&&q.firstChild&&m.dom.isBlock(q.firstChild)){A=D=A.firstChild;H=s=0;r=o.createRange();r.setStart(A,0);u=o.createRange();u.setStart(D,0)}A=A.nodeName=="HTML"?o.body:A;A=A.nodeName=="BODY"?A.firstChild:A;D=D.nodeName=="HTML"?o.body:D;D=D.nodeName=="BODY"?D.firstChild:D;y=this.getParentBlock(A);z=this.getParentBlock(D);x=y?y.nodeName:n.element;if(E=this.dom.getParent(y,"li,pre")){if(E.nodeName==
"LI")return c(m.selection,this.dom,E);return h}if(y&&(y.nodeName=="CAPTION"||/absolute|relative|fixed/gi.test(p.getStyle(y,"position",1)))){x=n.element;y=null}if(z&&(z.nodeName=="CAPTION"||/absolute|relative|fixed/gi.test(p.getStyle(y,"position",1)))){x=n.element;z=null}if(/(TD|TABLE|TH|CAPTION)/.test(x)||y&&x=="DIV"&&/left|right/gi.test(p.getStyle(y,"float",1))){x=n.element;y=z=null}I=y&&y.nodeName==x?y.cloneNode(0):m.dom.create(x);z=z&&z.nodeName==x?z.cloneNode(0):m.dom.create(x);z.removeAttribute("id");
if(/^(H[1-6])$/.test(x)&&b(t,y))z=m.dom.create(n.element);E=y=A;do{if(E==q||E.nodeType==9||this.dom.isBlock(E)||/(TD|TABLE|TH|CAPTION)/.test(E.nodeName))break;y=E}while(E=E.previousSibling?E.previousSibling:E.parentNode);E=ga=D;do{if(E==q||E.nodeType==9||this.dom.isBlock(E)||/(TD|TABLE|TH|CAPTION)/.test(E.nodeName))break;ga=E}while(E=E.nextSibling?E.nextSibling:E.parentNode);y.nodeName==x?r.setStart(y,0):r.setStartBefore(y);r.setEnd(A,H);I.appendChild(r.cloneContents()||o.createTextNode(""));try{u.setEndAfter(ga)}catch(O){}u.setStart(D,
s);z.appendChild(u.cloneContents()||o.createTextNode(""));t=o.createRange();if(!y.previousSibling&&y.parentNode.nodeName==x)t.setStartBefore(y.parentNode);else r.startContainer.nodeName==x&&r.startOffset==0?t.setStartBefore(r.startContainer):t.setStart(r.startContainer,r.startOffset);!ga.nextSibling&&ga.parentNode.nodeName==x?t.setEndAfter(ga.parentNode):t.setEnd(u.endContainer,u.endOffset);t.deleteContents();g&&m.getWin().scrollTo(0,C.y);if(I.firstChild&&I.firstChild.nodeName==x)I.innerHTML=I.firstChild.innerHTML;
if(z.firstChild&&z.firstChild.nodeName==x)z.innerHTML=z.firstChild.innerHTML;p.isEmpty(I)&&l(I,A);p.isEmpty(z)&&l(z,D);if(g&&parseFloat(opera.version())<9.5){t.insertNode(I);t.insertNode(z)}else{t.insertNode(z);t.insertNode(I)}z.normalize();I.normalize();m.selection.select(z,true);m.selection.collapse(true);o=m.dom.getPos(z).y;if(o<C.y||o+25>C.y+C.h)m.getWin().scrollTo(0,o<C.y?o:o-C.h+25);m.undoManager.add();return k},backspaceDelete:function(l,m){var p=this.editor,o=p.getBody(),n,s=p.selection,t=
s.getRng(),q=t.startContainer,r;if(!m&&t.collapsed&&q.nodeType==1&&t.startOffset==q.childNodes.length){r=new a.dom.TreeWalker(q.lastChild,q);for(n=q.lastChild;n;n=r.prev())if(n.nodeType==3){t.setStart(n,n.nodeValue.length);t.collapse(true);s.setRng(t);return}}if(q&&p.dom.isBlock(q)&&!/^(TD|TH)$/.test(q.nodeName)&&m)if(q.childNodes.length==0||q.childNodes.length==1&&q.firstChild.nodeName=="BR"){for(n=q;(n=n.previousSibling)&&!p.dom.isBlock(n););if(n){if(q!=o.firstChild){for(o=p.dom.doc.createTreeWalker(n,
NodeFilter.SHOW_TEXT,null,k);t=o.nextNode();)n=t;t=p.getDoc().createRange();t.setStart(n,n.nodeValue?n.nodeValue.length:0);t.setEnd(n,n.nodeValue?n.nodeValue.length:0);s.setRng(t);p.dom.remove(q)}return d.cancel(l)}}}})})(tinymce);
(function(a){var b=a.dom.Event,c=a.each,d=a.extend;a.create("tinymce.ControlManager",{ControlManager:function(e,f){var g=this;f=f||{};g.editor=e;g.controls={};g.onAdd=new a.util.Dispatcher(g);g.onPostRender=new a.util.Dispatcher(g);g.prefix=f.prefix||e.id+"_";g._cls={};g.onPostRender.add(function(){c(g.controls,function(h){h.postRender()})})},get:function(e){return this.controls[this.prefix+e]||this.controls[e]},setActive:function(e,f){var g=null;if(g=this.get(e))g.setActive(f);return g},setDisabled:function(e,
f){var g=null;if(g=this.get(e))g.setDisabled(f);return g},add:function(e){if(e){this.controls[e.id]=e;this.onAdd.dispatch(e,this)}return e},createControl:function(e){var f,g=this,h=g.editor;c(h.plugins,function(k){if(k.createControl)if(f=k.createControl(e,g))return false});switch(e){case "|":case "separator":return g.createSeparator()}if(!f&&h.buttons&&(f=h.buttons[e]))return g.createButton(e,f);return g.add(f)},createDropMenu:function(e,f,g){var h=this.editor,k,l,m;f=d({"class":"mceDropDown",constrain:h.settings.constrain_menus},
f);f["class"]=f["class"]+" "+h.getParam("skin")+"Skin";if(m=h.getParam("skin_variant"))f["class"]+=" "+h.getParam("skin")+"Skin"+m.substring(0,1).toUpperCase()+m.substring(1);e=this.prefix+e;k=this.controls[e]=new (g||this._cls.dropmenu||a.ui.DropMenu)(e,f);k.onAddItem.add(function(p,o){var n=o.settings;n.title=h.getLang(n.title,n.title);if(!n.onclick)n.onclick=function(){if(n.cmd)h.execCommand(n.cmd,n.ui||false,n.value)}});h.onRemove.add(function(){k.destroy()});if(a.isIE){k.onShowMenu.add(function(){h.focus();
l=h.selection.getBookmark(1)});k.onHideMenu.add(function(){if(l){h.selection.moveToBookmark(l);l=0}})}return this.add(k)},createListBox:function(e,f,g){var h=this.editor;if(this.get(e))return null;f.title=h.translate(f.title);f.scope=f.scope||h;if(!f.onselect)f.onselect=function(k){h.execCommand(f.cmd,f.ui||false,k||f.value)};f=d({title:f.title,"class":"mce_"+e,scope:f.scope,control_manager:this},f);e=this.prefix+e;if(h.settings.use_native_selects)g=new a.ui.NativeListBox(e,f);else{g=g||this._cls.listbox||
a.ui.ListBox;g=new g(e,f,h)}this.controls[e]=g;a.isWebKit&&g.onPostRender.add(function(k,l){b.add(l,"mousedown",function(){h.bookmark=h.selection.getBookmark(1)});b.add(l,"focus",function(){h.selection.moveToBookmark(h.bookmark);h.bookmark=null})});g.hideMenu&&h.onMouseDown.add(g.hideMenu,g);return this.add(g)},createButton:function(e,f,g){var h=this.editor;if(this.get(e))return null;f.title=h.translate(f.title);f.label=h.translate(f.label);f.scope=f.scope||h;if(!f.onclick&&!f.menu_button)f.onclick=
function(){h.execCommand(f.cmd,f.ui||false,f.value)};f=d({title:f.title,"class":"mce_"+e,unavailable_prefix:h.getLang("unavailable",""),scope:f.scope,control_manager:this},f);e=this.prefix+e;if(f.menu_button){g=g||this._cls.menubutton||a.ui.MenuButton;e=new g(e,f,h);h.onMouseDown.add(e.hideMenu,e)}else{g=this._cls.button||a.ui.Button;e=new g(e,f,h)}return this.add(e)},createMenuButton:function(e,f,g){f=f||{};f.menu_button=1;return this.createButton(e,f,g)},createSplitButton:function(e,f,g){var h=
this.editor;if(this.get(e))return null;f.title=h.translate(f.title);f.scope=f.scope||h;if(!f.onclick)f.onclick=function(k){h.execCommand(f.cmd,f.ui||false,k||f.value)};if(!f.onselect)f.onselect=function(k){h.execCommand(f.cmd,f.ui||false,k||f.value)};f=d({title:f.title,"class":"mce_"+e,scope:f.scope,control_manager:this},f);e=this.prefix+e;e=this.add(new (g||this._cls.splitbutton||a.ui.SplitButton)(e,f,h));h.onMouseDown.add(e.hideMenu,e);return e},createColorSplitButton:function(e,f,g){var h=this.editor,
k,l;if(this.get(e))return null;f.title=h.translate(f.title);f.scope=f.scope||h;if(!f.onclick)f.onclick=function(m){if(a.isIE)l=h.selection.getBookmark(1);h.execCommand(f.cmd,f.ui||false,m||f.value)};if(!f.onselect)f.onselect=function(m){h.execCommand(f.cmd,f.ui||false,m||f.value)};f=d({title:f.title,"class":"mce_"+e,menu_class:h.getParam("skin")+"Skin",scope:f.scope,more_colors_title:h.getLang("more_colors")},f);e=this.prefix+e;k=new (g||this._cls.colorsplitbutton||a.ui.ColorSplitButton)(e,f,h);h.onMouseDown.add(k.hideMenu,
k);h.onRemove.add(function(){k.destroy()});if(a.isIE){k.onShowMenu.add(function(){h.focus();l=h.selection.getBookmark(1)});k.onHideMenu.add(function(){if(l){h.selection.moveToBookmark(l);l=0}})}return this.add(k)},createToolbar:function(e,f,g){e=this.prefix+e;f=new (g||this._cls.toolbar||a.ui.Toolbar)(e,f,this.editor);if(this.get(e))return null;return this.add(f)},createToolbarGroup:function(e,f,g){e=this.prefix+e;f=new (g||this._cls.toolbarGroup||a.ui.ToolbarGroup)(e,f,this.editor);if(this.get(e))return null;
return this.add(f)},createSeparator:function(e){return new (e||this._cls.separator||a.ui.Separator)},setControlType:function(e,f){return this._cls[e.toLowerCase()]=f},destroy:function(){c(this.controls,function(e){e.destroy()});this.controls=null}})})(tinymce);
(function(a){var b=a.util.Dispatcher,c=a.each,d=a.isIE,e=a.isOpera;a.create("tinymce.WindowManager",{WindowManager:function(f){this.editor=f;this.onOpen=new b(this);this.onClose=new b(this);this.params={};this.features={}},open:function(f,g){var h="",k=this.editor.settings.dialog_type=="modal",l,m,p;p=a.DOM.getViewPort();f=f||{};g=g||{};m=e?p.w:screen.width;p=e?p.h:screen.height;f.name=f.name||"mc_"+(new Date).getTime();f.width=parseInt(f.width||320);f.height=parseInt(f.height||240);f.resizable=true;
f.left=f.left||parseInt(m/2)-f.width/2;f.top=f.top||parseInt(p/2)-f.height/2;g.inline=false;g.mce_width=f.width;g.mce_height=f.height;g.mce_auto_focus=f.auto_focus;if(k)if(d){f.center=true;f.help=false;f.dialogWidth=f.width+"px";f.dialogHeight=f.height+"px";f.scroll=f.scrollbars||false}c(f,function(n,s){if(a.is(n,"boolean"))n=n?"yes":"no";/^(name|url)$/.test(s)||(h+=d&&k?(h?";":"")+s+":"+n:(h?",":"")+s+"="+n)});this.features=f;this.params=g;this.onOpen.dispatch(this,f,g);m=f.url||f.file;m=a._addVer(m);
try{if(d&&k){l=1;window.showModalDialog(m,window,h)}else l=window.open(m,f.name,h)}catch(o){}l||alert(this.editor.getLang("popup_blocked"))},close:function(f){f.close();this.onClose.dispatch(this)},createInstance:function(f,g,h,k,l,m){return new (a.resolve(f))(g,h,k,l,m)},confirm:function(f,g,h,k){g.call(h||this,(k||window).confirm(this._decode(this.editor.getLang(f,f))))},alert:function(f,g,h,k){(k||window).alert(this._decode(this.editor.getLang(f,f)));if(g)g.call(h||this)},resizeBy:function(f,g,
h){h.resizeBy(f,g)},_decode:function(f){return a.DOM.decode(f).replace(/\\n/g,"\n")}})})(tinymce);
(function(a){a.Formatter=function(b){function c(G){return G.nodeType===1&&(G.face==="mceinline"||G.style.fontFamily==="mceinline")}function d(G){return G?y[G]:y}function e(G,N){if(G)if(typeof G!=="string")z(G,function(P,ea){e(ea,P)});else{N=N.length?N:[N];z(N,function(P){if(P.deep===L)P.deep=!P.selector;if(P.split===L)P.split=!P.selector||P.inline;if(P.remove===L&&P.selector&&!P.inline)P.remove="none";if(P.selector&&P.inline){P.mixed=true;P.block_expand=true}if(typeof P.classes==="string")P.classes=
P.classes.split(/\s+/)});y[G]=N}}function f(G,N,P){function ea(V){var X=V.startContainer,ca=V.startOffset;if(X.nodeType==1||X.nodeValue==="")if(X=X.nodeType==1?X.childNodes[ca]:X){X=new E(X,X.parentNode);for(ca=X.current();ca;ca=X.next())if(ca.nodeType==3&&!n(ca)){V.setStart(ca,0);break}}return V}function Q(V,X){X=X||S;if(V){z(X.styles,function(ca,da){I.setStyle(V,da,o(ca,N))});z(X.attributes,function(ca,da){I.setAttrib(V,da,o(ca,N))});z(X.classes,function(ca){ca=o(ca,N);I.hasClass(V,ca)||I.addClass(V,
ca)})}}function aa(){function V(ha,ja){var ma=new E(ja);for(P=ma.current();P;P=ma.prev())if(P.childNodes.length>1||P==ha)return P}var X=b.selection.getRng(),ca=X.startContainer,da=X.endContainer;if(ca!=da&&X.endOffset==0){ca=V(ca,da);X.setEnd(ca,ca.nodeType==3?ca.length:ca.childNodes.length)}return X}function ba(V,X,ca,da,ha){var ja=[],ma=-1,pa,na=-1,oa=-1,la;z(V.childNodes,function(qa,ra){if(qa.nodeName==="UL"||qa.nodeName==="OL"){ma=ra;pa=qa;return false}});z(V.childNodes,function(qa,ra){if(qa.nodeName===
"SPAN"&&I.getAttrib(qa,"data-mce-type")=="bookmark"&&qa.id==X.id+"_start")na=ra;if(qa.nodeName==="SPAN"&&I.getAttrib(qa,"data-mce-type")=="bookmark"&&qa.id==X.id+"_end")oa=ra});if(ma<=0||na<ma&&oa>ma){z(a.grep(V.childNodes),ha);return 0}else{la=ca.cloneNode(M);z(a.grep(V.childNodes),function(qa,ra){if(na<ma&&ra<ma||na>ma&&ra>ma){ja.push(qa);qa.parentNode.removeChild(qa)}});if(na<ma)V.insertBefore(la,pa);else na>ma&&V.insertBefore(la,pa.nextSibling);da.push(la);z(ja,function(qa){la.appendChild(qa)});
return la}}function ia(V,X){var ca=[],da,ha;da=S.inline||S.block;ha=I.create(da);Q(ha);C.walk(V,function(ja){function ma(na){var oa=na.nodeName.toLowerCase(),la=na.parentNode.nodeName.toLowerCase(),qa;if(m(oa,"br")){pa=0;S.block&&I.remove(na)}else if(S.wrapper&&h(na,G,N))pa=0;else if(S.block&&!S.wrapper&&/^(h[1-6]|p|div|pre|address|dl|dt|dd)$/.test(oa)){na=I.rename(na,da);Q(na);ca.push(na);pa=0}else{if(S.selector){z(K,function(ra){if(!("collapsed"in ra&&ra.collapsed!==fa))if(I.is(na,ra.selector)&&
!c(na)){Q(na,ra);qa=true}});if(!S.inline||qa){pa=0;return}}if(O(da,oa)&&O(la,da)&&!(na.nodeType===3&&na.nodeValue.length===1&&na.nodeValue.charCodeAt(0)===65279)){if(!pa){pa=ha.cloneNode(M);na.parentNode.insertBefore(pa,na);ca.push(pa)}pa.appendChild(na)}else if(oa=="li"&&X)pa=ba(na,X,ha,ca,ma);else{pa=0;z(a.grep(na.childNodes),ma);pa=0}}}var pa;z(ja,ma)});S.wrap_links===false&&z(ca,function(ja){function ma(pa){var na,oa,la;if(pa.nodeName==="A"){oa=ha.cloneNode(M);ca.push(oa);la=a.grep(pa.childNodes);
for(na=0;na<la.length;na++)oa.appendChild(la[na]);pa.appendChild(oa)}z(a.grep(pa.childNodes),ma)}ma(ja)});z(ca,function(ja){function ma(na){var oa,la;z(na.childNodes,function(qa){if(qa.nodeType==1&&!x(qa)&&!c(qa)){oa=qa;return M}});if(oa&&l(oa,S)){la=oa.cloneNode(M);Q(la);I.replace(la,na,J);I.remove(oa,1)}return la||na}var pa;pa=function(na){var oa=0;z(na.childNodes,function(la){!n(la)&&!x(la)&&oa++});return oa}(ja);if((ca.length>1||!U(ja))&&pa===0)I.remove(ja,1);else if(S.inline||S.wrapper){if(!S.exact&&
pa===1)ja=ma(ja);z(K,function(na){z(I.select(na.inline,ja),function(oa){var la;if(na.wrap_links===false){la=oa.parentNode;do if(la.nodeName==="A")return;while(la=la.parentNode)}q(na,N,oa,na.exact?oa:null)})});if(h(ja.parentNode,G,N)){I.remove(ja,1);ja=0;return J}S.merge_with_parents&&I.getParent(ja.parentNode,function(na){if(h(na,G,N)){I.remove(ja,1);ja=0;return J}});if(ja){ja=A(u(ja),ja);ja=A(ja,u(ja,J))}}})}var K=d(G),S=K[0],R,fa=ga.isCollapsed();if(S)if(P){R=I.createRng();R.setStartBefore(P);R.setEndAfter(P);
ia(t(R,K))}else if(!fa||!S.inline||I.select("td.mceSelected,th.mceSelected").length){var Z=b.selection.getNode();b.selection.setRng(aa());R=ga.getBookmark();ia(t(ga.getRng(J),K),R);if(S.styles&&(S.styles.color||S.styles.textDecoration)){a.walk(Z,F,"childNodes");F(Z)}ga.moveToBookmark(R);ga.setRng(ea(ga.getRng(J)));b.nodeChanged()}else D("apply",G,N)}function g(G,N,P){function ea(Z){var V=Z.startContainer,X=Z.startOffset,ca;if(V.nodeType==3&&X>=V.nodeValue.length-1){V=V.parentNode;X=Y(V)+1}if(V.nodeType==
1){ca=V.childNodes;V=ca[Math.min(X,ca.length-1)];V=new E(V);X>ca.length-1&&V.next();for(X=V.current();X;X=V.next())if(X.nodeType==3&&!n(X)){V=I.create("a",null,v);X.parentNode.insertBefore(V,X);Z.setStart(X,0);ga.setRng(Z);I.remove(V);break}}}function Q(Z){var V,X,ca;V=a.grep(Z.childNodes);X=0;for(ca=S.length;X<ca;X++)if(q(S[X],N,Z,Z))break;if(R.deep){X=0;for(ca=V.length;X<ca;X++)Q(V[X])}}function aa(Z){var V;z(I.getParents(Z.parentNode,void 0,I.getRoot()).reverse(),function(X){var ca;if(!V&&X.id!=
"_start"&&X.id!="_end")if((ca=h(X,G,N))&&ca.split!==false)V=X});return V}function ba(Z,V,X,ca){var da,ha,ja,ma,pa,na;if(Z){na=Z.parentNode;for(da=V.parentNode;da&&da!=na;da=da.parentNode){ha=da.cloneNode(M);for(pa=0;pa<S.length;pa++)if(q(S[pa],N,ha,ha)){ha=0;break}if(ha){ja&&ha.appendChild(ja);ma||(ma=ha);ja=ha}}if(ca&&(!R.mixed||!U(Z)))V=I.split(Z,V);if(ja){X.parentNode.insertBefore(ja,X);ma.appendChild(X)}}return V}function ia(Z){var V=I.get(Z?"_start":"_end"),X=V[Z?"firstChild":"lastChild"];if(x(X))X=
X[Z?"firstChild":"lastChild"];I.remove(V,true);return X}function K(Z){var V,X;Z=t(Z,S,J);if(R.split){V=H(Z,J);X=H(Z);if(V!=X){V=s(V,"span",{id:"_start","data-mce-type":"bookmark"});X=s(X,"span",{id:"_end","data-mce-type":"bookmark"});ba(aa(V),V,V,true);ba(aa(X),X,X,true);V=ia(J);X=ia()}else V=X=ba(aa(V),V,V,true);Z.startContainer=V.parentNode;Z.startOffset=Y(V);Z.endContainer=X.parentNode;Z.endOffset=Y(X)+1}C.walk(Z,function(ca){z(ca,function(da){Q(da);da.nodeType===1&&b.dom.getStyle(da,"text-decoration")===
"underline"&&da.parentNode&&ka(da.parentNode)==="underline"&&q({deep:false,exact:true,inline:"span",styles:{textDecoration:"underline"}},null,da)})})}var S=d(G),R=S[0],fa;if(P){fa=I.createRng();fa.setStartBefore(P);fa.setEndAfter(P);K(fa)}else if(!ga.isCollapsed()||!R.inline||I.select("td.mceSelected,th.mceSelected").length){P=ga.getBookmark();K(ga.getRng(J));ga.moveToBookmark(P);k(G,N,ga.getStart())&&ea(ga.getRng(true));b.nodeChanged()}else D("remove",G,N)}function h(G,N,P,ea){function Q(ia,K,S){var R,
fa,Z=K[S];if(Z)if(Z.length===L)for(R in Z){if(Z.hasOwnProperty(R)){fa=S==="attributes"?I.getAttrib(ia,R):p(ia,R);if(ea&&!fa&&!K.exact)return;if((!ea||K.exact)&&!m(fa,o(Z[R],P)))return}}else for(R=0;R<Z.length;R++)if(S==="attributes"?I.getAttrib(ia,Z[R]):p(ia,Z[R]))break;return K}var aa=d(N),ba;if(aa&&G)for(ba=0;ba<aa.length;ba++){N=aa[ba];if(l(G,N)&&Q(G,N,"attributes")&&Q(G,N,"styles")){if(aa=N.classes)for(ba=0;ba<aa.length;ba++)if(!I.hasClass(G,aa[ba]))return;return N}}}function k(G,N,P){function ea(aa){aa=
I.getParent(aa,function(ba){return!!h(ba,G,N,true)});return h(aa,G,N)}var Q;if(P)return ea(P);if(ga.isCollapsed()){for(P=T.apply.length-1;P>=0;P--)if(T.apply[P].name==G)return true;for(P=T.remove.length-1;P>=0;P--)if(T.remove[P].name==G)return false;return ea(ga.getNode())}P=ga.getNode();if(ea(P))return J;Q=ga.getStart();if(Q!=P)if(ea(Q))return J;return M}function l(G,N){if(m(G,N.inline))return J;if(m(G,N.block))return J;if(N.selector)return I.is(G,N.selector)}function m(G,N){G=G||"";N=N||"";G=""+
(G.nodeName||G);N=""+(N.nodeName||N);return G.toLowerCase()==N.toLowerCase()}function p(G,N){var P=I.getStyle(G,N);if(N=="color"||N=="backgroundColor")P=I.toHex(P);if(N=="fontWeight"&&P==700)P="bold";return""+P}function o(G,N){if(typeof G!="string")G=G(N);else if(N)G=G.replace(/%(\w+)/g,function(P,ea){return N[ea]||P});return G}function n(G){return G&&G.nodeType===3&&/^([\s\r\n]+|)$/.test(G.nodeValue)}function s(G,N,P){N=I.create(N,P);G.parentNode.insertBefore(N,G);N.appendChild(G);return N}function t(G,
N){function P(R,fa,Z,V){var X;for(V=V||I.getRoot();;){X=R.parentNode;if(X==V||!N[0].block_expand&&U(X))break;for(K=X[fa];K&&K!=R;K=K[Z]){if(K.nodeType==1&&!x(K))return R;if(K.nodeType==3&&!n(K))return R}R=R.parentNode}return R}function ea(R,fa){if(fa===L)fa=R.nodeType===3?R.length:R.childNodes.length;for(;R&&R.hasChildNodes();)if(R=R.childNodes[fa])fa=R.nodeType===3?R.length:R.childNodes.length;return{node:R,offset:fa}}var Q=G.startContainer,aa=G.startOffset,ba=G.endContainer,ia=G.endOffset,K,S;if(Q.nodeType==
1&&Q.hasChildNodes()){S=Q.childNodes.length-1;Q=Q.childNodes[aa>S?S:aa];if(Q.nodeType==3)aa=0}if(ba.nodeType==1&&ba.hasChildNodes()){S=ba.childNodes.length-1;ba=ba.childNodes[ia>S?S:ia-1];if(ba.nodeType==3)ia=ba.nodeValue.length}if(x(Q.parentNode))Q=Q.parentNode;if(x(Q))Q=Q.nextSibling||Q;if(x(ba.parentNode)){ia=I.nodeIndex(ba);ba=ba.parentNode}if(x(ba)&&ba.previousSibling){ba=ba.previousSibling;ia=ba.length}if(N[0].inline){S=ea(ba,ia);if(S.node){for(;S.node&&S.offset===0&&S.node.previousSibling;)S=
ea(S.node.previousSibling);if(S.node&&S.offset>0&&S.node.nodeType===3&&S.node.nodeValue.charAt(S.offset-1)===" ")if(S.offset>1){ba=S.node;ba.splitText(S.offset-1)}else if(S.node.previousSibling)ba=S.node.previousSibling}}if(N[0].inline||N[0].block_expand){Q=P(Q,"firstChild","nextSibling");ba=P(ba,"lastChild","previousSibling")}if(N[0].selector&&N[0].expand!==M&&!N[0].inline){S=function(R,fa){var Z,V,X,ca;if(R.nodeType==3&&R.nodeValue.length==0&&R[fa])R=R[fa];Z=I.getParents(R,void 0,I.getRoot());for(V=
0;V<Z.length;V++)for(X=0;X<N.length;X++){ca=N[X];if(!("collapsed"in ca&&ca.collapsed!==G.collapsed))if(I.is(Z[V],ca.selector))return Z[V]}return R};Q=S(Q,"previousSibling");ba=S(ba,"nextSibling")}if(N[0].block||N[0].selector){S=function(R,fa){var Z;N[0].wrapper||(Z=I.getParent(R,N[0].block));Z||(Z=I.getParent(R.nodeType==3?R.parentNode:R,U));if(Z&&N[0].wrapper)Z=I.getParents(Z,"ul,ol",I.getRoot()).reverse()[0]||Z;if(!Z)for(Z=R;Z[fa]&&!U(Z[fa]);){Z=Z[fa];if(m(Z,"br"))break}return Z||R};Q=S(Q,"previousSibling");
ba=S(ba,"nextSibling");if(N[0].block){U(Q)||(Q=P(Q,"firstChild","nextSibling"));U(ba)||(ba=P(ba,"lastChild","previousSibling"))}}if(Q.nodeType==1){aa=Y(Q);Q=Q.parentNode}if(ba.nodeType==1){ia=Y(ba)+1;ba=ba.parentNode}return{startContainer:Q,startOffset:aa,endContainer:ba,endOffset:ia}}function q(G,N,P,ea){var Q,aa,ba;if(!l(P,G))return M;if(G.remove!="all"){z(G.styles,function(ia,K){ia=o(ia,N);if(typeof K==="number"){K=ia;ea=0}if(!ea||m(p(ea,K),ia))I.setStyle(P,K,"");ba=1});if(ba&&I.getAttrib(P,"style")==
""){P.removeAttribute("style");P.removeAttribute("data-mce-style")}z(G.attributes,function(ia,K){var S;ia=o(ia,N);if(typeof K==="number"){K=ia;ea=0}if(!ea||m(I.getAttrib(ea,K),ia)){if(K=="class")if(ia=I.getAttrib(P,K)){S="";z(ia.split(/\s+/),function(R){if(/mce\w+/.test(R))S+=(S?" ":"")+R});if(S){I.setAttrib(P,K,S);return}}K=="class"&&P.removeAttribute("className");B.test(K)&&P.removeAttribute("data-mce-"+K);P.removeAttribute(K)}});z(G.classes,function(ia){ia=o(ia,N);if(!ea||I.hasClass(ea,ia))I.removeClass(P,
ia)});aa=I.getAttribs(P);for(Q=0;Q<aa.length;Q++)if(aa[Q].nodeName.indexOf("_")!==0)return M}if(G.remove!="none"){r(P,G);return J}}function r(G,N){var P=G.parentNode,ea;if(N.block)if(W){if(P==I.getRoot())if(!N.list_block||!m(G,N.list_block))z(a.grep(G.childNodes),function(aa){if(O(W,aa.nodeName.toLowerCase()))if(ea)ea.appendChild(aa);else ea=s(aa,W);else ea=0})}else{var Q=function(aa,ba,ia){aa=u(aa,ba,ia);return!aa||aa.nodeName=="BR"||U(aa)};if(U(G)&&!U(P)){!Q(G,M)&&!Q(G.firstChild,J,1)&&G.insertBefore(I.create("br"),
G.firstChild);!Q(G,J)&&!Q(G.lastChild,M,1)&&G.appendChild(I.create("br"))}}N.selector&&N.inline&&!m(N.inline,G)||I.remove(G,1)}function u(G,N,P){if(G){N=N?"nextSibling":"previousSibling";for(G=P?G:G[N];G;G=G[N])if(G.nodeType==1||!n(G))return G}}function x(G){return G&&G.nodeType==1&&G.getAttribute("data-mce-type")=="bookmark"}function A(G,N){function P(aa,ba){function ia(S){var R={};z(I.getAttribs(S),function(fa){fa=fa.nodeName.toLowerCase();if(fa.indexOf("_")!==0&&fa!=="style")R[fa]=I.getAttrib(S,
fa)});return R}function K(S,R){var fa,Z;for(Z in S)if(S.hasOwnProperty(Z)){fa=R[Z];if(fa===L)return M;if(S[Z]!=fa)return M;delete R[Z]}for(Z in R)if(R.hasOwnProperty(Z))return M;return J}if(aa.nodeName!=ba.nodeName)return M;if(!K(ia(aa),ia(ba)))return M;if(!K(I.parseStyle(I.getAttrib(aa,"style")),I.parseStyle(I.getAttrib(ba,"style"))))return M;return J}var ea,Q;if(G&&N){Q=function(aa,ba){for(ea=aa;ea;ea=ea[ba]){if(ea.nodeType==3&&ea.nodeValue.length!==0)break;if(ea.nodeType==1&&!x(ea))return ea}return aa};
G=Q(G,"previousSibling");N=Q(N,"nextSibling");if(P(G,N)){for(ea=G.nextSibling;ea&&ea!=N;){Q=ea;ea=ea.nextSibling;G.appendChild(Q)}I.remove(N);z(a.grep(N.childNodes),function(aa){G.appendChild(aa)});return G}}return N}function H(G,N){var P,ea,Q;P=G[N?"startContainer":"endContainer"];ea=G[N?"startOffset":"endOffset"];if(P.nodeType==1){Q=P.childNodes.length-1;!N&&ea&&ea--;P=P.childNodes[ea>Q?Q:ea]}return P}function D(G,N,P){function ea(){return T.apply.length||T.remove.length}function Q(S){z(T.apply.reverse(),
function(R){f(R.name,R.vars,S);R.name==="forecolor"&&R.vars.value&&F(S.parentNode)});z(T.remove.reverse(),function(R){g(R.name,R.vars,S)});I.remove(S,1);T.apply=[];T.remove=[]}var aa=T[G],ba=T[G=="apply"?"remove":"apply"];for(G=aa.length-1;G>=0;G--)if(aa[G].name==N)return;aa.push({name:N,vars:P});for(G=ba.length-1;G>=0;G--)ba[G].name==N&&ba.splice(G,1);if(ea()){b.getDoc().execCommand("FontName",false,"mceinline");T.lastRng=ga.getRng();z(I.select("font,span"),function(S){var R;if(c(S)){R=ga.getBookmark();
Q(S);ga.moveToBookmark(R);b.nodeChanged()}});if(!T.isListening&&ea()){T.isListening=true;var ia=function(S,R){var fa=I.createRng();Q(S);fa.setStart(R,R.nodeValue.length);fa.setEnd(R,R.nodeValue.length);ga.setRng(fa);b.nodeChanged()},K=false;z("onKeyDown,onKeyUp,onKeyPress,onMouseUp".split(","),function(S){b[S].addToTop(function(R,fa){if(fa.keyCode==13&&!fa.shiftKey)K=true;else if(ea()&&!a.dom.RangeUtils.compareRanges(T.lastRng,ga.getRng())){var Z=false;z(I.select("font,span"),function(ca){var da;
if(c(ca)){Z=true;for(da=ca.firstChild;da&&da.nodeType!=3;)da=da.firstChild;da?ia(ca,da):I.remove(ca)}});if(K&&!Z){for(var V=ga.getNode(),X=V;X&&X.nodeType!=3;)X=X.firstChild;if(X){for(V=X.parentNode;!U(V);)V=V.parentNode;ia(V,X)}}if(fa.type=="keyup"||fa.type=="mouseup"){T.apply=[];T.remove=[];K=false}}})})}}}var y={},z=a.each,I=b.dom,ga=b.selection,E=a.dom.TreeWalker,C=new a.dom.RangeUtils(I),O=b.schema.isValidChild,U=I.isBlock,W=b.settings.forced_root_block,Y=I.nodeIndex,v="\ufeff",B=/^(src|href|style)$/,
M=false,J=true,L,T={apply:[],remove:[]},ka=function(G){var N;b.dom.getParent(G,function(P){return(N=b.dom.getStyle(P,"text-decoration"))&&N!=="none"});return N},F=function(G){var N;if(G.nodeType===1&&G.parentNode&&G.parentNode.nodeType===1){N=ka(G.parentNode);if(b.dom.getStyle(G,"color")&&N)b.dom.setStyle(G,"text-decoration",N);else b.dom.getStyle(G,"textdecoration")===N&&b.dom.setStyle(G,"text-decoration",null)}};a.extend(this,{get:d,register:e,apply:f,remove:g,toggle:function(G,N,P){var ea=d(G);
k(G,N,P)&&(!("toggle"in ea[0])||ea[0].toggle)?g(G,N,P):f(G,N,P)},match:k,matchAll:function(G,N){var P,ea=[],Q={},aa,ba;if(ga.isCollapsed()){for(aa=0;aa<G.length;aa++)for(P=T.remove.length-1;P>=0;P--){ba=G[aa];if(T.remove[P].name==ba){Q[ba]=true;break}}for(P=T.apply.length-1;P>=0;P--)for(aa=0;aa<G.length;aa++){ba=G[aa];if(!Q[ba]&&T.apply[P].name==ba){Q[ba]=true;ea.push(ba)}}}P=ga.getStart();I.getParent(P,function(ia){var K,S;for(K=0;K<G.length;K++){S=G[K];if(!Q[S]&&h(ia,S,N)){Q[S]=true;ea.push(S)}}});
return ea},matchNode:h,canApply:function(G){G=d(G);var N,P,ea,Q;if(G){N=ga.getStart();N=I.getParents(N,void 0,I.getRoot());for(ea=G.length-1;ea>=0;ea--){Q=G[ea].selector;if(!Q)return J;for(P=N.length-1;P>=0;P--)if(I.is(N[P],Q))return J}}return M}})}})(tinymce);
tinymce.onAddEditor.add(function(a,b){var c,d,e,f=b.settings;if(f.inline_styles){d=a.explode(f.font_size_style_values);var g=function(k,l){a.each(l,function(m,p){m&&e.setStyle(k,p,m)});e.rename(k,"span")};c={font:function(k,l){g(l,{backgroundColor:l.style.backgroundColor,color:l.color,fontFamily:l.face,fontSize:d[parseInt(l.size)-1]})},u:function(k,l){g(l,{textDecoration:"underline"})},strike:function(k,l){g(l,{textDecoration:"line-through"})}};var h=function(k,l){e=k.dom;f.convert_fonts_to_spans&&
a.each(e.select("font,u,strike",l.node),function(m){c[m.nodeName.toLowerCase()](b.dom,m)})};b.onPreProcess.add(h);b.onSetContent.add(h);b.onInit.add(function(){b.selection.onSetContent.add(h)})}});addEvent(window,"load",initForm);var highlight_array=[];function initForm(){browserDetect();initializeFocus();document.getElementsByTagName("form");ifInstructs()}
function initializeFocus(){fields=getElementsByClassName(document,"*","field");for(i=0;i<fields.length;i++)if(fields[i].type=="radio"||fields[i].type=="checkbox"){fields[i].onclick=function(){clearSafariRadios();addClassName(this.parentNode.parentNode.parentNode,"focused",true)};fields[i].onfocus=function(){clearSafariRadios();addClassName(this.parentNode.parentNode.parentNode,"focused",true)};highlight_array.splice(highlight_array.length,0,fields[i])}else if(fields[i].className.match("addr")){fields[i].onfocus=
function(){clearSafariRadios();addClassName(this.parentNode.parentNode.parentNode,"focused",true)};fields[i].onblur=function(){removeClassName(this.parentNode.parentNode.parentNode,"focused")}}else if(fields[i].className.match("other"))fields[i].onfocus=function(){clearSafariRadios();addClassName(this.parentNode.parentNode.parentNode,"focused",true)};else{fields[i].onfocus=function(){clearSafariRadios();addClassName(this.parentNode.parentNode,"focused",true)};fields[i].onblur=function(){removeClassName(this.parentNode.parentNode,
"focused")}}}function clearSafariRadios(){for(var a=0;a<highlight_array.length;a++)highlight_array[a].parentNode&&removeClassName(highlight_array[a].parentNode.parentNode.parentNode,"focused")}function ifInstructs(){var a=document.getElementById("public");if(a){removeClassName(a,"noI");getElementsByClassName(document,"*","instruct")==""&&addClassName(a,"noI",true);a.offsetWidth<=450&&addClassName(a,"altInstruct",true)}}
function browserDetect(){var a=navigator.userAgent.toLowerCase(),b=document.getElementsByTagName("html");if(a.indexOf("firefox")+1)addClassName(b[0],"firefox",true);else if(a.indexOf("chrome")+1)addClassName(b[0],"chrome",true);else a.indexOf("safari")+1&&addClassName(b[0],"safari",true)}
function getElementsByClassName(a,b,c){a=b=="*"&&a.all?a.all:a.getElementsByTagName(b);b=[];c=c.replace(/\-/g,"\\-");c=RegExp("(^|\\s)"+c+"(\\s|$)");for(var d,e=0;e<a.length;e++){d=a[e];c.test(d.className)&&b.push(d)}return b}function addClassName(a,b,c){if(a.className){var d=a.className.split(" ");if(c){c=b.toUpperCase();for(var e=0;e<d.length;e++)if(d[e].toUpperCase()==c){d.splice(e,1);e--}}d[d.length]=b;a.className=d.join(" ")}else a.className=b}
function removeClassName(a,b){if(a.className){for(var c=a.className.split(" "),d=b.toUpperCase(),e=0;e<c.length;e++)if(c[e].toUpperCase()==d){c.splice(e,1);e--}a.className=c.join(" ")}}function addEvent(a,b,c){if(a!=null)if(a.attachEvent){a["e"+b+c]=c;a[b+c]=function(){a["e"+b+c](window.event)};a.attachEvent("on"+b,a[b+c])}else a.addEventListener(b,c,false)};function diff_match_patch(){this.Diff_Timeout=1;this.Diff_EditCost=4;this.Match_Threshold=0.5;this.Match_Distance=1E3;this.Patch_DeleteThreshold=0.5;this.Patch_Margin=4;this.Match_MaxBits=32}var DIFF_DELETE=-1,DIFF_INSERT=1,DIFF_EQUAL=0;
diff_match_patch.prototype.diff_main=function(a,b,c,d){if(typeof d=="undefined")d=this.Diff_Timeout<=0?Number.MAX_VALUE:(new Date).getTime()+this.Diff_Timeout*1E3;if(a==null||b==null)throw Error("Null input. (diff_main)");if(a==b){if(a)return[[DIFF_EQUAL,a]];return[]}if(typeof c=="undefined")c=true;var e=c,f=this.diff_commonPrefix(a,b);c=a.substring(0,f);a=a.substring(f);b=b.substring(f);f=this.diff_commonSuffix(a,b);var g=a.substring(a.length-f);a=a.substring(0,a.length-f);b=b.substring(0,b.length-
f);a=this.diff_compute_(a,b,e,d);c&&a.unshift([DIFF_EQUAL,c]);g&&a.push([DIFF_EQUAL,g]);this.diff_cleanupMerge(a);return a};
diff_match_patch.prototype.diff_compute_=function(a,b,c,d){if(!a)return[[DIFF_INSERT,b]];if(!b)return[[DIFF_DELETE,a]];var e=a.length>b.length?a:b,f=a.length>b.length?b:a,g=e.indexOf(f);if(g!=-1){c=[[DIFF_INSERT,e.substring(0,g)],[DIFF_EQUAL,f],[DIFF_INSERT,e.substring(g+f.length)]];if(a.length>b.length)c[0][0]=c[2][0]=DIFF_DELETE;return c}if(f.length==1)return[[DIFF_DELETE,a],[DIFF_INSERT,b]];if(e=this.diff_halfMatch_(a,b)){b=e[1];f=e[3];a=e[4];e=this.diff_main(e[0],e[2],c,d);c=this.diff_main(b,
f,c,d);return e.concat([[DIFF_EQUAL,a]],c)}if(c&&a.length>100&&b.length>100)return this.diff_lineMode_(a,b,d);return this.diff_bisect_(a,b,d)};
diff_match_patch.prototype.diff_lineMode_=function(a,b,c){var d=this.diff_linesToChars_(a,b);a=d[0];b=d[1];d=d[2];a=this.diff_bisect_(a,b,c);this.diff_charsToLines_(a,d);this.diff_cleanupSemantic(a);a.push([DIFF_EQUAL,""]);for(var e=b=0,f=0,g=d="";b<a.length;){switch(a[b][0]){case DIFF_INSERT:f++;g+=a[b][1];break;case DIFF_DELETE:e++;d+=a[b][1];break;case DIFF_EQUAL:if(e>=1&&f>=1){d=this.diff_main(d,g,false,c);a.splice(b-e-f,e+f);b=b-e-f;for(e=d.length-1;e>=0;e--)a.splice(b,0,d[e]);b+=d.length}e=
f=0;g=d=""}b++}a.pop();return a};
diff_match_patch.prototype.diff_bisect_=function(a,b,c){for(var d=a.length,e=b.length,f=Math.ceil((d+e)/2),g=2*f,h=Array(g),k=Array(g),l=0;l<g;l++){h[l]=-1;k[l]=-1}h[f+1]=0;k[f+1]=0;l=d-e;for(var m=l%2!=0,p=0,o=0,n=0,s=0,t=0;t<f;t++){if((new Date).getTime()>c)break;for(var q=-t+p;q<=t-o;q+=2){var r=f+q,u;u=q==-t||q!=t&&h[r-1]<h[r+1]?h[r+1]:h[r-1]+1;for(var x=u-q;u<d&&x<e&&a.charAt(u)==b.charAt(x);){u++;x++}h[r]=u;if(u>d)o+=2;else if(x>e)p+=2;else if(m){r=f+l-q;if(r>=0&&r<g&&k[r]!=-1){var A=d-k[r];
if(u>=A)return this.diff_bisectSplit_(a,b,u,x,c)}}}for(q=-t+n;q<=t-s;q+=2){r=f+q;A=q==-t||q!=t&&k[r-1]<k[r+1]?k[r+1]:k[r-1]+1;for(u=A-q;A<d&&u<e&&a.charAt(d-A-1)==b.charAt(e-u-1);){A++;u++}k[r]=A;if(A>d)s+=2;else if(u>e)n+=2;else if(!m){r=f+l-q;if(r>=0&&r<g&&h[r]!=-1){u=h[r];x=f+u-r;A=d-A;if(u>=A)return this.diff_bisectSplit_(a,b,u,x,c)}}}}return[[DIFF_DELETE,a],[DIFF_INSERT,b]]};
diff_match_patch.prototype.diff_bisectSplit_=function(a,b,c,d,e){var f=a.substring(0,c),g=b.substring(0,d);a=a.substring(c);b=b.substring(d);f=this.diff_main(f,g,false,e);e=this.diff_main(a,b,false,e);return f.concat(e)};
diff_match_patch.prototype.diff_linesToChars_=function(a,b){function c(h){for(var k="",l=0,m=-1,p=d.length;m<h.length-1;){m=h.indexOf("\n",l);if(m==-1)m=h.length-1;var o=h.substring(l,m+1);l=m+1;if(e.hasOwnProperty?e.hasOwnProperty(o):e[o]!==undefined)k+=String.fromCharCode(e[o]);else{k+=String.fromCharCode(p);e[o]=p;d[p++]=o}}return k}var d=[],e={};d[0]="";var f=c(a),g=c(b);return[f,g,d]};
diff_match_patch.prototype.diff_charsToLines_=function(a,b){for(var c=0;c<a.length;c++){for(var d=a[c][1],e=[],f=0;f<d.length;f++)e[f]=b[d.charCodeAt(f)];a[c][1]=e.join("")}};diff_match_patch.prototype.diff_commonPrefix=function(a,b){if(!a||!b||a.charAt(0)!=b.charAt(0))return 0;for(var c=0,d=Math.min(a.length,b.length),e=d,f=0;c<e;){if(a.substring(f,e)==b.substring(f,e))f=c=e;else d=e;e=Math.floor((d-c)/2+c)}return e};
diff_match_patch.prototype.diff_commonSuffix=function(a,b){if(!a||!b||a.charAt(a.length-1)!=b.charAt(b.length-1))return 0;for(var c=0,d=Math.min(a.length,b.length),e=d,f=0;c<e;){if(a.substring(a.length-e,a.length-f)==b.substring(b.length-e,b.length-f))f=c=e;else d=e;e=Math.floor((d-c)/2+c)}return e};
diff_match_patch.prototype.diff_commonOverlap_=function(a,b){var c=a.length,d=b.length;if(c==0||d==0)return 0;if(c>d)a=a.substring(c-d);else if(c<d)b=b.substring(0,c);c=Math.min(c,d);if(a==b)return c;d=0;for(var e=1;;){var f=a.substring(c-e);f=b.indexOf(f);if(f==-1)return d;e+=f;if(f==0||a.substring(c-e)==b.substring(0,e)){d=e;e++}}};
diff_match_patch.prototype.diff_halfMatch_=function(a,b){function c(l,m,p){for(var o=l.substring(p,p+Math.floor(l.length/4)),n=-1,s="",t,q,r,u;(n=m.indexOf(o,n+1))!=-1;){var x=f.diff_commonPrefix(l.substring(p),m.substring(n)),A=f.diff_commonSuffix(l.substring(0,p),m.substring(0,n));if(s.length<A+x){s=m.substring(n-A,n)+m.substring(n,n+x);t=l.substring(0,p-A);q=l.substring(p+x);r=m.substring(0,n-A);u=m.substring(n+x)}}return s.length*2>=l.length?[t,q,r,u,s]:null}if(this.Diff_Timeout<=0)return null;
var d=a.length>b.length?a:b,e=a.length>b.length?b:a;if(d.length<4||e.length*2<d.length)return null;var f=this,g=c(d,e,Math.ceil(d.length/4));d=c(d,e,Math.ceil(d.length/2));if(!g&&!d)return null;else g=d?g?g[4].length>d[4].length?g:d:d:g;var h,k;if(a.length>b.length){d=g[0];e=g[1];h=g[2];k=g[3]}else{h=g[0];k=g[1];d=g[2];e=g[3]}return[d,e,h,k,g[4]]};
diff_match_patch.prototype.diff_cleanupSemantic=function(a){for(var b=false,c=[],d=0,e=null,f=0,g=0,h=0,k=0,l=0;f<a.length;){if(a[f][0]==DIFF_EQUAL){c[d++]=f;g=k;h=l;l=k=0;e=a[f][1]}else{if(a[f][0]==DIFF_INSERT)k+=a[f][1].length;else l+=a[f][1].length;if(e!==null&&e.length<=Math.max(g,h)&&e.length<=Math.max(k,l)){a.splice(c[d-1],0,[DIFF_DELETE,e]);a[c[d-1]+1][0]=DIFF_INSERT;d--;d--;f=d>0?c[d-1]:-1;l=k=h=g=0;e=null;b=true}}f++}b&&this.diff_cleanupMerge(a);this.diff_cleanupSemanticLossless(a);for(f=
1;f<a.length;){if(a[f-1][0]==DIFF_DELETE&&a[f][0]==DIFF_INSERT){b=a[f-1][1];c=a[f][1];d=this.diff_commonOverlap_(b,c);if(d>=b.length/2||d>=c.length/2){a.splice(f,0,[DIFF_EQUAL,c.substring(0,d)]);a[f-1][1]=b.substring(0,b.length-d);a[f+1][1]=c.substring(d);f++}f++}f++}};
diff_match_patch.prototype.diff_cleanupSemanticLossless=function(a){function b(q,r){if(!q||!r)return 5;var u=0;if(q.charAt(q.length-1).match(c)||r.charAt(0).match(c)){u++;if(q.charAt(q.length-1).match(d)||r.charAt(0).match(d)){u++;if(q.charAt(q.length-1).match(e)||r.charAt(0).match(e)){u++;if(q.match(f)||r.match(g))u++}}}return u}for(var c=/[^a-zA-Z0-9]/,d=/\s/,e=/[\r\n]/,f=/\n\r?\n$/,g=/^\r?\n\r?\n/,h=1;h<a.length-1;){if(a[h-1][0]==DIFF_EQUAL&&a[h+1][0]==DIFF_EQUAL){var k=a[h-1][1],l=a[h][1],m=a[h+
1][1],p=this.diff_commonSuffix(k,l);if(p){var o=l.substring(l.length-p);k=k.substring(0,k.length-p);l=o+l.substring(0,l.length-p);m=o+m}p=k;o=l;for(var n=m,s=b(k,l)+b(l,m);l.charAt(0)===m.charAt(0);){k+=l.charAt(0);l=l.substring(1)+m.charAt(0);m=m.substring(1);var t=b(k,l)+b(l,m);if(t>=s){s=t;p=k;o=l;n=m}}if(a[h-1][1]!=p){if(p)a[h-1][1]=p;else{a.splice(h-1,1);h--}a[h][1]=o;if(n)a[h+1][1]=n;else{a.splice(h+1,1);h--}}}h++}};
diff_match_patch.prototype.diff_cleanupEfficiency=function(a){for(var b=false,c=[],d=0,e="",f=0,g=false,h=false,k=false,l=false;f<a.length;){if(a[f][0]==DIFF_EQUAL){if(a[f][1].length<this.Diff_EditCost&&(k||l)){c[d++]=f;g=k;h=l;e=a[f][1]}else{d=0;e=""}k=l=false}else{if(a[f][0]==DIFF_DELETE)l=true;else k=true;if(e&&(g&&h&&k&&l||e.length<this.Diff_EditCost/2&&g+h+k+l==3)){a.splice(c[d-1],0,[DIFF_DELETE,e]);a[c[d-1]+1][0]=DIFF_INSERT;d--;e="";if(g&&h){k=l=true;d=0}else{d--;f=d>0?c[d-1]:-1;k=l=false}b=
true}}f++}b&&this.diff_cleanupMerge(a)};
diff_match_patch.prototype.diff_cleanupMerge=function(a){a.push([DIFF_EQUAL,""]);for(var b=0,c=0,d=0,e="",f="",g;b<a.length;)switch(a[b][0]){case DIFF_INSERT:d++;f+=a[b][1];b++;break;case DIFF_DELETE:c++;e+=a[b][1];b++;break;case DIFF_EQUAL:if(c+d>1){if(c!==0&&d!==0){g=this.diff_commonPrefix(f,e);if(g!==0){if(b-c-d>0&&a[b-c-d-1][0]==DIFF_EQUAL)a[b-c-d-1][1]+=f.substring(0,g);else{a.splice(0,0,[DIFF_EQUAL,f.substring(0,g)]);b++}f=f.substring(g);e=e.substring(g)}g=this.diff_commonSuffix(f,e);if(g!==
0){a[b][1]=f.substring(f.length-g)+a[b][1];f=f.substring(0,f.length-g);e=e.substring(0,e.length-g)}}if(c===0)a.splice(b-c-d,c+d,[DIFF_INSERT,f]);else d===0?a.splice(b-c-d,c+d,[DIFF_DELETE,e]):a.splice(b-c-d,c+d,[DIFF_DELETE,e],[DIFF_INSERT,f]);b=b-c-d+(c?1:0)+(d?1:0)+1}else if(b!==0&&a[b-1][0]==DIFF_EQUAL){a[b-1][1]+=a[b][1];a.splice(b,1)}else b++;c=d=0;f=e=""}a[a.length-1][1]===""&&a.pop();c=false;for(b=1;b<a.length-1;){if(a[b-1][0]==DIFF_EQUAL&&a[b+1][0]==DIFF_EQUAL)if(a[b][1].substring(a[b][1].length-
a[b-1][1].length)==a[b-1][1]){a[b][1]=a[b-1][1]+a[b][1].substring(0,a[b][1].length-a[b-1][1].length);a[b+1][1]=a[b-1][1]+a[b+1][1];a.splice(b-1,1);c=true}else if(a[b][1].substring(0,a[b+1][1].length)==a[b+1][1]){a[b-1][1]+=a[b+1][1];a[b][1]=a[b][1].substring(a[b+1][1].length)+a[b+1][1];a.splice(b+1,1);c=true}b++}c&&this.diff_cleanupMerge(a)};
diff_match_patch.prototype.diff_xIndex=function(a,b){var c=0,d=0,e=0,f=0,g;for(g=0;g<a.length;g++){if(a[g][0]!==DIFF_INSERT)c+=a[g][1].length;if(a[g][0]!==DIFF_DELETE)d+=a[g][1].length;if(c>b)break;e=c;f=d}if(a.length!=g&&a[g][0]===DIFF_DELETE)return f;return f+(b-e)};
diff_match_patch.prototype.diff_prettyHtml=function(a){for(var b=[],c=0,d=/&/g,e=/</g,f=/>/g,g=/\n/g,h=0;h<a.length;h++){var k=a[h][0],l=a[h][1],m=l.replace(d,"&amp;").replace(e,"&lt;").replace(f,"&gt;").replace(g,"&para;<br>");switch(k){case DIFF_INSERT:b[h]='<ins style="background:#e6ffe6;">'+m+"</ins>";break;case DIFF_DELETE:b[h]='<del style="background:#ffe6e6;">'+m+"</del>";break;case DIFF_EQUAL:b[h]="<span>"+m+"</span>"}if(k!==DIFF_DELETE)c+=l.length}return b.join("")};
diff_match_patch.prototype.diff_text1=function(a){for(var b=[],c=0;c<a.length;c++)if(a[c][0]!==DIFF_INSERT)b[c]=a[c][1];return b.join("")};diff_match_patch.prototype.diff_text2=function(a){for(var b=[],c=0;c<a.length;c++)if(a[c][0]!==DIFF_DELETE)b[c]=a[c][1];return b.join("")};
diff_match_patch.prototype.diff_levenshtein=function(a){for(var b=0,c=0,d=0,e=0;e<a.length;e++){var f=a[e][1];switch(a[e][0]){case DIFF_INSERT:c+=f.length;break;case DIFF_DELETE:d+=f.length;break;case DIFF_EQUAL:b+=Math.max(c,d);d=c=0}}b+=Math.max(c,d);return b};
diff_match_patch.prototype.diff_toDelta=function(a){for(var b=[],c=0;c<a.length;c++)switch(a[c][0]){case DIFF_INSERT:b[c]="+"+encodeURI(a[c][1]);break;case DIFF_DELETE:b[c]="-"+a[c][1].length;break;case DIFF_EQUAL:b[c]="="+a[c][1].length}return b.join("\t").replace(/%20/g," ")};
diff_match_patch.prototype.diff_fromDelta=function(a,b){for(var c=[],d=0,e=0,f=b.split(/\t/g),g=0;g<f.length;g++){var h=f[g].substring(1);switch(f[g].charAt(0)){case "+":try{c[d++]=[DIFF_INSERT,decodeURI(h)]}catch(k){throw Error("Illegal escape in diff_fromDelta: "+h);}break;case "-":case "=":var l=parseInt(h,10);if(isNaN(l)||l<0)throw Error("Invalid number in diff_fromDelta: "+h);h=a.substring(e,e+=l);if(f[g].charAt(0)=="=")c[d++]=[DIFF_EQUAL,h];else c[d++]=[DIFF_DELETE,h];break;default:if(f[g])throw Error("Invalid diff operation in diff_fromDelta: "+
f[g]);}}if(e!=a.length)throw Error("Delta length ("+e+") does not equal source text length ("+a.length+").");return c};diff_match_patch.prototype.match_main=function(a,b,c){if(a==null||b==null||c==null)throw Error("Null input. (match_main)");c=Math.max(0,Math.min(c,a.length));return a==b?0:a.length?a.substring(c,c+b.length)==b?c:this.match_bitap_(a,b,c):-1};
diff_match_patch.prototype.match_bitap_=function(a,b,c){function d(q,r){var u=q/b.length,x=Math.abs(c-r);if(!f.Match_Distance)return x?1:u;return u+x/f.Match_Distance}if(b.length>this.Match_MaxBits)throw Error("Pattern too long for this browser.");var e=this.match_alphabet_(b),f=this,g=this.Match_Threshold,h=a.indexOf(b,c);if(h!=-1){g=Math.min(d(0,h),g);h=a.lastIndexOf(b,c+b.length);if(h!=-1)g=Math.min(d(0,h),g)}var k=1<<b.length-1;h=-1;for(var l,m,p=b.length+a.length,o,n=0;n<b.length;n++){l=0;for(m=
p;l<m;){if(d(n,c+m)<=g)l=m;else p=m;m=Math.floor((p-l)/2+l)}p=m;l=Math.max(1,c-m+1);var s=Math.min(c+m,a.length)+b.length;m=Array(s+2);for(m[s+1]=(1<<n)-1;s>=l;s--){var t=e[a.charAt(s-1)];m[s]=n===0?(m[s+1]<<1|1)&t:(m[s+1]<<1|1)&t|(o[s+1]|o[s])<<1|1|o[s+1];if(m[s]&k){t=d(n,s-1);if(t<=g){g=t;h=s-1;if(h>c)l=Math.max(1,2*c-h);else break}}}if(d(n+1,c)>g)break;o=m}return h};
diff_match_patch.prototype.match_alphabet_=function(a){for(var b={},c=0;c<a.length;c++)b[a.charAt(c)]=0;for(c=0;c<a.length;c++)b[a.charAt(c)]|=1<<a.length-c-1;return b};
diff_match_patch.prototype.patch_addContext_=function(a,b){if(b.length!=0){for(var c=b.substring(a.start2,a.start2+a.length1),d=0;b.indexOf(c)!=b.lastIndexOf(c)&&c.length<this.Match_MaxBits-this.Patch_Margin-this.Patch_Margin;){d+=this.Patch_Margin;c=b.substring(a.start2-d,a.start2+a.length1+d)}d+=this.Patch_Margin;(c=b.substring(a.start2-d,a.start2))&&a.diffs.unshift([DIFF_EQUAL,c]);(d=b.substring(a.start2+a.length1,a.start2+a.length1+d))&&a.diffs.push([DIFF_EQUAL,d]);a.start1-=c.length;a.start2-=
c.length;a.length1+=c.length+d.length;a.length2+=c.length+d.length}};
diff_match_patch.prototype.patch_make=function(a,b,c){var d;if(typeof a=="string"&&typeof b=="string"&&typeof c=="undefined"){d=a;b=this.diff_main(d,b,true);if(b.length>2){this.diff_cleanupSemantic(b);this.diff_cleanupEfficiency(b)}}else if(a&&typeof a=="object"&&typeof b=="undefined"&&typeof c=="undefined"){b=a;d=this.diff_text1(b)}else if(typeof a=="string"&&b&&typeof b=="object"&&typeof c=="undefined")d=a;else if(typeof a=="string"&&typeof b=="string"&&c&&typeof c=="object"){d=a;b=c}else throw Error("Unknown call format to patch_make.");
if(b.length===0)return[];c=[];a=new patch_obj;for(var e=0,f=0,g=0,h=d,k=0;k<b.length;k++){var l=b[k][0],m=b[k][1];if(!e&&l!==DIFF_EQUAL){a.start1=f;a.start2=g}switch(l){case DIFF_INSERT:a.diffs[e++]=b[k];a.length2+=m.length;d=d.substring(0,g)+m+d.substring(g);break;case DIFF_DELETE:a.length1+=m.length;a.diffs[e++]=b[k];d=d.substring(0,g)+d.substring(g+m.length);break;case DIFF_EQUAL:if(m.length<=2*this.Patch_Margin&&e&&b.length!=k+1){a.diffs[e++]=b[k];a.length1+=m.length;a.length2+=m.length}else if(m.length>=
2*this.Patch_Margin)if(e){this.patch_addContext_(a,h);c.push(a);a=new patch_obj;e=0;h=d;f=g}}if(l!==DIFF_INSERT)f+=m.length;if(l!==DIFF_DELETE)g+=m.length}if(e){this.patch_addContext_(a,h);c.push(a)}return c};diff_match_patch.prototype.patch_deepCopy=function(a){for(var b=[],c=0;c<a.length;c++){var d=a[c],e=new patch_obj;e.diffs=[];for(var f=0;f<d.diffs.length;f++)e.diffs[f]=d.diffs[f].slice();e.start1=d.start1;e.start2=d.start2;e.length1=d.length1;e.length2=d.length2;b[c]=e}return b};
diff_match_patch.prototype.patch_apply=function(a,b){if(a.length==0)return[b,[]];a=this.patch_deepCopy(a);var c=this.patch_addPadding(a);b=c+b+c;this.patch_splitMax(a);for(var d=0,e=[],f=0;f<a.length;f++){var g=a[f].start2+d,h=this.diff_text1(a[f].diffs),k,l=-1;if(h.length>this.Match_MaxBits){k=this.match_main(b,h.substring(0,this.Match_MaxBits),g);if(k!=-1){l=this.match_main(b,h.substring(h.length-this.Match_MaxBits),g+h.length-this.Match_MaxBits);if(l==-1||k>=l)k=-1}}else k=this.match_main(b,h,
g);if(k==-1){e[f]=false;d-=a[f].length2-a[f].length1}else{e[f]=true;d=k-g;g=l==-1?b.substring(k,k+h.length):b.substring(k,l+this.Match_MaxBits);if(h==g)b=b.substring(0,k)+this.diff_text2(a[f].diffs)+b.substring(k+h.length);else{g=this.diff_main(h,g,false);if(h.length>this.Match_MaxBits&&this.diff_levenshtein(g)/h.length>this.Patch_DeleteThreshold)e[f]=false;else{this.diff_cleanupSemanticLossless(g);h=0;var m;for(l=0;l<a[f].diffs.length;l++){var p=a[f].diffs[l];if(p[0]!==DIFF_EQUAL)m=this.diff_xIndex(g,
h);if(p[0]===DIFF_INSERT)b=b.substring(0,k+m)+p[1]+b.substring(k+m);else if(p[0]===DIFF_DELETE)b=b.substring(0,k+m)+b.substring(k+this.diff_xIndex(g,h+p[1].length));if(p[0]!==DIFF_DELETE)h+=p[1].length}}}}}b=b.substring(c.length,b.length-c.length);return[b,e]};
diff_match_patch.prototype.patch_addPadding=function(a){for(var b=this.Patch_Margin,c="",d=1;d<=b;d++)c+=String.fromCharCode(d);for(d=0;d<a.length;d++){a[d].start1+=b;a[d].start2+=b}d=a[0];var e=d.diffs;if(e.length==0||e[0][0]!=DIFF_EQUAL){e.unshift([DIFF_EQUAL,c]);d.start1-=b;d.start2-=b;d.length1+=b;d.length2+=b}else if(b>e[0][1].length){var f=b-e[0][1].length;e[0][1]=c.substring(e[0][1].length)+e[0][1];d.start1-=f;d.start2-=f;d.length1+=f;d.length2+=f}d=a[a.length-1];e=d.diffs;if(e.length==0||
e[e.length-1][0]!=DIFF_EQUAL){e.push([DIFF_EQUAL,c]);d.length1+=b;d.length2+=b}else if(b>e[e.length-1][1].length){f=b-e[e.length-1][1].length;e[e.length-1][1]+=c.substring(0,f);d.length1+=f;d.length2+=f}return c};
diff_match_patch.prototype.patch_splitMax=function(a){for(var b=this.Match_MaxBits,c=0;c<a.length;c++)if(a[c].length1>b){var d=a[c];a.splice(c--,1);for(var e=d.start1,f=d.start2,g="";d.diffs.length!==0;){var h=new patch_obj,k=true;h.start1=e-g.length;h.start2=f-g.length;if(g!==""){h.length1=h.length2=g.length;h.diffs.push([DIFF_EQUAL,g])}for(;d.diffs.length!==0&&h.length1<b-this.Patch_Margin;){g=d.diffs[0][0];var l=d.diffs[0][1];if(g===DIFF_INSERT){h.length2+=l.length;f+=l.length;h.diffs.push(d.diffs.shift());
k=false}else if(g===DIFF_DELETE&&h.diffs.length==1&&h.diffs[0][0]==DIFF_EQUAL&&l.length>2*b){h.length1+=l.length;e+=l.length;k=false;h.diffs.push([g,l]);d.diffs.shift()}else{l=l.substring(0,b-h.length1-this.Patch_Margin);h.length1+=l.length;e+=l.length;if(g===DIFF_EQUAL){h.length2+=l.length;f+=l.length}else k=false;h.diffs.push([g,l]);if(l==d.diffs[0][1])d.diffs.shift();else d.diffs[0][1]=d.diffs[0][1].substring(l.length)}}g=this.diff_text2(h.diffs);g=g.substring(g.length-this.Patch_Margin);l=this.diff_text1(d.diffs).substring(0,
this.Patch_Margin);if(l!==""){h.length1+=l.length;h.length2+=l.length;if(h.diffs.length!==0&&h.diffs[h.diffs.length-1][0]===DIFF_EQUAL)h.diffs[h.diffs.length-1][1]+=l;else h.diffs.push([DIFF_EQUAL,l])}k||a.splice(++c,0,h)}}};diff_match_patch.prototype.patch_toText=function(a){for(var b=[],c=0;c<a.length;c++)b[c]=a[c];return b.join("")};
diff_match_patch.prototype.patch_fromText=function(a){var b=[];if(!a)return b;a=a.split("\n");for(var c=0,d=/^@@ -(\d+),?(\d*) \+(\d+),?(\d*) @@$/;c<a.length;){var e=a[c].match(d);if(!e)throw Error("Invalid patch string: "+a[c]);var f=new patch_obj;b.push(f);f.start1=parseInt(e[1],10);if(e[2]===""){f.start1--;f.length1=1}else if(e[2]=="0")f.length1=0;else{f.start1--;f.length1=parseInt(e[2],10)}f.start2=parseInt(e[3],10);if(e[4]===""){f.start2--;f.length2=1}else if(e[4]=="0")f.length2=0;else{f.start2--;
f.length2=parseInt(e[4],10)}for(c++;c<a.length;){e=a[c].charAt(0);try{var g=decodeURI(a[c].substring(1))}catch(h){throw Error("Illegal escape in patch_fromText: "+g);}if(e=="-")f.diffs.push([DIFF_DELETE,g]);else if(e=="+")f.diffs.push([DIFF_INSERT,g]);else if(e==" ")f.diffs.push([DIFF_EQUAL,g]);else if(e=="@")break;else if(e!=="")throw Error('Invalid patch mode "'+e+'" in: '+g);c++}}return b};function patch_obj(){this.diffs=[];this.start2=this.start1=null;this.length2=this.length1=0}
patch_obj.prototype.toString=function(){for(var a=["@@ -"+(this.length1===0?this.start1+",0":this.length1==1?this.start1+1:this.start1+1+","+this.length1)+" +"+(this.length2===0?this.start2+",0":this.length2==1?this.start2+1:this.start2+1+","+this.length2)+" @@\n"],b,c=0;c<this.diffs.length;c++){switch(this.diffs[c][0]){case DIFF_INSERT:b="+";break;case DIFF_DELETE:b="-";break;case DIFF_EQUAL:b=" "}a[c+1]=b+encodeURI(this.diffs[c][1])+"\n"}return a.join("").replace(/%20/g," ")};
this.diff_match_patch=diff_match_patch;this.patch_obj=patch_obj;this.DIFF_DELETE=DIFF_DELETE;this.DIFF_INSERT=DIFF_INSERT;this.DIFF_EQUAL=DIFF_EQUAL;var JSON;JSON||(JSON={});
(function(){function a(l){return l<10?"0"+l:l}function b(l){e.lastIndex=0;return e.test(l)?'"'+l.replace(e,function(m){var p=h[m];return typeof p==="string"?p:"\\u"+("0000"+m.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+l+'"'}function c(l,m){var p,o,n,s,t=f,q,r=m[l];if(r&&typeof r==="object"&&typeof r.toJSON==="function")r=r.toJSON(l);if(typeof k==="function")r=k.call(m,l,r);switch(typeof r){case "string":return b(r);case "number":return isFinite(r)?String(r):"null";case "boolean":case "null":return String(r);case "object":if(!r)return"null";
f+=g;q=[];if(Object.prototype.toString.apply(r)==="[object Array]"){s=r.length;for(p=0;p<s;p+=1)q[p]=c(p,r)||"null";n=q.length===0?"[]":f?"[\n"+f+q.join(",\n"+f)+"\n"+t+"]":"["+q.join(",")+"]";f=t;return n}if(k&&typeof k==="object"){s=k.length;for(p=0;p<s;p+=1)if(typeof k[p]==="string"){o=k[p];if(n=c(o,r))q.push(b(o)+(f?": ":":")+n)}}else for(o in r)if(Object.prototype.hasOwnProperty.call(r,o))if(n=c(o,r))q.push(b(o)+(f?": ":":")+n);n=q.length===0?"{}":f?"{\n"+f+q.join(",\n"+f)+"\n"+t+"}":"{"+q.join(",")+
"}";f=t;return n}}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+a(this.getUTCMonth()+1)+"-"+a(this.getUTCDate())+"T"+a(this.getUTCHours())+":"+a(this.getUTCMinutes())+":"+a(this.getUTCSeconds())+"Z":null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()}}var d=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
e=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,f,g,h={"\u0008":"\\b","\t":"\\t","\n":"\\n","\u000c":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},k;if(typeof JSON.stringify!=="function")JSON.stringify=function(l,m,p){var o;g=f="";if(typeof p==="number")for(o=0;o<p;o+=1)g+=" ";else if(typeof p==="string")g=p;if((k=m)&&typeof m!=="function"&&(typeof m!=="object"||typeof m.length!=="number"))throw Error("JSON.stringify");return c("",
{"":l})};if(typeof JSON.parse!=="function")JSON.parse=function(l,m){function p(n,s){var t,q,r=n[s];if(r&&typeof r==="object")for(t in r)if(Object.prototype.hasOwnProperty.call(r,t)){q=p(r,t);if(q!==undefined)r[t]=q;else delete r[t]}return m.call(n,s,r)}var o;l=String(l);d.lastIndex=0;if(d.test(l))l=l.replace(d,function(n){return"\\u"+("0000"+n.charCodeAt(0).toString(16)).slice(-4)});if(/^[\],:{}\s]*$/.test(l.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,
"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){o=eval("("+l+")");return typeof m==="function"?p({"":o},""):o}throw new SyntaxError("JSON.parse");}})();window.remove_editor=0;var MAX_REQUEST_SIZE=10485760,MAX_AREA=1E8;window.remove_editor=0;
var RESOURCES_PATH="includes/mxGraph/resources",RESOURCE_BASE=RESOURCES_PATH+"/grapheditor",STENCIL_PATH="includes/mxGraph/stencils",IMAGE_PATH="includes/mxGraph/images",STYLE_PATH="includes/mxGraph/styles",CSS_PATH="includes/mxGraph/styles",tapAndHoldStartsConnection=true,showConnectorImg=true,urlParams=function(a){var b={},c=a.lastIndexOf("?");if(c>0){a=a.substring(c+1).split("&");for(var d=0;d<a.length;d++){c=a[d].indexOf("=");if(c>0)b[a[d].substring(0,c)]=a[d].substring(c+1)}}return b}(window.location.href);
if(typeof tinyMCE!="undefined"){tinyMCE.baseURL=window.base_url+"includes/tiny_mce";tinyMCE.init({mode:"none",theme:"advanced",apply_source_formatting:false,plugins:"spellchecker,table,inlinepopups,paste",theme_advanced_buttons1:"image,link,hr,|,cleanup,|,code",theme_advanced_buttons2:"",theme_advanced_buttons3:"",theme_advanced_toolbar_location:"top",theme_advanced_toolbar_align:"left",theme_advanced_statusbar_location:"bottom",theme_advanced_resizing:false})}mxLoadResources=false;mxBasePath="includes/mxGraph/src";
mxLanguage=urlParams.lang;mxLanguages=["de"];function editor_lost_focus(a){if(a.target.className!="mxCellEditor"||a.target.tagName.toLowerCase()!="span"){el=document.getElementById("mxCellEditor");if(el!=null){window.remove_editor=1;el.style.visibility="visible";el.focus();el.blur()}}};var mxClient={VERSION:"2.0.0.1",IS_IE:0<=navigator.userAgent.indexOf("MSIE"),IS_IE6:0<=navigator.userAgent.indexOf("MSIE 6"),IS_QUIRKS:0<=navigator.userAgent.indexOf("MSIE")&&(null==document.documentMode||5==document.documentMode),VML_PREFIX:"v",OFFICE_PREFIX:"o",IS_NS:0<=navigator.userAgent.indexOf("Mozilla/")&&0>navigator.userAgent.indexOf("MSIE"),IS_OP:0<=navigator.userAgent.indexOf("Opera/"),IS_OT:0>navigator.userAgent.indexOf("Presto/2.4.")&&0>navigator.userAgent.indexOf("Presto/2.3.")&&0>navigator.userAgent.indexOf("Presto/2.2.")&&
0>navigator.userAgent.indexOf("Presto/2.1.")&&0>navigator.userAgent.indexOf("Presto/2.0.")&&0>navigator.userAgent.indexOf("Presto/1."),IS_SF:0<=navigator.userAgent.indexOf("AppleWebKit/")&&0>navigator.userAgent.indexOf("Chrome/"),IS_GC:0<=navigator.userAgent.indexOf("Chrome/"),IS_MT:0<=navigator.userAgent.indexOf("Firefox/")&&0>navigator.userAgent.indexOf("Firefox/1.")&&0>navigator.userAgent.indexOf("Firefox/2.")||0<=navigator.userAgent.indexOf("Iceweasel/")&&0>navigator.userAgent.indexOf("Iceweasel/1.")&&
0>navigator.userAgent.indexOf("Iceweasel/2.")||0<=navigator.userAgent.indexOf("SeaMonkey/")&&0>navigator.userAgent.indexOf("SeaMonkey/1.")||0<=navigator.userAgent.indexOf("Iceape/")&&0>navigator.userAgent.indexOf("Iceape/1."),IS_SVG:0<=navigator.userAgent.indexOf("Firefox/")||0<=navigator.userAgent.indexOf("Iceweasel/")||0<=navigator.userAgent.indexOf("Seamonkey/")||0<=navigator.userAgent.indexOf("Iceape/")||0<=navigator.userAgent.indexOf("Galeon/")||0<=navigator.userAgent.indexOf("Epiphany/")||0<=
navigator.userAgent.indexOf("AppleWebKit/")||0<=navigator.userAgent.indexOf("Gecko/")||0<=navigator.userAgent.indexOf("Opera/"),NO_FO:!document.createElementNS||"[object SVGForeignObjectElement]"!=document.createElementNS("http://www.w3.org/2000/svg","foreignObject")||0<=navigator.userAgent.indexOf("Opera/"),IS_VML:"MICROSOFT INTERNET EXPLORER"==navigator.appName.toUpperCase(),IS_MAC:0<navigator.userAgent.toUpperCase().indexOf("MACINTOSH"),IS_TOUCH:"ontouchstart"in document.documentElement,IS_POINTER:window.navigator.msPointerEnabled,
IS_LOCAL:0>document.location.href.indexOf("http://")&&0>document.location.href.indexOf("https://"),isBrowserSupported:function(){return mxClient.IS_VML||mxClient.IS_SVG},link:function(a,b,c){c=c||document;if(mxClient.IS_IE6)c.write('<link rel="'+a+'" href="'+b+'" charset="ISO-8859-1" type="text/css"/>');else{var d=c.createElement("link");d.setAttribute("rel",a);d.setAttribute("href",b);d.setAttribute("charset","ISO-8859-1");d.setAttribute("type","text/css");c.getElementsByTagName("head")[0].appendChild(d)}},
include:function(a){document.write('<script src="'+a+'"><\/script>')},dispose:function(){for(var a=0;a<mxEvent.objects.length;a++)null!=mxEvent.objects[a].mxListenerList&&mxEvent.removeAllListeners(mxEvent.objects[a])}};mxClient.IS_OP&&mxClient.IS_OT?mxClient.CSS_PREFIX="O":mxClient.IS_SF||mxClient.IS_GC?mxClient.CSS_PREFIX="Webkit":mxClient.IS_MT?mxClient.CSS_PREFIX="Moz":mxClient.IS_IE&&9<=document.documentMode&&(mxClient.CSS_PREFIX="ms");"undefined"==typeof mxLoadResources&&(mxLoadResources=true);
"undefined"==typeof mxResourceExtension&&(mxResourceExtension=".txt");"undefined"==typeof mxLoadStylesheets&&(mxLoadStylesheets=true);"undefined"!=typeof mxBasePath&&0<mxBasePath.length?("/"==mxBasePath.substring(mxBasePath.length-1)&&(mxBasePath=mxBasePath.substring(0,mxBasePath.length-1)),mxClient.basePath=mxBasePath):mxClient.basePath=".";
"undefined"!=typeof mxImageBasePath&&0<mxImageBasePath.length?("/"==mxImageBasePath.substring(mxImageBasePath.length-1)&&(mxImageBasePath=mxImageBasePath.substring(0,mxImageBasePath.length-1)),mxClient.imageBasePath=mxImageBasePath):mxClient.imageBasePath=mxClient.basePath+"/images";mxClient.language="undefined"!=typeof mxLanguage&&null!=mxLanguage?mxLanguage:mxClient.IS_IE?navigator.userLanguage:navigator.language;
mxClient.defaultLanguage="undefined"!=typeof mxDefaultLanguage&&null!=mxDefaultLanguage?mxDefaultLanguage:"en";mxLoadStylesheets&&mxClient.link("stylesheet",mxClient.basePath+"/css/common.css");"undefined"!=typeof mxLanguages&&null!=mxLanguages&&(mxClient.languages=mxLanguages);
if(mxClient.IS_IE){if(9<=document.documentMode){mxClient.IS_VML=false;mxClient.IS_SVG=true}else{8==document.documentMode?(document.namespaces.add(mxClient.VML_PREFIX,"urn:schemas-microsoft-com:vml","#default#VML"),document.namespaces.add(mxClient.OFFICE_PREFIX,"urn:schemas-microsoft-com:office:office","#default#VML")):(document.namespaces.add(mxClient.VML_PREFIX,"urn:schemas-microsoft-com:vml"),document.namespaces.add(mxClient.OFFICE_PREFIX,"urn:schemas-microsoft-com:office:office"));var ss=document.createStyleSheet();
ss.cssText=mxClient.VML_PREFIX+"\\:*{behavior:url(#default#VML)}"+mxClient.OFFICE_PREFIX+"\\:*{behavior:url(#default#VML)}";mxLoadStylesheets&&mxClient.link("stylesheet",mxClient.basePath+"/css/explorer.css")}window.attachEvent("onunload",mxClient.dispose)}
var mxLog={consoleName:"Console",TRACE:false,DEBUG:true,WARN:true,buffer:"",init:function(){if(null==mxLog.window&&null!=document.body){var a=mxLog.consoleName+" - mxGraph "+mxClient.VERSION,b=document.createElement("table");b.setAttribute("width","100%");b.setAttribute("height","100%");var c=document.createElement("tbody"),d=document.createElement("tr"),e=document.createElement("td");e.style.verticalAlign="top";mxLog.textarea=document.createElement("textarea");mxLog.textarea.setAttribute("readOnly",
"true");mxLog.textarea.style.height="100%";mxLog.textarea.style.resize="none";mxLog.textarea.value=mxLog.buffer;mxLog.textarea.style.width=mxClient.IS_NS&&"BackCompat"!=document.compatMode?"99%":"100%";e.appendChild(mxLog.textarea);d.appendChild(e);c.appendChild(d);d=document.createElement("tr");mxLog.td=document.createElement("td");mxLog.td.style.verticalAlign="top";mxLog.td.setAttribute("height","30px");d.appendChild(mxLog.td);c.appendChild(d);b.appendChild(c);mxLog.addButton("Info",function(){mxLog.info()});
mxLog.addButton("DOM",function(g){g=mxUtils.getInnerHtml(document.body);mxLog.debug(g)});mxLog.addButton("Trace",function(){mxLog.TRACE=!mxLog.TRACE;mxLog.TRACE?mxLog.debug("Tracing enabled"):mxLog.debug("Tracing disabled")});mxLog.addButton("Copy",function(){try{mxUtils.copy(mxLog.textarea.value)}catch(g){mxUtils.alert(g)}});mxLog.addButton("Show",function(){try{mxUtils.popup(mxLog.textarea.value)}catch(g){mxUtils.alert(g)}});mxLog.addButton("Clear",function(){mxLog.textarea.value=""});d=c=0;"number"===
typeof window.innerWidth?(c=window.innerHeight,d=window.innerWidth):(c=document.documentElement.clientHeight||document.body.clientHeight,d=document.body.clientWidth);mxLog.window=new mxWindow(a,b,Math.max(0,d-320),Math.max(0,c-210),300,160);mxLog.window.setMaximizable(true);mxLog.window.setScrollable(false);mxLog.window.setResizable(true);mxLog.window.setClosable(true);mxLog.window.destroyOnClose=false;if((mxClient.IS_NS||mxClient.IS_IE)&&!mxClient.IS_GC&&!mxClient.IS_SF&&"BackCompat"!=document.compatMode){var f=
mxLog.window.getElement();a=function(){mxLog.textarea.style.height=Math.max(0,f.offsetHeight-70)+"px"};mxLog.window.addListener(mxEvent.RESIZE_END,a);mxLog.window.addListener(mxEvent.MAXIMIZE,a);mxLog.window.addListener(mxEvent.NORMALIZE,a);mxLog.textarea.style.height="92px"}}},info:function(){mxLog.writeln(mxUtils.toString(navigator))},addButton:function(a,b){var c=document.createElement("button");mxUtils.write(c,a);mxEvent.addListener(c,"click",b);mxLog.td.appendChild(c)},isVisible:function(){return null!=
mxLog.window?mxLog.window.isVisible():false},show:function(){mxLog.setVisible(true)},setVisible:function(a){null==mxLog.window&&mxLog.init();null!=mxLog.window&&mxLog.window.setVisible(a)},enter:function(a){if(mxLog.TRACE)return mxLog.writeln("Entering "+a),(new Date).getTime()},leave:function(a,b){if(mxLog.TRACE){var c=0!=b?" ("+((new Date).getTime()-b)+" ms)":"";mxLog.writeln("Leaving "+a+c)}},debug:function(){mxLog.DEBUG&&mxLog.writeln.apply(this,arguments)},warn:function(){mxLog.WARN&&mxLog.writeln.apply(this,
arguments)},write:function(){for(var a="",b=0;b<arguments.length;b++){a+=arguments[b];b<arguments.length-1&&(a+=" ")}null!=mxLog.textarea?(mxLog.textarea.value+=a,0<=navigator.userAgent.indexOf("Presto/2.5")&&(mxLog.textarea.style.visibility="hidden",mxLog.textarea.style.visibility="visible"),mxLog.textarea.scrollTop=mxLog.textarea.scrollHeight):mxLog.buffer+=a},writeln:function(){for(var a="",b=0;b<arguments.length;b++){a+=arguments[b];b<arguments.length-1&&(a+=" ")}mxLog.write(a+"\n")}},mxObjectIdentity=
{FIELD_NAME:"mxObjectId",counter:0,get:function(a){if("object"==typeof a&&null==a[mxObjectIdentity.FIELD_NAME]){var b=mxUtils.getFunctionName(a.constructor);a[mxObjectIdentity.FIELD_NAME]=b+"#"+mxObjectIdentity.counter++}return a[mxObjectIdentity.FIELD_NAME]},clear:function(a){"object"==typeof a&&delete a[mxObjectIdentity.FIELD_NAME]}};function mxDictionary(){this.clear()}mxDictionary.prototype.map=null;mxDictionary.prototype.clear=function(){this.map={}};
mxDictionary.prototype.get=function(a){a=mxObjectIdentity.get(a);return this.map[a]};mxDictionary.prototype.put=function(a,b){var c=mxObjectIdentity.get(a),d=this.map[c];this.map[c]=b;return d};mxDictionary.prototype.remove=function(a){a=mxObjectIdentity.get(a);var b=this.map[a];delete this.map[a];return b};mxDictionary.prototype.getKeys=function(){var a=[],b;for(b in this.map)a.push(b);return a};mxDictionary.prototype.getValues=function(){var a=[],b;for(b in this.map)a.push(this.map[b]);return a};
mxDictionary.prototype.visit=function(a){for(var b in this.map)a(b,this.map[b])};
var mxResources={resources:[],extension:mxResourceExtension,resourcesEncoded:false,loadDefaultBundle:true,loadSpecialBundle:true,isLanguageSupported:function(a){return null!=mxClient.languages?0<=mxUtils.indexOf(mxClient.languages,a):true},getDefaultBundle:function(a,b){return mxResources.loadDefaultBundle||!mxResources.isLanguageSupported(b)?a+mxResources.extension:null},getSpecialBundle:function(a,b){if(null==mxClient.languages||!this.isLanguageSupported(b)){var c=b.indexOf("-");0<c&&(b=b.substring(0,
c))}return mxResources.loadSpecialBundle&&mxResources.isLanguageSupported(b)&&b!=mxClient.defaultLanguage?a+"_"+b+mxResources.extension:null},add:function(a,b){b=null!=b?b:mxClient.language.toLowerCase();if(b!=mxConstants.NONE){var c=mxResources.getDefaultBundle(a,b);if(null!=c)try{var d=mxUtils.load(c);d.isReady()&&mxResources.parse(d.getText())}catch(e){}c=mxResources.getSpecialBundle(a,b);if(null!=c)try{d=mxUtils.load(c);d.isReady()&&mxResources.parse(d.getText())}catch(f){}}},parse:function(a){if(null!=
a){a=a.split("\n");for(var b=0;b<a.length;b++)if("#"!=a[b].charAt(0)){var c=a[b].indexOf("=");if(0<c){var d=a[b].substring(0,c),e=a[b].length;13==a[b].charCodeAt(e-1)&&e--;c=a[b].substring(c+1,e);this.resourcesEncoded?(c=c.replace(/\\(?=u[a-fA-F\d]{4})/g,"%"),mxResources.resources[d]=unescape(c)):mxResources.resources[d]=c}}}},get:function(a,b,c){a=mxResources.resources[a];null==a&&(a=c);if(null!=a&&null!=b){c=[];for(var d=null,e=0;e<a.length;e++){var f=a.charAt(e);"{"==f?d="":null!=d&&"}"==f?(d=
parseInt(d)-1,0<=d&&d<b.length&&c.push(b[d]),d=null):null!=d?d+=f:c.push(f)}a=c.join("")}return a}};function mxPoint(a,b){this.x=null!=a?a:0;this.y=null!=b?b:0}mxPoint.prototype.x=null;mxPoint.prototype.y=null;mxPoint.prototype.equals=function(a){return a.x==this.x&&a.y==this.y};mxPoint.prototype.clone=function(){return mxUtils.clone(this)};function mxRectangle(a,b,c,d){mxPoint.call(this,a,b);this.width=null!=c?c:0;this.height=null!=d?d:0}mxRectangle.prototype=new mxPoint;
mxRectangle.prototype.constructor=mxRectangle;mxRectangle.prototype.width=null;mxRectangle.prototype.height=null;mxRectangle.prototype.setRect=function(a,b,c,d){this.x=a;this.y=b;this.width=c;this.height=d};mxRectangle.prototype.getCenterX=function(){return this.x+this.width/2};mxRectangle.prototype.getCenterY=function(){return this.y+this.height/2};
mxRectangle.prototype.add=function(a){if(null!=a){var b=Math.min(this.x,a.x),c=Math.min(this.y,a.y),d=Math.max(this.x+this.width,a.x+a.width);a=Math.max(this.y+this.height,a.y+a.height);this.x=b;this.y=c;this.width=d-b;this.height=a-c}};mxRectangle.prototype.grow=function(a){this.x-=a;this.y-=a;this.width+=2*a;this.height+=2*a};mxRectangle.prototype.getPoint=function(){return new mxPoint(this.x,this.y)};
mxRectangle.prototype.equals=function(a){return a.x==this.x&&a.y==this.y&&a.width==this.width&&a.height==this.height};
var mxEffects={animateChanges:function(a,b,c){var d=0,e=function(){for(var g=false,h=0;h<b.length;h++){var k=b[h];if(k instanceof mxGeometryChange||k instanceof mxTerminalChange||k instanceof mxValueChange||k instanceof mxChildChange||k instanceof mxStyleChange){var l=a.getView().getState(k.cell||k.child,false);if(null!=l)if(g=true,k.constructor!=mxGeometryChange||a.model.isEdge(k.cell))mxUtils.setOpacity(l.shape.node,100*d/10);else{var m=a.getView().scale,p=(k.geometry.x-k.previous.x)*m,o=(k.geometry.y-
k.previous.y)*m,n=(k.geometry.width-k.previous.width)*m;m*=k.geometry.height-k.previous.height;0==d?(l.x-=p,l.y-=o,l.width-=n,l.height-=m):(l.x+=p/10,l.y+=o/10,l.width+=n/10,l.height+=m/10);a.cellRenderer.redraw(l);mxEffects.cascadeOpacity(a,k.cell,100*d/10)}}}10>d&&g?(d++,window.setTimeout(e,f)):null!=c&&c()},f=30;e()},cascadeOpacity:function(a,b,c){for(var d=a.model.getChildCount(b),e=0;e<d;e++){var f=a.model.getChildAt(b,e),g=a.getView().getState(f);null!=g&&(mxUtils.setOpacity(g.shape.node,c),
mxEffects.cascadeOpacity(a,f,c))}b=a.model.getEdges(b);if(null!=b)for(e=0;e<b.length;e++){d=a.getView().getState(b[e]);null!=d&&mxUtils.setOpacity(d.shape.node,c)}},fadeOut:function(a,b,c,d,e,f){d=d||40;e=e||30;var g=b||100;mxUtils.setOpacity(a,g);if(f||null==f){var h=function(){g=Math.max(g-d,0);mxUtils.setOpacity(a,g);0<g?window.setTimeout(h,e):(a.style.visibility="hidden",c&&a.parentNode&&a.parentNode.removeChild(a))};window.setTimeout(h,e)}else{a.style.visibility="hidden";c&&a.parentNode&&a.parentNode.removeChild(a)}}},
mxUtils={errorResource:"none"!=mxClient.language?"error":"",closeResource:"none"!=mxClient.language?"close":"",errorImage:mxClient.imageBasePath+"/error.gif",removeCursors:function(a){null!=a.style&&(a.style.cursor="");a=a.childNodes;if(null!=a)for(var b=a.length,c=0;c<b;c+=1)mxUtils.removeCursors(a[c])},getCurrentStyle:function(){return mxClient.IS_IE?function(a){return null!=a?a.currentStyle:null}:function(a){return null!=a?window.getComputedStyle(a,""):null}}(),hasScrollbars:function(a){a=mxUtils.getCurrentStyle(a);
return null!=a&&("scroll"==a.overflow||"auto"==a.overflow)},bind:function(a,b){return function(){return b.apply(a,arguments)}},eval:function(a){var b=null;if(0<=a.indexOf("function"))try{eval("var _mxJavaScriptExpression="+a);b=_mxJavaScriptExpression;_mxJavaScriptExpression=null}catch(c){mxLog.warn(c.message+" while evaluating "+a)}else try{b=eval(a)}catch(d){mxLog.warn(d.message+" while evaluating "+a)}return b},findNode:function(a,b,c){var d=a.getAttribute(b);if(null!=d&&d==c)return a;for(a=a.firstChild;null!=
a;){d=mxUtils.findNode(a,b,c);if(null!=d)return d;a=a.nextSibling}return null},findNodeByAttribute:function(){return 9<=document.documentMode?function(a,b,c){var d=null;if(null!=a)if(a.nodeType==mxConstants.NODETYPE_ELEMENT&&a.getAttribute(b)==c)d=a;else for(a=a.firstChild;null!=a&&null==d;){d=mxUtils.findNodeByAttribute(a,b,c);a=a.nextSibling}return d}:mxClient.IS_IE?function(a,b,c){return null==a?null:a.ownerDocument.selectSingleNode("//*[@"+b+"='"+c+"']")}:function(a,b,c){return null==a?null:a.ownerDocument.evaluate("//*[@"+
b+"='"+c+"']",a.ownerDocument,null,XPathResult.ANY_TYPE,null).iterateNext()}}(),getFunctionName:function(a){var b=null;if(null!=a)if(null!=a.name)b=a.name;else{a=a.toString();for(b=9;" "==a.charAt(b);)b++;var c=a.indexOf("(",b);b=a.substring(b,c)}return b},indexOf:function(a,b){if(null!=a&&null!=b)for(var c=0;c<a.length;c++)if(a[c]==b)return c;return-1},remove:function(a,b){var c=null;if("object"==typeof b)for(var d=mxUtils.indexOf(b,a);0<=d;){b.splice(d,1);c=a;d=mxUtils.indexOf(b,a)}for(var e in b)b[e]==
a&&(delete b[e],c=a);return c},isNode:function(a,b,c,d){return null!=a&&!isNaN(a.nodeType)&&(null==b||a.nodeName.toLowerCase()==b.toLowerCase())?null==c||a.getAttribute(c)==d:false},getChildNodes:function(a,b){b=b||mxConstants.NODETYPE_ELEMENT;for(var c=[],d=a.firstChild;null!=d;){d.nodeType==b&&c.push(d);d=d.nextSibling}return c},createXmlDocument:function(){var a=null;document.implementation&&document.implementation.createDocument?a=document.implementation.createDocument("","",null):window.ActiveXObject&&
(a=new ActiveXObject("Microsoft.XMLDOM"));return a},parseXml:function(){return mxClient.IS_IE&&("undefined"===typeof document.documentMode||9>document.documentMode)?function(a){var b=mxUtils.createXmlDocument();b.async="false";b.loadXML(a);return b}:function(a){return(new DOMParser).parseFromString(a,"text/xml")}}(),clearSelection:function(){if(document.selection)return function(){document.selection.empty()};if(window.getSelection)return function(){window.getSelection().removeAllRanges()}}(),getPrettyXml:function(a,
b,c){var d=[];if(null!=a)if(b=b||"  ",c=c||"",a.nodeType==mxConstants.NODETYPE_TEXT)d.push(a.nodeValue);else{d.push(c+"<"+a.nodeName);var e=a.attributes;if(null!=e)for(var f=0;f<e.length;f++){var g=mxUtils.htmlEntities(e[f].nodeValue);d.push(" "+e[f].nodeName+'="'+g+'"')}e=a.firstChild;if(null!=e){for(d.push(">\n");null!=e;){d.push(mxUtils.getPrettyXml(e,b,c+b));e=e.nextSibling}d.push(c+"</"+a.nodeName+">\n")}else d.push("/>\n")}return d.join("")},removeWhitespace:function(a,b){for(var c=b?a.previousSibling:
a.nextSibling;null!=c&&c.nodeType==mxConstants.NODETYPE_TEXT;){var d=b?c.previousSibling:c.nextSibling,e=mxUtils.getTextContent(c);0==mxUtils.trim(e).length&&c.parentNode.removeChild(c);c=d}},htmlEntities:function(a,b){a=(a||"").replace(/&/g,"&amp;");a=a.replace(/"/g,"&quot;");a=a.replace(/\'/g,"&#39;");a=a.replace(/</g,"&lt;");a=a.replace(/>/g,"&gt;");if(null==b||b)a=a.replace(/\n/g,"&#xa;");return a},isVml:function(a){return null!=a&&"urn:schemas-microsoft-com:vml"==a.tagUrn},getXml:function(a,
b){var c="";null!=window.XMLSerializer?c=(new XMLSerializer).serializeToString(a):null!=a.xml&&(c=a.xml.replace(/\r\n\t[\t]*/g,"").replace(/>\r\n/g,">").replace(/\r\n/g,"\n"));return c.replace(/\n/g,b||"&#xa;")},getTextContent:function(a){var b="";null!=a&&(null!=a.firstChild&&(a=a.firstChild),b=a.nodeValue||"");return b},getInnerHtml:function(){return mxClient.IS_IE?function(a){return null!=a?a.innerHTML:""}:function(a){return null!=a?(new XMLSerializer).serializeToString(a):""}}(),getOuterHtml:function(){return mxClient.IS_IE?
function(a){if(null!=a){if(null!=a.outerHTML)return a.outerHTML;var b=[];b.push("<"+a.nodeName);var c=a.attributes;if(null!=c)for(var d=0;d<c.length;d++){var e=c[d].nodeValue;null!=e&&0<e.length&&(b.push(" "),b.push(c[d].nodeName),b.push('="'),b.push(e),b.push('"'))}0==a.innerHTML.length?b.push("/>"):(b.push(">"),b.push(a.innerHTML),b.push("</"+a.nodeName+">"));return b.join("")}return""}:function(a){return null!=a?(new XMLSerializer).serializeToString(a):""}}(),write:function(a,b){var c=a.ownerDocument.createTextNode(b);
null!=a&&a.appendChild(c);return c},writeln:function(a,b){var c=a.ownerDocument.createTextNode(b);null!=a&&(a.appendChild(c),a.appendChild(document.createElement("br")));return c},br:function(a,b){b=b||1;for(var c=null,d=0;d<b;d++)null!=a&&(c=a.ownerDocument.createElement("br"),a.appendChild(c));return c},button:function(a,b,c){c=(null!=c?c:document).createElement("button");mxUtils.write(c,a);mxEvent.addListener(c,"click",function(d){b(d)});return c},para:function(a,b){var c=document.createElement("p");
mxUtils.write(c,b);null!=a&&a.appendChild(c);return c},addTransparentBackgroundFilter:function(a){a.style.filter+="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+mxClient.imageBasePath+"/transparent.gif', sizingMethod='scale')"},linkAction:function(a,b,c,d,e){return mxUtils.link(a,b,function(){c.execute(d)},e)},linkInvoke:function(a,b,c,d,e,f){return mxUtils.link(a,b,function(){c[d](e)},f)},link:function(a,b,c,d){var e=document.createElement("span");e.style.color="blue";e.style.textDecoration=
"underline";e.style.cursor="pointer";null!=d&&(e.style.paddingLeft=d+"px");mxEvent.addListener(e,"click",c);mxUtils.write(e,b);null!=a&&a.appendChild(e);return e},fit:function(a){var b=parseInt(a.offsetLeft),c=parseInt(a.offsetWidth),d=document.body,e=document.documentElement,f=(d.scrollLeft||e.scrollLeft)+(d.clientWidth||e.clientWidth);b+c>f&&(a.style.left=Math.max(d.scrollLeft||e.scrollLeft,f-c)+"px");b=parseInt(a.offsetTop);c=parseInt(a.offsetHeight);f=(d.scrollTop||e.scrollTop)+Math.max(d.clientHeight||
0,e.clientHeight);b+c>f&&(a.style.top=Math.max(d.scrollTop||e.scrollTop,f-c)+"px")},open:function(a){if(mxClient.IS_NS){try{netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect")}catch(b){return mxUtils.alert("Permission to read file denied."),""}var c=Components.classes["@mozilla.org/file/local;1"].createInstance(Components.interfaces.nsILocalFile);c.initWithPath(a);if(!c.exists())return mxUtils.alert("File not found."),"";a=Components.classes["@mozilla.org/network/file-input-stream;1"].createInstance(Components.interfaces.nsIFileInputStream);
a.init(c,1,4,null);c=Components.classes["@mozilla.org/scriptableinputstream;1"].createInstance(Components.interfaces.nsIScriptableInputStream);c.init(a);return c.read(c.available())}c=(new ActiveXObject("Scripting.FileSystemObject")).OpenTextFile(a,1);a=c.readAll();c.close();return a},save:function(a,b){if(mxClient.IS_NS){try{netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect")}catch(c){mxUtils.alert("Permission to write file denied.");return}var d=Components.classes["@mozilla.org/file/local;1"].createInstance(Components.interfaces.nsILocalFile);
d.initWithPath(a);d.exists()||d.create(0,420);var e=Components.classes["@mozilla.org/network/file-output-stream;1"].createInstance(Components.interfaces.nsIFileOutputStream);e.init(d,34,4,null);e.write(b,b.length);e.flush();e.close()}else{d=(new ActiveXObject("Scripting.FileSystemObject")).CreateTextFile(a,true);d.Write(b);d.Close()}},saveAs:function(a){var b=document.createElement("iframe");b.setAttribute("src","");b.style.visibility="hidden";document.body.appendChild(b);try{if(mxClient.IS_NS){var c=
b.contentDocument;c.open();c.write(a);c.close();try{netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");b.focus();saveDocument(c)}catch(d){mxUtils.alert("Permission to save document denied.")}}else{c=b.contentWindow.document;c.write(a);c.execCommand("SaveAs",false,document.location)}}finally{document.body.removeChild(b)}},copy:function(a){if(window.clipboardData)window.clipboardData.setData("Text",a);else{netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");
var b=Components.classes["@mozilla.org/widget/clipboard;1"].createInstance(Components.interfaces.nsIClipboard);if(b){var c=Components.classes["@mozilla.org/widget/transferable;1"].createInstance(Components.interfaces.nsITransferable);if(c){c.addDataFlavor("text/unicode");var d=Components.classes["@mozilla.org/supports-string;1"].createInstance(Components.interfaces.nsISupportsString);d.data=a;c.setTransferData("text/unicode",d,2*a.length);b.setData(c,null,Components.interfaces.nsIClipboard.kGlobalClipboard)}}}},
load:function(a){a=new mxXmlRequest(a,null,"GET",false);a.send();return a},get:function(a,b,c){return(new mxXmlRequest(a,null,"GET")).send(b,c)},post:function(a,b,c,d){return(new mxXmlRequest(a,b)).send(c,d)},submit:function(a,b,c,d){return(new mxXmlRequest(a,b)).simulate(c,d)},loadInto:function(a,b,c){mxClient.IS_IE?b.onreadystatechange=function(){4==b.readyState&&c()}:b.addEventListener("load",c,false);b.load(a)},getValue:function(a,b,c){a=null!=a?a[b]:null;null==a&&(a=c);return a},getNumber:function(a,
b,c){a=null!=a?a[b]:null;null==a&&(a=c||0);return Number(a)},getColor:function(a,b,c){a=null!=a?a[b]:null;null==a?a=c:a==mxConstants.NONE&&(a=null);return a},clone:function(a,b,c){c=null!=c?c:false;var d=null;if(null!=a&&"function"==typeof a.constructor){d=new a.constructor;for(var e in a)if(e!=mxObjectIdentity.FIELD_NAME&&(null==b||0>mxUtils.indexOf(b,e)))d[e]=!c&&"object"==typeof a[e]?mxUtils.clone(a[e]):a[e]}return d},equalPoints:function(a,b){if(null==a&&null!=b||null!=a&&null==b||null!=a&&null!=
b&&a.length!=b.length)return false;if(null!=a&&null!=b)for(var c=0;c<a.length;c++)if(a[c]==b[c]||null!=a[c]&&!a[c].equals(b[c]))return false;return true},equalEntries:function(a,b){if(null==a&&null!=b||null!=a&&null==b||null!=a&&null!=b&&a.length!=b.length)return false;if(null!=a&&null!=b)for(var c in a)if(a[c]!=b[c])return false;return true},extend:function(a,b){var c=function(){};c.prototype=b.prototype;a.prototype=new c;a.prototype.constructor=a},toString:function(a){var b="",c;for(c in a)try{if(null==
a[c])b+=c+" = [null]\n";else if("function"==typeof a[c])b+=c+" => [Function]\n";else if("object"==typeof a[c]){var d=mxUtils.getFunctionName(a[c].constructor);b+=c+" => ["+d+"]\n"}else b+=c+" = "+a[c]+"\n"}catch(e){b+=c+"="+e.message}return b},toRadians:function(a){return Math.PI*a/180},arcToCurves:function(a,b,c,d,e,f,g,h,k){h-=a;k-=b;if(0===c||0===d)return o;c=Math.abs(c);d=Math.abs(d);var l=-h/2,m=-k/2,p=Math.cos(e*Math.PI/180),o=Math.sin(e*Math.PI/180);e=p*l+o*m;l=-1*o*l+p*m;m=e*e;var n=l*l,s=
c*c,t=d*d,q=m/s+n/t;1<q?(c*=Math.sqrt(q),d*=Math.sqrt(q),f=0):(f===g&&(q=-1),f=q*Math.sqrt((s*t-s*n-t*m)/(s*n+t*m)));m=f*c*l/d;n=-1*f*d*e/c;h=p*m-o*n+h/2;k=o*m+p*n+k/2;s=Math.atan2((l-n)/d,(e-m)/c)-Math.atan2(0,1);f=0<=s?s:2*Math.PI+s;s=Math.atan2((-l-n)/d,(-e-m)/c)-Math.atan2((l-n)/d,(e-m)/c);e=0<=s?s:2*Math.PI+s;0==g&&0<e?e-=2*Math.PI:0!=g&&0>e&&(e+=2*Math.PI);g=2*e/Math.PI;g=Math.ceil(0>g?-1*g:g);e/=g;l=8/3*Math.sin(e/4)*Math.sin(e/4)/Math.sin(e/2);m=p*c;p*=d;c*=o;d*=o;var r=Math.cos(f),u=Math.sin(f);
n=-l*(m*u+d*r);s=-l*(c*u-p*r);o=[];for(var x=0;x<g;++x){f+=e;r=Math.cos(f);u=Math.sin(f);t=m*r-d*u+h;q=c*r+p*u+k;var A=-l*(m*u+d*r);r=-l*(c*u-p*r);u=6*x;o[u]=Number(n+a);o[u+1]=Number(s+b);o[u+2]=Number(t-A+a);o[u+3]=Number(q-r+b);o[u+4]=Number(t+a);o[u+5]=Number(q+b);n=t+A;s=q+r}return o},getBoundingBox:function(a,b){var c=null;if(null!=a&&null!=b&&0!=b){var d=mxUtils.toRadians(b);c=Math.cos(d);var e=Math.sin(d),f=new mxPoint(a.x+a.width/2,a.y+a.height/2),g=new mxPoint(a.x,a.y);d=new mxPoint(a.x+
a.width,a.y);var h=new mxPoint(d.x,a.y+a.height),k=new mxPoint(a.x,h.y);g=mxUtils.getRotatedPoint(g,c,e,f);d=mxUtils.getRotatedPoint(d,c,e,f);h=mxUtils.getRotatedPoint(h,c,e,f);k=mxUtils.getRotatedPoint(k,c,e,f);c=new mxRectangle(g.x,g.y,0,0);c.add(new mxRectangle(d.x,d.y,0,0));c.add(new mxRectangle(h.x,h.y,0,0));c.add(new mxRectangle(k.x,k.y,0,0))}return c},getRotatedPoint:function(a,b,c,d){d=null!=d?d:new mxPoint;var e=a.x-d.x;a=a.y-d.y;return new mxPoint(e*b-a*c+d.x,a*b+e*c+d.y)},getPortConstraints:function(a,
b,c,d){a=mxUtils.getValue(a.style,mxConstants.STYLE_PORT_CONSTRAINT,null);if(null==a)return d;d=a.toString();a=mxConstants.DIRECTION_MASK_NONE;0<=d.indexOf(mxConstants.DIRECTION_NORTH)&&(a|=mxConstants.DIRECTION_MASK_NORTH);0<=d.indexOf(mxConstants.DIRECTION_WEST)&&(a|=mxConstants.DIRECTION_MASK_WEST);0<=d.indexOf(mxConstants.DIRECTION_SOUTH)&&(a|=mxConstants.DIRECTION_MASK_SOUTH);0<=d.indexOf(mxConstants.DIRECTION_EAST)&&(a|=mxConstants.DIRECTION_MASK_EAST);return a},reversePortConstraints:function(a){var b=
0;b=(a&mxConstants.DIRECTION_MASK_WEST)<<3;b|=(a&mxConstants.DIRECTION_MASK_NORTH)<<1;b|=(a&mxConstants.DIRECTION_MASK_SOUTH)>>1;return b|(a&mxConstants.DIRECTION_MASK_EAST)>>3},findNearestSegment:function(a,b,c){var d=-1;if(0<a.absolutePoints.length)for(var e=a.absolutePoints[0],f=null,g=1;g<a.absolutePoints.length;g++){var h=a.absolutePoints[g];e=mxUtils.ptSegDistSq(e.x,e.y,h.x,h.y,b,c);if(null==f||e<f){f=e;d=g-1}e=h}return d},rectangleIntersectsSegment:function(a,b,c){var d=a.y,e=a.x,f=d+a.height,
g=e+a.width;a=b.x;var h=c.x;b.x>c.x&&(a=c.x,h=b.x);h>g&&(h=g);a<e&&(a=e);if(a>h)return false;e=b.y;g=c.y;var k=c.x-b.x;1.0E-7<Math.abs(k)&&(c=(c.y-b.y)/k,b=b.y-c*b.x,e=c*a+b,g=c*h+b);e>g&&(b=g,g=e,e=b);g>f&&(g=f);e<d&&(e=d);return e>g?false:true},contains:function(a,b,c){return a.x<=b&&a.x+a.width>=b&&a.y<=c&&a.y+a.height>=c},intersects:function(a,b){var c=a.width,d=a.height,e=b.width,f=b.height;if(0>=e||0>=f||0>=c||0>=d)return false;var g=a.x,h=a.y,k=b.x,l=b.y;e+=k;f+=l;c+=g;d+=h;return(e<k||e>g)&&
(f<l||f>h)&&(c<g||c>k)&&(d<h||d>l)},intersectsHotspot:function(a,b,c,d,e,f){d=null!=d?d:1;e=null!=e?e:0;f=null!=f?f:0;if(0<d){var g=a.getCenterX(),h=a.getCenterY(),k=a.width,l=a.height,m=mxUtils.getValue(a.style,mxConstants.STYLE_STARTSIZE)*a.view.scale;0<m&&(mxUtils.getValue(a.style,mxConstants.STYLE_HORIZONTAL,true)?(h=a.y+m/2,l=m):(g=a.x+m/2,k=m));k=Math.max(e,k*d);l=Math.max(e,l*d);0<f&&(k=Math.min(k,f),l=Math.min(l,f));d=new mxRectangle(g-k/2,h-l/2,k,l);g=mxUtils.toRadians(mxUtils.getValue(a.style,
mxConstants.STYLE_ROTATION)||0);0!=g&&(e=Math.cos(-g),f=Math.sin(-g),g=new mxPoint(a.getCenterX(),a.getCenterY()),a=mxUtils.getRotatedPoint(new mxPoint(b,c),e,f,g),b=a.x,c=a.y);return mxUtils.contains(d,b,c)}return true},getOffset:function(a,b){var c=0,d=0;if(null!=b&&b){var e=document.body,f=document.documentElement;c+=e.scrollLeft||f.scrollLeft;d+=e.scrollTop||f.scrollTop}for(;a.offsetParent;){c+=a.offsetLeft;d+=a.offsetTop;a=a.offsetParent}return new mxPoint(c,d)},getScrollOrigin:function(a){for(var b=
document.body,c=document.documentElement,d=new mxPoint(b.scrollLeft||c.scrollLeft,b.scrollTop||c.scrollTop);null!=a&&a!=b&&a!=c;){!isNaN(a.scrollLeft)&&!isNaN(a.scrollTop)&&(d.x+=a.scrollLeft,d.y+=a.scrollTop);a=a.parentNode}return d},convertPoint:function(a,b,c){var d=mxUtils.getScrollOrigin(a);a=mxUtils.getOffset(a);a.x-=d.x;a.y-=d.y;return new mxPoint(b-a.x,c-a.y)},ltrim:function(a,b){return a.replace(RegExp("^["+(b||"\\s")+"]+","g"),"")},rtrim:function(a,b){return a.replace(RegExp("["+(b||"\\s")+
"]+$","g"),"")},trim:function(a,b){return mxUtils.ltrim(mxUtils.rtrim(a,b),b)},isNumeric:function(a){return null!=a&&(null==a.length||0<a.length&&0>a.indexOf("0x")&&0>a.indexOf("0X"))&&!isNaN(a)},mod:function(a,b){return(a%b+b)%b},intersection:function(a,b,c,d,e,f,g,h){var k=(h-f)*(c-a)-(g-e)*(d-b);g=((g-e)*(b-f)-(h-f)*(a-e))/k;e=((c-a)*(b-f)-(d-b)*(a-e))/k;return 0<=g&&1>=g&&0<=e&&1>=e?new mxPoint(a+g*(c-a),b+g*(d-b)):null},ptSegDistSq:function(a,b,c,d,e,f){c-=a;d-=b;e-=a;f-=b;0>=e*c+f*d?c=0:(e=
c-e,f=d-f,a=e*c+f*d,c=0>=a?0:a*a/(c*c+d*d));e=e*e+f*f-c;0>e&&(e=0);return e},relativeCcw:function(a,b,c,d,e,f){c-=a;d-=b;e-=a;f-=b;a=e*d-f*c;0==a&&(a=e*c+f*d,0<a&&(a=(e-c)*c+(f-d)*d,0>a&&(a=0)));return 0>a?-1:0<a?1:0},animateChanges:function(){mxEffects.animateChanges.apply(this,arguments)},cascadeOpacity:function(){mxEffects.cascadeOpacity.apply(this,arguments)},fadeOut:function(){mxEffects.fadeOut.apply(this,arguments)},setOpacity:function(a,b){mxUtils.isVml(a)?a.style.filter=100<=b?null:"alpha(opacity="+
b/5+")":mxClient.IS_IE&&("undefined"===typeof document.documentMode||9>document.documentMode)?a.style.filter=100<=b?null:"alpha(opacity="+b+")":a.style.opacity=b/100},createImage:function(a){var b=null;mxClient.IS_IE6&&"CSS1Compat"!=document.compatMode?(b=document.createElement(mxClient.VML_PREFIX+":image"),b.setAttribute("src",a),b.style.borderStyle="none"):(b=document.createElement("img"),b.setAttribute("src",a),b.setAttribute("border","0"));return b},sortCells:function(a,b){b=null!=b?b:true;var c=
new mxDictionary;a.sort(function(d,e){var f=c.get(d);null==f&&(f=mxCellPath.create(d).split(mxCellPath.PATH_SEPARATOR),c.put(d,f));var g=c.get(e);null==g&&(g=mxCellPath.create(e).split(mxCellPath.PATH_SEPARATOR),c.put(e,g));f=mxCellPath.compare(f,g);return 0==f?0:0<f==b?1:-1});return a},getStylename:function(a){return null!=a&&(a=a.split(";")[0],0>a.indexOf("="))?a:""},getStylenames:function(a){var b=[];if(null!=a){a=a.split(";");for(var c=0;c<a.length;c++)0>a[c].indexOf("=")&&b.push(a[c])}return b},
indexOfStylename:function(a,b){if(null!=a&&null!=b)for(var c=a.split(";"),d=0,e=0;e<c.length;e++){if(c[e]==b)return d;d+=c[e].length+1}return-1},addStylename:function(a,b){0>mxUtils.indexOfStylename(a,b)&&(null==a?a="":0<a.length&&";"!=a.charAt(a.length-1)&&(a+=";"),a+=b);return a},removeStylename:function(a,b){var c=[];if(null!=a)for(var d=a.split(";"),e=0;e<d.length;e++)d[e]!=b&&c.push(d[e]);return c.join(";")},removeAllStylenames:function(a){var b=[];if(null!=a){a=a.split(";");for(var c=0;c<a.length;c++)0<=
a[c].indexOf("=")&&b.push(a[c])}return b.join(";")},setCellStyles:function(a,b,c,d){if(null!=b&&0<b.length){a.beginUpdate();try{for(var e=0;e<b.length;e++)if(null!=b[e]){var f=mxUtils.setStyle(a.getStyle(b[e]),c,d);a.setStyle(b[e],f)}}finally{a.endUpdate()}}},setStyle:function(a,b,c){var d=null!=c&&("undefined"==typeof c.length||0<c.length);if(null==a||0==a.length)d&&(a=b+"="+c);else{var e=a.indexOf(b+"=");0>e?d&&(d=";"==a.charAt(a.length-1)?"":";",a=a+d+b+"="+c):(b=d?b+"="+c:"",c=a.indexOf(";",e),
d||c++,a=a.substring(0,e)+b+(c>e?a.substring(c):""))}return a},setCellStyleFlags:function(a,b,c,d,e){if(null!=b&&0<b.length){a.beginUpdate();try{for(var f=0;f<b.length;f++)if(null!=b[f]){var g=mxUtils.setStyleFlag(a.getStyle(b[f]),c,d,e);a.setStyle(b[f],g)}}finally{a.endUpdate()}}},setStyleFlag:function(a,b,c,d){if(null==a||0==a.length)a=d||null==d?b+"="+c:b+"=0";else{var e=a.indexOf(b+"=");if(0>e){e=";"==a.charAt(a.length-1)?"":";";a=d||null==d?a+e+b+"="+c:a+e+b+"=0"}else{var f=a.indexOf(";",e),
g="";g=0>f?a.substring(e+b.length+1):a.substring(e+b.length+1,f);g=null==d?parseInt(g)^c:d?parseInt(g)|c:parseInt(g)&~c;a=a.substring(0,e)+b+"="+g+(0<=f?a.substring(f):"")}}return a},getAlignmentAsPoint:function(a,b){var c=0,d=0;a==mxConstants.ALIGN_CENTER?c=-0.5:a==mxConstants.ALIGN_RIGHT&&(c=-1);b==mxConstants.ALIGN_MIDDLE?d=-0.5:b==mxConstants.ALIGN_BOTTOM&&(d=-1);return new mxPoint(c,d)},getSizeForString:function(a,b,c,d){b=null!=b?b:mxConstants.DEFAULT_FONTSIZE;c=null!=c?c:mxConstants.DEFAULT_FONTFAMILY;
var e=document.createElement("div");e.style.fontFamily=c;e.style.fontSize=Math.round(b)+"px";e.style.lineHeight=Math.round(b*mxConstants.LINE_HEIGHT)+"px";e.style.position="absolute";e.style.visibility="hidden";e.style.display=mxClient.IS_QUIRKS?"inline":"inline-block";e.style.zoom="1";null!=d?(e.style.width=d+"px",e.style.whiteSpace="normal"):e.style.whiteSpace="nowrap";e.innerHTML=a;document.body.appendChild(e);a=new mxRectangle(0,0,e.offsetWidth,e.offsetHeight);document.body.removeChild(e);return a},
getViewXml:function(a,b,c,d,e){d=null!=d?d:0;e=null!=e?e:0;b=null!=b?b:1;null==c&&(c=[a.getModel().getRoot()]);var f=a.getView(),g=null,h=f.isEventsEnabled();f.setEventsEnabled(false);var k=f.drawPane,l=f.overlayPane;a.dialect==mxConstants.DIALECT_SVG?(f.drawPane=document.createElementNS(mxConstants.NS_SVG,"g"),f.canvas.appendChild(f.drawPane),f.overlayPane=document.createElementNS(mxConstants.NS_SVG,"g")):(f.drawPane=f.drawPane.cloneNode(false),f.canvas.appendChild(f.drawPane),f.overlayPane=f.overlayPane.cloneNode(false));
f.canvas.appendChild(f.overlayPane);var m=f.getTranslate();f.translate=new mxPoint(d,e);b=new mxTemporaryCellStates(a.getView(),b,c);try{g=(new mxCodec).encode(a.getView())}finally{b.destroy();f.translate=m;f.canvas.removeChild(f.drawPane);f.canvas.removeChild(f.overlayPane);f.drawPane=k;f.overlayPane=l;f.setEventsEnabled(h)}return g},getScaleForPageCount:function(a,b,c,d){if(1>a)return 1;c=null!=c?c:mxConstants.PAGE_FORMAT_A4_PORTRAIT;d=null!=d?d:0;var e=c.width-2*d;c=c.height-2*d;d=b.getGraphBounds().clone();
b=b.getView().getScale();d.width/=b;d.height/=b;b=d.width;c=b/d.height/(e/c);d=Math.sqrt(a);var f=Math.sqrt(c);c=d*f;d/=f;if(1>c&&d>a){var g=d/a;d=a;c/=g}1>d&&c>a&&(g=c/a,c=a,d/=g);g=Math.ceil(c)*Math.ceil(d);for(f=0;g>a;){g=Math.floor(c)/c;var h=Math.floor(d)/d;1==g&&(g=Math.floor(c-1)/c);1==h&&(h=Math.floor(d-1)/d);g=g>h?g:h;c*=g;d*=g;g=Math.ceil(c)*Math.ceil(d);f++;if(10<f)break}return 0.99999*(e*c/b)},show:function(a,b,c,d){c=null!=c?c:0;d=null!=d?d:0;null==b?b=window.open().document:b.open();
var e=a.getGraphBounds();c=-e.x+c;d=-e.y+d;if(mxClient.IS_IE){e="<html><head>";for(var f=document.getElementsByTagName("base"),g=0;g<f.length;g++)e+=f[g].outerHTML;e+="<style>";for(g=0;g<document.styleSheets.length;g++)try{e+=document.styleSheets(g).cssText}catch(h){}e+="</style></head>";e+="<body>";e+=a.container.innerHTML;e+="</body>";e+="<html>";b.writeln(e);b.close();a=b.body.getElementsByTagName("DIV")[0];null!=a&&(a.style.position="absolute",a.style.left=c+"px",a.style.top=d+"px")}else{b.writeln("<html");
b.writeln("<head>");f=document.getElementsByTagName("base");for(g=0;g<f.length;g++)b.writeln(mxUtils.getOuterHtml(f[g]));f=document.getElementsByTagName("link");for(g=0;g<f.length;g++)b.writeln(mxUtils.getOuterHtml(f[g]));f=document.getElementsByTagName("style");for(g=0;g<f.length;g++)b.writeln(mxUtils.getOuterHtml(f[g]));b.writeln("</head>");b.writeln("</html>");b.close();null==b.body&&b.documentElement.appendChild(b.createElement("body"));b.body.style.overflow="auto";for(a=a.container.firstChild;null!=
a;){g=a.cloneNode(true);b.body.appendChild(g);a=a.nextSibling}a=b.getElementsByTagName("g")[0];null!=a&&(a.setAttribute("transform","translate("+c+","+d+")"),c=a.ownerSVGElement,c.setAttribute("width",e.width+Math.max(e.x,0)+3),c.setAttribute("height",e.height+Math.max(e.y,0)+3))}mxUtils.removeCursors(b.body);return b},printScreen:function(a){var b=window.open();mxUtils.show(a,b.document);a=function(){b.focus();b.print();b.close()};mxClient.IS_GC?b.setTimeout(a,500):a()},popup:function(a,b){if(b){var c=
document.createElement("div");c.style.overflow="scroll";c.style.width="636px";c.style.height="460px";var d=document.createElement("pre");d.innerHTML=mxUtils.htmlEntities(a,false).replace(/\n/g,"<br>").replace(/ /g,"&nbsp;");c.appendChild(d);c=new mxWindow("Popup Window",c,document.body.clientWidth/2-320,(document.body.clientHeight||document.documentElement.clientHeight)/2-240,640,480,false,true);c.setClosable(true);c.setVisible(true)}else mxClient.IS_NS?(c=window.open(),c.document.writeln("<pre>"+
mxUtils.htmlEntities(a)+"</pre"),c.document.close()):(c=window.open(),d=c.document.createElement("pre"),d.innerHTML=mxUtils.htmlEntities(a,false).replace(/\n/g,"<br>").replace(/ /g,"&nbsp;"),c.document.body.appendChild(d))},alert:function(a){alert(a)},prompt:function(a,b){return prompt(a,b)},confirm:function(a){return confirm(a)},error:function(a,b,c,d){var e=document.createElement("div");e.style.padding="20px";var f=document.createElement("img");f.setAttribute("src",d||mxUtils.errorImage);f.setAttribute("valign",
"bottom");f.style.verticalAlign="middle";e.appendChild(f);e.appendChild(document.createTextNode("\u00a0"));e.appendChild(document.createTextNode("\u00a0"));e.appendChild(document.createTextNode("\u00a0"));mxUtils.write(e,a);a=document.body.clientWidth;d=document.body.clientHeight||document.documentElement.clientHeight;var g=new mxWindow(mxResources.get(mxUtils.errorResource)||mxUtils.errorResource,e,(a-b)/2,d/4,b,null,false,true);c&&(mxUtils.br(e),b=document.createElement("p"),c=document.createElement("button"),
mxClient.IS_IE?c.style.cssText="float:right":c.setAttribute("style","float:right"),mxEvent.addListener(c,"click",function(){g.destroy()}),mxUtils.write(c,mxResources.get(mxUtils.closeResource)||mxUtils.closeResource),b.appendChild(c),e.appendChild(b),mxUtils.br(e),g.setClosable(true));g.setVisible(true);return g},makeDraggable:function(a,b,c,d,e,f,g,h,k,l){a=new mxDragSource(a,c);a.dragOffset=new mxPoint(null!=e?e:0,null!=f?f:mxConstants.TOOLTIP_VERTICAL_OFFSET);a.autoscroll=g;a.setGuidesEnabled(false);
null!=k&&(a.highlightDropTargets=k);null!=l&&(a.getDropTarget=l);a.getGraphForEvent=function(m){return"function"==typeof b?b(m):b};null!=d&&(a.createDragElement=function(){return d.cloneNode(true)},h&&(a.createPreviewElement=function(m){var p=d.cloneNode(true),o=parseInt(p.style.width),n=parseInt(p.style.height);p.style.width=Math.round(o*m.view.scale)+"px";p.style.height=Math.round(n*m.view.scale)+"px";return p}));return a}},mxConstants={DEFAULT_HOTSPOT:0.3,MIN_HOTSPOT_SIZE:8,MAX_HOTSPOT_SIZE:0,
RENDERING_HINT_EXACT:"exact",RENDERING_HINT_FASTER:"faster",RENDERING_HINT_FASTEST:"fastest",DIALECT_SVG:"svg",DIALECT_VML:"vml",DIALECT_MIXEDHTML:"mixedHtml",DIALECT_PREFERHTML:"preferHtml",DIALECT_STRICTHTML:"strictHtml",NS_SVG:"http://www.w3.org/2000/svg",NS_XHTML:"http://www.w3.org/1999/xhtml",NS_XLINK:"http://www.w3.org/1999/xlink",SHADOWCOLOR:"gray",SHADOW_OFFSET_X:2,SHADOW_OFFSET_Y:3,SHADOW_OPACITY:1,NODETYPE_ELEMENT:1,NODETYPE_ATTRIBUTE:2,NODETYPE_TEXT:3,NODETYPE_CDATA:4,NODETYPE_ENTITY_REFERENCE:5,
NODETYPE_ENTITY:6,NODETYPE_PROCESSING_INSTRUCTION:7,NODETYPE_COMMENT:8,NODETYPE_DOCUMENT:9,NODETYPE_DOCUMENTTYPE:10,NODETYPE_DOCUMENT_FRAGMENT:11,NODETYPE_NOTATION:12,TOOLTIP_VERTICAL_OFFSET:16,DEFAULT_VALID_COLOR:"#00FF00",DEFAULT_INVALID_COLOR:"#FF0000",HIGHLIGHT_STROKEWIDTH:3,CURSOR_MOVABLE_VERTEX:"move",CURSOR_MOVABLE_EDGE:"move",CURSOR_LABEL_HANDLE:"default",CURSOR_BEND_HANDLE:"pointer",CURSOR_CONNECT:"pointer",HIGHLIGHT_COLOR:"#00FF00",CONNECT_TARGET_COLOR:"#0000FF",INVALID_CONNECT_TARGET_COLOR:"#FF0000",
DROP_TARGET_COLOR:"#0000FF",VALID_COLOR:"#00FF00",INVALID_COLOR:"#FF0000",EDGE_SELECTION_COLOR:"#00FF00",VERTEX_SELECTION_COLOR:"#00FF00",VERTEX_SELECTION_STROKEWIDTH:1,EDGE_SELECTION_STROKEWIDTH:1,VERTEX_SELECTION_DASHED:true,EDGE_SELECTION_DASHED:true,GUIDE_COLOR:"#FF0000",GUIDE_STROKEWIDTH:1,OUTLINE_COLOR:"#0099FF",OUTLINE_STROKEWIDTH:mxClient.IS_IE?2:3,HANDLE_SIZE:7,LABEL_HANDLE_SIZE:4,HANDLE_FILLCOLOR:"#00FF00",HANDLE_STROKECOLOR:"black",LABEL_HANDLE_FILLCOLOR:"yellow",CONNECT_HANDLE_FILLCOLOR:"#0000FF",
LOCKED_HANDLE_FILLCOLOR:"#FF0000",OUTLINE_HANDLE_FILLCOLOR:"#00FFFF",OUTLINE_HANDLE_STROKECOLOR:"#0033FF",DEFAULT_FONTFAMILY:"Arial,Helvetica",DEFAULT_FONTSIZE:11,LINE_HEIGHT:1.2,DEFAULT_FONTSTYLE:0,DEFAULT_STARTSIZE:40,DEFAULT_MARKERSIZE:6,DEFAULT_IMAGESIZE:24,ENTITY_SEGMENT:30,RECTANGLE_ROUNDING_FACTOR:0.15,LINE_ARCSIZE:20,ARROW_SPACING:10,ARROW_WIDTH:30,ARROW_SIZE:30,PAGE_FORMAT_A4_PORTRAIT:new mxRectangle(0,0,826,1169),PAGE_FORMAT_A4_LANDSCAPE:new mxRectangle(0,0,1169,826),PAGE_FORMAT_LETTER_PORTRAIT:new mxRectangle(0,
0,850,1100),PAGE_FORMAT_LETTER_LANDSCAPE:new mxRectangle(0,0,1100,850),NONE:"none",STYLE_PERIMETER:"perimeter",STYLE_SOURCE_PORT:"sourcePort",STYLE_TARGET_PORT:"targetPort",STYLE_PORT_CONSTRAINT:"portConstraint",STYLE_OPACITY:"opacity",STYLE_TEXT_OPACITY:"textOpacity",STYLE_OVERFLOW:"overflow",STYLE_ORTHOGONAL:"orthogonal",STYLE_EXIT_X:"exitX",STYLE_EXIT_Y:"exitY",STYLE_EXIT_PERIMETER:"exitPerimeter",STYLE_ENTRY_X:"entryX",STYLE_ENTRY_Y:"entryY",STYLE_ENTRY_PERIMETER:"entryPerimeter",STYLE_WHITE_SPACE:"whiteSpace",
STYLE_ROTATION:"rotation",STYLE_FILLCOLOR:"fillColor",STYLE_SWIMLANE_FILLCOLOR:"swimlaneFillColor",STYLE_GRADIENTCOLOR:"gradientColor",STYLE_GRADIENT_DIRECTION:"gradientDirection",STYLE_STROKECOLOR:"strokeColor",STYLE_SEPARATORCOLOR:"separatorColor",STYLE_STROKEWIDTH:"strokeWidth",STYLE_ALIGN:"align",STYLE_VERTICAL_ALIGN:"verticalAlign",STYLE_LABEL_POSITION:"labelPosition",STYLE_VERTICAL_LABEL_POSITION:"verticalLabelPosition",STYLE_IMAGE_ASPECT:"imageAspect",STYLE_IMAGE_ALIGN:"imageAlign",STYLE_IMAGE_VERTICAL_ALIGN:"imageVerticalAlign",
STYLE_GLASS:"glass",STYLE_IMAGE:"image",STYLE_IMAGE_WIDTH:"imageWidth",STYLE_IMAGE_HEIGHT:"imageHeight",STYLE_IMAGE_BACKGROUND:"imageBackground",STYLE_IMAGE_BORDER:"imageBorder",STYLE_FLIPH:"flipH",STYLE_FLIPV:"flipV",STYLE_NOLABEL:"noLabel",STYLE_NOEDGESTYLE:"noEdgeStyle",STYLE_LABEL_BACKGROUNDCOLOR:"labelBackgroundColor",STYLE_LABEL_BORDERCOLOR:"labelBorderColor",STYLE_LABEL_PADDING:"labelPadding",STYLE_INDICATOR_SHAPE:"indicatorShape",STYLE_INDICATOR_IMAGE:"indicatorImage",STYLE_INDICATOR_COLOR:"indicatorColor",
STYLE_INDICATOR_STROKECOLOR:"indicatorStrokeColor",STYLE_INDICATOR_GRADIENTCOLOR:"indicatorGradientColor",STYLE_INDICATOR_SPACING:"indicatorSpacing",STYLE_INDICATOR_WIDTH:"indicatorWidth",STYLE_INDICATOR_HEIGHT:"indicatorHeight",STYLE_INDICATOR_DIRECTION:"indicatorDirection",STYLE_SHADOW:"shadow",STYLE_SEGMENT:"segment",STYLE_ENDARROW:"endArrow",STYLE_STARTARROW:"startArrow",STYLE_ENDSIZE:"endSize",STYLE_STARTSIZE:"startSize",STYLE_SWIMLANE_LINE:"swimlaneLine",STYLE_ENDFILL:"endFill",STYLE_STARTFILL:"startFill",
STYLE_DASHED:"dashed",STYLE_DASH_PATTERN:"dashPattern",STYLE_ROUNDED:"rounded",STYLE_CURVED:"curved",STYLE_ARCSIZE:"arcSize",STYLE_SMOOTH:"smooth",STYLE_SOURCE_PERIMETER_SPACING:"sourcePerimeterSpacing",STYLE_TARGET_PERIMETER_SPACING:"targetPerimeterSpacing",STYLE_PERIMETER_SPACING:"perimeterSpacing",STYLE_SPACING:"spacing",STYLE_SPACING_TOP:"spacingTop",STYLE_SPACING_LEFT:"spacingLeft",STYLE_SPACING_BOTTOM:"spacingBottom",STYLE_SPACING_RIGHT:"spacingRight",STYLE_HORIZONTAL:"horizontal",STYLE_DIRECTION:"direction",
STYLE_ELBOW:"elbow",STYLE_FONTCOLOR:"fontColor",STYLE_FONTFAMILY:"fontFamily",STYLE_FONTSIZE:"fontSize",STYLE_FONTSTYLE:"fontStyle",STYLE_AUTOSIZE:"autosize",STYLE_FOLDABLE:"foldable",STYLE_EDITABLE:"editable",STYLE_BENDABLE:"bendable",STYLE_MOVABLE:"movable",STYLE_RESIZABLE:"resizable",STYLE_ROTATABLE:"rotatable",STYLE_CLONEABLE:"cloneable",STYLE_DELETABLE:"deletable",STYLE_SHAPE:"shape",STYLE_EDGE:"edgeStyle",STYLE_LOOP:"loopStyle",STYLE_ROUTING_CENTER_X:"routingCenterX",STYLE_ROUTING_CENTER_Y:"routingCenterY",
FONT_BOLD:1,FONT_ITALIC:2,FONT_UNDERLINE:4,FONT_SHADOW:8,SHAPE_RECTANGLE:"rectangle",SHAPE_ELLIPSE:"ellipse",SHAPE_DOUBLE_ELLIPSE:"doubleEllipse",SHAPE_RHOMBUS:"rhombus",SHAPE_LINE:"line",SHAPE_IMAGE:"image",SHAPE_ARROW:"arrow",SHAPE_LABEL:"label",SHAPE_CYLINDER:"cylinder",SHAPE_SWIMLANE:"swimlane",SHAPE_CONNECTOR:"connector",SHAPE_ACTOR:"actor",SHAPE_CLOUD:"cloud",SHAPE_TRIANGLE:"triangle",SHAPE_HEXAGON:"hexagon",ARROW_CLASSIC:"classic",ARROW_BLOCK:"block",ARROW_OPEN:"open",ARROW_OVAL:"oval",ARROW_DIAMOND:"diamond",
ARROW_DIAMOND_THIN:"diamondThin",ALIGN_LEFT:"left",ALIGN_CENTER:"center",ALIGN_RIGHT:"right",ALIGN_TOP:"top",ALIGN_MIDDLE:"middle",ALIGN_BOTTOM:"bottom",DIRECTION_NORTH:"north",DIRECTION_SOUTH:"south",DIRECTION_EAST:"east",DIRECTION_WEST:"west",DIRECTION_MASK_NONE:0,DIRECTION_MASK_WEST:1,DIRECTION_MASK_NORTH:2,DIRECTION_MASK_SOUTH:4,DIRECTION_MASK_EAST:8,DIRECTION_MASK_ALL:15,ELBOW_VERTICAL:"vertical",ELBOW_HORIZONTAL:"horizontal",EDGESTYLE_ELBOW:"elbowEdgeStyle",EDGESTYLE_ENTITY_RELATION:"entityRelationEdgeStyle",
EDGESTYLE_LOOP:"loopEdgeStyle",EDGESTYLE_SIDETOSIDE:"sideToSideEdgeStyle",EDGESTYLE_TOPTOBOTTOM:"topToBottomEdgeStyle",EDGESTYLE_ORTHOGONAL:"orthogonalEdgeStyle",EDGESTYLE_SEGMENT:"segmentEdgeStyle",PERIMETER_ELLIPSE:"ellipsePerimeter",PERIMETER_RECTANGLE:"rectanglePerimeter",PERIMETER_RHOMBUS:"rhombusPerimeter",PERIMETER_TRIANGLE:"trianglePerimeter"};
function mxEventObject(a){this.name=a;this.properties=[];for(var b=1;b<arguments.length;b+=2)null!=arguments[b+1]&&(this.properties[arguments[b]]=arguments[b+1])}mxEventObject.prototype.name=null;mxEventObject.prototype.properties=null;mxEventObject.prototype.consumed=false;mxEventObject.prototype.getName=function(){return this.name};mxEventObject.prototype.getProperties=function(){return this.properties};mxEventObject.prototype.getProperty=function(a){return this.properties[a]};
mxEventObject.prototype.isConsumed=function(){return this.consumed};mxEventObject.prototype.consume=function(){this.consumed=true};function mxMouseEvent(a,b){this.evt=a;this.state=b}mxMouseEvent.prototype.consumed=false;mxMouseEvent.prototype.evt=null;mxMouseEvent.prototype.graphX=null;mxMouseEvent.prototype.graphY=null;mxMouseEvent.prototype.state=null;mxMouseEvent.prototype.getEvent=function(){return this.evt};mxMouseEvent.prototype.getSource=function(){return mxEvent.getSource(this.evt)};
mxMouseEvent.prototype.isSource=function(a){if(null!=a)for(var b=this.getSource();null!=b;){if(b==a.node)return true;b=b.parentNode}return false};mxMouseEvent.prototype.getX=function(){return mxEvent.getClientX(this.getEvent())};mxMouseEvent.prototype.getY=function(){return mxEvent.getClientY(this.getEvent())};mxMouseEvent.prototype.getGraphX=function(){return this.graphX};mxMouseEvent.prototype.getGraphY=function(){return this.graphY};mxMouseEvent.prototype.getState=function(){return this.state};
mxMouseEvent.prototype.getCell=function(){var a=this.getState();return null!=a?a.cell:null};mxMouseEvent.prototype.isPopupTrigger=function(){return mxEvent.isPopupTrigger(this.getEvent())};mxMouseEvent.prototype.isConsumed=function(){return this.consumed};mxMouseEvent.prototype.consume=function(a){(null!=a?a:1)&&this.evt.preventDefault&&this.evt.preventDefault();this.evt.returnValue=false;this.consumed=true};function mxEventSource(a){this.setEventSource(a)}mxEventSource.prototype.eventListeners=null;
mxEventSource.prototype.eventsEnabled=true;mxEventSource.prototype.eventSource=null;mxEventSource.prototype.isEventsEnabled=function(){return this.eventsEnabled};mxEventSource.prototype.setEventsEnabled=function(a){this.eventsEnabled=a};mxEventSource.prototype.getEventSource=function(){return this.eventSource};mxEventSource.prototype.setEventSource=function(a){this.eventSource=a};
mxEventSource.prototype.addListener=function(a,b){null==this.eventListeners&&(this.eventListeners=[]);this.eventListeners.push(a);this.eventListeners.push(b)};mxEventSource.prototype.removeListener=function(a){if(null!=this.eventListeners)for(var b=0;b<this.eventListeners.length;)this.eventListeners[b+1]==a?this.eventListeners.splice(b,2):b+=2};
mxEventSource.prototype.fireEvent=function(a,b){if(null!=this.eventListeners&&this.isEventsEnabled()){null==a&&(a=new mxEventObject);null==b&&(b=this.getEventSource());null==b&&(b=this);for(var c=[b,a],d=0;d<this.eventListeners.length;d+=2){var e=this.eventListeners[d];(null==e||e==a.getName())&&this.eventListeners[d+1].apply(this,c)}}};
var mxEvent={objects:[],addListener:function(){var a=function(b,c,d){null==b.mxListenerList&&(b.mxListenerList=[],mxEvent.objects.push(b));b.mxListenerList.push({name:c,f:d})};return window.addEventListener?function(b,c,d){b.addEventListener(c,d,false);a(b,c,d)}:function(b,c,d){b.attachEvent("on"+c,d);a(b,c,d)}}(),removeListener:function(){var a=function(b,c,d){if(null!=b.mxListenerList){c=b.mxListenerList.length;for(var e=0;e<c;e++)if(b.mxListenerList[e].f==d){b.mxListenerList.splice(e,1);break}0==
b.mxListenerList.length&&(b.mxListenerList=null)}};return window.removeEventListener?function(b,c,d){b.removeEventListener(c,d,false);a(b,c,d)}:function(b,c,d){b.detachEvent("on"+c,d);a(b,c,d)}}(),removeAllListeners:function(a){var b=a.mxListenerList;if(null!=b)for(;0<b.length;){var c=b[0];mxEvent.removeListener(a,c.name,c.f)}},addGestureListeners:function(a,b,c,d){null!=b&&mxEvent.addListener(a,mxClient.IS_POINTER?"MSPointerDown":"mousedown",b);null!=c&&mxEvent.addListener(a,mxClient.IS_POINTER?
"MSPointerMove":"mousemove",c);null!=d&&mxEvent.addListener(a,mxClient.IS_POINTER?"MSPointerUp":"mouseup",d);!mxClient.IS_POINTER&&mxClient.IS_TOUCH&&(null!=b&&mxEvent.addListener(a,"touchstart",b),null!=c&&mxEvent.addListener(a,"touchmove",c),null!=d&&mxEvent.addListener(a,"touchend",d))},removeGestureListeners:function(a,b,c,d){null!=b&&mxEvent.removeListener(a,mxClient.IS_POINTER?"MSPointerDown":"mousedown",b);null!=c&&mxEvent.removeListener(a,mxClient.IS_POINTER?"MSPointerMove":"mousemove",c);
null!=d&&mxEvent.removeListener(a,mxClient.IS_POINTER?"MSPointerUp":"mouseup",d);!mxClient.IS_POINTER&&mxClient.IS_TOUCH&&(null!=b&&mxEvent.removeListener(a,"touchstart",b),null!=c&&mxEvent.removeListener(a,"touchmove",c),null!=d&&mxEvent.removeListener(a,"touchend",d))},redirectMouseEvents:function(a,b,c,d,e,f,g){var h=function(k){return"function"==typeof c?c(k):c};mxEvent.addGestureListeners(a,function(k){null!=d?d(k):mxEvent.isConsumed(k)||b.fireMouseEvent(mxEvent.MOUSE_DOWN,new mxMouseEvent(k,
h(k)))},function(k){null!=e?e(k):mxEvent.isConsumed(k)||b.fireMouseEvent(mxEvent.MOUSE_MOVE,new mxMouseEvent(k,h(k)))},function(k){null!=f?f(k):mxEvent.isConsumed(k)||b.fireMouseEvent(mxEvent.MOUSE_UP,new mxMouseEvent(k,h(k)))});mxEvent.addListener(a,"dblclick",function(k){if(null!=g)g(k);else if(!mxEvent.isConsumed(k)){var l=h(k);b.dblClick(k,null!=l?l.cell:null)}})},release:function(a){if(null!=a&&(mxEvent.removeAllListeners(a),a=a.childNodes,null!=a))for(var b=a.length,c=0;c<b;c+=1)mxEvent.release(a[c])},
addMouseWheelListener:function(a){if(null!=a){var b=function(c){null==c&&(c=window.event);var d=0;d=mxClient.IS_NS&&!mxClient.IS_SF&&!mxClient.IS_GC?-c.detail/2:c.wheelDelta/120;0!=d&&a(c,0<d)};mxClient.IS_NS?mxEvent.addListener(window,mxClient.IS_SF||mxClient.IS_GC?"mousewheel":"DOMMouseScroll",b):mxEvent.addListener(document,"mousewheel",b)}},disableContextMenu:function(){return mxClient.IS_IE&&("undefined"===typeof document.documentMode||9>document.documentMode)?function(a){mxEvent.addListener(a,
"contextmenu",function(){return false})}:function(a){a.setAttribute("oncontextmenu","return false;")}}(),getSource:function(a){return null!=a.srcElement?a.srcElement:a.target},isConsumed:function(a){return null!=a.isConsumed&&a.isConsumed},isLeftMouseButton:function(a){return a.button==(mxClient.IS_IE&&("undefined"===typeof document.documentMode||9>document.documentMode)?1:0)},isRightMouseButton:function(a){return 2==a.button},isPopupTrigger:function(a){return mxEvent.isRightMouseButton(a)||mxEvent.isShiftDown(a)&&
!mxEvent.isControlDown(a)},isShiftDown:function(a){return null!=a?a.shiftKey:false},isAltDown:function(a){return null!=a?a.altKey:false},isControlDown:function(a){return null!=a?a.ctrlKey:false},isMetaDown:function(a){return null!=a?a.metaKey:false},getMainEvent:function(a){("touchstart"==a.type||"touchmove"==a.type)&&null!=a.touches&&null!=a.touches[0]?a=a.touches[0]:"touchend"==a.type&&null!=a.changedTouches&&null!=a.changedTouches[0]&&(a=a.changedTouches[0]);return a},getClientX:function(a){return mxEvent.getMainEvent(a).clientX},
getClientY:function(a){return mxEvent.getMainEvent(a).clientY},consume:function(a,b,c){c=null!=c?c:true;if(null!=b?b:1)a.preventDefault?(c&&a.stopPropagation(),a.preventDefault()):c&&(a.cancelBubble=true);a.isConsumed=true;a.returnValue=false},LABEL_HANDLE:-1,ROTATION_HANDLE:-2,MOUSE_DOWN:"mouseDown",MOUSE_MOVE:"mouseMove",MOUSE_UP:"mouseUp",ACTIVATE:"activate",RESIZE_START:"resizeStart",RESIZE:"resize",RESIZE_END:"resizeEnd",MOVE_START:"moveStart",MOVE:"move",MOVE_END:"moveEnd",PAN_START:"panStart",
PAN:"pan",PAN_END:"panEnd",MINIMIZE:"minimize",NORMALIZE:"normalize",MAXIMIZE:"maximize",HIDE:"hide",SHOW:"show",CLOSE:"close",DESTROY:"destroy",REFRESH:"refresh",SIZE:"size",SELECT:"select",FIRED:"fired",GET:"get",RECEIVE:"receive",CONNECT:"connect",DISCONNECT:"disconnect",SUSPEND:"suspend",RESUME:"resume",MARK:"mark",SESSION:"session",ROOT:"root",POST:"post",OPEN:"open",SAVE:"save",BEFORE_ADD_VERTEX:"beforeAddVertex",ADD_VERTEX:"addVertex",AFTER_ADD_VERTEX:"afterAddVertex",DONE:"done",EXECUTE:"execute",
EXECUTED:"executed",BEGIN_UPDATE:"beginUpdate",START_EDIT:"startEdit",END_UPDATE:"endUpdate",END_EDIT:"endEdit",BEFORE_UNDO:"beforeUndo",UNDO:"undo",REDO:"redo",CHANGE:"change",NOTIFY:"notify",LAYOUT_CELLS:"layoutCells",CLICK:"click",SCALE:"scale",TRANSLATE:"translate",SCALE_AND_TRANSLATE:"scaleAndTranslate",UP:"up",DOWN:"down",ADD:"add",REMOVE:"remove",CLEAR:"clear",ADD_CELLS:"addCells",CELLS_ADDED:"cellsAdded",MOVE_CELLS:"moveCells",CELLS_MOVED:"cellsMoved",RESIZE_CELLS:"resizeCells",CELLS_RESIZED:"cellsResized",
TOGGLE_CELLS:"toggleCells",CELLS_TOGGLED:"cellsToggled",ORDER_CELLS:"orderCells",CELLS_ORDERED:"cellsOrdered",REMOVE_CELLS:"removeCells",CELLS_REMOVED:"cellsRemoved",GROUP_CELLS:"groupCells",UNGROUP_CELLS:"ungroupCells",REMOVE_CELLS_FROM_PARENT:"removeCellsFromParent",FOLD_CELLS:"foldCells",CELLS_FOLDED:"cellsFolded",ALIGN_CELLS:"alignCells",LABEL_CHANGED:"labelChanged",CONNECT_CELL:"connectCell",CELL_CONNECTED:"cellConnected",SPLIT_EDGE:"splitEdge",FLIP_EDGE:"flipEdge",START_EDITING:"startEditing",
ADD_OVERLAY:"addOverlay",REMOVE_OVERLAY:"removeOverlay",UPDATE_CELL_SIZE:"updateCellSize",ESCAPE:"escape",CLICK:"click",DOUBLE_CLICK:"doubleClick",START:"start",RESET:"reset"};function mxXmlRequest(a,b,c,d,e,f){this.url=a;this.params=b;this.method=c||"POST";this.async=null!=d?d:true;this.username=e;this.password=f}mxXmlRequest.prototype.url=null;mxXmlRequest.prototype.params=null;mxXmlRequest.prototype.method=null;mxXmlRequest.prototype.async=null;mxXmlRequest.prototype.binary=false;
mxXmlRequest.prototype.username=null;mxXmlRequest.prototype.password=null;mxXmlRequest.prototype.request=null;mxXmlRequest.prototype.isBinary=function(){return this.binary};mxXmlRequest.prototype.setBinary=function(a){this.binary=a};mxXmlRequest.prototype.getText=function(){return this.request.responseText};mxXmlRequest.prototype.isReady=function(){return 4==this.request.readyState};mxXmlRequest.prototype.getDocumentElement=function(){var a=this.getXml();return null!=a?a.documentElement:null};
mxXmlRequest.prototype.getXml=function(){var a=this.request.responseXML;if(9<=document.documentMode||null==a||null==a.documentElement)a=mxUtils.parseXml(this.request.responseText);return a};mxXmlRequest.prototype.getText=function(){return this.request.responseText};mxXmlRequest.prototype.getStatus=function(){return this.request.status};
mxXmlRequest.prototype.create=function(){if(window.XMLHttpRequest)return function(){var a=new XMLHttpRequest;this.isBinary()&&a.overrideMimeType&&a.overrideMimeType("text/plain; charset=x-user-defined");return a};if("undefined"!=typeof ActiveXObject)return function(){return new ActiveXObject("Microsoft.XMLHTTP")}}();
mxXmlRequest.prototype.send=function(a){this.request=this.create();null!=this.request&&(null!=a&&(this.request.onreadystatechange=mxUtils.bind(this,function(){this.isReady()&&(a(this),this.onreadystatechaange=null)})),this.request.open(this.method,this.url,this.async,this.username,this.password),this.setRequestHeaders(this.request,this.params),this.request.send(this.params))};mxXmlRequest.prototype.setRequestHeaders=function(a,b){null!=b&&a.setRequestHeader("Content-Type","application/x-www-form-urlencoded")};
mxXmlRequest.prototype.simulate=function(a,b){a=a||document;var c=null;a==document&&(c=window.onbeforeunload,window.onbeforeunload=null);var d=a.createElement("form");d.setAttribute("method",this.method);d.setAttribute("action",this.url);null!=b&&d.setAttribute("target",b);d.style.display="none";d.style.visibility="hidden";for(var e=0<this.params.indexOf("&")?this.params.split("&"):this.params.split(),f=0;f<e.length;f++){var g=e[f].indexOf("=");if(0<g){var h=e[f].substring(0,g),k=e[f].substring(g+
1);g=a.createElement("textarea");g.setAttribute("name",h);k=k.replace(/\n/g,"&#xa;");h=a.createTextNode(k);g.appendChild(h);d.appendChild(g)}}a.body.appendChild(d);d.submit();a.body.removeChild(d);null!=c&&(window.onbeforeunload=c)};
var mxClipboard={STEPSIZE:10,insertCount:1,cells:null,isEmpty:function(){return null==mxClipboard.cells},cut:function(a,b){b=mxClipboard.copy(a,b);mxClipboard.insertCount=0;mxClipboard.removeCells(a,b);return b},removeCells:function(a,b){a.removeCells(b)},copy:function(a,b){b=b||a.getSelectionCells();var c=a.getExportableCells(b);mxClipboard.insertCount=1;mxClipboard.cells=a.cloneCells(c);return c},paste:function(a){if(null!=mxClipboard.cells){var b=a.getImportableCells(mxClipboard.cells),c=mxClipboard.insertCount*
mxClipboard.STEPSIZE,d=a.getDefaultParent();b=a.importCells(b,c,c,d);mxClipboard.insertCount++;a.setSelectionCells(b)}}};function mxWindow(a,b,c,d,e,f,g,h,k,l){null!=b&&(g=null!=g?g:true,this.content=b,this.init(c,d,e,f,l),this.installMaximizeHandler(),this.installMinimizeHandler(),this.installCloseHandler(),this.setMinimizable(g),this.setTitle(a),(null==h||h)&&this.installMoveHandler(),null!=k&&null!=k.parentNode?k.parentNode.replaceChild(this.div,k):document.body.appendChild(this.div))}
mxWindow.prototype=new mxEventSource;mxWindow.prototype.constructor=mxWindow;mxWindow.prototype.closeImage=mxClient.imageBasePath+"/close.gif";mxWindow.prototype.minimizeImage=mxClient.imageBasePath+"/minimize.gif";mxWindow.prototype.normalizeImage=mxClient.imageBasePath+"/normalize.gif";mxWindow.prototype.maximizeImage=mxClient.imageBasePath+"/maximize.gif";mxWindow.prototype.resizeImage=mxClient.imageBasePath+"/resize.gif";mxWindow.prototype.visible=false;mxWindow.prototype.content=false;
mxWindow.prototype.minimumSize=new mxRectangle(0,0,50,40);mxWindow.prototype.title=false;mxWindow.prototype.content=false;mxWindow.prototype.destroyOnClose=true;
mxWindow.prototype.init=function(a,b,c,d,e){e=null!=e?e:"mxWindow";this.div=document.createElement("div");this.div.className=e;this.div.style.left=a+"px";this.div.style.top=b+"px";this.table=document.createElement("table");this.table.className=e;null!=c&&(mxClient.IS_IE||(this.div.style.width=c+"px"),this.table.style.width=c+"px");null!=d&&(mxClient.IS_IE||(this.div.style.height=d+"px"),this.table.style.height=d+"px");a=document.createElement("tbody");b=document.createElement("tr");this.title=document.createElement("td");
this.title.className=e+"Title";b.appendChild(this.title);a.appendChild(b);b=document.createElement("tr");this.td=document.createElement("td");this.td.className=e+"Pane";this.contentWrapper=document.createElement("div");this.contentWrapper.className=e+"Pane";this.contentWrapper.style.width="100%";this.contentWrapper.appendChild(this.content);if(mxClient.IS_IE||"DIV"!=this.content.nodeName.toUpperCase())this.contentWrapper.style.height="100%";this.td.appendChild(this.contentWrapper);b.appendChild(this.td);
a.appendChild(b);this.table.appendChild(a);this.div.appendChild(this.table);e=mxUtils.bind(this,function(){this.activate()});mxEvent.addGestureListeners(this.title,e);mxEvent.addGestureListeners(this.table,e);this.hide()};mxWindow.prototype.setTitle=function(a){for(var b=this.title.firstChild;null!=b;){var c=b.nextSibling;b.nodeType==mxConstants.NODETYPE_TEXT&&b.parentNode.removeChild(b);b=c}mxUtils.write(this.title,a||"")};
mxWindow.prototype.setScrollable=function(a){0>navigator.userAgent.indexOf("Presto/2.5")&&(this.contentWrapper.style.overflow=a?"auto":"hidden")};
mxWindow.prototype.activate=function(){if(mxWindow.activeWindow!=this){var a=mxUtils.getCurrentStyle(this.getElement());a=null!=a?a.zIndex:3;if(mxWindow.activeWindow){var b=mxWindow.activeWindow.getElement();null!=b&&null!=b.style&&(b.style.zIndex=a)}b=mxWindow.activeWindow;this.getElement().style.zIndex=parseInt(a)+1;mxWindow.activeWindow=this;this.fireEvent(new mxEventObject(mxEvent.ACTIVATE,"previousWindow",b))}};mxWindow.prototype.getElement=function(){return this.div};
mxWindow.prototype.fit=function(){mxUtils.fit(this.div)};mxWindow.prototype.isResizable=function(){return null!=this.resize?"none"!=this.resize.style.display:false};
mxWindow.prototype.setResizable=function(a){a?null==this.resize?(this.resize=document.createElement("img"),this.resize.style.position="absolute",this.resize.style.bottom="2px",this.resize.style.right="2px",this.resize.setAttribute("src",mxClient.imageBasePath+"/resize.gif"),this.resize.style.cursor="nw-resize",mxEvent.addGestureListeners(this.resize,mxUtils.bind(this,function(b){this.activate();var c=mxEvent.getClientX(b),d=mxEvent.getClientY(b),e=this.div.offsetWidth,f=this.div.offsetHeight,g=mxUtils.bind(this,
function(k){var l=mxEvent.getClientX(k)-c,m=mxEvent.getClientY(k)-d;this.setSize(e+l,f+m);this.fireEvent(new mxEventObject(mxEvent.RESIZE,"event",k));mxEvent.consume(k)}),h=mxUtils.bind(this,function(k){mxEvent.removeGestureListeners(document,null,g,h);this.fireEvent(new mxEventObject(mxEvent.RESIZE_END,"event",k));mxEvent.consume(k)});mxEvent.addGestureListeners(document,null,g,h);this.fireEvent(new mxEventObject(mxEvent.RESIZE_START,"event",b));mxEvent.consume(b)}),null,null),this.div.appendChild(this.resize),
mxClient.IS_POINTER&&(this.resize.style.msTouchAction="none")):this.resize.style.display="inline":null!=this.resize&&(this.resize.style.display="none")};
mxWindow.prototype.setSize=function(a,b){a=Math.max(this.minimumSize.width,a);b=Math.max(this.minimumSize.height,b);mxClient.IS_IE||(this.div.style.width=a+"px",this.div.style.height=b+"px");this.table.style.width=a+"px";this.table.style.height=b+"px";mxClient.IS_IE||(this.contentWrapper.style.height=this.div.offsetHeight-this.title.offsetHeight-2+"px")};mxWindow.prototype.setMinimizable=function(a){this.minimize.style.display=a?"":"none"};
mxWindow.prototype.getMinimumSize=function(){return new mxRectangle(0,0,0,this.title.offsetHeight)};
mxWindow.prototype.installMinimizeHandler=function(){this.minimize=document.createElement("img");this.minimize.setAttribute("src",this.minimizeImage);this.minimize.setAttribute("align","right");this.minimize.setAttribute("title","Minimize");this.minimize.style.cursor="pointer";this.minimize.style.marginRight="1px";this.minimize.style.display="none";this.title.appendChild(this.minimize);var a=false,b=null,c=null,d=mxUtils.bind(this,function(e){this.activate();if(a){a=false;this.minimize.setAttribute("src",
this.minimizeImage);this.minimize.setAttribute("title","Minimize");this.contentWrapper.style.display="";this.maximize.style.display=b;mxClient.IS_IE||(this.div.style.height=c);this.table.style.height=c;null!=this.resize&&(this.resize.style.visibility="");this.fireEvent(new mxEventObject(mxEvent.NORMALIZE,"event",e))}else{a=true;this.minimize.setAttribute("src",this.normalizeImage);this.minimize.setAttribute("title","Normalize");this.contentWrapper.style.display="none";b=this.maximize.style.display;
this.maximize.style.display="none";c=this.table.style.height;var f=this.getMinimumSize();0<f.height&&(mxClient.IS_IE||(this.div.style.height=f.height+"px"),this.table.style.height=f.height+"px");0<f.width&&(mxClient.IS_IE||(this.div.style.width=f.width+"px"),this.table.style.width=f.width+"px");null!=this.resize&&(this.resize.style.visibility="hidden");this.fireEvent(new mxEventObject(mxEvent.MINIMIZE,"event",e))}mxEvent.consume(e)});mxEvent.addGestureListeners(this.minimize,d)};
mxWindow.prototype.setMaximizable=function(a){this.maximize.style.display=a?"":"none"};
mxWindow.prototype.installMaximizeHandler=function(){this.maximize=document.createElement("img");this.maximize.setAttribute("src",this.maximizeImage);this.maximize.setAttribute("align","right");this.maximize.setAttribute("title","Maximize");this.maximize.style.cursor="default";this.maximize.style.marginLeft="1px";this.maximize.style.cursor="pointer";this.maximize.style.display="none";this.title.appendChild(this.maximize);var a=false,b=null,c=null,d=null,e=null,f=mxUtils.bind(this,function(g){this.activate();
if("none"!=this.maximize.style.display){if(a){a=false;this.maximize.setAttribute("src",this.maximizeImage);this.maximize.setAttribute("title","Maximize");this.contentWrapper.style.display="";this.minimize.style.visibility="";this.div.style.left=b+"px";this.div.style.top=c+"px";if(!mxClient.IS_IE&&(this.div.style.height=d,this.div.style.width=e,h=mxUtils.getCurrentStyle(this.contentWrapper),"auto"==h.overflow||null!=this.resize))this.contentWrapper.style.height=this.div.offsetHeight-this.title.offsetHeight-
2+"px";this.table.style.height=d;this.table.style.width=e;null!=this.resize&&(this.resize.style.visibility="");this.fireEvent(new mxEventObject(mxEvent.NORMALIZE,"event",g))}else{a=true;this.maximize.setAttribute("src",this.normalizeImage);this.maximize.setAttribute("title","Normalize");this.contentWrapper.style.display="";this.minimize.style.visibility="hidden";b=parseInt(this.div.style.left);c=parseInt(this.div.style.top);d=this.table.style.height;e=this.table.style.width;this.div.style.left="0px";
this.div.style.top="0px";mxClient.IS_IE||(this.div.style.height=document.body.clientHeight-2+"px",this.div.style.width=document.body.clientWidth-2+"px");this.table.style.width=document.body.clientWidth-2+"px";this.table.style.height=document.body.clientHeight-2+"px";null!=this.resize&&(this.resize.style.visibility="hidden");if(!mxClient.IS_IE){var h=mxUtils.getCurrentStyle(this.contentWrapper);if("auto"==h.overflow||null!=this.resize)this.contentWrapper.style.height=this.div.offsetHeight-this.title.offsetHeight-
2+"px"}this.fireEvent(new mxEventObject(mxEvent.MAXIMIZE,"event",g))}mxEvent.consume(g)}});mxEvent.addGestureListeners(this.maximize,f);mxEvent.addListener(this.title,"dblclick",f)};
mxWindow.prototype.installMoveHandler=function(){this.title.style.cursor="move";mxEvent.addGestureListeners(this.title,mxUtils.bind(this,function(a){var b=mxEvent.getClientX(a),c=mxEvent.getClientY(a),d=this.getX(),e=this.getY(),f=mxUtils.bind(this,function(h){var k=mxEvent.getClientX(h)-b,l=mxEvent.getClientY(h)-c;this.setLocation(d+k,e+l);this.fireEvent(new mxEventObject(mxEvent.MOVE,"event",h));mxEvent.consume(h)}),g=mxUtils.bind(this,function(h){mxEvent.removeGestureListeners(document,null,f,
g);this.fireEvent(new mxEventObject(mxEvent.MOVE_END,"event",h));mxEvent.consume(h)});mxEvent.addGestureListeners(document,null,f,g);this.fireEvent(new mxEventObject(mxEvent.MOVE_START,"event",a));mxEvent.consume(a)}));mxClient.IS_POINTER&&(this.title.style.msTouchAction="none")};mxWindow.prototype.setLocation=function(a,b){this.div.style.left=a+"px";this.div.style.top=b+"px"};mxWindow.prototype.getX=function(){return parseInt(this.div.style.left)};mxWindow.prototype.getY=function(){return parseInt(this.div.style.top)};
mxWindow.prototype.installCloseHandler=function(){this.closeImg=document.createElement("img");this.closeImg.setAttribute("src",this.closeImage);this.closeImg.setAttribute("align","right");this.closeImg.setAttribute("title","Close");this.closeImg.style.marginLeft="2px";this.closeImg.style.cursor="pointer";this.closeImg.style.display="none";this.title.insertBefore(this.closeImg,this.title.firstChild);mxEvent.addGestureListeners(this.closeImg,mxUtils.bind(this,function(a){this.fireEvent(new mxEventObject(mxEvent.CLOSE,
"event",a));this.destroyOnClose?this.destroy():this.setVisible(false);mxEvent.consume(a)}))};mxWindow.prototype.setImage=function(a){this.image=document.createElement("img");this.image.setAttribute("src",a);this.image.setAttribute("align","left");this.image.style.marginRight="4px";this.image.style.marginLeft="0px";this.image.style.marginTop="-2px";this.title.insertBefore(this.image,this.title.firstChild)};mxWindow.prototype.setClosable=function(a){this.closeImg.style.display=a?"":"none"};
mxWindow.prototype.isVisible=function(){return null!=this.div?"hidden"!=this.div.style.visibility:false};mxWindow.prototype.setVisible=function(a){null!=this.div&&this.isVisible()!=a&&(a?this.show():this.hide())};mxWindow.prototype.show=function(){this.div.style.visibility="";this.activate();var a=mxUtils.getCurrentStyle(this.contentWrapper);if(!mxClient.IS_IE&&("auto"==a.overflow||null!=this.resize))this.contentWrapper.style.height=this.div.offsetHeight-this.title.offsetHeight-2+"px";this.fireEvent(new mxEventObject(mxEvent.SHOW))};
mxWindow.prototype.hide=function(){this.div.style.visibility="hidden";this.fireEvent(new mxEventObject(mxEvent.HIDE))};mxWindow.prototype.destroy=function(){this.fireEvent(new mxEventObject(mxEvent.DESTROY));null!=this.div&&(mxEvent.release(this.div),this.div.parentNode.removeChild(this.div),this.div=null);this.contentWrapper=this.content=this.title=null};
function mxForm(a){this.table=document.createElement("table");this.table.className=a;this.body=document.createElement("tbody");this.table.appendChild(this.body)}mxForm.prototype.table=null;mxForm.prototype.body=false;mxForm.prototype.getTable=function(){return this.table};
mxForm.prototype.addButtons=function(a,b){var c=document.createElement("tr"),d=document.createElement("td");c.appendChild(d);d=document.createElement("td");var e=document.createElement("button");mxUtils.write(e,mxResources.get("ok")||"OK");d.appendChild(e);mxEvent.addListener(e,"click",function(){a()});e=document.createElement("button");mxUtils.write(e,mxResources.get("cancel")||"Cancel");d.appendChild(e);mxEvent.addListener(e,"click",function(){b()});c.appendChild(d);this.body.appendChild(c)};
mxForm.prototype.addText=function(a,b){var c=document.createElement("input");c.setAttribute("type","text");c.value=b;return this.addField(a,c)};mxForm.prototype.addCheckbox=function(a,b){var c=document.createElement("input");c.setAttribute("type","checkbox");this.addField(a,c);b&&(c.checked=true);return c};mxForm.prototype.addTextarea=function(a,b,c){var d=document.createElement("textarea");mxClient.IS_NS&&c--;d.setAttribute("rows",c||2);d.value=b;return this.addField(a,d)};
mxForm.prototype.addCombo=function(a,b,c){var d=document.createElement("select");null!=c&&d.setAttribute("size",c);b&&d.setAttribute("multiple","true");return this.addField(a,d)};mxForm.prototype.addOption=function(a,b,c,d){var e=document.createElement("option");mxUtils.writeln(e,b);e.setAttribute("value",c);d&&e.setAttribute("selected",d);a.appendChild(e)};
mxForm.prototype.addField=function(a,b){var c=document.createElement("tr"),d=document.createElement("td");mxUtils.write(d,a);c.appendChild(d);d=document.createElement("td");d.appendChild(b);c.appendChild(d);this.body.appendChild(c);return b};function mxImage(a,b,c){this.src=a;this.width=b;this.height=c}mxImage.prototype.src=null;mxImage.prototype.width=null;mxImage.prototype.height=null;
function mxDivResizer(a,b){if("div"==a.nodeName.toLowerCase()){null==b&&(b=window);this.div=a;var c=mxUtils.getCurrentStyle(a);null!=c&&(this.resizeWidth="auto"==c.width,this.resizeHeight="auto"==c.height);mxEvent.addListener(b,"resize",mxUtils.bind(this,function(){this.handlingResize||(this.handlingResize=true,this.resize(),this.handlingResize=false)}));this.resize()}}mxDivResizer.prototype.resizeWidth=true;mxDivResizer.prototype.resizeHeight=true;mxDivResizer.prototype.handlingResize=false;
mxDivResizer.prototype.resize=function(){var a=this.getDocumentWidth(),b=this.getDocumentHeight(),c=parseInt(this.div.style.left),d=parseInt(this.div.style.right),e=parseInt(this.div.style.top),f=parseInt(this.div.style.bottom);this.resizeWidth&&!isNaN(c)&&!isNaN(d)&&0<=c&&0<=d&&0<a-d-c&&(this.div.style.width=a-d-c+"px");this.resizeHeight&&!isNaN(e)&&!isNaN(f)&&0<=e&&0<=f&&0<b-e-f&&(this.div.style.height=b-e-f+"px")};mxDivResizer.prototype.getDocumentWidth=function(){return document.body.clientWidth};
mxDivResizer.prototype.getDocumentHeight=function(){return document.body.clientHeight};function mxDragSource(a,b){this.element=a;this.dropHandler=b;mxEvent.addGestureListeners(a,mxUtils.bind(this,this.mouseDown))}mxDragSource.prototype.element=null;mxDragSource.prototype.dropHandler=null;mxDragSource.prototype.dragOffset=null;mxDragSource.prototype.dragElement=null;mxDragSource.prototype.previewElement=null;mxDragSource.prototype.enabled=true;mxDragSource.prototype.currentGraph=null;
mxDragSource.prototype.currentDropTarget=null;mxDragSource.prototype.currentPoint=null;mxDragSource.prototype.currentGuide=null;mxDragSource.prototype.currentHighlight=null;mxDragSource.prototype.autoscroll=true;mxDragSource.prototype.guidesEnabled=true;mxDragSource.prototype.gridEnabled=true;mxDragSource.prototype.highlightDropTargets=true;mxDragSource.prototype.dragElementZIndex=100;mxDragSource.prototype.dragElementOpacity=70;mxDragSource.prototype.isEnabled=function(){return this.enabled};
mxDragSource.prototype.setEnabled=function(a){this.enabled=a};mxDragSource.prototype.isGuidesEnabled=function(){return this.guidesEnabled};mxDragSource.prototype.setGuidesEnabled=function(a){this.guidesEnabled=a};mxDragSource.prototype.isGridEnabled=function(){return this.gridEnabled};mxDragSource.prototype.setGridEnabled=function(a){this.gridEnabled=a};mxDragSource.prototype.getGraphForEvent=function(){return null};mxDragSource.prototype.getDropTarget=function(a,b,c){return a.getCellAt(b,c)};
mxDragSource.prototype.createDragElement=function(){return this.element.cloneNode(true)};mxDragSource.prototype.createPreviewElement=function(){return null};
mxDragSource.prototype.mouseDown=function(a){this.enabled&&!mxEvent.isConsumed(a)&&null==this.mouseMoveHandler&&(this.startDrag(a),this.mouseMoveHandler=mxUtils.bind(this,this.mouseMove),this.mouseUpHandler=mxUtils.bind(this,this.mouseUp),mxEvent.addGestureListeners(document,null,this.mouseMoveHandler,this.mouseUpHandler),mxEvent.consume(a,true,false))};
mxDragSource.prototype.startDrag=function(a){this.dragElement=this.createDragElement(a);this.dragElement.style.position="absolute";this.dragElement.style.zIndex=this.dragElementZIndex;mxUtils.setOpacity(this.dragElement,this.dragElementOpacity)};mxDragSource.prototype.stopDrag=function(){null!=this.dragElement&&(null!=this.dragElement.parentNode&&this.dragElement.parentNode.removeChild(this.dragElement),this.dragElement=null)};
mxDragSource.prototype.graphContainsEvent=function(a,b){var c=mxEvent.getClientX(b),d=mxEvent.getClientY(b),e=mxUtils.getOffset(a.container),f=mxUtils.getScrollOrigin();return c>=e.x-f.x&&d>=e.y-f.y&&c<=e.x-f.x+a.container.offsetWidth&&d<=e.y-f.y+a.container.offsetHeight};
mxDragSource.prototype.mouseMove=function(a){var b=this.getGraphForEvent(a);null!=b&&!this.graphContainsEvent(b,a)&&(b=null);b!=this.currentGraph&&(null!=this.currentGraph&&this.dragExit(this.currentGraph),this.currentGraph=b,null!=this.currentGraph&&this.dragEnter(this.currentGraph));null!=this.currentGraph&&this.dragOver(this.currentGraph,a);if(null!=this.dragElement&&(null==this.previewElement||"visible"!=this.previewElement.style.visibility)){b=mxEvent.getClientX(a);var c=mxEvent.getClientY(a);
null==this.dragElement.parentNode&&document.body.appendChild(this.dragElement);this.dragElement.style.visibility="visible";null!=this.dragOffset&&(b+=this.dragOffset.x,c+=this.dragOffset.y);b+=document.body.scrollLeft||document.documentElement.scrollLeft;c+=document.body.scrollTop||document.documentElement.scrollTop;this.dragElement.style.left=b+"px";this.dragElement.style.top=c+"px"}else null!=this.dragElement&&(this.dragElement.style.visibility="hidden");mxEvent.consume(a)};
mxDragSource.prototype.mouseUp=function(a){if(null!=this.currentGraph){if(null!=this.currentPoint&&(null==this.previewElement||"hidden"!=this.previewElement.style.visibility)){var b=this.currentGraph.view.scale,c=this.currentGraph.view.translate;this.drop(this.currentGraph,a,this.currentDropTarget,this.currentPoint.x/b-c.x,this.currentPoint.y/b-c.y)}this.dragExit(this.currentGraph)}this.stopDrag(a);mxEvent.removeGestureListeners(document,null,this.mouseMoveHandler,this.mouseUpHandler);this.currentGraph=
this.mouseUpHandler=this.mouseMoveHandler=null;mxEvent.consume(a)};mxDragSource.prototype.dragEnter=function(a){a.isMouseDown=true;this.previewElement=this.createPreviewElement(a);this.isGuidesEnabled()&&null!=this.previewElement&&(this.currentGuide=new mxGuide(a,a.graphHandler.getGuideStates()));this.highlightDropTargets&&(this.currentHighlight=new mxCellHighlight(a,mxConstants.DROP_TARGET_COLOR))};
mxDragSource.prototype.dragExit=function(a){this.currentPoint=this.currentDropTarget=null;a.isMouseDown=false;null!=this.previewElement&&(null!=this.previewElement.parentNode&&this.previewElement.parentNode.removeChild(this.previewElement),this.previewElement=null);null!=this.currentGuide&&(this.currentGuide.destroy(),this.currentGuide=null);null!=this.currentHighlight&&(this.currentHighlight.destroy(),this.currentHighlight=null)};
mxDragSource.prototype.dragOver=function(a,b){var c=mxUtils.getOffset(a.container),d=mxUtils.getScrollOrigin(a.container),e=mxEvent.getClientX(b)-c.x+d.x;c=mxEvent.getClientY(b)-c.y+d.y;a.autoScroll&&(null==this.autoscroll||this.autoscroll)&&a.scrollPointToVisible(e,c,a.autoExtend);null!=this.currentHighlight&&a.isDropEnabled()&&(this.currentDropTarget=this.getDropTarget(a,e,c),d=a.getView().getState(this.currentDropTarget),this.currentHighlight.highlight(d));if(null!=this.previewElement){null==this.previewElement.parentNode&&
(a.container.appendChild(this.previewElement),this.previewElement.style.zIndex="3",this.previewElement.style.position="absolute");d=this.isGridEnabled()&&a.isGridEnabledEvent(b);var f=true;if(null!=this.currentGuide&&this.currentGuide.isEnabledForEvent(b)){f=parseInt(this.previewElement.style.width);var g=parseInt(this.previewElement.style.height);f=new mxRectangle(0,0,f,g);c=new mxPoint(e,c);c=this.currentGuide.move(f,c,d);f=false;e=c.x;c=c.y}else if(d){d=a.view.scale;g=a.view.translate;var h=a.gridSize/
2;e=(a.snap(e/d-g.x-h)+g.x)*d;c=(a.snap(c/d-g.y-h)+g.y)*d}null!=this.currentGuide&&f&&this.currentGuide.hide();null!=this.previewOffset&&(e+=this.previewOffset.x,c+=this.previewOffset.y);this.previewElement.style.left=Math.round(e)+"px";this.previewElement.style.top=Math.round(c)+"px";this.previewElement.style.visibility="visible"}this.currentPoint=new mxPoint(e,c)};mxDragSource.prototype.drop=function(a,b,c,d,e){this.dropHandler(a,b,c,d,e);a.container.focus()};
function mxToolbar(a){this.container=a}mxToolbar.prototype=new mxEventSource;mxToolbar.prototype.constructor=mxToolbar;mxToolbar.prototype.container=null;mxToolbar.prototype.enabled=true;mxToolbar.prototype.noReset=false;mxToolbar.prototype.updateDefaultMode=true;
mxToolbar.prototype.addItem=function(a,b,c,d,e,f){var g=document.createElement(null!=b?"img":"button"),h=e||(null!=f?"mxToolbarMode":"mxToolbarItem");g.className=h;g.setAttribute("src",b);null!=a&&(null!=b?g.setAttribute("title",a):mxUtils.write(g,a));this.container.appendChild(g);null!=c&&(mxEvent.addListener(g,"click",c),mxClient.IS_TOUCH&&mxEvent.addListener(g,"touchend",c));a=mxUtils.bind(this,function(){null!=d?g.setAttribute("src",b):g.style.backgroundColor=""});mxEvent.addGestureListeners(g,
mxUtils.bind(this,function(k){null!=d?g.setAttribute("src",d):g.style.backgroundColor="gray";if(null!=f){null==this.menu&&(this.menu=new mxPopupMenu,this.menu.init());var l=this.currentImg;this.menu.isMenuShowing()&&this.menu.hideMenu();l!=g&&(this.currentImg=g,this.menu.factoryMethod=f,l=new mxPoint(g.offsetLeft,g.offsetTop+g.offsetHeight),this.menu.popup(l.x,l.y,null,k),this.menu.isMenuShowing()&&(g.className=h+"Selected",this.menu.hideMenu=function(){mxPopupMenu.prototype.hideMenu.apply(this);
g.className=h;this.currentImg=null}))}}),null,a);mxEvent.addListener(g,"mouseout",a);return g};mxToolbar.prototype.addCombo=function(a){var b=document.createElement("div");b.style.display="inline";b.className="mxToolbarComboContainer";var c=document.createElement("select");c.className=a||"mxToolbarCombo";b.appendChild(c);this.container.appendChild(b);return c};
mxToolbar.prototype.addActionCombo=function(a,b){var c=document.createElement("select");c.className=b||"mxToolbarCombo";this.addOption(c,a,null);mxEvent.addListener(c,"change",function(d){var e=c.options[c.selectedIndex];c.selectedIndex=0;null!=e.funct&&e.funct(d)});this.container.appendChild(c);return c};mxToolbar.prototype.addOption=function(a,b,c){var d=document.createElement("option");mxUtils.writeln(d,b);"function"==typeof c?d.funct=c:d.setAttribute("value",c);a.appendChild(d);return d};
mxToolbar.prototype.addSwitchMode=function(a,b,c,d,e){var f=document.createElement("img");f.initialClassName=e||"mxToolbarMode";f.className=f.initialClassName;f.setAttribute("src",b);f.altIcon=d;null!=a&&f.setAttribute("title",a);mxEvent.addListener(f,"click",mxUtils.bind(this,function(g){g=this.selectedMode.altIcon;null!=g?(this.selectedMode.altIcon=this.selectedMode.getAttribute("src"),this.selectedMode.setAttribute("src",g)):this.selectedMode.className=this.selectedMode.initialClassName;this.updateDefaultMode&&
(this.defaultMode=f);this.selectedMode=f;g=f.altIcon;null!=g?(f.altIcon=f.getAttribute("src"),f.setAttribute("src",g)):f.className=f.initialClassName+"Selected";this.fireEvent(new mxEventObject(mxEvent.SELECT));c()}));this.container.appendChild(f);null==this.defaultMode&&(this.defaultMode=f,this.selectMode(f),c());return f};
mxToolbar.prototype.addMode=function(a,b,c,d,e,f){f=null!=f?f:true;var g=document.createElement(null!=b?"img":"button");g.initialClassName=e||"mxToolbarMode";g.className=g.initialClassName;g.setAttribute("src",b);g.altIcon=d;null!=a&&g.setAttribute("title",a);this.enabled&&f&&(mxEvent.addListener(g,"click",mxUtils.bind(this,function(){this.selectMode(g,c);this.noReset=false})),mxEvent.addListener(g,"dblclick",mxUtils.bind(this,function(){this.selectMode(g,c);this.noReset=true})),null==this.defaultMode&&
(this.defaultMode=g,this.defaultFunction=c,this.selectMode(g,c)));this.container.appendChild(g);return g};
mxToolbar.prototype.selectMode=function(a,b){if(this.selectedMode!=a){if(null!=this.selectedMode){var c=this.selectedMode.altIcon;null!=c?(this.selectedMode.altIcon=this.selectedMode.getAttribute("src"),this.selectedMode.setAttribute("src",c)):this.selectedMode.className=this.selectedMode.initialClassName}this.selectedMode=a;c=this.selectedMode.altIcon;null!=c?(this.selectedMode.altIcon=this.selectedMode.getAttribute("src"),this.selectedMode.setAttribute("src",c)):this.selectedMode.className=this.selectedMode.initialClassName+
"Selected";this.fireEvent(new mxEventObject(mxEvent.SELECT,"function",b))}};mxToolbar.prototype.resetMode=function(a){(a||!this.noReset)&&this.selectedMode!=this.defaultMode&&this.selectMode(this.defaultMode,this.defaultFunction)};mxToolbar.prototype.addSeparator=function(a){return this.addItem(null,a,null)};mxToolbar.prototype.addBreak=function(){mxUtils.br(this.container)};
mxToolbar.prototype.addLine=function(){var a=document.createElement("hr");a.style.marginRight="6px";a.setAttribute("size","1");this.container.appendChild(a)};mxToolbar.prototype.destroy=function(){mxEvent.release(this.container);this.selectedMode=this.defaultFunction=this.defaultMode=this.container=null;null!=this.menu&&this.menu.destroy()};
function mxSession(a,b,c,d){this.model=a;this.urlInit=b;this.urlPoll=c;this.urlNotify=d;null!=a&&(this.codec=new mxCodec,this.codec.lookup=function(e){return a.getCell(e)});a.addListener(mxEvent.NOTIFY,mxUtils.bind(this,function(e,f){var g=f.getProperty("edit");(null!=g&&this.debug||this.connected&&!this.suspended)&&this.notify("<edit>"+this.encodeChanges(g.changes,g.undone)+"</edit>")}))}mxSession.prototype=new mxEventSource;mxSession.prototype.constructor=mxSession;mxSession.prototype.model=null;
mxSession.prototype.urlInit=null;mxSession.prototype.urlPoll=null;mxSession.prototype.urlNotify=null;mxSession.prototype.codec=null;mxSession.prototype.linefeed="&#xa;";mxSession.prototype.escapePostData=true;mxSession.prototype.significantRemoteChanges=true;mxSession.prototype.sent=0;mxSession.prototype.received=0;mxSession.prototype.debug=false;mxSession.prototype.connected=false;mxSession.prototype.suspended=false;mxSession.prototype.polling=false;
mxSession.prototype.start=function(){this.debug?(this.connected=true,this.fireEvent(new mxEventObject(mxEvent.CONNECT))):this.connected||this.get(this.urlInit,mxUtils.bind(this,function(){this.connected=true;this.fireEvent(new mxEventObject(mxEvent.CONNECT));this.poll()}))};mxSession.prototype.suspend=function(){this.connected&&!this.suspended&&(this.suspended=true,this.fireEvent(new mxEventObject(mxEvent.SUSPEND)))};
mxSession.prototype.resume=function(){this.connected&&this.suspended&&(this.suspended=false,this.fireEvent(new mxEventObject(mxEvent.RESUME)),this.polling||this.poll())};mxSession.prototype.stop=function(a){this.connected&&(this.connected=false);this.fireEvent(new mxEventObject(mxEvent.DISCONNECT,"reason",a))};mxSession.prototype.poll=function(){this.connected&&!this.suspended&&null!=this.urlPoll?(this.polling=true,this.get(this.urlPoll,mxUtils.bind(this,function(){this.poll()}))):this.polling=false};
mxSession.prototype.notify=function(a,b,c){null!=a&&0<a.length&&(null!=this.urlNotify&&(this.debug?(mxLog.show(),mxLog.debug("mxSession.notify: "+this.urlNotify+" xml="+a)):(a="<message><delta>"+a+"</delta></message>",this.escapePostData&&(a=encodeURIComponent(a)),mxUtils.post(this.urlNotify,"xml="+a,b,c))),this.sent+=a.length,this.fireEvent(new mxEventObject(mxEvent.NOTIFY,"url",this.urlNotify,"xml",a)))};
mxSession.prototype.get=function(a,b,c){if("undefined"!=typeof mxUtils){var d=mxUtils.bind(this,function(e){null!=c?c(e):this.stop(e)});mxUtils.get(a,mxUtils.bind(this,function(e){if("undefined"!=typeof mxUtils)if(e.isReady()&&404!=e.getStatus()){if(this.received+=e.getText().length,this.fireEvent(new mxEventObject(mxEvent.GET,"url",a,"request",e)),this.isValidResponse(e)){if(0<e.getText().length){var f=e.getDocumentElement();null==f?d("Invalid response: "+e.getText()):this.receive(f)}null!=b&&b(e)}}else d("Response not ready")}),
function(){d("Transmission error")})}};mxSession.prototype.isValidResponse=function(a){return 0>a.getText().indexOf("<?php")};mxSession.prototype.encodeChanges=function(a,b){for(var c="",d=b?-1:1,e=b?a.length-1:0;0<=e&&e<a.length;e+=d){var f=this.codec.encode(a[e]);c+=mxUtils.getXml(f,this.linefeed)}return c};
mxSession.prototype.receive=function(a){if(null!=a&&a.nodeType==mxConstants.NODETYPE_ELEMENT){var b=a.getAttribute("namespace");null!=b&&(this.model.prefix=b+"-");for(b=a.firstChild;null!=b;){var c=b.nodeName.toLowerCase();"state"==c?this.processState(b):"delta"==c&&this.processDelta(b);b=b.nextSibling}this.fireEvent(new mxEventObject(mxEvent.RECEIVE,"node",a))}};mxSession.prototype.processState=function(a){(new mxCodec(a.ownerDocument)).decode(a.firstChild,this.model)};
mxSession.prototype.processDelta=function(a){for(a=a.firstChild;null!=a;){"edit"==a.nodeName&&this.processEdit(a);a=a.nextSibling}};mxSession.prototype.processEdit=function(a){a=this.decodeChanges(a);if(0<a.length){var b=this.createUndoableEdit(a);this.model.fireEvent(new mxEventObject(mxEvent.CHANGE,"edit",b,"changes",a));this.model.fireEvent(new mxEventObject(mxEvent.UNDO,"edit",b));this.fireEvent(new mxEventObject(mxEvent.FIRED,"edit",b))}};
mxSession.prototype.createUndoableEdit=function(a){var b=new mxUndoableEdit(this.model,this.significantRemoteChanges);b.changes=a;b.notify=function(){b.source.fireEvent(new mxEventObject(mxEvent.CHANGE,"edit",b,"changes",b.changes));b.source.fireEvent(new mxEventObject(mxEvent.NOTIFY,"edit",b,"changes",b.changes))};return b};mxSession.prototype.decodeChanges=function(a){this.codec.document=a.ownerDocument;var b=[];for(a=a.firstChild;null!=a;){var c=this.decodeChange(a);null!=c&&b.push(c);a=a.nextSibling}return b};
mxSession.prototype.decodeChange=function(a){var b=null;a.nodeType==mxConstants.NODETYPE_ELEMENT&&(b="mxRootChange"==a.nodeName?(new mxCodec(a.ownerDocument)).decode(a):this.codec.decode(a),null!=b&&(b.model=this.model,b.execute(),"mxChildChange"==a.nodeName&&null==b.parent&&this.cellRemoved(b.child)));return b};mxSession.prototype.cellRemoved=function(a){this.codec.putObject(a.getId(),a);for(var b=this.model.getChildCount(a),c=0;c<b;c++)this.cellRemoved(this.model.getChildAt(a,c))};
function mxUndoableEdit(a,b){this.source=a;this.changes=[];this.significant=null!=b?b:true}mxUndoableEdit.prototype.source=null;mxUndoableEdit.prototype.changes=null;mxUndoableEdit.prototype.significant=null;mxUndoableEdit.prototype.undone=false;mxUndoableEdit.prototype.redone=false;mxUndoableEdit.prototype.isEmpty=function(){return 0==this.changes.length};mxUndoableEdit.prototype.isSignificant=function(){return this.significant};mxUndoableEdit.prototype.add=function(a){this.changes.push(a)};
mxUndoableEdit.prototype.notify=function(){};mxUndoableEdit.prototype.die=function(){};mxUndoableEdit.prototype.undo=function(){if(!this.undone){this.source.fireEvent(new mxEventObject(mxEvent.START_EDIT));for(var a=this.changes.length-1;0<=a;a--){var b=this.changes[a];null!=b.execute?b.execute():null!=b.undo&&b.undo();this.source.fireEvent(new mxEventObject(mxEvent.EXECUTED,"change",b))}this.undone=true;this.redone=false;this.source.fireEvent(new mxEventObject(mxEvent.END_EDIT))}this.notify()};
mxUndoableEdit.prototype.redo=function(){if(!this.redone){this.source.fireEvent(new mxEventObject(mxEvent.START_EDIT));for(var a=this.changes.length,b=0;b<a;b++){var c=this.changes[b];null!=c.execute?c.execute():null!=c.redo&&c.redo();this.source.fireEvent(new mxEventObject(mxEvent.EXECUTED,"change",c))}this.undone=false;this.redone=true;this.source.fireEvent(new mxEventObject(mxEvent.END_EDIT))}this.notify()};function mxUndoManager(a){this.size=null!=a?a:100;this.clear()}
mxUndoManager.prototype=new mxEventSource;mxUndoManager.prototype.constructor=mxUndoManager;mxUndoManager.prototype.size=null;mxUndoManager.prototype.history=null;mxUndoManager.prototype.indexOfNextAdd=0;mxUndoManager.prototype.isEmpty=function(){return 0==this.history.length};mxUndoManager.prototype.clear=function(){this.history=[];this.indexOfNextAdd=0;this.fireEvent(new mxEventObject(mxEvent.CLEAR))};mxUndoManager.prototype.canUndo=function(){return 0<this.indexOfNextAdd};
mxUndoManager.prototype.undo=function(){for(;0<this.indexOfNextAdd;){var a=this.history[--this.indexOfNextAdd];a.undo();if(a.isSignificant()){this.fireEvent(new mxEventObject(mxEvent.UNDO,"edit",a));break}}};mxUndoManager.prototype.canRedo=function(){return this.indexOfNextAdd<this.history.length};
mxUndoManager.prototype.redo=function(){for(var a=this.history.length;this.indexOfNextAdd<a;){var b=this.history[this.indexOfNextAdd++];b.redo();if(b.isSignificant()){this.fireEvent(new mxEventObject(mxEvent.REDO,"edit",b));break}}};mxUndoManager.prototype.undoableEditHappened=function(a){this.trim();0<this.size&&this.size==this.history.length&&this.history.shift();this.history.push(a);this.indexOfNextAdd=this.history.length;this.fireEvent(new mxEventObject(mxEvent.ADD,"edit",a))};
mxUndoManager.prototype.trim=function(){if(this.history.length>this.indexOfNextAdd)for(var a=this.history.splice(this.indexOfNextAdd,this.history.length-this.indexOfNextAdd),b=0;b<a.length;b++)a[b].die()};
var mxUrlConverter=function(){var a=true,b=null,c=null;return{isEnabled:function(){return a},setEnabled:function(d){a=d},getBaseUrl:function(){return b},setBaseUrl:function(d){b=d},getBaseDomain:function(){return b},setBaseDomain:function(d){b=d},isRelativeUrl:function(d){return"http://"!=d.substring(0,7)&&"https://"!=d.substring(0,8)&&"data:image"!=d.substring(0,10)},convert:function(d){if(a&&this.isRelativeUrl(d)){if(null==b){c=location.protocol+"//"+location.host;b=c+location.pathname;var e=b.lastIndexOf("/");
0<e&&(b=b.substring(0,e+1))}d="/"==d.charAt(0)?c+d:b+d}return d}}};
function mxPanningManager(a){this.thread=null;this.active=false;this.dy=this.dx=this.t0y=this.t0x=this.tdy=this.tdx=0;this.scrollbars=false;this.scrollTop=this.scrollLeft=0;this.mouseListener={mouseDown:function(){},mouseMove:function(){},mouseUp:mxUtils.bind(this,function(){this.active&&this.stop()})};a.addMouseListener(this.mouseListener);mxEvent.addListener(document,"mouseup",mxUtils.bind(this,function(){this.active&&this.stop()}));var b=mxUtils.bind(this,function(){this.scrollbars=mxUtils.hasScrollbars(a.container);
this.scrollLeft=a.container.scrollLeft;this.scrollTop=a.container.scrollTop;return window.setInterval(mxUtils.bind(this,function(){this.tdx-=this.dx;this.tdy-=this.dy;if(this.scrollbars){a.panGraph(-a.container.scrollLeft-Math.ceil(this.dx),-a.container.scrollTop-Math.ceil(this.dy));a.panDx=this.scrollLeft-a.container.scrollLeft;a.panDy=this.scrollTop-a.container.scrollTop;a.fireEvent(new mxEventObject(mxEvent.PAN))}else a.panGraph(this.getDx(),this.getDy())}),this.delay)});this.isActive=function(){return active};
this.getDx=function(){return Math.round(this.tdx)};this.getDy=function(){return Math.round(this.tdy)};this.start=function(){this.t0x=a.view.translate.x;this.t0y=a.view.translate.y;this.active=true};this.panTo=function(c,d,e,f){this.active||this.start();this.scrollLeft=a.container.scrollLeft;this.scrollTop=a.container.scrollTop;var g=a.container;this.dx=c+(null!=e?e:0)-g.scrollLeft-g.clientWidth;0>this.dx&&Math.abs(this.dx)<this.border?this.dx=this.border+this.dx:this.dx=this.handleMouseOut?Math.max(this.dx,
0):0;0==this.dx&&(this.dx=c-g.scrollLeft,this.dx=0<this.dx&&this.dx<this.border?this.dx-this.border:this.handleMouseOut?Math.min(0,this.dx):0);this.dy=d+(null!=f?f:0)-g.scrollTop-g.clientHeight;0>this.dy&&Math.abs(this.dy)<this.border?this.dy=this.border+this.dy:this.dy=this.handleMouseOut?Math.max(this.dy,0):0;0==this.dy&&(this.dy=d-g.scrollTop,this.dy=0<this.dy&&this.dy<this.border?this.dy-this.border:this.handleMouseOut?Math.min(0,this.dy):0);0!=this.dx||0!=this.dy?(this.dx*=this.damper,this.dy*=
this.damper,null==this.thread&&(this.thread=b())):null!=this.thread&&(window.clearInterval(this.thread),this.thread=null)};this.stop=function(){if(this.active)if(this.active=false,null!=this.thread&&(window.clearInterval(this.thread),this.thread=null),this.tdy=this.tdx=0,this.scrollbars){a.panDx=0;a.panDy=0;a.fireEvent(new mxEventObject(mxEvent.PAN))}else{var c=a.panDx,d=a.panDy;if(0!=c||0!=d){a.panGraph(0,0);a.view.setTranslate(this.t0x+c/a.view.scale,this.t0y+d/a.view.scale)}}};this.destroy=function(){a.removeMouseListener(this.mouseListener)}}
mxPanningManager.prototype.damper=1/6;mxPanningManager.prototype.delay=10;mxPanningManager.prototype.handleMouseOut=true;mxPanningManager.prototype.border=0;function mxPopupMenu(a){this.factoryMethod=a;null!=a&&this.init()}mxPopupMenu.prototype=new mxEventSource;mxPopupMenu.prototype.constructor=mxPopupMenu;mxPopupMenu.prototype.submenuImage=mxClient.imageBasePath+"/submenu.gif";mxPopupMenu.prototype.zIndex=10006;mxPopupMenu.prototype.factoryMethod=null;
mxPopupMenu.prototype.useLeftButtonForPopup=false;mxPopupMenu.prototype.enabled=true;mxPopupMenu.prototype.itemCount=0;mxPopupMenu.prototype.autoExpand=false;mxPopupMenu.prototype.smartSeparators=false;mxPopupMenu.prototype.labels=true;
mxPopupMenu.prototype.init=function(){this.table=document.createElement("table");this.table.className="mxPopupMenu";this.tbody=document.createElement("tbody");this.table.appendChild(this.tbody);this.div=document.createElement("div");this.div.className="mxPopupMenu";this.div.style.display="inline";this.div.style.zIndex=this.zIndex;this.div.appendChild(this.table);mxEvent.disableContextMenu(this.div)};mxPopupMenu.prototype.isEnabled=function(){return this.enabled};
mxPopupMenu.prototype.setEnabled=function(a){this.enabled=a};mxPopupMenu.prototype.isPopupTrigger=function(a){return a.isPopupTrigger()||this.useLeftButtonForPopup&&mxEvent.isLeftMouseButton(a.getEvent())};
mxPopupMenu.prototype.addItem=function(a,b,c,d,e,f){d=d||this;this.itemCount++;d.willAddSeparator&&(d.containsItems&&this.addSeparator(d,true),d.willAddSeparator=false);d.containsItems=true;var g=document.createElement("tr");g.className="mxPopupMenuItem";var h=document.createElement("td");h.className="mxPopupMenuIcon";null!=b?(e=document.createElement("img"),e.src=b,h.appendChild(e)):null!=e&&(b=document.createElement("div"),b.className=e,h.appendChild(b));g.appendChild(h);this.labels&&(h=document.createElement("td"),
h.className="mxPopupMenuItem"+(null!=f&&!f?" disabled":""),mxUtils.write(h,a),h.align="left",g.appendChild(h),a=document.createElement("td"),a.className="mxPopupMenuItem"+(null!=f&&!f?" disabled":""),a.style.paddingRight="6px",a.style.textAlign="right",g.appendChild(a),null==d.div&&this.createSubmenu(d));d.tbody.appendChild(g);if(null==f||f){mxEvent.addGestureListeners(g,mxUtils.bind(this,function(k){this.eventReceiver=g;d.activeRow!=g&&d.activeRow!=d&&(null!=d.activeRow&&null!=d.activeRow.div.parentNode&&
this.hideSubmenu(d),null!=g.div&&(this.showSubmenu(d,g),d.activeRow=g));mxEvent.consume(k)}),mxUtils.bind(this,function(){d.activeRow!=g&&d.activeRow!=d&&(null!=d.activeRow&&null!=d.activeRow.div.parentNode&&this.hideSubmenu(d),this.autoExpand&&null!=g.div&&(this.showSubmenu(d,g),d.activeRow=g));g.className="mxPopupMenuItemHover"}),mxUtils.bind(this,function(k){this.eventReceiver==g&&(d.activeRow!=g&&this.hideMenu(),null!=c&&c(k));this.eventReceiver=null;mxEvent.consume(k)}));mxEvent.addListener(g,
"mouseout",mxUtils.bind(this,function(){g.className="mxPopupMenuItem"}))}return g};
mxPopupMenu.prototype.createSubmenu=function(a){a.table=document.createElement("table");a.table.className="mxPopupMenu";a.tbody=document.createElement("tbody");a.table.appendChild(a.tbody);a.div=document.createElement("div");a.div.className="mxPopupMenu";a.div.style.position="absolute";a.div.style.display="inline";a.div.style.zIndex=this.zIndex;a.div.appendChild(a.table);var b=document.createElement("img");b.setAttribute("src",this.submenuImage);td=a.firstChild.nextSibling.nextSibling;td.appendChild(b)};
mxPopupMenu.prototype.showSubmenu=function(a,b){if(null!=b.div){b.div.style.left=a.div.offsetLeft+b.offsetLeft+b.offsetWidth-1+"px";b.div.style.top=a.div.offsetTop+b.offsetTop+"px";document.body.appendChild(b.div);var c=parseInt(b.div.offsetLeft),d=parseInt(b.div.offsetWidth),e=document.body,f=document.documentElement;if(c+d>(e.scrollLeft||f.scrollLeft)+(e.clientWidth||f.clientWidth))b.div.style.left=a.div.offsetLeft-d+(mxClient.IS_IE?6:-6)+"px";mxUtils.fit(b.div)}};
mxPopupMenu.prototype.addSeparator=function(a,b){a=a||this;if(this.smartSeparators&&!b)a.willAddSeparator=true;else if(null!=a.tbody){a.willAddSeparator=false;var c=document.createElement("tr"),d=document.createElement("td");d.className="mxPopupMenuIcon";d.style.padding="0 0 0 0px";c.appendChild(d);d=document.createElement("td");d.style.padding="0 0 0 0px";d.setAttribute("colSpan","2");var e=document.createElement("hr");e.setAttribute("size","1");d.appendChild(e);c.appendChild(d);a.tbody.appendChild(c)}};
mxPopupMenu.prototype.popup=function(a,b,c,d){if(null!=this.div&&null!=this.tbody&&null!=this.factoryMethod){this.div.style.left=a+"px";for(this.div.style.top=b+"px";null!=this.tbody.firstChild;){mxEvent.release(this.tbody.firstChild);this.tbody.removeChild(this.tbody.firstChild)}this.itemCount=0;this.factoryMethod(this,c,d);0<this.itemCount&&(this.showMenu(),this.fireEvent(new mxEventObject(mxEvent.SHOW)))}};
mxPopupMenu.prototype.isMenuShowing=function(){return null!=this.div&&this.div.parentNode==document.body};mxPopupMenu.prototype.showMenu=function(){9<=document.documentMode&&(this.div.style.filter="none");document.body.appendChild(this.div);mxUtils.fit(this.div)};mxPopupMenu.prototype.hideMenu=function(){null!=this.div&&(null!=this.div.parentNode&&this.div.parentNode.removeChild(this.div),this.hideSubmenu(this),this.containsItems=false)};
mxPopupMenu.prototype.hideSubmenu=function(a){null!=a.activeRow&&(this.hideSubmenu(a.activeRow),null!=a.activeRow.div.parentNode&&a.activeRow.div.parentNode.removeChild(a.activeRow.div),a.activeRow=null)};mxPopupMenu.prototype.destroy=function(){null!=this.div&&(mxEvent.release(this.div),null!=this.div.parentNode&&this.div.parentNode.removeChild(this.div),this.div=null)};
function mxAutoSaveManager(a){this.changeHandler=mxUtils.bind(this,function(b,c){this.isEnabled()&&this.graphModelChanged(c.getProperty("edit").changes)});this.setGraph(a)}mxAutoSaveManager.prototype=new mxEventSource;mxAutoSaveManager.prototype.constructor=mxAutoSaveManager;mxAutoSaveManager.prototype.graph=null;mxAutoSaveManager.prototype.autoSaveDelay=10;mxAutoSaveManager.prototype.autoSaveThrottle=2;mxAutoSaveManager.prototype.autoSaveThreshold=5;mxAutoSaveManager.prototype.ignoredChanges=0;
mxAutoSaveManager.prototype.lastSnapshot=0;mxAutoSaveManager.prototype.enabled=true;mxAutoSaveManager.prototype.changeHandler=null;mxAutoSaveManager.prototype.isEnabled=function(){return this.enabled};mxAutoSaveManager.prototype.setEnabled=function(a){this.enabled=a};mxAutoSaveManager.prototype.setGraph=function(a){null!=this.graph&&this.graph.getModel().removeListener(this.changeHandler);this.graph=a;null!=this.graph&&this.graph.getModel().addListener(mxEvent.CHANGE,this.changeHandler)};
mxAutoSaveManager.prototype.save=function(){};mxAutoSaveManager.prototype.graphModelChanged=function(a){a=((new Date).getTime()-this.lastSnapshot)/1E3;a>this.autoSaveDelay||this.ignoredChanges>=this.autoSaveThreshold&&a>this.autoSaveThrottle?(this.save(),this.reset()):this.ignoredChanges++};mxAutoSaveManager.prototype.reset=function(){this.lastSnapshot=(new Date).getTime();this.ignoredChanges=0};mxAutoSaveManager.prototype.destroy=function(){this.setGraph(null)};
function mxAnimation(a){this.delay=null!=a?a:20}mxAnimation.prototype=new mxEventSource;mxAnimation.prototype.constructor=mxAnimation;mxAnimation.prototype.delay=null;mxAnimation.prototype.thread=null;mxAnimation.prototype.startAnimation=function(){null==this.thread&&(this.thread=window.setInterval(mxUtils.bind(this,this.updateAnimation),this.delay))};mxAnimation.prototype.updateAnimation=function(){this.fireEvent(new mxEventObject(mxEvent.EXECUTE))};
mxAnimation.prototype.stopAnimation=function(){null!=this.thread&&(window.clearInterval(this.thread),this.thread=null,this.fireEvent(new mxEventObject(mxEvent.DONE)))};function mxMorphing(a,b,c,d){mxAnimation.call(this,d);this.graph=a;this.steps=null!=b?b:6;this.ease=null!=c?c:1.5}mxMorphing.prototype=new mxAnimation;mxMorphing.prototype.constructor=mxMorphing;mxMorphing.prototype.graph=null;mxMorphing.prototype.steps=null;mxMorphing.prototype.step=0;mxMorphing.prototype.ease=null;
mxMorphing.prototype.cells=null;mxMorphing.prototype.updateAnimation=function(){var a=new mxCellStatePreview(this.graph);if(null!=this.cells)for(var b=0;b<this.cells.length;b++)this.animateCell(cells[b],a,false);else this.animateCell(this.graph.getModel().getRoot(),a,true);this.show(a);(a.isEmpty()||this.step++>=this.steps)&&this.stopAnimation()};mxMorphing.prototype.show=function(a){a.show()};
mxMorphing.prototype.animateCell=function(a,b,c){var d=this.graph.getView().getState(a),e=null;if(null!=d&&(e=this.getDelta(d),this.graph.getModel().isVertex(a)&&(0!=e.x||0!=e.y))){var f=this.graph.view.getTranslate(),g=this.graph.view.getScale();e.x+=f.x*g;e.y+=f.y*g;b.moveState(d,-e.x/this.ease,-e.y/this.ease)}if(c&&!this.stopRecursion(d,e)){d=this.graph.getModel().getChildCount(a);for(e=0;e<d;e++)this.animateCell(this.graph.getModel().getChildAt(a,e),b,c)}};
mxMorphing.prototype.stopRecursion=function(a,b){return null!=b&&(0!=b.x||0!=b.y)};mxMorphing.prototype.getDelta=function(a){var b=this.getOriginForCell(a.cell),c=this.graph.getView().getTranslate(),d=this.graph.getView().getScale();a=new mxPoint(a.x/d-c.x,a.y/d-c.y);return new mxPoint((b.x-a.x)*d,(b.y-a.y)*d)};
mxMorphing.prototype.getOriginForCell=function(a){var b=null;null!=a&&(b=this.getOriginForCell(this.graph.getModel().getParent(a)),a=this.graph.getCellGeometry(a),null!=a&&(b.x+=a.x,b.y+=a.y));null==b&&(b=this.graph.view.getTranslate(),b=new mxPoint(-b.x,-b.y));return b};function mxImageBundle(a){this.images=[];this.alt=null!=a?a:false}mxImageBundle.prototype.images=null;mxImageBundle.prototype.images=null;mxImageBundle.prototype.putImage=function(a,b,c){this.images[a]={value:b,fallback:c}};
mxImageBundle.prototype.getImage=function(a){var b=null;null!=a&&(a=this.images[a],null!=a&&(b=this.alt?a.fallback:a.value));return b};function mxImageExport(){}mxImageExport.prototype.includeOverlays=false;mxImageExport.prototype.drawState=function(a,b){null!=a&&(this.visitStatesRecursive(a,b,this.drawCellState),this.includeOverlays&&this.visitStatesRecursive(a,b,this.drawOverlays))};
mxImageExport.prototype.visitStatesRecursive=function(a,b,c){if(null!=a){c(a,b);for(var d=a.view.graph,e=d.model.getChildCount(a.cell),f=0;f<e;f++)this.visitStatesRecursive(d.view.getState(d.model.getChildAt(a.cell,f)),b,c)}};mxImageExport.prototype.drawCellState=function(a,b){a.shape instanceof mxShape&&(b.save(),a.shape.paint(b),b.restore());null!=a.text&&(b.save(),a.text.paint(b),b.restore())};
mxImageExport.prototype.drawOverlays=function(a,b){null!=a.overlays&&a.overlays.visit(function(c,d){d instanceof mxShape&&d.paint(b)})};function mxAbstractCanvas2D(){this.converter=this.createUrlConverter();this.reset()}mxAbstractCanvas2D.prototype.state=null;mxAbstractCanvas2D.prototype.states=null;mxAbstractCanvas2D.prototype.path=null;mxAbstractCanvas2D.prototype.rotateHtml=true;mxAbstractCanvas2D.prototype.lastX=0;mxAbstractCanvas2D.prototype.lastY=0;mxAbstractCanvas2D.prototype.moveOp="M";
mxAbstractCanvas2D.prototype.lineOp="L";mxAbstractCanvas2D.prototype.quadOp="Q";mxAbstractCanvas2D.prototype.curveOp="C";mxAbstractCanvas2D.prototype.closeOp="Z";mxAbstractCanvas2D.prototype.pointerEvents=false;mxAbstractCanvas2D.prototype.createUrlConverter=function(){return new mxUrlConverter};mxAbstractCanvas2D.prototype.reset=function(){this.state=this.createState();this.states=[]};
mxAbstractCanvas2D.prototype.createState=function(){return{dx:0,dy:0,scale:1,alpha:1,fillColor:null,fillAlpha:1,gradientColor:null,gradientAlpha:1,gradientDirection:null,strokeColor:null,strokeWidth:1,dashed:false,dashPattern:"3 3",lineCap:"flat",lineJoin:"miter",miterLimit:10,fontColor:"#000000",fontBackgroundColor:null,fontBorderColor:null,fontSize:mxConstants.DEFAULT_FONTSIZE,fontFamily:mxConstants.DEFAULT_FONTFAMILY,fontStyle:0,shadow:false,shadowColor:mxConstants.SHADOWCOLOR,shadowAlpha:mxConstants.SHADOW_OPACITY,
shadowDx:mxConstants.SHADOW_OFFSET_X,shadowDy:mxConstants.SHADOW_OFFSET_Y,rotation:0,rotationCx:0,rotationCy:0}};mxAbstractCanvas2D.prototype.format=function(a){return Math.round(parseFloat(a))};
mxAbstractCanvas2D.prototype.addOp=function(){if(null!=this.path&&(this.path.push(arguments[0]),2<arguments.length))for(var a=this.state,b=2;b<arguments.length;b+=2){this.lastX=arguments[b-1];this.lastY=arguments[b];this.path.push(this.format((this.lastX+a.dx)*a.scale));this.path.push(this.format((this.lastY+a.dy)*a.scale))}};mxAbstractCanvas2D.prototype.rotatePoint=function(a,b,c,d,e){c*=Math.PI/180;return mxUtils.getRotatedPoint(new mxPoint(a,b),Math.cos(c),Math.sin(c),new mxPoint(d,e))};
mxAbstractCanvas2D.prototype.save=function(){this.states.push(this.state);this.state=mxUtils.clone(this.state)};mxAbstractCanvas2D.prototype.restore=function(){this.state=this.states.pop()};mxAbstractCanvas2D.prototype.scale=function(a){this.state.scale*=a;this.state.strokeWidth*=a};mxAbstractCanvas2D.prototype.translate=function(a,b){this.state.dx+=a;this.state.dy+=b};mxAbstractCanvas2D.prototype.setAlpha=function(a){this.state.alpha=a};
mxAbstractCanvas2D.prototype.setFillColor=function(a){a==mxConstants.NONE&&(a=null);this.state.fillColor=a;this.state.gradientColor=null};mxAbstractCanvas2D.prototype.setGradient=function(a,b,c,d,e,f,g,h,k){c=this.state;c.fillColor=a;c.fillAlpha=null!=h?h:1;c.gradientColor=b;c.gradientAlpha=null!=k?k:1;c.gradientDirection=g};mxAbstractCanvas2D.prototype.setStrokeColor=function(a){a==mxConstants.NONE&&(a=null);this.state.strokeColor=a};
mxAbstractCanvas2D.prototype.setStrokeWidth=function(a){this.state.strokeWidth=a};mxAbstractCanvas2D.prototype.setDashed=function(a){this.state.dashed=a};mxAbstractCanvas2D.prototype.setDashPattern=function(a){this.state.dashPattern=a};mxAbstractCanvas2D.prototype.setLineCap=function(a){this.state.lineCap=a};mxAbstractCanvas2D.prototype.setLineJoin=function(a){this.state.lineJoin=a};mxAbstractCanvas2D.prototype.setMiterLimit=function(a){this.state.miterLimit=a};
mxAbstractCanvas2D.prototype.setFontColor=function(a){a==mxConstants.NONE&&(a=null);this.state.fontColor=a};mxAbstractCanvas2D.prototype.setFontBackgroundColor=function(a){a==mxConstants.NONE&&(a=null);this.state.fontBackgroundColor=a};mxAbstractCanvas2D.prototype.setFontBorderColor=function(a){a==mxConstants.NONE&&(a=null);this.state.fontBorderColor=a};mxAbstractCanvas2D.prototype.setFontSize=function(a){this.state.fontSize=a};
mxAbstractCanvas2D.prototype.setFontFamily=function(a){this.state.fontFamily=a};mxAbstractCanvas2D.prototype.setFontStyle=function(a){null==a&&(a=0);this.state.fontStyle=a};mxAbstractCanvas2D.prototype.setShadow=function(a){this.state.shadow=a};mxAbstractCanvas2D.prototype.setShadowColor=function(a){a==mxConstants.NONE&&(a=null);this.state.shadowColor=a};mxAbstractCanvas2D.prototype.setShadowAlpha=function(a){this.state.shadowAlpha=a};
mxAbstractCanvas2D.prototype.setShadowOffset=function(a,b){this.state.shadowDx=a;this.state.shadowDy=b};mxAbstractCanvas2D.prototype.begin=function(){this.lastY=this.lastX=0;this.path=[]};mxAbstractCanvas2D.prototype.moveTo=function(a,b){this.addOp(this.moveOp,a,b)};mxAbstractCanvas2D.prototype.lineTo=function(a,b){this.addOp(this.lineOp,a,b)};mxAbstractCanvas2D.prototype.quadTo=function(a,b,c,d){this.addOp(this.quadOp,a,b,c,d)};
mxAbstractCanvas2D.prototype.curveTo=function(a,b,c,d,e,f){this.addOp(this.curveOp,a,b,c,d,e,f)};mxAbstractCanvas2D.prototype.arcTo=function(a,b,c,d,e,f,g){a=mxUtils.arcToCurves(this.lastX,this.lastY,a,b,c,d,e,f,g);for(b=0;b<a.length;b+=6)this.curveTo(a[b],a[b+1],a[b+2],a[b+3],a[b+4],a[b+5])};mxAbstractCanvas2D.prototype.close=function(){this.addOp(this.closeOp)};mxAbstractCanvas2D.prototype.end=function(){};
function mxXmlCanvas2D(a){mxAbstractCanvas2D.call(this);this.root=a;this.writeDefaults()}mxUtils.extend(mxXmlCanvas2D,mxAbstractCanvas2D);mxXmlCanvas2D.prototype.textEnabled=true;mxXmlCanvas2D.prototype.compressed=true;
mxXmlCanvas2D.prototype.writeDefaults=function(){var a;a=this.createElement("fontfamily");a.setAttribute("family",mxConstants.DEFAULT_FONTFAMILY);this.root.appendChild(a);a=this.createElement("fontsize");a.setAttribute("size",mxConstants.DEFAULT_FONTSIZE);this.root.appendChild(a);a=this.createElement("shadowcolor");a.setAttribute("color",mxConstants.SHADOWCOLOR);this.root.appendChild(a);a=this.createElement("shadowalpha");a.setAttribute("alpha",mxConstants.SHADOW_OPACITY);this.root.appendChild(a);
a=this.createElement("shadowoffset");a.setAttribute("dx",mxConstants.SHADOW_OFFSET_X);a.setAttribute("dy",mxConstants.SHADOW_OFFSET_Y);this.root.appendChild(a)};mxXmlCanvas2D.prototype.format=function(a){return parseFloat(parseFloat(a).toFixed(2))};mxXmlCanvas2D.prototype.createElement=function(a){return this.root.ownerDocument.createElement(a)};mxXmlCanvas2D.prototype.save=function(){this.compressed&&mxAbstractCanvas2D.prototype.save.apply(this,arguments);this.root.appendChild(this.createElement("save"))};
mxXmlCanvas2D.prototype.restore=function(){this.compressed&&mxAbstractCanvas2D.prototype.restore.apply(this,arguments);this.root.appendChild(this.createElement("restore"))};mxXmlCanvas2D.prototype.scale=function(a){if(this.compressed){if(this.state.scale==a)return;mxAbstractCanvas2D.prototype.setAlpha.apply(this,arguments)}var b=this.createElement("scale");b.setAttribute("scale",a);this.root.appendChild(b)};
mxXmlCanvas2D.prototype.translate=function(a,b){var c=this.createElement("translate");c.setAttribute("dx",this.format(a));c.setAttribute("dy",this.format(b));this.root.appendChild(c)};mxXmlCanvas2D.prototype.rotate=function(a,b,c,d,e){var f=this.createElement("rotate");if(0!=a||b||c){f.setAttribute("theta",this.format(a));f.setAttribute("flipH",b?"1":"0");f.setAttribute("flipV",c?"1":"0");f.setAttribute("cx",this.format(d));f.setAttribute("cy",this.format(e));this.root.appendChild(f)}};
mxXmlCanvas2D.prototype.setAlpha=function(a){if(this.compressed){if(this.state.alpha==a)return;mxAbstractCanvas2D.prototype.setAlpha.apply(this,arguments)}var b=this.createElement("alpha");b.setAttribute("alpha",this.format(a));this.root.appendChild(b)};
mxXmlCanvas2D.prototype.setFillColor=function(a){a==mxConstants.NONE&&(a=null);if(this.compressed){if(this.state.fillColor==a)return;mxAbstractCanvas2D.prototype.setFillColor.apply(this,arguments)}var b=this.createElement("fillcolor");b.setAttribute("color",null!=a?a:mxConstants.NONE);this.root.appendChild(b)};
mxXmlCanvas2D.prototype.setGradient=function(a,b,c,d,e,f,g,h,k){if(null!=a&&null!=b){mxAbstractCanvas2D.prototype.setGradient.apply(this,arguments);var l=this.createElement("gradient");l.setAttribute("c1",a);l.setAttribute("c2",b);l.setAttribute("x",this.format(c));l.setAttribute("y",this.format(d));l.setAttribute("w",this.format(e));l.setAttribute("h",this.format(f));null!=g&&l.setAttribute("direction",g);null!=h&&l.setAttribute("alpha1",h);null!=k&&l.setAttribute("alpha2",k);this.root.appendChild(l)}};
mxXmlCanvas2D.prototype.setStrokeColor=function(a){a==mxConstants.NONE&&(a=null);if(this.compressed){if(this.state.strokeColor==a)return;mxAbstractCanvas2D.prototype.setStrokeColor.apply(this,arguments)}var b=this.createElement("strokecolor");b.setAttribute("color",null!=a?a:mxConstants.NONE);this.root.appendChild(b)};
mxXmlCanvas2D.prototype.setStrokeWidth=function(a){if(this.compressed){if(this.state.strokeWidth==a)return;mxAbstractCanvas2D.prototype.setStrokeWidth.apply(this,arguments)}var b=this.createElement("strokewidth");b.setAttribute("width",this.format(a));this.root.appendChild(b)};
mxXmlCanvas2D.prototype.setDashed=function(a){if(this.compressed){if(this.state.dashed==a)return;mxAbstractCanvas2D.prototype.setDashed.apply(this,arguments)}var b=this.createElement("dashed");b.setAttribute("dashed",a?"1":"0");this.root.appendChild(b)};mxXmlCanvas2D.prototype.setDashPattern=function(a){if(this.compressed){if(this.state.dashPattern==a)return;mxAbstractCanvas2D.prototype.setDashPattern.apply(this,arguments)}var b=this.createElement("dashpattern");b.setAttribute("pattern",a);this.root.appendChild(b)};
mxXmlCanvas2D.prototype.setLineCap=function(a){if(this.compressed){if(this.state.lineCap==a)return;mxAbstractCanvas2D.prototype.setLineCap.apply(this,arguments)}var b=this.createElement("linecap");b.setAttribute("cap",a);this.root.appendChild(b)};mxXmlCanvas2D.prototype.setLineJoin=function(a){if(this.compressed){if(this.state.lineJoin==a)return;mxAbstractCanvas2D.prototype.setLineJoin.apply(this,arguments)}var b=this.createElement("linejoin");b.setAttribute("join",a);this.root.appendChild(b)};
mxXmlCanvas2D.prototype.setMiterLimit=function(a){if(this.compressed){if(this.state.miterLimit==a)return;mxAbstractCanvas2D.prototype.setMiterLimit.apply(this,arguments)}var b=this.createElement("miterlimit");b.setAttribute("limit",a);this.root.appendChild(b)};
mxXmlCanvas2D.prototype.setFontColor=function(a){if(this.textEnabled){a==mxConstants.NONE&&(a=null);if(this.compressed){if(this.state.fontColor==a)return;mxAbstractCanvas2D.prototype.setFontColor.apply(this,arguments)}var b=this.createElement("fontcolor");b.setAttribute("color",null!=a?a:mxConstants.NONE);this.root.appendChild(b)}};
mxXmlCanvas2D.prototype.setFontBackgroundColor=function(a){if(this.textEnabled){a==mxConstants.NONE&&(a=null);if(this.compressed){if(this.state.fontBackgroundColor==a)return;mxAbstractCanvas2D.prototype.setFontBackgroundColor.apply(this,arguments)}var b=this.createElement("fontbackgroundcolor");b.setAttribute("color",null!=a?a:mxConstants.NONE);this.root.appendChild(b)}};
mxXmlCanvas2D.prototype.setFontBorderColor=function(a){if(this.textEnabled){a==mxConstants.NONE&&(a=null);if(this.compressed){if(this.state.fontBorderColor==a)return;mxAbstractCanvas2D.prototype.setFontBorderColor.apply(this,arguments)}var b=this.createElement("fontbordercolor");b.setAttribute("color",null!=a?a:mxConstants.NONE);this.root.appendChild(b)}};
mxXmlCanvas2D.prototype.setFontSize=function(a){if(this.textEnabled){if(this.compressed){if(this.state.fontSize==a)return;mxAbstractCanvas2D.prototype.setFontSize.apply(this,arguments)}var b=this.createElement("fontsize");b.setAttribute("size",a);this.root.appendChild(b)}};
mxXmlCanvas2D.prototype.setFontFamily=function(a){if(this.textEnabled){if(this.compressed){if(this.state.fontFamily==a)return;mxAbstractCanvas2D.prototype.setFontFamily.apply(this,arguments)}var b=this.createElement("fontfamily");b.setAttribute("family",a);this.root.appendChild(b)}};
mxXmlCanvas2D.prototype.setFontStyle=function(a){if(this.textEnabled){null==a&&(a=0);if(this.compressed){if(this.state.fontStyle==a)return;mxAbstractCanvas2D.prototype.setFontStyle.apply(this,arguments)}var b=this.createElement("fontstyle");b.setAttribute("style",a);this.root.appendChild(b)}};
mxXmlCanvas2D.prototype.setShadow=function(a){if(this.compressed){if(this.state.shadow==a)return;mxAbstractCanvas2D.prototype.setShadow.apply(this,arguments)}var b=this.createElement("shadow");b.setAttribute("enabled",a?"1":"0");this.root.appendChild(b)};
mxXmlCanvas2D.prototype.setShadowColor=function(a){if(this.compressed){a==mxConstants.NONE&&(a=null);if(this.state.shadowColor==a)return;mxAbstractCanvas2D.prototype.setShadowColor.apply(this,arguments)}var b=this.createElement("shadowcolor");b.setAttribute("color",null!=a?a:mxConstants.NONE);this.root.appendChild(b)};
mxXmlCanvas2D.prototype.setShadowAlpha=function(a){if(this.compressed){if(this.state.shadowAlpha==a)return;mxAbstractCanvas2D.prototype.setShadowAlpha.apply(this,arguments)}var b=this.createElement("shadowalpha");b.setAttribute("alpha",a);this.root.appendChild(b)};
mxXmlCanvas2D.prototype.setShadowOffset=function(a,b){if(this.compressed){if(this.state.shadowDx==a&&this.state.shadowDy==b)return;mxAbstractCanvas2D.prototype.setShadowOffset.apply(this,arguments)}var c=this.createElement("shadowoffset");c.setAttribute("dx",a);c.setAttribute("dy",b);this.root.appendChild(c)};
mxXmlCanvas2D.prototype.rect=function(a,b,c,d){var e=this.createElement("rect");e.setAttribute("x",this.format(a));e.setAttribute("y",this.format(b));e.setAttribute("w",this.format(c));e.setAttribute("h",this.format(d));this.root.appendChild(e)};
mxXmlCanvas2D.prototype.roundrect=function(a,b,c,d,e,f){var g=this.createElement("roundrect");g.setAttribute("x",this.format(a));g.setAttribute("y",this.format(b));g.setAttribute("w",this.format(c));g.setAttribute("h",this.format(d));g.setAttribute("dx",this.format(e));g.setAttribute("dy",this.format(f));this.root.appendChild(g)};
mxXmlCanvas2D.prototype.ellipse=function(a,b,c,d){var e=this.createElement("ellipse");e.setAttribute("x",this.format(a));e.setAttribute("y",this.format(b));e.setAttribute("w",this.format(c));e.setAttribute("h",this.format(d));this.root.appendChild(e)};
mxXmlCanvas2D.prototype.image=function(a,b,c,d,e,f,g,h){e=this.converter.convert(e);var k=this.createElement("image");k.setAttribute("x",this.format(a));k.setAttribute("y",this.format(b));k.setAttribute("w",this.format(c));k.setAttribute("h",this.format(d));k.setAttribute("src",e);k.setAttribute("aspect",f?"1":"0");k.setAttribute("flipH",g?"1":"0");k.setAttribute("flipV",h?"1":"0");this.root.appendChild(k)};
mxXmlCanvas2D.prototype.begin=function(){this.root.appendChild(this.createElement("begin"));this.lastY=this.lastX=0};mxXmlCanvas2D.prototype.moveTo=function(a,b){var c=this.createElement("move");c.setAttribute("x",this.format(a));c.setAttribute("y",this.format(b));this.root.appendChild(c);this.lastX=a;this.lastY=b};
mxXmlCanvas2D.prototype.lineTo=function(a,b){var c=this.createElement("line");c.setAttribute("x",this.format(a));c.setAttribute("y",this.format(b));this.root.appendChild(c);this.lastX=a;this.lastY=b};mxXmlCanvas2D.prototype.quadTo=function(a,b,c,d){var e=this.createElement("quad");e.setAttribute("x1",this.format(a));e.setAttribute("y1",this.format(b));e.setAttribute("x2",this.format(c));e.setAttribute("y2",this.format(d));this.root.appendChild(e);this.lastX=c;this.lastY=d};
mxXmlCanvas2D.prototype.curveTo=function(a,b,c,d,e,f){var g=this.createElement("curve");g.setAttribute("x1",this.format(a));g.setAttribute("y1",this.format(b));g.setAttribute("x2",this.format(c));g.setAttribute("y2",this.format(d));g.setAttribute("x3",this.format(e));g.setAttribute("y3",this.format(f));this.root.appendChild(g);this.lastX=e;this.lastY=f};mxXmlCanvas2D.prototype.close=function(){this.root.appendChild(this.createElement("close"))};
mxXmlCanvas2D.prototype.text=function(a,b,c,d,e,f,g,h,k,l,m,p){if(this.textEnabled&&null!=e){mxUtils.isNode(e)&&(e=mxUtils.getOuterHtml(e));var o=this.createElement("text");o.setAttribute("x",this.format(a));o.setAttribute("y",this.format(b));o.setAttribute("w",this.format(c));o.setAttribute("h",this.format(d));o.setAttribute("str",e);null!=f&&o.setAttribute("align",f);null!=g&&o.setAttribute("valign",g);o.setAttribute("wrap",h?"1":"0");null==k&&(k="");o.setAttribute("format",k);null!=l&&o.setAttribute("overflow",
l);null!=m&&o.setAttribute("clip",m?"1":"0");null!=p&&o.setAttribute("rotation",p);this.root.appendChild(o)}};mxXmlCanvas2D.prototype.stroke=function(){this.root.appendChild(this.createElement("stroke"))};mxXmlCanvas2D.prototype.fill=function(){this.root.appendChild(this.createElement("fill"))};mxXmlCanvas2D.prototype.fillAndStroke=function(){this.root.appendChild(this.createElement("fillstroke"))};
function mxSvgCanvas2D(a,b){mxAbstractCanvas2D.call(this);this.root=a;this.gradients=[];this.defs=null;this.styleEnabled=null!=b?b:false;var c=null;if(a.ownerDocument!=document)for(c=a;null!=c&&"svg"!=c.nodeName;)c=c.parentNode;null!=c&&(0<c.getElementsByTagName("defs").length&&(this.defs=c.getElementsByTagName("defs")[0]),null==this.defs&&(this.defs=this.createElement("defs"),null!=c.firstChild?c.insertBefore(this.defs,c.firstChild):c.appendChild(this.defs)),this.styleEnabled&&this.defs.appendChild(this.createStyle()))}
mxUtils.extend(mxSvgCanvas2D,mxAbstractCanvas2D);mxSvgCanvas2D.prototype.node=null;mxSvgCanvas2D.prototype.matchHtmlAlignment=true;mxSvgCanvas2D.prototype.textEnabled=true;mxSvgCanvas2D.prototype.foEnabled=true;mxSvgCanvas2D.prototype.foAltText="[Object]";mxSvgCanvas2D.prototype.strokeTolerance=0;mxSvgCanvas2D.prototype.refCount=0;mxSvgCanvas2D.prototype.blockImagePointerEvents=false;mxSvgCanvas2D.prototype.reset=function(){mxAbstractCanvas2D.prototype.reset.apply(this,arguments);this.gradients=[]};
mxSvgCanvas2D.prototype.createStyle=function(a){a=this.createElement("style");a.setAttribute("type","text/css");mxUtils.write(a,"svg{font-family:"+mxConstants.DEFAULT_FONTFAMILY+";font-size:"+mxConstants.DEFAULT_FONTSIZE+";fill:none;stroke-miterlimit:10}");return a};
mxSvgCanvas2D.prototype.createElement=function(a,b){if(null!=this.root.ownerDocument.createElementNS)return this.root.ownerDocument.createElementNS(b||mxConstants.NS_SVG,a);var c=this.root.ownerDocument.createElement(a);null!=b&&c.setAttribute("xmlns",b);return c};
mxSvgCanvas2D.prototype.createAlternateContent=function(a,b,c,d,e){return null!=this.foAltText?(a=this.state,b=this.createElement("text"),b.setAttribute("x",Math.round(d/2)),b.setAttribute("y",Math.round((e+a.fontSize)/2)),b.setAttribute("fill",a.fontColor||"black"),b.setAttribute("text-anchor","middle"),b.setAttribute("font-size",Math.round(a.fontSize)+"px"),b.setAttribute("font-family",a.fontFamily),(a.fontStyle&mxConstants.FONT_BOLD)==mxConstants.FONT_BOLD&&b.setAttribute("font-weight","bold"),
(a.fontStyle&mxConstants.FONT_ITALIC)==mxConstants.FONT_ITALIC&&b.setAttribute("font-style","italic"),(a.fontStyle&mxConstants.FONT_UNDERLINE)==mxConstants.FONT_UNDERLINE&&b.setAttribute("text-decoration","underline"),mxUtils.write(b,this.foAltText),b):null};
mxSvgCanvas2D.prototype.createGradientId=function(a,b,c,d,e){"#"==a.charAt(0)&&(a=a.substring(1));"#"==b.charAt(0)&&(b=b.substring(1));a=a.toLowerCase()+"-"+c;b=b.toLowerCase()+"-"+d;c=null;null==e||e==mxConstants.DIRECTION_SOUTH?c="s":e==mxConstants.DIRECTION_EAST?c="e":(d=a,a=b,b=d,e==mxConstants.DIRECTION_NORTH?c="s":e==mxConstants.DIRECTION_WEST&&(c="e"));return"mx-gradient-"+a+"-"+b+"-"+c};
mxSvgCanvas2D.prototype.getSvgGradient=function(a,b,c,d,e){var f=this.createGradientId(a,b,c,d,e),g=this.gradients[f];if(null==g){var h=this.root.ownerSVGElement,k=0,l=f+"-"+k;if(null!=h)for(g=h.ownerDocument.getElementById(l);null!=g&&g.ownerSVGElement!=h;){l=f+"-"+k++;g=h.ownerDocument.getElementById(l)}else l="id"+ ++this.refCount;null==g&&(g=this.createSvgGradient(a,b,c,d,e),g.setAttribute("id",l),null!=this.defs?this.defs.appendChild(g):h.appendChild(g));this.gradients[f]=g}return g.getAttribute("id")};
mxSvgCanvas2D.prototype.createSvgGradient=function(a,b,c,d,e){var f=this.createElement("linearGradient");f.setAttribute("x1","0%");f.setAttribute("y1","0%");f.setAttribute("x2","0%");f.setAttribute("y2","0%");null==e||e==mxConstants.DIRECTION_SOUTH?f.setAttribute("y2","100%"):e==mxConstants.DIRECTION_EAST?f.setAttribute("x2","100%"):e==mxConstants.DIRECTION_NORTH?f.setAttribute("y1","100%"):e==mxConstants.DIRECTION_WEST&&f.setAttribute("x1","100%");c=1>c?";stop-opacity:"+c:"";e=this.createElement("stop");
e.setAttribute("offset","0%");e.setAttribute("style","stop-color:"+a+c);f.appendChild(e);c=1>d?";stop-opacity:"+d:"";e=this.createElement("stop");e.setAttribute("offset","100%");e.setAttribute("style","stop-color:"+b+c);f.appendChild(e);return f};
mxSvgCanvas2D.prototype.addNode=function(a,b){var c=this.node,d=this.state;if(null!=c){if("path"==c.nodeName)if(null!=this.path&&0<this.path.length)c.setAttribute("d",this.path.join(" "));else return;a&&null!=d.fillColor?this.updateFill():this.styleEnabled||("ellipse"==c.nodeName&&mxClient.IS_NS&&!mxClient.IS_GC&&!mxClient.IS_SF?c.setAttribute("fill","transparent"):c.setAttribute("fill","none"),a=false);b&&null!=d.strokeColor?this.updateStroke():this.styleEnabled||c.setAttribute("stroke","none");
null!=d.transform&&0<d.transform.length&&c.setAttribute("transform",d.transform);d.shadow&&this.root.appendChild(this.createShadow(c));0<this.strokeTolerance&&!a&&this.root.appendChild(this.createTolerance(c));this.pointerEvents&&("path"!=c.nodeName||this.path[this.path.length-1]==this.closeOp)&&c.setAttribute("pointer-events","all");this.root.appendChild(c)}};
mxSvgCanvas2D.prototype.updateFill=function(){var a=this.state;1>a.alpha&&this.node.setAttribute("fill-opacity",a.alpha);null!=a.fillColor&&(null!=a.gradientColor?(a=this.getSvgGradient(a.fillColor,a.gradientColor,a.fillAlpha,a.gradientAlpha,a.gradientDirection),this.node.setAttribute("fill","url(#"+a+")")):this.node.setAttribute("fill",a.fillColor.toLowerCase()))};
mxSvgCanvas2D.prototype.updateStroke=function(){var a=this.state;this.node.setAttribute("stroke",a.strokeColor.toLowerCase());1>a.alpha&&this.node.setAttribute("stroke-opacity",a.alpha);var b=Math.max(1,this.format(a.strokeWidth*a.scale));1!=b&&this.node.setAttribute("stroke-width",b);"path"==this.node.nodeName&&this.updateStrokeAttributes();a.dashed&&this.node.setAttribute("stroke-dasharray",this.createDashPattern(b))};
mxSvgCanvas2D.prototype.updateStrokeAttributes=function(){var a=this.state;null!=a.lineJoin&&"miter"!=a.lineJoin&&this.node.setAttribute("stroke-linejoin",a.lineJoin);if(null!=a.lineCap){var b=a.lineCap;"flat"==b&&(b="butt");"butt"!=b&&this.node.setAttribute("stroke-linecap",b)}null!=a.miterLimit&&(!this.styleEnabled||10!=a.miterLimit)&&this.node.setAttribute("stroke-miterlimit",a.miterLimit)};
mxSvgCanvas2D.prototype.createDashPattern=function(a){var b=this.state.dashPattern.split(" "),c=[];if(0<b.length)for(var d=0;d<b.length;d++)c[d]=Number(b[d])*a;return c.join(" ")};
mxSvgCanvas2D.prototype.createTolerance=function(a){a=a.cloneNode(true);var b=parseFloat(a.getAttribute("stroke-width")||1)+this.strokeTolerance;a.setAttribute("pointer-events","stroke");a.setAttribute("visibility","hidden");a.removeAttribute("stroke-dasharray");a.setAttribute("stroke-width",b);a.setAttribute("fill","none");a.setAttribute("stroke",mxClient.IS_OP?"none":"white");return a};
mxSvgCanvas2D.prototype.createShadow=function(a){a=a.cloneNode(true);var b=this.state;"none"!=a.getAttribute("fill")&&a.setAttribute("fill",b.shadowColor);"none"!=a.getAttribute("stroke")&&a.setAttribute("stroke",b.shadowColor);a.setAttribute("transform","translate("+this.format(b.shadowDx*b.scale)+","+this.format(b.shadowDy*b.scale)+")"+(b.transform||""));a.setAttribute("opacity",b.shadowAlpha);return a};
mxSvgCanvas2D.prototype.rotate=function(a,b,c,d,e){if(0!=a||b||c){var f=this.state;d+=f.dx;e+=f.dy;d*=f.scale;e*=f.scale;f.transform=f.transform||"";if(b&&c)a+=180;else if(b^c){var g=b?d:0,h=b?-1:1,k=c?e:0,l=c?-1:1;f.transform+="translate("+this.format(g)+","+this.format(k)+")scale("+this.format(h)+","+this.format(l)+")translate("+this.format(-g)+","+this.format(-k)+")"}if(b?!c:c)a*=-1;0!=a&&(f.transform+="rotate("+this.format(a)+","+this.format(d)+","+this.format(e)+")");f.rotation+=a;f.rotationCx=
d;f.rotationCy=e}};mxSvgCanvas2D.prototype.begin=function(){mxAbstractCanvas2D.prototype.begin.apply(this,arguments);this.node=this.createElement("path")};mxSvgCanvas2D.prototype.rect=function(a,b,c,d){var e=this.state,f=this.createElement("rect");f.setAttribute("x",this.format((a+e.dx)*e.scale));f.setAttribute("y",this.format((b+e.dy)*e.scale));f.setAttribute("width",this.format(c*e.scale));f.setAttribute("height",this.format(d*e.scale));this.node=f};
mxSvgCanvas2D.prototype.roundrect=function(a,b,c,d,e,f){this.rect(a,b,c,d);0<e&&this.node.setAttribute("rx",this.format(e*this.state.scale));0<f&&this.node.setAttribute("ry",this.format(f*this.state.scale))};mxSvgCanvas2D.prototype.ellipse=function(a,b,c,d){var e=this.state,f=this.createElement("ellipse");f.setAttribute("cx",Math.round((a+c/2+e.dx)*e.scale));f.setAttribute("cy",Math.round((b+d/2+e.dy)*e.scale));f.setAttribute("rx",c/2*e.scale);f.setAttribute("ry",d/2*e.scale);this.node=f};
mxSvgCanvas2D.prototype.image=function(a,b,c,d,e,f,g,h){e=this.converter.convert(e);f=null!=f?f:true;g=null!=g?g:false;h=null!=h?h:false;var k=this.state;a+=k.dx;b+=k.dy;var l=this.createElement("image");l.setAttribute("x",this.format(a*k.scale));l.setAttribute("y",this.format(b*k.scale));l.setAttribute("width",this.format(c*k.scale));l.setAttribute("height",this.format(d*k.scale));null==l.setAttributeNS||this.root.ownerDocument!=document?l.setAttribute("xlink:href",e):l.setAttributeNS(mxConstants.NS_XLINK,
"href",e);f||l.setAttribute("preserveAspectRatio","none");1>k.alpha&&l.setAttribute("opacity",k.alpha);e=this.state.transform||"";if(g||h){var m=f=1,p=0,o=0;g&&(f=-1,p=-c-2*a);h&&(m=-1,o=-d-2*b);e+="scale("+f+","+m+")translate("+p+","+o+")"}0<e.length&&l.setAttribute("transform",e);this.root.appendChild(l);this.blockImagePointerEvents&&(l.setAttribute("style","pointer-events:none"),l=this.createElement("rect"),l.setAttribute("visibility","hidden"),l.setAttribute("pointer-events","fill"),l.setAttribute("x",
this.format(a*k.scale)),l.setAttribute("y",this.format(b*k.scale)),l.setAttribute("width",this.format(c*k.scale)),l.setAttribute("height",this.format(d*k.scale)),this.root.appendChild(l))};
mxSvgCanvas2D.prototype.createDiv=function(a,b,c,d,e){c=this.state;d="display:inline-block;font-size:"+Math.round(c.fontSize)+"px;font-family:"+c.fontFamily+";color:"+c.fontColor+";line-height:"+Math.round(c.fontSize*mxConstants.LINE_HEIGHT)+"px;"+d;(c.fontStyle&mxConstants.FONT_BOLD)==mxConstants.FONT_BOLD&&(d+="font-weight:bold;");(c.fontStyle&mxConstants.FONT_ITALIC)==mxConstants.FONT_ITALIC&&(d+="font-style:italic;");(c.fontStyle&mxConstants.FONT_UNDERLINE)==mxConstants.FONT_UNDERLINE&&(d+="text-decoration:underline;");
b==mxConstants.ALIGN_CENTER?d+="text-align:center;":b==mxConstants.ALIGN_RIGHT&&(d+="text-align:right;");b="";null!=c.fontBackgroundColor&&(b+="background-color:"+c.fontBackgroundColor+";");null!=c.fontBorderColor&&(b+="border:1px solid "+c.fontBorderColor+";");mxUtils.isNode(a)||(c=document.createElement("textarea"),c.innerHTML=a.replace(/&lt;/g,"&amp;lt;").replace(/&gt;/g,"&amp;gt;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),a=c.value,"fill"!=e&&"width"!=e?0<b.length&&(a='<div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;'+
b+'">'+a+"</div>"):d+=b);if(!mxClient.IS_IE&&document.createElementNS)return e=document.createElementNS("http://www.w3.org/1999/xhtml","div"),e.setAttribute("style",d),mxUtils.isNode(a)?this.root.ownerDocument!=document?e.appendChild(a.cloneNode(true)):e.appendChild(a):e.innerHTML=a,e;mxUtils.isNode(a)&&this.root.ownerDocument!=document&&(a=a.outerHTML);a=a.replace(/<br>/g,"<br />").replace(/<hr>/g,"<hr />");return mxUtils.parseXml('<div xmlns="http://www.w3.org/1999/xhtml" style="'+d+'">'+a+"</div>").documentElement};
mxSvgCanvas2D.prototype.text=function(a,b,c,d,e,f,g,h,k,l,m,p){if(this.textEnabled&&null!=e){p=null!=p?p:0;var o=this.state;a+=o.dx;b+=o.dy;if(this.foEnabled&&"html"==k){var n="vertical-align:top;";m?(n+="overflow:hidden;",0<d&&(n+="max-height:"+Math.round(d)+"px;"),0<c&&(n+="width:"+Math.round(c)+"px;")):"fill"==l?(n+="width:"+Math.round(c)+"px;",n+="height:"+Math.round(d)+"px;"):"width"==l&&(n+="width:"+Math.round(c)+"px;",0<d&&(n+="max-height:"+Math.round(d)+"px;"));h&&0<c?(m||(n+="width:"+Math.round(c)+
"px;"),n+="white-space:normal;"):n+="white-space:nowrap;";var s=this.createElement("g");1>o.alpha&&s.setAttribute("opacity",o.alpha);var t=this.createElement("foreignObject");t.setAttribute("pointer-events","all");n=this.createDiv(e,f,g,n,l);if(null!=n){s.appendChild(t);this.root.appendChild(s);var q=0,r=0;if(mxClient.IS_IE&&!mxClient.IS_SVG){var u=document.createElement("div");u.style.cssText=n.getAttribute("style");u.style.display=mxClient.IS_QUIRKS?"inline":"inline-block";u.style.visibility="hidden";
u.innerHTML=mxUtils.isNode(e)?e.outerHTML:e;document.body.appendChild(u);q=u.offsetWidth;r=mxClient.IS_QUIRKS&&0<d&&m?Math.min(d,u.offsetHeight+2):u.offsetHeight;u.parentNode.removeChild(u);t.appendChild(n)}else this.root.ownerDocument!=document||0<=navigator.userAgent.indexOf("Firefox/3.")?(n.style.visibility="hidden",document.body.appendChild(n),q=n.offsetWidth,r=n.offsetHeight,t.appendChild(n),n.style.visibility=""):(t.appendChild(n),q=n.offsetWidth,r=n.offsetHeight);"fill"==l?(c=Math.max(c,q),
d=Math.max(d,r)):(c="width"==l?Math.max(c,q):q,d=r);1>o.alpha&&s.setAttribute("opacity",o.alpha);q=n=0;f==mxConstants.ALIGN_CENTER?n-=c/2:f==mxConstants.ALIGN_RIGHT&&(n-=c);a+=n;g==mxConstants.ALIGN_MIDDLE?q-=d/2:g==mxConstants.ALIGN_BOTTOM&&(q-=d);b+=q;r=1!=o.scale?"scale("+o.scale+")":"";0!=o.rotation&&this.rotateHtml?(r+="rotate("+o.rotation+","+c/2+","+d/2+")",b=this.rotatePoint((a+c/2)*o.scale,(b+d/2)*o.scale,o.rotation,o.rotationCx,o.rotationCy),a=b.x-c*o.scale/2,b=b.y-d*o.scale/2):(a*=o.scale,
b*=o.scale);0!=p&&(r+="rotate("+p+","+-n+","+-q+")");s.setAttribute("transform","translate("+Math.round(a)+","+Math.round(b)+")"+r);t.setAttribute("width",Math.round(Math.max(1,c)));t.setAttribute("height",Math.round(Math.max(1,d)));this.root.ownerDocument!=document&&(a=this.createAlternateContent(t,a,b,c,d,e,f,g,h,k,l,m,p),null!=a&&(t.setAttribute("requiredFeatures","http://www.w3.org/TR/SVG11/feature#Extensibility"),c=this.createElement("switch"),c.appendChild(t),c.appendChild(a),s.appendChild(c)))}}else this.plainText(a,
b,c,d,e,f,g,h,l,m,p)}};mxSvgCanvas2D.prototype.createClip=function(a,b,c,d){a=Math.round(a);b=Math.round(b);c=Math.round(c);d=Math.round(d);for(var e="mx-clip-"+a+"-"+b+"-"+c+"-"+d,f=0,g=e+"-"+f;null!=document.getElementById(g);)g=e+"-"+ ++f;clip=this.createElement("clipPath");clip.setAttribute("id",g);e=this.createElement("rect");e.setAttribute("x",a);e.setAttribute("y",b);e.setAttribute("width",c);e.setAttribute("height",d);clip.appendChild(e);return clip};
mxSvgCanvas2D.prototype.plainText=function(a,b,c,d,e,f,g,h,k,l,m){m=null!=m?m:0;h=this.state;var p=Math.round(h.fontSize),o=this.createElement("g"),n=h.transform||"";0!=m&&(n+="rotate("+m+","+this.format(a*h.scale)+","+this.format(b*h.scale)+")");if(l&&0<c&&0<d){var s=a;m=b;f==mxConstants.ALIGN_CENTER?s-=c/2:f==mxConstants.ALIGN_RIGHT&&(s-=c);"fill"!=k&&(g==mxConstants.ALIGN_MIDDLE?m-=d/2:g==mxConstants.ALIGN_BOTTOM&&(m-=d));m=this.createClip(s*h.scale-2,m*h.scale-2,c*h.scale+4,d*h.scale+4);null!=
this.defs?this.defs.appendChild(m):this.root.appendChild(m);o.setAttribute("clip-path","url(#"+m.getAttribute("id")+")")}this.updateFont(o,f);m=f==mxConstants.ALIGN_RIGHT?"end":f==mxConstants.ALIGN_CENTER?"middle":"start";"start"!=m&&o.setAttribute("text-anchor",m);(!this.styleEnabled||p!=mxConstants.DEFAULT_FONTSIZE)&&o.setAttribute("font-size",Math.round(p*h.scale)+"px");0<n.length&&o.setAttribute("transform",n);1>h.alpha&&o.setAttribute("opacity",h.alpha);n=e.split("\n");s=Math.round(p*mxConstants.LINE_HEIGHT);
var t=p+(n.length-1)*s;m=b+p-1;g==mxConstants.ALIGN_MIDDLE?"fill"==k?m-=d/2:(l=(this.matchHtmlAlignment&&l&&0<d?Math.min(t,d):t)/2,m-=l+1):g==mxConstants.ALIGN_BOTTOM&&("fill"==k?m-=d:(l=this.matchHtmlAlignment&&l&&0<d?Math.min(t,d):t,m-=l+2));for(l=0;l<n.length;l++){0<n[l].length&&0<mxUtils.trim(n[l]).length&&(p=this.createElement("text"),p.setAttribute("x",this.format(a*h.scale)),p.setAttribute("y",this.format(m*h.scale)),mxUtils.write(p,n[l]),o.appendChild(p));m+=s}this.root.appendChild(o);this.addTextBackground(o,
e,a,b,c,"fill"==k?d:t,f,g,k)};
mxSvgCanvas2D.prototype.updateFont=function(a){var b=this.state;a.setAttribute("fill",b.fontColor);(!this.styleEnabled||b.fontFamily!=mxConstants.DEFAULT_FONTFAMILY)&&a.setAttribute("font-family",b.fontFamily);(b.fontStyle&mxConstants.FONT_BOLD)==mxConstants.FONT_BOLD&&a.setAttribute("font-weight","bold");(b.fontStyle&mxConstants.FONT_ITALIC)==mxConstants.FONT_ITALIC&&a.setAttribute("font-style","italic");(b.fontStyle&mxConstants.FONT_UNDERLINE)==mxConstants.FONT_UNDERLINE&&a.setAttribute("text-decoration",
"underline")};
mxSvgCanvas2D.prototype.addTextBackground=function(a,b,c,d,e,f,g,h,k){var l=this.state;if(null!=l.fontBackgroundColor||null!=l.fontBorderColor){var m=null;"fill"==k||"width"==k?(g==mxConstants.ALIGN_CENTER?c-=e/2:g==mxConstants.ALIGN_RIGHT&&(c-=e),h==mxConstants.ALIGN_MIDDLE?d-=f/2:h==mxConstants.ALIGN_BOTTOM&&(d-=f),m=new mxRectangle((c+1)*l.scale,d*l.scale,(e-2)*l.scale,(f+2)*l.scale)):null!=a.getBBox&&this.root.ownerDocument==document?(m=a.getBBox(),b=mxClient.IS_IE&&mxClient.IS_SVG,m=new mxRectangle(m.x,
m.y+(b?0:1),m.width,m.height+(b?1:0))):(m=document.createElement("div"),m.style.lineHeight=Math.round(l.fontSize*mxConstants.LINE_HEIGHT)+"px",m.style.fontSize=Math.round(l.fontSize)+"px",m.style.fontFamily=l.fontFamily,m.style.whiteSpace="nowrap",m.style.position="absolute",m.style.visibility="hidden",m.style.display=mxClient.IS_QUIRKS?"inline":"inline-block",m.style.zoom="1",(l.fontStyle&mxConstants.FONT_BOLD)==mxConstants.FONT_BOLD&&(m.style.fontWeight="bold"),(l.fontStyle&mxConstants.FONT_ITALIC)==
mxConstants.FONT_ITALIC&&(m.style.fontStyle="italic"),b=mxUtils.htmlEntities(b,false),m.innerHTML=b.replace(/\n/g,"<br/>"),document.body.appendChild(m),e=m.offsetWidth,f=m.offsetHeight,m.parentNode.removeChild(m),g==mxConstants.ALIGN_CENTER?c-=e/2:g==mxConstants.ALIGN_RIGHT&&(c-=e),h==mxConstants.ALIGN_MIDDLE?d-=f/2:h==mxConstants.ALIGN_BOTTOM&&(d-=f),m=new mxRectangle((c+1)*l.scale,(d+2)*l.scale,e*l.scale,(f+1)*l.scale));null!=m&&(b=this.createElement("rect"),b.setAttribute("fill",l.fontBackgroundColor||
"none"),b.setAttribute("stroke",l.fontBorderColor||"none"),b.setAttribute("x",Math.floor(m.x-1)),b.setAttribute("y",Math.floor(m.y-1)),b.setAttribute("width",Math.ceil(m.width+2)),b.setAttribute("height",Math.ceil(m.height)),l=null!=l.fontBorderColor?Math.max(1,this.format(l.scale)):0,b.setAttribute("stroke-width",l),this.root.ownerDocument==document&&1==mxUtils.mod(l,2)&&b.setAttribute("transform","translate(0.5, 0.5)"),a.insertBefore(b,a.firstChild))}};
mxSvgCanvas2D.prototype.stroke=function(){this.addNode(false,true)};mxSvgCanvas2D.prototype.fill=function(){this.addNode(true,false)};mxSvgCanvas2D.prototype.fillAndStroke=function(){this.addNode(true,true)};var mxVmlCanvas2D=function(a){mxAbstractCanvas2D.call(this);this.root=a};mxUtils.extend(mxVmlCanvas2D,mxAbstractCanvas2D);mxVmlCanvas2D.prototype.node=null;mxVmlCanvas2D.prototype.textEnabled=true;mxVmlCanvas2D.prototype.moveOp="m";mxVmlCanvas2D.prototype.lineOp="l";
mxVmlCanvas2D.prototype.curveOp="c";mxVmlCanvas2D.prototype.closeOp="x";mxVmlCanvas2D.prototype.rotatedHtmlBackground="";mxVmlCanvas2D.prototype.vmlScale=1;
mxVmlCanvas2D.prototype.addNode=function(a,b){var c=this.node,d=this.state;if(null!=c){if("shape"==c.nodeName)if(null!=this.path&&0<this.path.length){c.path=this.path.join(" ")+" e";c.style.width=this.root.style.width;c.style.height=this.root.style.height;c.coordsize=parseInt(c.style.width)+" "+parseInt(c.style.height)}else return;c.strokeweight=this.format(Math.max(1,d.strokeWidth*d.scale/this.vmlScale))+"px";d.shadow&&this.root.appendChild(this.createShadow(c,a&&null!=d.fillColor,b&&null!=d.strokeColor));
b&&null!=d.strokeColor?(c.stroked="true",c.strokecolor=d.strokeColor):c.stroked="false";c.appendChild(this.createStroke());a&&null!=d.fillColor?c.appendChild(this.createFill()):this.pointerEvents&&("shape"!=c.nodeName||this.path[this.path.length-1]==this.closeOp)?c.appendChild(this.createTransparentFill()):c.filled="false";this.root.appendChild(c)}};
mxVmlCanvas2D.prototype.createTransparentFill=function(){var a=document.createElement(mxClient.VML_PREFIX+":fill");a.src=mxClient.imageBasePath+"/transparent.gif";a.type="tile";return a};
mxVmlCanvas2D.prototype.createFill=function(){var a=this.state,b=document.createElement(mxClient.VML_PREFIX+":fill");b.color=a.fillColor;if(null!=a.gradientColor){b.type="gradient";b.method="none";b.color2=a.gradientColor;var c=180-a.rotation;c=a.gradientDirection==mxConstants.DIRECTION_WEST?c-(90+("x"==this.root.style.flip?180:0)):a.gradientDirection==mxConstants.DIRECTION_EAST?c+(90+("x"==this.root.style.flip?180:0)):a.gradientDirection==mxConstants.DIRECTION_NORTH?c-(180+("y"==this.root.style.flip?
-180:0)):c+("y"==this.root.style.flip?-180:0);if("x"==this.root.style.flip||"y"==this.root.style.flip)c*=-1;b.angle=mxUtils.mod(c,360);b.opacity=100*a.alpha*a.fillAlpha+"%";b.setAttribute(mxClient.OFFICE_PREFIX+":opacity2",100*a.alpha*a.gradientAlpha+"%")}else 1>a.alpha&&(b.opacity=100*a.alpha+"%");return b};
mxVmlCanvas2D.prototype.createStroke=function(){var a=this.state,b=document.createElement(mxClient.VML_PREFIX+":stroke");b.endcap=a.lineCap||"flat";b.joinstyle=a.lineJoin||"miter";b.miterlimit=a.miterLimit||"10";1>a.alpha&&(b.opacity=100*a.alpha+"%");a.dashed&&(b.dashstyle=this.getVmlDashStyle());return b};mxVmlCanvas2D.prototype.getVmlDashStyle=function(){var a="dash";if(null!=this.state.dashPattern){var b=this.state.dashPattern.split(" ");0<b.length&&1==b[0]&&(a="0 2")}return a};
mxVmlCanvas2D.prototype.createShadow=function(a,b,c){var d=this.state,e=-d.rotation*(Math.PI/180),f=Math.cos(e);e=Math.sin(e);var g=d.shadowDx*d.scale,h=d.shadowDy*d.scale;"x"==this.root.style.flip?g*=-1:"y"==this.root.style.flip&&(h*=-1);var k=a.cloneNode(true);k.style.marginLeft=Math.round(g*f-h*e)+"px";k.style.marginTop=Math.round(g*e+h*f)+"px";8==document.documentMode&&(k.strokeweight=a.strokeweight,"shape"==a.nodeName&&(k.path=this.path.join(" ")+" e",k.style.width=this.root.style.width,k.style.height=
this.root.style.height,k.coordsize=parseInt(a.style.width)+" "+parseInt(a.style.height)));c?(k.strokecolor=d.shadowColor,k.appendChild(this.createShadowStroke())):k.stroked="false";b?k.appendChild(this.createShadowFill()):k.filled="false";return k};mxVmlCanvas2D.prototype.createShadowFill=function(){var a=document.createElement(mxClient.VML_PREFIX+":fill");a.color=this.state.shadowColor;a.opacity=100*this.state.alpha*this.state.shadowAlpha+"%";return a};
mxVmlCanvas2D.prototype.createShadowStroke=function(){var a=this.createStroke();a.opacity=100*this.state.alpha*this.state.shadowAlpha+"%";return a};mxVmlCanvas2D.prototype.rotate=function(a,b,c,d,e){b&&c?a+=180:b?this.root.style.flip="x":c&&(this.root.style.flip="y");if(b?!c:c)a*=-1;this.root.style.rotation=a;this.state.rotation+=a;this.state.rotationCx=d;this.state.rotationCy=e};
mxVmlCanvas2D.prototype.begin=function(){mxAbstractCanvas2D.prototype.begin.apply(this,arguments);this.node=document.createElement(mxClient.VML_PREFIX+":shape");this.node.style.position="absolute"};
mxVmlCanvas2D.prototype.quadTo=function(a,b,c,d){var e=this.state,f=(this.lastX+e.dx)*e.scale,g=(this.lastY+e.dy)*e.scale;a=(a+e.dx)*e.scale;b=(b+e.dy)*e.scale;c=(c+e.dx)*e.scale;d=(d+e.dy)*e.scale;g+=2/3*(b-g);var h=c+2/3*(a-c);b=d+2/3*(b-d);this.path.push("c "+this.format(f+2/3*(a-f))+" "+this.format(g)+" "+this.format(h)+" "+this.format(b)+" "+this.format(c)+" "+this.format(d));this.lastX=c/e.scale-e.dx;this.lastY=d/e.scale-e.dy};
mxVmlCanvas2D.prototype.createRect=function(a,b,c,d,e){var f=this.state;a=document.createElement(a);a.style.position="absolute";a.style.left=this.format((b+f.dx)*f.scale)+"px";a.style.top=this.format((c+f.dy)*f.scale)+"px";a.style.width=this.format(d*f.scale)+"px";a.style.height=this.format(e*f.scale)+"px";return a};mxVmlCanvas2D.prototype.rect=function(a,b,c,d){this.node=this.createRect(mxClient.VML_PREFIX+":rect",a,b,c,d)};
mxVmlCanvas2D.prototype.roundrect=function(a,b,c,d,e,f){this.node=this.createRect(mxClient.VML_PREFIX+":roundrect",a,b,c,d);this.node.setAttribute("arcsize",Math.max(100*e/c,100*f/d)+"%")};mxVmlCanvas2D.prototype.ellipse=function(a,b,c,d){this.node=this.createRect(mxClient.VML_PREFIX+":oval",a,b,c,d)};
mxVmlCanvas2D.prototype.image=function(a,b,c,d,e,f,g,h){var k=null;f?(k=this.createRect(mxClient.VML_PREFIX+":rect",a,b,c,d),k.stroked="false",a=document.createElement(mxClient.VML_PREFIX+":fill"),a.aspect=f?"atmost":"ignore",a.rotate="true",a.type="frame",a.src=e,k.appendChild(a)):(k=this.createRect(mxClient.VML_PREFIX+":image",a,b,c,d),k.src=e);g&&h?k.style.rotation="180":g?k.style.flip="x":h&&(k.style.flip="y");1>this.state.alpha&&(k.style.filter+="alpha(opacity="+100*this.state.alpha+")");this.root.appendChild(k)};
mxVmlCanvas2D.prototype.createDiv=function(a,b,c,d){c=document.createElement("div");var e=this.state,f="";null!=e.fontBackgroundColor&&(f+="background-color:"+e.fontBackgroundColor+";");null!=e.fontBorderColor&&(f+="border:1px solid "+e.fontBorderColor+";");mxUtils.isNode(a)?c.appendChild(a):0<f.length&&"fill"!=d&&"width"!=d?(d=document.createElement("div"),d.style.cssText=f,d.style.display=mxClient.IS_QUIRKS?"inline":"inline-block",d.style.zoom="1",d.innerHTML=a,c.appendChild(d)):(c.style.cssText=
f,c.innerHTML=a);a=c.style;a.fontSize=Math.round(e.fontSize/this.vmlScale)+"px";a.fontFamily=e.fontFamily;a.color=e.fontColor;a.verticalAlign="top";a.textAlign=b||"left";a.lineHeight=Math.round(e.fontSize*mxConstants.LINE_HEIGHT/this.vmlScale)+"px";(e.fontStyle&mxConstants.FONT_BOLD)==mxConstants.FONT_BOLD&&(a.fontWeight="bold");(e.fontStyle&mxConstants.FONT_ITALIC)==mxConstants.FONT_ITALIC&&(a.fontStyle="italic");(e.fontStyle&mxConstants.FONT_UNDERLINE)==mxConstants.FONT_UNDERLINE&&(a.textDecoration=
"underline");return c};
mxVmlCanvas2D.prototype.text=function(a,b,c,d,e,f,g,h,k,l,m,p){if(this.textEnabled&&null!=e){var o=this.state;if("html"==k){null!=o.rotation&&(b=this.rotatePoint(a,b,o.rotation,o.rotationCx,o.rotationCy),a=b.x,b=b.y);8==document.documentMode?(a+=o.dx,b+=o.dy):(a*=o.scale,b*=o.scale);k=8==document.documentMode?document.createElement(mxClient.VML_PREFIX+":group"):document.createElement("div");k.style.position="absolute";k.style.display="inline";k.style.left=this.format(a)+"px";k.style.top=this.format(b)+
"px";k.style.zoom=o.scale;var n=document.createElement("div");n.style.position="relative";n.style.display="inline";var s=mxUtils.getAlignmentAsPoint(f,g),t=s.x;s=s.y;e=this.createDiv(e,f,g,l);f=document.createElement("div");h&&0<c?(m||(e.style.width=Math.round(c)+"px"),e.style.whiteSpace="normal"):e.style.whiteSpace="nowrap";h=o.rotation+(p||0);this.rotateHtml&&0!=h?(f.style.display="inline",f.style.zoom="1",f.appendChild(e),8==document.documentMode&&"DIV"!=this.root.nodeName?(n.appendChild(f),k.appendChild(n)):
k.appendChild(f)):8==document.documentMode?(n.appendChild(e),k.appendChild(n)):(e.style.display="inline",k.appendChild(e));"DIV"!=this.root.nodeName?(p=document.createElement(mxClient.VML_PREFIX+":rect"),p.stroked="false",p.filled="false",p.appendChild(k),this.root.appendChild(p)):this.root.appendChild(k);m?(e.style.overflow="hidden",0<c&&(e.style.width=Math.round(c)+"px"),0<d&&8==document.documentMode&&(e.style.maxHeight=Math.round(d)+"px")):"fill"==l?(e.style.width=c+"px",e.style.height=d+"px"):
"width"==l&&(e.style.width=c+"px",0<d&&(e.style.maxHeight=Math.round(d)+"px"));if(this.rotateHtml&&0!=h){c=h*(Math.PI/180);h=parseFloat(parseFloat(Math.cos(c)).toFixed(8));p=parseFloat(parseFloat(Math.sin(-c)).toFixed(8));c%=2*Math.PI;0>c&&(c+=2*Math.PI);c%=Math.PI;c>Math.PI/2&&(c=Math.PI-c);g=Math.cos(c);var q=Math.sin(c);8==document.documentMode&&(e.style.display="inline-block",f.style.display="inline-block",n.style.display="inline-block");e.style.visibility="hidden";document.body.appendChild(e);
c=e.offsetWidth;n=e.offsetHeight;if(mxClient.IS_QUIRKS&&(m||"width"==l)&&n>d){n=d;e.style.height=n+"px"}d=n;m=(d-d*g+c*-q)/2-p*c*(t+0.5)+h*d*(s+0.5);l=(c-c*g+d*-q)/2+h*c*(t+0.5)+p*d*(s+0.5);"group"==k.nodeName&&"DIV"==this.root.nodeName?(t=document.createElement("div"),t.style.display="inline-block",t.style.position="absolute",t.style.left=this.format(a+(l-c/2)*o.scale)+"px",t.style.top=this.format(b+(m-d/2)*o.scale)+"px",k.parentNode.appendChild(t),t.appendChild(k)):(o=8==document.documentMode?1:
o.scale,k.style.left=this.format(a+(l-c/2)*o)+"px",k.style.top=this.format(b+(m-d/2)*o)+"px");f.style.filter="progid:DXImageTransform.Microsoft.Matrix(M11="+h+", M12="+p+", M21="+-p+", M22="+h+", sizingMethod='auto expand')";f.style.backgroundColor=this.rotatedHtmlBackground;1>this.state.alpha&&(f.style.filter+="alpha(opacity="+100*this.state.alpha+")");e.style.visibility="";f.appendChild(e)}else 8!=document.documentMode?(e.style.verticalAlign="top",1>this.state.alpha&&(k.style.filter="alpha(opacity="+
100*this.state.alpha+")"),o=e.parentNode,e.style.visibility="hidden",document.body.appendChild(e),c=e.offsetWidth,n=e.offsetHeight,mxClient.IS_QUIRKS&&m&&n>d&&(n=d,e.style.height=n+"px"),d=n,e.style.visibility="",o.appendChild(e),k.style.left=this.format(a+c*t*this.state.scale)+"px",k.style.top=this.format(b+d*s*this.state.scale)+"px"):(1>this.state.alpha&&(e.style.filter="alpha(opacity="+100*this.state.alpha+")"),n.style.left=100*t+"%",n.style.top=100*s+"%")}else this.plainText(a,b,c,d,mxUtils.htmlEntities(e,
false),f,g,h,k,l,m,p)}};
mxVmlCanvas2D.prototype.plainText=function(a,b,c,d,e,f,g,h,k,l,m,p){h=this.state;a=(a+h.dx)*h.scale;b=(b+h.dy)*h.scale;c=document.createElement(mxClient.VML_PREFIX+":shape");c.style.width="1px";c.style.height="1px";c.stroked="false";d=document.createElement(mxClient.VML_PREFIX+":fill");d.color=h.fontColor;d.opacity=100*h.alpha+"%";c.appendChild(d);d=document.createElement(mxClient.VML_PREFIX+":path");d.textpathok="true";d.v="m "+this.format(0)+" "+this.format(0)+" l "+this.format(1)+" "+this.format(0);
c.appendChild(d);d=document.createElement(mxClient.VML_PREFIX+":textpath");d.style.cssText="v-text-align:"+f;d.style.align=f;d.style.fontFamily=h.fontFamily;d.string=e;d.on="true";f=Math.round(h.fontSize*h.scale/this.vmlScale);d.style.fontSize=f+"px";(h.fontStyle&mxConstants.FONT_BOLD)==mxConstants.FONT_BOLD&&(d.style.fontWeight="bold");(h.fontStyle&mxConstants.FONT_ITALIC)==mxConstants.FONT_ITALIC&&(d.style.fontStyle="italic");(h.fontStyle&mxConstants.FONT_UNDERLINE)==mxConstants.FONT_UNDERLINE&&
(d.style.textDecoration="underline");e=e.split("\n");h=f+(e.length-1)*f*mxConstants.LINE_HEIGHT;f=e=0;g==mxConstants.ALIGN_BOTTOM?f=-h/2:g!=mxConstants.ALIGN_MIDDLE&&(f=h/2);null!=p&&(c.style.rotation=p,g=p*(Math.PI/180),e=Math.sin(g)*f,f*=Math.cos(g));c.appendChild(d);c.style.left=this.format(a-e)+"px";c.style.top=this.format(b+f)+"px";this.root.appendChild(c)};mxVmlCanvas2D.prototype.stroke=function(){this.addNode(false,true)};mxVmlCanvas2D.prototype.fill=function(){this.addNode(true,false)};
mxVmlCanvas2D.prototype.fillAndStroke=function(){this.addNode(true,true)};function mxGuide(a,b){this.graph=a;this.setStates(b)}mxGuide.prototype.graph=null;mxGuide.prototype.states=null;mxGuide.prototype.horizontal=true;mxGuide.prototype.vertical=true;mxGuide.prototype.guideX=null;mxGuide.prototype.guideY=null;mxGuide.prototype.setStates=function(a){this.states=a};mxGuide.prototype.isEnabledForEvent=function(){return true};
mxGuide.prototype.getGuideTolerance=function(){return this.graph.gridSize*this.graph.view.scale/2};mxGuide.prototype.createGuideShape=function(a){a=new mxPolyline([],mxConstants.GUIDE_COLOR,mxConstants.GUIDE_STROKEWIDTH);a.isDashed=true;return a};
mxGuide.prototype.move=function(a,b,c){if(null!=this.states&&(this.horizontal||this.vertical)&&null!=a&&null!=b){var d=this.graph.getView().translate,e=this.graph.getView().scale,f=b.x,g=b.y,h=false,k=false,l=this.getGuideTolerance(),m=l,p=l;l=a.clone();l.x+=b.x;l.y+=b.y;var o=l.x,n=l.x+l.width,s=l.getCenterX(),t=l.y,q=l.y+l.height,r=l.getCenterY();b=function(A){A+=this.graph.panDx;var H=false;Math.abs(A-s)<m?(f=A-a.getCenterX(),m=Math.abs(A-s),H=true):Math.abs(A-o)<m?(f=A-a.x,m=Math.abs(A-o),H=true):
Math.abs(A-n)<m&&(f=A-a.x-a.width,m=Math.abs(A-n),H=true);if(H){null==this.guideX&&(this.guideX=this.createGuideShape(true),this.guideX.dialect=this.graph.dialect!=mxConstants.DIALECT_SVG?mxConstants.DIALECT_VML:mxConstants.DIALECT_SVG,this.guideX.pointerEvents=false,this.guideX.init(this.graph.getView().getOverlayPane()));var D=this.graph.container;A-=this.graph.panDx;this.guideX.points=[new mxPoint(A,-this.graph.panDy),new mxPoint(A,D.scrollHeight-3-this.graph.panDy)]}h=h||H};l=function(A){A+=this.graph.panDy;
var H=false;Math.abs(A-r)<p?(g=A-a.getCenterY(),p=Math.abs(A-r),H=true):Math.abs(A-t)<p?(g=A-a.y,p=Math.abs(A-t),H=true):Math.abs(A-q)<p&&(g=A-a.y-a.height,p=Math.abs(A-q),H=true);if(H){null==this.guideY&&(this.guideY=this.createGuideShape(false),this.guideY.dialect=this.graph.dialect!=mxConstants.DIALECT_SVG?mxConstants.DIALECT_VML:mxConstants.DIALECT_SVG,this.guideY.pointerEvents=false,this.guideY.init(this.graph.getView().getOverlayPane()));var D=this.graph.container;A-=this.graph.panDy;this.guideY.points=
[new mxPoint(-this.graph.panDx,A),new mxPoint(D.scrollWidth-3-this.graph.panDx,A)]}k=k||H};for(var u=0;u<this.states.length;u++){var x=this.states[u];null!=x&&(this.horizontal&&(b.call(this,x.getCenterX()),b.call(this,x.x),b.call(this,x.x+x.width)),this.vertical&&(l.call(this,x.getCenterY()),l.call(this,x.y),l.call(this,x.y+x.height)))}!h&&null!=this.guideX?this.guideX.node.style.visibility="hidden":null!=this.guideX&&(this.guideX.node.style.visibility="visible",this.guideX.redraw());!k&&null!=this.guideY?
this.guideY.node.style.visibility="hidden":null!=this.guideY&&(this.guideY.node.style.visibility="visible",this.guideY.redraw());c&&(h||(c=a.x-(this.graph.snap(a.x/e-d.x)+d.x)*e,f=this.graph.snap(f/e)*e-c),k||(d=a.y-(this.graph.snap(a.y/e-d.y)+d.y)*e,g=this.graph.snap(g/e)*e-d));b=new mxPoint(f,g)}return b};mxGuide.prototype.hide=function(){null!=this.guideX&&(this.guideX.node.style.visibility="hidden");null!=this.guideY&&(this.guideY.node.style.visibility="hidden")};
mxGuide.prototype.destroy=function(){null!=this.guideX&&(this.guideX.destroy(),this.guideX=null);null!=this.guideY&&(this.guideY.destroy(),this.guideY=null)};function mxStencil(a){this.desc=a;this.parseDescription();this.parseConstraints()}mxStencil.defaultLocalized=false;mxStencil.prototype.desc=null;mxStencil.prototype.constraints=null;mxStencil.prototype.aspect=null;mxStencil.prototype.w0=null;mxStencil.prototype.h0=null;mxStencil.prototype.bgNode=null;mxStencil.prototype.fgNode=null;
mxStencil.prototype.strokewidth=null;mxStencil.prototype.parseDescription=function(){this.fgNode=this.desc.getElementsByTagName("foreground")[0];this.bgNode=this.desc.getElementsByTagName("background")[0];this.w0=Number(this.desc.getAttribute("w")||100);this.h0=Number(this.desc.getAttribute("h")||100);var a=this.desc.getAttribute("aspect");this.aspect=null!=a?a:"variable";a=this.desc.getAttribute("strokewidth");this.strokewidth=null!=a?a:"1"};
mxStencil.prototype.parseConstraints=function(){var a=this.desc.getElementsByTagName("connections")[0];if(null!=a&&(a=mxUtils.getChildNodes(a),null!=a&&0<a.length)){this.constraints=[];for(var b=0;b<a.length;b++)this.constraints.push(this.parseConstraint(a[b]))}};mxStencil.prototype.parseConstraint=function(a){var b=Number(a.getAttribute("x")),c=Number(a.getAttribute("y"));a="1"==a.getAttribute("perimeter");return new mxConnectionConstraint(new mxPoint(b,c),a)};
mxStencil.prototype.evaluateTextAttribute=function(a,b,c){b=this.evaluateAttribute(a,b,c);a=a.getAttribute("localized");if(mxStencil.defaultLocalized&&null==a||"1"==a)b=mxResources.get(b);return b};mxStencil.prototype.evaluateAttribute=function(a,b,c){b=a.getAttribute(b);null==b&&(a=mxUtils.getTextContent(a),null!=a&&(a=mxUtils.eval(a),"function"==typeof a&&(b=a(c))));return b};
mxStencil.prototype.drawShape=function(a,b,c,d,e,f){this.drawChildren(a,b,c,d,e,f,this.bgNode,false);this.drawChildren(a,b,c,d,e,f,this.fgNode,true)};
mxStencil.prototype.drawChildren=function(a,b,c,d,e,f,g,h){if(null!=g){var k=mxUtils.getValue(b.style,mxConstants.STYLE_DIRECTION,null);c=this.computeAspect(b.style,c,d,e,f,k);d=Math.min(c.width,c.height);d="inherit"==this.strokewidth?Number(mxUtils.getNumber(b.style,mxConstants.STYLE_STROKEWIDTH,1)):Number(this.strokewidth)*d;a.setStrokeWidth(d);for(g=g.firstChild;null!=g;){g.nodeType==mxConstants.NODETYPE_ELEMENT&&this.drawNode(a,b,g,c,h);g=g.nextSibling}}};
mxStencil.prototype.computeAspect=function(a,b,c,d,e,f){a=b;b=d/this.w0;var g=e/this.h0;if(f="north"==f||"south"==f){g=d/this.h0;b=e/this.w0;var h=(d-e)/2;a+=h;c-=h}"fixed"==this.aspect&&(b=g=Math.min(b,g),f?(a+=(e-this.w0*b)/2,c+=(d-this.h0*g)/2):(a+=(d-this.w0*b)/2,c+=(e-this.h0*g)/2));return new mxRectangle(a,c,b,g)};
mxStencil.prototype.drawNode=function(a,b,c,d,e){var f=c.nodeName,g=d.x,h=d.y,k=d.width,l=d.height,m=Math.min(k,l);if("save"==f)a.save();else if("restore"==f)a.restore();else if("path"==f){a.begin();for(c=c.firstChild;null!=c;){c.nodeType==mxConstants.NODETYPE_ELEMENT&&this.drawNode(a,b,c,d,e);c=c.nextSibling}}else if("close"==f)a.close();else if("move"==f)a.moveTo(g+Number(c.getAttribute("x"))*k,h+Number(c.getAttribute("y"))*l);else if("line"==f)a.lineTo(g+Number(c.getAttribute("x"))*k,h+Number(c.getAttribute("y"))*
l);else if("quad"==f)a.quadTo(g+Number(c.getAttribute("x1"))*k,h+Number(c.getAttribute("y1"))*l,g+Number(c.getAttribute("x2"))*k,h+Number(c.getAttribute("y2"))*l);else if("curve"==f)a.curveTo(g+Number(c.getAttribute("x1"))*k,h+Number(c.getAttribute("y1"))*l,g+Number(c.getAttribute("x2"))*k,h+Number(c.getAttribute("y2"))*l,g+Number(c.getAttribute("x3"))*k,h+Number(c.getAttribute("y3"))*l);else if("arc"==f)a.arcTo(Number(c.getAttribute("rx"))*k,Number(c.getAttribute("ry"))*l,Number(c.getAttribute("x-axis-rotation")),
Number(c.getAttribute("large-arc-flag")),Number(c.getAttribute("sweep-flag")),g+Number(c.getAttribute("x"))*k,h+Number(c.getAttribute("y"))*l);else if("rect"==f)a.rect(g+Number(c.getAttribute("x"))*k,h+Number(c.getAttribute("y"))*l,Number(c.getAttribute("w"))*k,Number(c.getAttribute("h"))*l);else if("roundrect"==f){b=c.getAttribute("arcsize");0==b&&(b=100*mxConstants.RECTANGLE_ROUNDING_FACTOR);m=Number(c.getAttribute("w"))*k;d=Number(c.getAttribute("h"))*l;b=Number(b)/100;b=Math.min(m*b,d*b);a.roundrect(g+
Number(c.getAttribute("x"))*k,h+Number(c.getAttribute("y"))*l,m,d,b,b)}else if("ellipse"==f)a.ellipse(g+Number(c.getAttribute("x"))*k,h+Number(c.getAttribute("y"))*l,Number(c.getAttribute("w"))*k,Number(c.getAttribute("h"))*l);else if("image"==f){b=this.evaluateAttribute(c,"src",b);a.image(g+Number(c.getAttribute("x"))*k,h+Number(c.getAttribute("y"))*l,Number(c.getAttribute("w"))*k,Number(c.getAttribute("h"))*l,b,false,"1"==c.getAttribute("flipH"),"1"==c.getAttribute("flipV"))}else if("text"==f){m=
this.evaluateTextAttribute(c,"str",b);d="1"==c.getAttribute("vertical")?-90:0;if("0"==c.getAttribute("align-shape")){var p=b.rotation,o=1==mxUtils.getValue(b.style,mxConstants.STYLE_FLIPH,0);b=1==mxUtils.getValue(b.style,mxConstants.STYLE_FLIPV,0);d=o&&b?d-p:o||b?d+p:d-p}d-=c.getAttribute("rotation");a.text(g+Number(c.getAttribute("x"))*k,h+Number(c.getAttribute("y"))*l,0,0,m,c.getAttribute("align")||"left",c.getAttribute("valign")||"top",false,"",null,false,d)}else if("include-shape"==f){p=mxStencilRegistry.getStencil(c.getAttribute("name"));
null!=p&&(g+=Number(c.getAttribute("x"))*k,h+=Number(c.getAttribute("y"))*l,m=Number(c.getAttribute("w"))*k,d=Number(c.getAttribute("h"))*l,p.drawShape(a,b,g,h,m,d))}else if("fillstroke"==f)a.fillAndStroke();else if("fill"==f)a.fill();else if("stroke"==f)a.stroke();else if("strokewidth"==f){k="1"==c.getAttribute("fixed")?1:m;a.setStrokeWidth(Number(c.getAttribute("width"))*k)}else if("dashed"==f)a.setDashed("1"==c.getAttribute("dashed"));else if("dashpattern"==f){if(c=c.getAttribute("pattern"),null!=
c){c=c.split(" ");k=[];for(l=0;l<c.length;l++)0<c[l].length&&k.push(Number(c[l])*m);c=k.join(" ");a.setDashPattern(c)}}else"strokecolor"==f?a.setStrokeColor(c.getAttribute("color")):"linecap"==f?a.setLineCap(c.getAttribute("cap")):"linejoin"==f?a.setLineJoin(c.getAttribute("join")):"miterlimit"==f?a.setMiterLimit(Number(c.getAttribute("limit"))):"fillcolor"==f?a.setFillColor(c.getAttribute("color")):"alpha"==f?a.setAlpha(c.getAttribute("alpha")):"fontcolor"==f?a.setFontColor(c.getAttribute("color")):
"fontstyle"==f?a.setFontStyle(c.getAttribute("style")):"fontfamily"==f?a.setFontFamily(c.getAttribute("family")):"fontsize"==f&&a.setFontSize(Number(c.getAttribute("size"))*m);e&&("fillstroke"==f||"fill"==f||"stroke"==f)&&a.setShadow(false)};function mxShape(a){this.stencil=a;this.strokewidth=1;this.rotation=0;this.opacity=100;this.flipV=this.flipH=false}mxShape.prototype.dialect=null;mxShape.prototype.scale=1;mxShape.prototype.bounds=null;mxShape.prototype.points=null;mxShape.prototype.node=null;
mxShape.prototype.style=null;mxShape.prototype.style=null;mxShape.prototype.boundingBox=null;mxShape.prototype.stencil=null;mxShape.prototype.svgStrokeTolerance=6;mxShape.prototype.pointerEvents=true;mxShape.prototype.stencilPointerEvents=false;mxShape.prototype.vmlScale=1;mxShape.prototype.init=function(a){null==this.node&&(this.node=this.create(a),null!=a&&a.appendChild(this.node))};mxShape.prototype.isParseVml=function(){return true};mxShape.prototype.isHtmlAllowed=function(){return false};
mxShape.prototype.getSvgScreenOffset=function(){return 1==mxUtils.mod(Math.max(1,Math.round(this.strokewidth*this.scale)),2)?0.5:0};mxShape.prototype.create=function(a){return null!=a.ownerSVGElement?this.createSvg(a):8==document.documentMode||this.dialect==mxConstants.DIALECT_SVG||this.dialect!=mxConstants.DIALECT_VML&&this.isHtmlAllowed()?this.createHtml(a):this.createVml(a)};mxShape.prototype.createSvg=function(){return document.createElementNS(mxConstants.NS_SVG,"g")};
mxShape.prototype.createVml=function(){var a=document.createElement(mxClient.VML_PREFIX+":group");a.style.position="absolute";return a};mxShape.prototype.createHtml=function(){var a=document.createElement("div");a.style.position="absolute";return a};mxShape.prototype.reconfigure=function(){this.redraw()};
mxShape.prototype.redraw=function(){this.updateBoundsFromPoints();this.checkBounds()?(this.node.style.visibility="","DIV"==this.node.nodeName&&this.isHtmlAllowed()?this.redrawHtmlShape():this.redrawShape(),this.updateBoundingBox()):(this.node.style.visibility="hidden",this.boundingBox=null)};
mxShape.prototype.updateBoundsFromPoints=function(){var a=this.points;if(null!=a&&0<a.length&&null!=a[0]){this.bounds=new mxRectangle(Number(a[0].x),Number(a[0].y),1,1);for(var b=1;b<this.points.length;b++)null!=a[b]&&this.bounds.add(new mxRectangle(Number(a[b].x),Number(a[b].y),1,1))}};mxShape.prototype.getLabelBounds=function(a){return a};
mxShape.prototype.checkBounds=function(){return null!=this.bounds&&!isNaN(this.bounds.x)&&!isNaN(this.bounds.y)&&!isNaN(this.bounds.width)&&!isNaN(this.bounds.height)&&0<this.bounds.width&&0<this.bounds.height};mxShape.prototype.createVmlGroup=function(){var a=document.createElement(mxClient.VML_PREFIX+":group");a.style.position="absolute";a.style.width=this.node.style.width;a.style.height=this.node.style.height;return a};
mxShape.prototype.redrawShape=function(){var a=this.createCanvas();for(a.pointerEvents=this.pointerEvents;this.node.hasChildNodes();)this.node.removeChild(this.node.lastChild);this.paint(a);this.node!=a.root&&this.node.insertAdjacentHTML("beforeend",a.root.outerHTML);"DIV"==this.node.nodeName&&8==document.documentMode&&(this.node.style.filter="",(null==this.stencil||!this.stencilPointerEvents)&&mxUtils.addTransparentBackgroundFilter(this.node));this.destroyCanvas(a)};
mxShape.prototype.createCanvas=function(){var a=null,b=null;if(null!=this.node.ownerSVGElement){a=new mxSvgCanvas2D(this.node,false);a.strokeTolerance=this.svgStrokeTolerance;a.blockImagePointerEvents=mxClient.IS_NS&&!mxClient.IS_SF&&!mxClient.IS_GC;b=this.getSvgScreenOffset();0!=b?this.node.setAttribute("transform","translate("+b+","+b+")"):this.node.removeAttribute("transform")}else{this.updateVmlContainer();var c=Math.max(1,Math.round(this.bounds.width)),d=Math.max(1,Math.round(this.bounds.height));
b=8==document.documentMode&&this.isParseVml()?this.createVmlGroup():this.node;a=new mxVmlCanvas2D(b,false);""!=b.tagUrn&&(b.coordsize=c*this.vmlScale+","+d*this.vmlScale,a.scale(this.vmlScale),a.vmlScale=this.vmlScale);b=this.scale;a.translate(-Math.round(this.bounds.x/b),-Math.round(this.bounds.y/b))}return a};
mxShape.prototype.updateVmlContainer=function(){this.node.style.left=Math.round(this.bounds.x)+"px";this.node.style.top=Math.round(this.bounds.y)+"px";var a=Math.max(1,Math.round(this.bounds.height));this.node.style.width=Math.max(1,Math.round(this.bounds.width))+"px";this.node.style.height=a+"px";this.node.style.overflow="visible"};
mxShape.prototype.destroyCanvas=function(a){if(a instanceof mxSvgCanvas2D){for(var b in a.gradients){var c=a.gradients[b];c.mxRefCount=(c.mxRefCount||0)+1}this.releaseSvgGradients(this.oldGradients);this.oldGradients=a.gradients}};
mxShape.prototype.paint=function(a){var b=this.scale,c=this.bounds.x/b,d=this.bounds.y/b,e=this.bounds.width/b,f=this.bounds.height/b;if(this.isPaintBoundsInverted()){var g=(e-f)/2;c+=g;d-=g;g=e;e=f;f=g}this.updateTransform(a,c,d,e,f);this.configureCanvas(a,c,d,e,f);if(null!=this.stencil)this.paintStencilShape(a,c,d,e,f);else if(a.setStrokeWidth(this.strokewidth),null!=this.points){c=[];for(d=0;d<this.points.length;d++)c.push(new mxPoint(this.points[d].x/b,this.points[d].y/b));this.paintEdgeShape(a,
c)}else this.paintVertexShape(a,c,d,e,f)};mxShape.prototype.configureCanvas=function(a,b,c,d,e){var f=null;null!=this.style&&(f=this.style.dashPattern);a.setAlpha(this.opacity/100);null!=this.isShadow&&a.setShadow(this.isShadow);null!=this.isDashed&&a.setDashed(this.isDashed);null!=f&&a.setDashPattern(f);null!=this.gradient?(b=this.getGradientBounds(a,b,c,d,e),a.setGradient(this.fill,this.gradient,b.x,b.y,b.width,b.height,this.gradientDirection)):a.setFillColor(this.fill);a.setStrokeColor(this.stroke)};
mxShape.prototype.getGradientBounds=function(a,b,c,d,e){return new mxRectangle(b,c,d,e)};mxShape.prototype.updateTransform=function(a,b,c,d,e){a.scale(this.scale);a.rotate(this.getShapeRotation(),this.flipH,this.flipV,b+d/2,c+e/2)};
mxShape.prototype.paintStencilShape=function(a,b,c,d,e){this.stencilPointerEvents&&(this.dialect==mxConstants.DIALECT_SVG?this.addTransparentBackgroundRectangle(this.node,b,c,d,e):8!=document.documentMode&&this.setTransparentBackgroundImage(this.node));this.stencil.drawShape(a,this,b,c,d,e)};mxShape.prototype.paintVertexShape=function(a,b,c,d,e){this.paintBackground(a,b,c,d,e);a.setShadow(false);this.paintForeground(a,b,c,d,e)};mxShape.prototype.paintBackground=function(){};
mxShape.prototype.paintForeground=function(){};mxShape.prototype.paintEdgeShape=function(){};mxShape.prototype.getArcSize=function(a,b){var c=mxUtils.getValue(this.style,mxConstants.STYLE_ARCSIZE,100*mxConstants.RECTANGLE_ROUNDING_FACTOR)/100;return Math.min(a*c,b*c)};
mxShape.prototype.paintGlassEffect=function(a,b,c,d,e,f){var g=Math.ceil(this.strokewidth/2);a.setGradient("#ffffff","#ffffff",b,c,d,0.6*e,"south",0.9,0.1);a.begin();f+=2*g;this.isRounded?(a.moveTo(b-g+f,c-g),a.quadTo(b-g,c-g,b-g,c-g+f),a.lineTo(b-g,c+0.4*e),a.quadTo(b+0.5*d,c+0.7*e,b+d+g,c+0.4*e),a.lineTo(b+d+g,c-g+f),a.quadTo(b+d+g,c-g,b+d+g-f,c-g)):(a.moveTo(b-g,c-g),a.lineTo(b-g,c+0.4*e),a.quadTo(b+0.5*d,c+0.7*e,b+d+g,c+0.4*e),a.lineTo(b+d+g,c-g));a.close();a.fill()};
mxShape.prototype.apply=function(a){this.state=a;this.style=a.style;if(null!=this.style){this.fill=mxUtils.getValue(this.style,mxConstants.STYLE_FILLCOLOR,this.fill);this.gradient=mxUtils.getValue(this.style,mxConstants.STYLE_GRADIENTCOLOR,this.gradient);this.gradientDirection=mxUtils.getValue(this.style,mxConstants.STYLE_GRADIENT_DIRECTION,this.gradientDirection);this.opacity=mxUtils.getValue(this.style,mxConstants.STYLE_OPACITY,this.opacity);this.stroke=mxUtils.getValue(this.style,mxConstants.STYLE_STROKECOLOR,
this.stroke);this.strokewidth=mxUtils.getNumber(this.style,mxConstants.STYLE_STROKEWIDTH,this.strokewidth);this.spacing=mxUtils.getValue(this.style,mxConstants.STYLE_SPACING,this.spacing);this.startSize=mxUtils.getNumber(this.style,mxConstants.STYLE_STARTSIZE,this.startSize);this.endSize=mxUtils.getNumber(this.style,mxConstants.STYLE_ENDSIZE,this.endSize);this.startArrow=mxUtils.getValue(this.style,mxConstants.STYLE_STARTARROW,this.startArrow);this.endArrow=mxUtils.getValue(this.style,mxConstants.STYLE_ENDARROW,
this.endArrow);this.rotation=mxUtils.getValue(this.style,mxConstants.STYLE_ROTATION,this.rotation);this.direction=mxUtils.getValue(this.style,mxConstants.STYLE_DIRECTION,this.direction);this.flipH=1==mxUtils.getValue(this.style,mxConstants.STYLE_FLIPH,0);this.flipV=1==mxUtils.getValue(this.style,mxConstants.STYLE_FLIPV,0);null!=this.stencil&&(this.flipH=1==mxUtils.getValue(this.style,"stencilFlipH",0)||this.flipH,this.flipV=1==mxUtils.getValue(this.style,"stencilFlipV",0)||this.flipV);if("north"==
this.direction||"south"==this.direction){a=this.flipH;this.flipH=this.flipV;this.flipV=a}this.isShadow=1==mxUtils.getValue(this.style,mxConstants.STYLE_SHADOW,this.isShadow);this.isDashed=1==mxUtils.getValue(this.style,mxConstants.STYLE_DASHED,this.isDashed);this.isRounded=1==mxUtils.getValue(this.style,mxConstants.STYLE_ROUNDED,this.isRounded);this.glass=1==mxUtils.getValue(this.style,mxConstants.STYLE_GLASS,this.glass);"none"==this.fill&&(this.fill=null);"none"==this.gradient&&(this.gradient=null);
"none"==this.stroke&&(this.stroke=null)}};mxShape.prototype.setCursor=function(a){null==a&&(a="");this.cursor=a;null!=this.node&&(this.node.style.cursor=a)};mxShape.prototype.getCursor=function(){return this.cursor};
mxShape.prototype.updateBoundingBox=function(){if(null!=this.bounds){var a=this.createBoundingBox();if(null!=a){this.augmentBoundingBox(a);var b=this.getShapeRotation();0!=b&&(a=mxUtils.getBoundingBox(a,b));a.x=Math.floor(a.x);a.y=Math.floor(a.y);a.width=Math.ceil(a.width);a.height=Math.ceil(a.height)}this.boundingBox=a}};
mxShape.prototype.createBoundingBox=function(){var a=this.bounds.clone();if(this.isPaintBoundsInverted()){var b=(a.width-a.height)/2;a.x+=b;a.y-=b;b=a.width;a.width=a.height;a.height=b}return a};mxShape.prototype.augmentBoundingBox=function(a){this.isShadow&&(a.width+=Math.ceil(mxConstants.SHADOW_OFFSET_X*this.scale),a.height+=Math.ceil(mxConstants.SHADOW_OFFSET_Y*this.scale));a.grow(Math.ceil(Math.ceil(this.strokewidth*this.scale)/2))};
mxShape.prototype.isPaintBoundsInverted=function(){return null==this.stencil&&("north"==this.direction||"south"==this.direction)};mxShape.prototype.getRotation=function(){return null!=this.rotation?this.rotation:0};mxShape.prototype.getTextRotation=function(){var a=this.getRotation();1!=mxUtils.getValue(this.style,mxConstants.STYLE_HORIZONTAL,1)&&(a+=mxText.prototype.verticalTextRotation);return a};
mxShape.prototype.getShapeRotation=function(){var a=this.getRotation();null!=this.direction&&("north"==this.direction?a+=270:"west"==this.direction?a+=180:"south"==this.direction&&(a+=90));return a};
mxShape.prototype.addTransparentBackgroundRectangle=function(a,b,c,d,e){a=document.createElementNS(mxConstants.NS_SVG,"rect");a.setAttribute("x",b);a.setAttribute("y",c);a.setAttribute("width",d);a.setAttribute("height",e);a.setAttribute("fill","none");a.setAttribute("stroke","none");a.setAttribute("pointer-events","all");this.node.appendChild(a)};mxShape.prototype.setTransparentBackgroundImage=function(a){a.style.backgroundImage="url('"+mxClient.imageBasePath+"/transparent.gif')"};
mxShape.prototype.releaseSvgGradients=function(a){if(null!=a)for(var b in a){var c=a[b];c.mxRefCount=(c.mxRefCount||0)-1;0==c.mxRefCount&&null!=c.parentNode&&c.parentNode.removeChild(c)}};mxShape.prototype.destroy=function(){null!=this.node&&(mxEvent.release(this.node),null!=this.node.parentNode&&this.node.parentNode.removeChild(this.node),this.node=null);this.releaseSvgGradients(this.oldGradients);this.oldGradients=null};
var mxStencilRegistry={stencils:[],addStencil:function(a,b){mxStencilRegistry.stencils[a]=b},getStencil:function(a){return mxStencilRegistry.stencils[a]}},mxMarker={markers:[],addMarker:function(a,b){mxMarker.markers[a]=b},createMarker:function(a,b,c,d,e,f,g,h,k,l){var m=mxMarker.markers[c];return null!=m?m(a,b,c,d,e,f,g,h,k,l):null}};
(function(){function a(c,d,e,f,g,h,k,l,m,p){d=1.118*g*m;l=1.118*h*m;g*=k+m;h*=k+m;var o=f.clone();o.x-=d;o.y-=l;k=e!=mxConstants.ARROW_CLASSIC?1:0.75;f.x+=-g*k-d;f.y+=-h*k-l;return function(){c.begin();c.moveTo(o.x,o.y);c.lineTo(o.x-g-h/2,o.y-h+g/2);e==mxConstants.ARROW_CLASSIC&&c.lineTo(o.x-3*g/4,o.y-3*h/4);c.lineTo(o.x+h/2-g,o.y-h-g/2);c.close();p?c.fillAndStroke():c.stroke()}}function b(c,d,e,f,g,h,k,l,m,p){l=e==mxConstants.ARROW_DIAMOND?0.7071:0.9862;d=g*m*l;l*=h*m;g*=k+m;h*=k+m;var o=f.clone();
o.x-=d;o.y-=l;f.x+=-g-d;f.y+=-h-l;var n=e==mxConstants.ARROW_DIAMOND?2:3.4;return function(){c.begin();c.moveTo(o.x,o.y);c.lineTo(o.x-g/2-h/n,o.y+g/n-h/2);c.lineTo(o.x-g,o.y-h);c.lineTo(o.x-g/2+h/n,o.y-h/2-g/n);c.close();p?c.fillAndStroke():c.stroke()}}mxMarker.addMarker("classic",a);mxMarker.addMarker("block",a);mxMarker.addMarker("open",function(c,d,e,f,g,h,k,l,m){d=1.118*g*m;e=1.118*h*m;g*=k+m;h*=k+m;var p=f.clone();p.x-=d;p.y-=e;f.x+=2*-d;f.y+=2*-e;return function(){c.begin();c.moveTo(p.x-g-h/
2,p.y-h+g/2);c.lineTo(p.x,p.y);c.lineTo(p.x+h/2-g,p.y-h-g/2);c.stroke()}});mxMarker.addMarker("oval",function(c,d,e,f,g,h,k,l,m,p){var o=k/2,n=f.clone();f.x-=g*o;f.y-=h*o;return function(){c.ellipse(n.x-o,n.y-o,k,k);p?c.fillAndStroke():c.stroke()}});mxMarker.addMarker("diamond",b);mxMarker.addMarker("diamondThin",b)})();function mxActor(a,b,c,d){mxShape.call(this);this.bounds=a;this.fill=b;this.stroke=c;this.strokewidth=null!=d?d:1}mxUtils.extend(mxActor,mxShape);
mxActor.prototype.paintVertexShape=function(a,b,c,d,e){a.translate(b,c);a.begin();this.redrawPath(a,b,c,d,e);a.fillAndStroke()};mxActor.prototype.redrawPath=function(a,b,c,d,e){b=d/3;a.moveTo(0,e);a.curveTo(0,3*e/5,0,2*e/5,d/2,2*e/5);a.curveTo(d/2-b,2*e/5,d/2-b,0,d/2,0);a.curveTo(d/2+b,0,d/2+b,2*e/5,d/2,2*e/5);a.curveTo(d,2*e/5,d,3*e/5,d,e);a.close()};function mxCloud(a,b,c,d){mxActor.call(this);this.bounds=a;this.fill=b;this.stroke=c;this.strokewidth=null!=d?d:1}mxUtils.extend(mxCloud,mxActor);
mxCloud.prototype.redrawPath=function(a,b,c,d,e){a.moveTo(0.25*d,0.25*e);a.curveTo(0.05*d,0.25*e,0,0.5*e,0.16*d,0.55*e);a.curveTo(0,0.66*e,0.18*d,0.9*e,0.31*d,0.8*e);a.curveTo(0.4*d,e,0.7*d,e,0.8*d,0.8*e);a.curveTo(d,0.8*e,d,0.6*e,0.875*d,0.5*e);a.curveTo(d,0.3*e,0.8*d,0.1*e,0.625*d,0.2*e);a.curveTo(0.5*d,0.05*e,0.3*d,0.05*e,0.25*d,0.25*e);a.close()};function mxRectangleShape(a,b,c,d){mxShape.call(this);this.bounds=a;this.fill=b;this.stroke=c;this.strokewidth=null!=d?d:1}
mxUtils.extend(mxRectangleShape,mxShape);mxRectangleShape.prototype.isHtmlAllowed=function(){return!this.isRounded&&!this.glass&&0==this.rotation};mxRectangleShape.prototype.paintBackground=function(a,b,c,d,e){if(this.isRounded){var f=mxUtils.getValue(this.style,mxConstants.STYLE_ARCSIZE,100*mxConstants.RECTANGLE_ROUNDING_FACTOR)/100;f=Math.min(d*f,e*f);a.roundrect(b,c,d,e,f,f)}else a.rect(b,c,d,e);a.fillAndStroke()};
mxRectangleShape.prototype.paintForeground=function(a,b,c,d,e){this.glass&&this.paintGlassEffect(a,b,c,d,e,this.getArcSize(d+this.strokewidth,e+this.strokewidth))};mxRectangleShape.prototype.redrawHtmlShape=function(){this.updateHtmlBounds(this.node);this.updateHtmlFilters(this.node);this.updateHtmlColors(this.node)};
mxRectangleShape.prototype.updateHtmlBounds=function(a){var b=9<=document.documentMode?0:Math.ceil(this.strokewidth*this.scale);a.style.borderWidth=Math.max(1,b)+"px";a.style.overflow="hidden";a.style.left=Math.round(this.bounds.x-b/2)+"px";a.style.top=Math.round(this.bounds.y-b/2)+"px";"CSS1Compat"==document.compatMode&&(b=-b);a.style.width=Math.round(Math.max(0,this.bounds.width+b))+"px";a.style.height=Math.round(Math.max(0,this.bounds.height+b))+"px"};
mxRectangleShape.prototype.updateHtmlColors=function(a){var b=this.stroke;null!=b&&b!=mxConstants.NONE?(a.style.borderColor=b,this.isDashed?a.style.borderStyle="dashed":0<this.strokewidth&&(a.style.borderStyle="solid"),a.style.borderWidth=Math.max(1,Math.ceil(this.strokewidth*this.scale))+"px"):a.style.borderWidth="0px";b=this.fill;null!=b&&b!=mxConstants.NONE?(a.style.backgroundColor=b,a.style.backgroundImage="none"):this.pointerEvents?a.style.backgroundColor="transparent":8==document.documentMode?
mxUtils.addTransparentBackgroundFilter(a):this.setTransparentBackgroundImage(a)};
mxRectangleShape.prototype.updateHtmlFilters=function(a){var b="";100>this.opacity&&(b+="alpha(opacity="+this.opacity+")");this.isShadow&&(b+="progid:DXImageTransform.Microsoft.dropShadow (OffX='"+Math.round(mxConstants.SHADOW_OFFSET_X*this.scale)+"', OffY='"+Math.round(mxConstants.SHADOW_OFFSET_Y*this.scale)+"', Color='"+mxConstants.SHADOWCOLOR+"')");if(this.gradient){var c=this.fill,d=this.gradient,e="0",f={east:0,south:1,west:2,north:3},g=null!=this.direction?f[this.direction]:0;null!=this.gradientDirection&&
(g=mxUtils.mod(g+f[this.gradientDirection]-1,4));1==g?(e="1",f=c,c=d,d=f):2==g?(f=c,c=d,d=f):3==g&&(e="1");b+="progid:DXImageTransform.Microsoft.gradient(startColorStr='"+c+"', endColorStr='"+d+"', gradientType='"+e+"')"}a.style.filter=b};function mxEllipse(a,b,c,d){mxShape.call(this);this.bounds=a;this.fill=b;this.stroke=c;this.strokewidth=null!=d?d:1}mxUtils.extend(mxEllipse,mxShape);mxEllipse.prototype.paintVertexShape=function(a,b,c,d,e){a.ellipse(b,c,d,e);a.fillAndStroke()};
function mxDoubleEllipse(a,b,c,d){mxShape.call(this);this.bounds=a;this.fill=b;this.stroke=c;this.strokewidth=null!=d?d:1}mxUtils.extend(mxDoubleEllipse,mxShape);mxDoubleEllipse.prototype.vmlScale=10;mxDoubleEllipse.prototype.paintBackground=function(a,b,c,d,e){a.ellipse(b,c,d,e);a.fillAndStroke()};mxDoubleEllipse.prototype.paintForeground=function(a,b,c,d,e){var f=Math.min(4,Math.min(d/5,e/5));d-=2*f;e-=2*f;0<d&&0<e&&a.ellipse(b+f,c+f,d,e);a.stroke()};
function mxRhombus(a,b,c,d){mxShape.call(this);this.bounds=a;this.fill=b;this.stroke=c;this.strokewidth=null!=d?d:1}mxUtils.extend(mxRhombus,mxShape);mxRhombus.prototype.paintVertexShape=function(a,b,c,d,e){var f=d/2,g=e/2;a.begin();a.moveTo(b+f,c);a.lineTo(b+d,c+g);a.lineTo(b+f,c+e);a.lineTo(b,c+g);a.close();a.fillAndStroke()};function mxPolyline(a,b,c){mxShape.call(this);this.points=a;this.stroke=b;this.strokewidth=null!=c?c:1}mxUtils.extend(mxPolyline,mxShape);
mxPolyline.prototype.getRotation=function(){return 0};mxPolyline.prototype.paintEdgeShape=function(a,b){this.paintLine(a,b,this.isRounded)};
mxPolyline.prototype.paintLine=function(a,b,c){var d=mxUtils.getValue(this.style,mxConstants.STYLE_ARCSIZE,mxConstants.LINE_ARCSIZE)/2,e=b[0],f=b[b.length-1];a.begin();a.moveTo(e.x,e.y);for(var g=1;g<b.length-1;g++){var h=b[g],k=e.x-h.x;e=e.y-h.y;if(c&&g<b.length-1&&(0!=k||0!=e)){var l=Math.sqrt(k*k+e*e);k=k*Math.min(d,l/2)/l;e=e*Math.min(d,l/2)/l;a.lineTo(h.x+k,h.y+e);e=b[g+1];k=e.x-h.x;e=e.y-h.y;l=Math.max(1,Math.sqrt(k*k+e*e));k=k*Math.min(d,l/2)/l;e=e*Math.min(d,l/2)/l;k=h.x+k;e=h.y+e;a.quadTo(h.x,
h.y,k,e);h=new mxPoint(k,e)}else a.lineTo(h.x,h.y);e=h}a.lineTo(f.x,f.y);a.stroke()};function mxArrow(a,b,c,d,e,f,g){mxShape.call(this);this.points=a;this.fill=b;this.stroke=c;this.strokewidth=null!=d?d:1;this.arrowWidth=null!=e?e:mxConstants.ARROW_WIDTH;this.spacing=null!=f?f:mxConstants.ARROW_SPACING;this.endSize=null!=g?g:mxConstants.ARROW_SIZE}mxUtils.extend(mxArrow,mxShape);
mxArrow.prototype.paintEdgeShape=function(a,b){var c=mxConstants.ARROW_SPACING,d=mxConstants.ARROW_WIDTH,e=mxConstants.ARROW_SIZE,f=b[0],g=b[b.length-1],h=g.x-f.x,k=g.y-f.y,l=Math.sqrt(h*h+k*k),m=l-2*c-e;h/=l;k/=l;l=d*k/3;d=-d*h/3;e=f.x-l/2+c*h;f=f.y-d/2+c*k;var p=e+l,o=f+d,n=p+m*h;m=o+m*k;var s=n+l,t=m+d,q=s-3*l,r=t-3*d;a.begin();a.moveTo(e,f);a.lineTo(p,o);a.lineTo(n,m);a.lineTo(s,t);a.lineTo(g.x-c*h,g.y-c*k);a.lineTo(q,r);a.lineTo(q+l,r+d);a.close();a.fillAndStroke()};
function mxText(a,b,c,d,e,f,g,h,k,l,m,p,o,n,s,t,q,r,u,x){mxShape.call(this);this.value=a;this.bounds=b;this.color=null!=e?e:"black";this.align=null!=c?c:"";this.valign=null!=d?d:"";this.family=null!=f?f:mxConstants.DEFAULT_FONTFAMILY;this.size=null!=g?g:mxConstants.DEFAULT_FONTSIZE;this.fontStyle=null!=h?h:mxConstants.DEFAULT_FONTSTYLE;this.spacing=parseInt(k||2);this.spacingTop=this.spacing+parseInt(l||0);this.spacingRight=this.spacing+parseInt(m||0);this.spacingBottom=this.spacing+parseInt(p||0);
this.spacingLeft=this.spacing+parseInt(o||0);this.horizontal=null!=n?n:true;this.background=s;this.border=t;this.wrap=null!=q?q:false;this.clipped=null!=r?r:false;this.overflow=null!=u?u:"visible";this.labelPadding=null!=x?x:0;this.rotation=0}mxUtils.extend(mxText,mxShape);mxText.prototype.baseSpacingTop=0;mxText.prototype.baseSpacingBottom=0;mxText.prototype.baseSpacingLeft=0;mxText.prototype.baseSpacingRight=0;mxText.prototype.replaceLinefeeds=true;mxText.prototype.verticalTextRotation=-90;
mxText.prototype.ignoreClippedStringSize=true;mxText.prototype.ignoreStringSize=false;mxText.prototype.isParseVml=function(){return false};mxText.prototype.isHtmlAllowed=function(){return 8!=document.documentMode};mxText.prototype.getSvgScreenOffset=function(){return 0};mxText.prototype.checkBounds=function(){return null!=this.bounds&&!isNaN(this.bounds.x)&&!isNaN(this.bounds.y)&&!isNaN(this.bounds.width)&&!isNaN(this.bounds.height)};
mxText.prototype.updateBoundingBox=function(){var a=this.node;8==document.documentMode&&null!=a.firstChild&&(a=a.firstChild,null!=a.firstChild&&(a=a.firstChild));this.boundingBox=this.bounds.clone();var b=this.getTextRotation();if(!this.ignoreStringSize&&null!=a&&"fill"!=this.overflow&&(!this.clipped||!this.ignoreClippedStringSize)){var c=null,d=null;if(null!=a.ownerSVGElement)if(null!=a.firstChild&&null!=a.firstChild.firstChild&&"foreignObject"==a.firstChild.firstChild.nodeName){a=a.firstChild.firstChild;
c=this.wrap?this.bounds.width:parseInt(a.getAttribute("width"))*this.scale;d=parseInt(a.getAttribute("height"))*this.scale}else{b=a.getBBox();if(0==b.width&&0==b.height)return;this.boundingBox=new mxRectangle(b.x,b.y,b.width,b.height);b=0}else{d=this.state.view.textDiv;null!=this.offsetWidth&&null!=this.offsetHeight?(c=this.wrap?this.bounds.width:this.offsetWidth*this.scale,d=this.offsetHeight*this.scale):null!=d?(this.updateFont(d),this.updateSize(d),mxUtils.isNode(this.value)?d.innerHTML=this.value.outerHTML:
(c=this.replaceLinefeeds?this.value.replace(/\n/g,"<br/>"):this.value,d.innerHTML=c),c=this.wrap?this.bounds.width:d.offsetWidth*this.scale,d=d.offsetHeight*this.scale):(c=this.wrap?this.bounds.width:a.offsetWidth*this.scale,d=a.offsetHeight*this.scale)}null!=c&&null!=d&&(this.boundingBox=new mxRectangle(this.bounds.x+this.margin.x*c,this.bounds.y+this.margin.y*d,c,d))}else{this.boundingBox.x+=this.margin.x*this.boundingBox.width;this.boundingBox.y+=this.margin.y*this.boundingBox.height}null!=this.boundingBox&&
(0!=b&&(b=mxUtils.getBoundingBox(this.boundingBox,b),this.boundingBox.x=b.x,this.boundingBox.y=b.y,mxClient.IS_QUIRKS||(this.boundingBox.width=b.width,this.boundingBox.height=b.height)),this.boundingBox.x=Math.floor(this.boundingBox.x),this.boundingBox.y=Math.floor(this.boundingBox.y),this.boundingBox.width=Math.ceil(this.boundingBox.width),this.boundingBox.height=Math.ceil(this.boundingBox.height))};mxText.prototype.getShapeRotation=function(){return 0};
mxText.prototype.getTextRotation=function(){return null!=this.state&&null!=this.state.shape?this.state.shape.getTextRotation():0};mxText.prototype.isPaintBoundsInverted=function(){return!this.horizontal&&null!=this.state&&this.state.view.graph.model.isVertex(this.state.cell)};
mxText.prototype.configureCanvas=function(a){mxShape.prototype.configureCanvas.apply(this,arguments);a.setFontColor(this.color);a.setFontBackgroundColor(this.background);a.setFontBorderColor(this.border);a.setFontFamily(this.family);a.setFontSize(this.size);a.setFontStyle(this.fontStyle)};
mxText.prototype.updateVmlContainer=function(){this.node.style.left=Math.round(this.bounds.x)+"px";this.node.style.top=Math.round(this.bounds.y)+"px";this.node.style.width="1px";this.node.style.height="1px";this.node.style.overflow="visible"};
mxText.prototype.paint=function(a){var b=this.scale,c=this.bounds.x/b,d=this.bounds.y/b,e=this.bounds.width/b;b=this.bounds.height/b;this.updateTransform(a,c,d,e,b);this.configureCanvas(a,c,d,e,b);var f=mxUtils.isNode(this.value)||this.dialect==mxConstants.DIALECT_STRICTHTML,g=f||a instanceof mxVmlCanvas2D?"html":"",h=this.value;!f&&"html"==g&&(h=mxUtils.htmlEntities(h,false));h=!mxUtils.isNode(this.value)&&this.replaceLinefeeds&&"html"==g?h.replace(/\n/g,"<br/>"):h;a.text(c,d,e,b,h,this.align,this.valign,
this.wrap,g,this.overflow,this.clipped,this.getTextRotation())};mxText.prototype.redrawHtmlShape=function(){var a=this.node.style;a.opacity=1>this.opacity?this.opacity:"";a.overflow="";a.width="";a.height="";this.updateFont(this.node);this.updateSize(this.node);this.updateValue();this.offsetHeight=this.offsetWidth=null;null!=mxClient.CSS_PREFIX?this.updateHtmlTransform():this.updateHtmlFilter()};
mxText.prototype.updateHtmlTransform=function(){var a=this.getTextRotation(),b=this.node.style,c=this.margin.x,d=this.margin.y;0!=a?(b[mxClient.CSS_PREFIX+"TransformOrigin"]=100*-c+"% "+100*-d+"%",b[mxClient.CSS_PREFIX+"Transform"]="translate("+100*c+"%,"+100*d+"%)scale("+this.scale+") rotate("+a+"deg)"):(b[mxClient.CSS_PREFIX+"TransformOrigin"]="0% 0%",b[mxClient.CSS_PREFIX+"Transform"]="scale("+this.scale+")translate("+100*c+"%,"+100*d+"%)");b.left=Math.round(this.bounds.x)+"px";b.top=Math.round(this.bounds.y)+
"px"};
mxText.prototype.updateHtmlFilter=function(){var a=this.node.style,b=this.margin.x,c=this.margin.y,d=this.scale;a.filter="";var e=0,f=0,g=null!=this.state?this.state.view.textDiv:null;if(null!=g){g.style.overflow="";g.style.height="";g.style.width="";this.updateFont(g);this.updateSize(g);if(mxUtils.isNode(this.value))g.innerHTML=this.value.outerHTML;else{var h=this.value;this.dialect!=mxConstants.DIALECT_STRICTHTML&&(h=mxUtils.htmlEntities(h,false));h=this.replaceLinefeeds?h.replace(/\n/g,"<br/>"):h;
g.innerHTML=h}e=g.offsetWidth+2;f=g.offsetHeight+2}else{e=this.node.offsetWidth;f=this.node.offsetHeight+1}this.offsetWidth=e;this.offsetHeight=f;g=this.bounds.width/d;h=this.bounds.height/d;mxClient.IS_QUIRKS&&(this.clipped||"width"==this.overflow)&&0<h?(h=Math.min(h,f),a.height=Math.round(h)+"px"):h=f;"fill"!=this.overflow&&"width"!=this.overflow&&(mxClient.IS_QUIRKS&&(this.clipped||this.wrap)&&0<g?(g=Math.min(g,e),a.width=Math.round(g)+"px"):g=e);h*=d;g*=d;e=this.getTextRotation()*(Math.PI/180);
f=parseFloat(parseFloat(Math.cos(e)).toFixed(8));var k=parseFloat(parseFloat(Math.sin(-e)).toFixed(8));e%=2*Math.PI;0>e&&(e+=2*Math.PI);e%=Math.PI;e>Math.PI/2&&(e=Math.PI-e);var l=Math.cos(e),m=Math.sin(-e);b=g*-(b+0.5);c=h*-(c+0.5);0!=e&&(a.filter="progid:DXImageTransform.Microsoft.Matrix(M11="+f+", M12="+k+", M21="+-k+", M22="+f+", sizingMethod='auto expand')");a.zoom=d;a.left=Math.round(this.bounds.x+((g-g*l+h*m)/2-f*b-k*c)-g/2)+"px";a.top=Math.round(this.bounds.y+((h-h*l+g*m)/2+k*b-f*c)-h/2)+
"px"};
mxText.prototype.updateValue=function(){if(mxUtils.isNode(this.value)){this.node.innerHTML="";this.node.appendChild(this.value)}else{var a=this.value;this.dialect!=mxConstants.DIALECT_STRICTHTML&&(a=mxUtils.htmlEntities(a,false));a=this.replaceLinefeeds?a.replace(/\n/g,"<br/>"):a;var b=null!=this.background&&this.background!=mxConstants.NONE?this.background:null,c=null!=this.border&&this.border!=mxConstants.NONE?this.border:null;if(null!=b||null!=c)if("fill"==this.overflow||"width"==this.overflow){null!=b&&
(this.node.style.backgroundColor=b);null!=c&&(this.node.style.border="1px solid "+c)}else{var d="";null!=b&&(d+="background-color:"+b+";");null!=c&&(d+="border:1px solid "+c+";");a='<div style="zoom:1;'+d+"display:inline-block;_display:inline;padding-bottom:1px;padding-right:1px;line-height:"+this.node.style.lineHeight+'">'+a+"</div>";this.node.style.lineHeight=""}this.node.innerHTML=a}};
mxText.prototype.updateFont=function(a){a=a.style;a.lineHeight=Math.round(this.size*mxConstants.LINE_HEIGHT)+"px";a.fontSize=Math.round(this.size)+"px";a.fontFamily=this.family;a.verticalAlign="top";a.color=this.color;a.fontWeight=(this.fontStyle&mxConstants.FONT_BOLD)==mxConstants.FONT_BOLD?"bold":"";a.fontStyle=(this.fontStyle&mxConstants.FONT_ITALIC)==mxConstants.FONT_ITALIC?"italic":"";a.textDecoration=(this.fontStyle&mxConstants.FONT_UNDERLINE)==mxConstants.FONT_UNDERLINE?"underline":"";a.textAlign=
this.align==mxConstants.ALIGN_CENTER?"center":this.align==mxConstants.ALIGN_RIGHT?"right":"left"};
mxText.prototype.updateSize=function(a){var b=Math.round(this.bounds.width/this.scale),c=Math.round(this.bounds.height/this.scale);a=a.style;this.clipped?(a.overflow="hidden",0<c&&(a.maxHeight=c+"px"),0<b&&(a.width=b+"px")):"fill"==this.overflow?(a.width=b+"px",a.height=c+"px"):"width"==this.overflow&&(a.width=b+"px",0<c&&(a.maxHeight=c+"px"));this.wrap&&0<b?(this.clipped||(a.width=b+"px"),a.whiteSpace="normal"):a.whiteSpace="nowrap"};
mxText.prototype.updateMargin=function(){this.margin=mxUtils.getAlignmentAsPoint(this.align,this.valign)};
mxText.prototype.getSpacing=function(){var a=0,b=0;a=this.align==mxConstants.ALIGN_CENTER?(this.spacingLeft-this.spacingRight)/2:this.align==mxConstants.ALIGN_RIGHT?-this.spacingRight-this.baseSpacingRight:this.spacingLeft+this.baseSpacingLeft;b=this.valign==mxConstants.ALIGN_MIDDLE?(this.spacingTop-this.spacingBottom)/2:this.valign==mxConstants.ALIGN_BOTTOM?-this.spacingBottom-this.baseSpacingBottom:this.spacingTop+this.baseSpacingTop;return new mxPoint(a,b)};
function mxTriangle(){mxActor.call(this)}mxUtils.extend(mxTriangle,mxActor);mxTriangle.prototype.redrawPath=function(a,b,c,d,e){a.moveTo(0,0);a.lineTo(d,0.5*e);a.lineTo(0,e);a.close()};function mxHexagon(){mxActor.call(this)}mxUtils.extend(mxHexagon,mxActor);mxHexagon.prototype.redrawPath=function(a,b,c,d,e){a.moveTo(0.25*d,0);a.lineTo(0.75*d,0);a.lineTo(d,0.5*e);a.lineTo(0.75*d,e);a.lineTo(0.25*d,e);a.lineTo(0,0.5*e);a.close()};
function mxLine(a,b,c){mxShape.call(this);this.bounds=a;this.stroke=b;this.strokewidth=null!=c?c:1}mxUtils.extend(mxLine,mxShape);mxLine.prototype.paintVertexShape=function(a,b,c,d,e){c+=e/2;a.begin();a.moveTo(b,c);a.lineTo(b+d,c);a.stroke()};function mxImageShape(a,b,c,d,e){mxShape.call(this);this.bounds=a;this.image=b;this.fill=c;this.stroke=d;this.strokewidth=null!=e?e:1;this.shadow=false}mxUtils.extend(mxImageShape,mxRectangleShape);mxImageShape.prototype.preserveImageAspect=true;
mxImageShape.prototype.getSvgScreenOffset=function(){return!mxClient.IS_IE?0.5:0};
mxImageShape.prototype.apply=function(){mxShape.prototype.apply.apply(this,arguments);this.gradient=this.stroke=this.fill=null;null!=this.style&&(this.fill=mxUtils.getValue(this.style,mxConstants.STYLE_IMAGE_BACKGROUND),this.stroke=mxUtils.getValue(this.style,mxConstants.STYLE_IMAGE_BORDER),this.preserveImageAspect=1==mxUtils.getNumber(this.style,mxConstants.STYLE_IMAGE_ASPECT,1),this.flipH=this.flipH||1==mxUtils.getValue(this.style,"imageFlipH",0),this.flipV=this.flipV||1==mxUtils.getValue(this.style,
"imageFlipV",0))};mxImageShape.prototype.isHtmlAllowed=function(){return!this.preserveImageAspect};mxImageShape.prototype.createHtml=function(){var a=document.createElement("div");a.style.position="absolute";return a};
mxImageShape.prototype.paintVertexShape=function(a,b,c,d,e){if(null!=this.image){var f=mxUtils.getValue(this.style,mxConstants.STYLE_IMAGE_BACKGROUND,null),g=mxUtils.getValue(this.style,mxConstants.STYLE_IMAGE_BORDER,null);if(null!=f||null!=g){a.setFillColor(f);a.setStrokeColor(g);a.rect(b,c,d,e);a.fillAndStroke()}a.image(b,c,d,e,this.image,this.preserveImageAspect,false,false)}else mxRectangleShape.prototype.paintBackground.apply(this,arguments)};
mxImageShape.prototype.redrawHtmlShape=function(){this.node.style.left=Math.round(this.bounds.x)+"px";this.node.style.top=Math.round(this.bounds.y)+"px";this.node.style.width=Math.max(0,Math.round(this.bounds.width))+"px";this.node.style.height=Math.max(0,Math.round(this.bounds.height))+"px";this.node.style.backgroundColor=this.fill||"";this.node.style.borderColor=this.stroke||"";this.node.innerHTML="";if(null!=this.image){var a=document.createElement(mxClient.IS_IE6||null==mxClient.CSS_PREFIX&&0!=
this.rotation?mxClient.VML_PREFIX+":image":"img");a.style.position="absolute";a.src=this.image;var b=100>this.opacity?"alpha(opacity="+this.opacity+")":"";this.node.style.filter=b;this.flipH&&this.flipV?b+="progid:DXImageTransform.Microsoft.BasicImage(rotation=2)":this.flipH?b+="progid:DXImageTransform.Microsoft.BasicImage(mirror=1)":this.flipV&&(b+="progid:DXImageTransform.Microsoft.BasicImage(rotation=2, mirror=1)");a.style.filter!=b&&(a.style.filter=b);"image"==a.nodeName?a.style.rotation=this.rotation:
a.style[mxClient.CSS_PREFIX+"Transform"]="rotate("+this.rotation+"deg)";a.style.width=this.node.style.width;a.style.height=this.node.style.height;this.node.style.backgroundImage="";this.node.appendChild(a)}else this.setTransparentBackgroundImage(this.node)};function mxLabel(a,b,c,d){mxRectangleShape.call(this,a,b,c,d)}mxUtils.extend(mxLabel,mxRectangleShape);mxLabel.prototype.imageSize=mxConstants.DEFAULT_IMAGESIZE;mxLabel.prototype.spacing=2;mxLabel.prototype.indicatorSize=10;
mxLabel.prototype.indicatorSpacing=2;mxLabel.prototype.init=function(){mxShape.prototype.init.apply(this,arguments);null!=this.indicatorColor&&null!=this.indicatorShape&&(this.indicator=new this.indicatorShape,this.indicator.dialect=this.dialect,this.indicator.bounds=this.bounds,this.indicator.fill=this.indicatorColor,this.indicator.stroke=this.indicatorColor,this.indicator.gradient=this.indicatorGradientColor,this.indicator.direction=this.indicatorDirection,this.indicator.init(this.node))};
mxLabel.prototype.redraw=function(){null!=this.indicator&&(this.indicator.fill=this.indicatorColor,this.indicator.stroke=this.indicatorColor,this.indicator.gradient=this.indicatorGradientColor,this.indicator.direction=this.indicatorDirection);mxShape.prototype.redraw.apply(this,arguments)};mxLabel.prototype.isHtmlAllowed=function(){return mxRectangleShape.prototype.isHtmlAllowed.apply(this,arguments)&&null==this.indicatorColor&&null==this.indicatorShape};
mxLabel.prototype.paintForeground=function(a,b,c,d,e){this.paintImage(a,b,c,d,e);this.paintIndicator(a,b,c,d,e);mxRectangleShape.prototype.paintForeground.apply(this,arguments)};mxLabel.prototype.paintImage=function(a,b,c,d,e){null!=this.image&&(b=this.getImageBounds(b,c,d,e),a.image(b.x,b.y,b.width,b.height,this.image,false,false,false))};
mxLabel.prototype.getImageBounds=function(a,b,c,d){var e=mxUtils.getValue(this.style,mxConstants.STYLE_IMAGE_ALIGN,mxConstants.ALIGN_LEFT),f=mxUtils.getValue(this.style,mxConstants.STYLE_IMAGE_VERTICAL_ALIGN,mxConstants.ALIGN_MIDDLE),g=mxUtils.getNumber(this.style,mxConstants.STYLE_IMAGE_WIDTH,mxConstants.DEFAULT_IMAGESIZE),h=mxUtils.getNumber(this.style,mxConstants.STYLE_IMAGE_HEIGHT,mxConstants.DEFAULT_IMAGESIZE),k=mxUtils.getNumber(this.style,mxConstants.STYLE_SPACING,this.spacing)+5;a=e==mxConstants.ALIGN_CENTER?
a+(c-g)/2:e==mxConstants.ALIGN_RIGHT?a+(c-g-k):a+k;b=f==mxConstants.ALIGN_TOP?b+k:f==mxConstants.ALIGN_BOTTOM?b+(d-h-k):b+(d-h)/2;return new mxRectangle(a,b,g,h)};mxLabel.prototype.paintIndicator=function(a,b,c,d,e){null!=this.indicator?(this.indicator.bounds=this.getIndicatorBounds(b,c,d,e),this.indicator.paint(a)):null!=this.indicatorImage&&(b=this.getIndicatorBounds(b,c,d,e),a.image(b.x,b.y,b.width,b.height,this.indicatorImage,false,false,false))};
mxLabel.prototype.getIndicatorBounds=function(a,b,c,d){var e=mxUtils.getValue(this.style,mxConstants.STYLE_IMAGE_ALIGN,mxConstants.ALIGN_LEFT),f=mxUtils.getValue(this.style,mxConstants.STYLE_IMAGE_VERTICAL_ALIGN,mxConstants.ALIGN_MIDDLE),g=mxUtils.getNumber(this.style,mxConstants.STYLE_INDICATOR_WIDTH,this.indicatorSize),h=mxUtils.getNumber(this.style,mxConstants.STYLE_INDICATOR_HEIGHT,this.indicatorSize),k=this.spacing+5;a=e==mxConstants.ALIGN_RIGHT?a+(c-g-k):e==mxConstants.ALIGN_CENTER?a+(c-g)/
2:a+k;b=f==mxConstants.ALIGN_BOTTOM?b+(d-h-k):f==mxConstants.ALIGN_TOP?b+k:b+(d-h)/2;return new mxRectangle(a,b,g,h)};
mxLabel.prototype.redrawHtmlShape=function(){for(mxRectangleShape.prototype.redrawHtmlShape.apply(this,arguments);this.node.hasChildNodes();)this.node.removeChild(this.node.lastChild);if(null!=this.image){var a=document.createElement("img");a.style.position="relative";a.setAttribute("border","0");var b=this.getImageBounds(this.bounds.x,this.bounds.y,this.bounds.width,this.bounds.height);b.x-=this.bounds.x;b.y-=this.bounds.y;a.style.left=Math.round(b.x)+"px";a.style.top=Math.round(b.y)+"px";a.style.width=
Math.round(b.width)+"px";a.style.height=Math.round(b.height)+"px";a.src=this.image;this.node.appendChild(a)}};function mxCylinder(a,b,c,d){mxShape.call(this);this.bounds=a;this.fill=b;this.stroke=c;this.strokewidth=null!=d?d:1}mxUtils.extend(mxCylinder,mxShape);mxCylinder.prototype.maxHeight=40;mxCylinder.prototype.svgStrokeTolerance=0;
mxCylinder.prototype.paintVertexShape=function(a,b,c,d,e){a.translate(b,c);a.begin();this.redrawPath(a,b,c,d,e,false);a.fillAndStroke();a.setShadow(false);a.begin();this.redrawPath(a,b,c,d,e,true);a.stroke()};
mxCylinder.prototype.redrawPath=function(a,b,c,d,e,f){b=Math.min(this.maxHeight,Math.round(e/5));if(f&&null!=this.fill||!f&&null==this.fill){a.moveTo(0,b);a.curveTo(0,2*b,d,2*b,d,b);f||(a.stroke(),a.begin())}f||(a.moveTo(0,b),a.curveTo(0,-b/3,d,-b/3,d,b),a.lineTo(d,e-b),a.curveTo(d,e+b/3,0,e+b/3,0,e-b),a.close())};function mxConnector(a,b,c){mxPolyline.call(this,a,b,c)}mxUtils.extend(mxConnector,mxPolyline);
mxConnector.prototype.paintEdgeShape=function(a,b){var c=this.createMarker(a,b,true),d=this.createMarker(a,b,false);null==this.style||1!=this.style[mxConstants.STYLE_CURVED]?this.paintLine(a,b,this.isRounded):this.paintCurvedLine(a,b);a.setFillColor(this.stroke);a.setShadow(false);a.setDashed(false);null!=c&&c();null!=d&&d()};
mxConnector.prototype.paintCurvedLine=function(a,b){a.begin();var c=b[0],d=b.length;a.moveTo(c.x,c.y);for(c=1;c<d-2;c++){var e=b[c],f=b[c+1];a.quadTo(e.x,e.y,(e.x+f.x)/2,(e.y+f.y)/2)}e=b[d-2];f=b[d-1];a.quadTo(e.x,e.y,f.x,f.y);a.stroke()};
mxConnector.prototype.createMarker=function(a,b,c){var d=b.length,e=c?b[1]:b[d-2];b=c?b[0]:b[d-1];d=b.x-e.x;var f=b.y-e.y,g=Math.max(1,Math.sqrt(d*d+f*f));e=d/g;d=f/g;f=mxUtils.getNumber(this.style,c?mxConstants.STYLE_STARTSIZE:mxConstants.STYLE_ENDSIZE,mxConstants.DEFAULT_MARKERSIZE);g=mxUtils.getValue(this.style,c?mxConstants.STYLE_STARTARROW:mxConstants.STYLE_ENDARROW);return mxMarker.createMarker(a,this,g,b,e,d,f,c,this.strokewidth,0!=this.style[c?mxConstants.STYLE_STARTFILL:mxConstants.STYLE_ENDFILL])};
mxConnector.prototype.augmentBoundingBox=function(a){mxShape.prototype.augmentBoundingBox.apply(this,arguments);var b=0;mxUtils.getValue(this.style,mxConstants.STYLE_STARTARROW,mxConstants.NONE)!=mxConstants.NONE&&(b=mxUtils.getNumber(this.style,mxConstants.STYLE_STARTSIZE,mxConstants.DEFAULT_MARKERSIZE)+1);mxUtils.getValue(this.style,mxConstants.STYLE_ENDARROW,mxConstants.NONE)!=mxConstants.NONE&&(b=Math.max(b,mxUtils.getNumber(this.style,mxConstants.STYLE_ENDSIZE,mxConstants.DEFAULT_MARKERSIZE))+
1);a.grow(Math.ceil(b*this.scale))};function mxSwimlane(a,b,c,d){mxShape.call(this);this.bounds=a;this.fill=b;this.stroke=c;this.strokewidth=null!=d?d:1}mxUtils.extend(mxSwimlane,mxShape);mxSwimlane.prototype.imageSize=16;mxSwimlane.prototype.getGradientBounds=function(a,b,c,d,e){a=Math.min(e,mxUtils.getValue(this.style,mxConstants.STYLE_STARTSIZE,mxConstants.DEFAULT_STARTSIZE));return new mxRectangle(b,c,d,a)};
mxSwimlane.prototype.getRotation=function(){var a=mxShape.prototype.getRotation.apply(this,arguments);1!=mxUtils.getValue(this.style,mxConstants.STYLE_HORIZONTAL,1)&&(a+=mxText.prototype.verticalTextRotation);return a};mxSwimlane.prototype.getTextRotation=function(){return this.getRotation()};mxSwimlane.prototype.isPaintBoundsInverted=function(){return mxShape.prototype.isPaintBoundsInverted.apply(this,arguments)||1!=mxUtils.getValue(this.style,mxConstants.STYLE_HORIZONTAL,1)};
mxSwimlane.prototype.getArcSize=function(a,b,c){a=mxUtils.getValue(this.style,mxConstants.STYLE_ARCSIZE,100*mxConstants.RECTANGLE_ROUNDING_FACTOR)/100;return 3*c*a};
mxSwimlane.prototype.paintVertexShape=function(a,b,c,d,e){var f=Math.min(e,mxUtils.getValue(this.style,mxConstants.STYLE_STARTSIZE,mxConstants.DEFAULT_STARTSIZE)),g=mxUtils.getValue(this.style,mxConstants.STYLE_SWIMLANE_FILLCOLOR,mxConstants.NONE),h=1==mxUtils.getValue(this.style,mxConstants.STYLE_SWIMLANE_LINE,1),k=0;a.translate(b,c);this.isRounded?(k=this.getArcSize(d,e,f),this.paintRoundedSwimlane(a,b,c,d,e,f,k,g,h)):this.paintSwimlane(a,b,c,d,e,f,g,h);g=mxUtils.getValue(this.style,mxConstants.STYLE_SEPARATORCOLOR,
mxConstants.NONE);this.paintSeparator(a,d,f,e,g);null!=this.image&&(e=this.getImageBounds(b,c,d,e),a.image(e.x-b,e.y-c,e.width,e.height,this.image,false,false,false));this.glass&&(a.setShadow(false),this.paintGlassEffect(a,0,0,d,f,k))};
mxSwimlane.prototype.paintSwimlane=function(a,b,c,d,e,f,g,h){g!=mxConstants.NONE&&(a.save(),a.setFillColor(g),a.rect(0,0,d,e),a.fillAndStroke(),a.restore(),a.setShadow(false));a.begin();a.moveTo(0,f);a.lineTo(0,0);a.lineTo(d,0);a.lineTo(d,f);h&&a.close();a.fillAndStroke();f<e&&g==mxConstants.NONE&&(a.pointerEvents=false,a.begin(),a.moveTo(0,f),a.lineTo(0,e),a.lineTo(d,e),a.lineTo(d,f),a.stroke())};
mxSwimlane.prototype.paintRoundedSwimlane=function(a,b,c,d,e,f,g,h,k){h!=mxConstants.NONE&&(a.save(),a.setFillColor(h),a.roundrect(0,0,d,e,g,g),a.fillAndStroke(),a.restore(),a.setShadow(false));a.begin();a.moveTo(d,f);a.lineTo(d,g);a.quadTo(d,0,d-Math.min(d/2,g),0);a.lineTo(Math.min(d/2,g),0);a.quadTo(0,0,0,g);a.lineTo(0,f);k&&a.close();a.fillAndStroke();f<e&&h==mxConstants.NONE&&(a.pointerEvents=false,a.begin(),a.moveTo(0,f),a.lineTo(0,e-g),a.quadTo(0,e,Math.min(d/2,g),e),a.lineTo(d-Math.min(d/2,
g),e),a.quadTo(d,e,d,e-g),a.lineTo(d,f),a.stroke())};mxSwimlane.prototype.paintSeparator=function(a,b,c,d,e){e!=mxConstants.NONE&&(a.setStrokeColor(e),a.setDashed(true),a.begin(),a.moveTo(b,c),a.lineTo(b,d),a.stroke(),a.setDashed(false))};mxSwimlane.prototype.getImageBounds=function(a,b,c){return new mxRectangle(a+c-this.imageSize,b,this.imageSize,this.imageSize)};function mxGraphLayout(a){this.graph=a}mxGraphLayout.prototype.graph=null;mxGraphLayout.prototype.useBoundingBox=true;
mxGraphLayout.prototype.parent=null;mxGraphLayout.prototype.moveCell=function(){};mxGraphLayout.prototype.execute=function(){};mxGraphLayout.prototype.getGraph=function(){return this.graph};mxGraphLayout.prototype.getConstraint=function(a,b,c){c=this.graph.view.getState(b);b=null!=c?c.style:this.graph.getCellStyle(b);return null!=b?b[a]:null};
mxGraphLayout.traverse=function(a,b,c,d,e){if(null!=c&&null!=a){b=null!=b?b:true;e=e||[];var f=mxCellPath.create(a);if(null==e[f]&&(e[f]=a,d=c(a,d),null==d||d))if(d=this.graph.model.getEdgeCount(a),0<d)for(f=0;f<d;f++){var g=this.graph.model.getEdgeAt(a,f),h=this.graph.model.getTerminal(g,true)==a;if(!b||h){h=this.graph.view.getVisibleTerminal(g,!h);this.traverse(h,b,c,g,e)}}}};mxGraphLayout.prototype.isVertexMovable=function(a){return this.graph.isCellMovable(a)};
mxGraphLayout.prototype.isVertexIgnored=function(a){return!this.graph.getModel().isVertex(a)||!this.graph.isCellVisible(a)};mxGraphLayout.prototype.isEdgeIgnored=function(a){var b=this.graph.getModel();return!b.isEdge(a)||!this.graph.isCellVisible(a)||null==b.getTerminal(a,true)||null==b.getTerminal(a,false)};mxGraphLayout.prototype.setEdgeStyleEnabled=function(a,b){this.graph.setCellStyles(mxConstants.STYLE_NOEDGESTYLE,b?"0":"1",[a])};
mxGraphLayout.prototype.setOrthogonalEdge=function(a,b){this.graph.setCellStyles(mxConstants.STYLE_ORTHOGONAL,b?"1":"0",[a])};mxGraphLayout.prototype.getParentOffset=function(a){var b=new mxPoint;if(null!=a&&a!=this.parent){var c=this.graph.getModel();if(c.isAncestor(this.parent,a))for(var d=c.getGeometry(a);a!=this.parent;){b.x+=d.x;b.y+=d.y;a=c.getParent(a);d=c.getGeometry(a)}}return b};
mxGraphLayout.prototype.setEdgePoints=function(a,b){if(null!=a){var c=this.graph.model,d=c.getGeometry(a);null==d?(d=new mxGeometry,d.setRelative(true)):d=d.clone();if(null!=this.parent&&null!=b){var e=c.getParent(a);e=this.getParentOffset(e);for(var f=0;f<b.length;f++){b[f].x-=e.x;b[f].y-=e.y}}d.points=b;c.setGeometry(a,d)}};
mxGraphLayout.prototype.setVertexLocation=function(a,b,c){var d=this.graph.getModel(),e=d.getGeometry(a),f=null;if(null!=e){f=new mxRectangle(b,c,e.width,e.height);if(this.useBoundingBox){var g=this.graph.getView().getState(a);if(null!=g&&null!=g.text&&null!=g.text.boundingBox){var h=this.graph.getView().scale,k=g.text.boundingBox;g.text.boundingBox.x<g.x&&(b+=(g.x-k.x)/h,f.width=k.width);g.text.boundingBox.y<g.y&&(c+=(g.y-k.y)/h,f.height=k.height)}}null!=this.parent&&(g=d.getParent(a),null!=g&&g!=
this.parent&&(g=this.getParentOffset(g),b-=g.x,c-=g.y));if(e.x!=b||e.y!=c){e=e.clone();e.x=b;e.y=c;d.setGeometry(a,e)}}return f};
mxGraphLayout.prototype.getVertexBounds=function(a){var b=this.graph.getModel().getGeometry(a);if(this.useBoundingBox){var c=this.graph.getView().getState(a);if(null!=c&&null!=c.text&&null!=c.text.boundingBox){var d=this.graph.getView().scale,e=c.text.boundingBox,f=Math.max(c.x-e.x,0)/d,g=Math.max(c.y-e.y,0)/d,h=Math.max(e.x+e.width-(c.x+c.width),0)/d;c=Math.max(e.y+e.height-(c.y+c.height),0)/d;b=new mxRectangle(b.x-f,b.y-g,b.width+f+h,b.height+g+c)}}null!=this.parent&&(a=this.graph.getModel().getParent(a),
b=b.clone(),null!=a&&a!=this.parent&&(a=this.getParentOffset(a),b.x+=a.x,b.y+=a.y));return new mxRectangle(b.x,b.y,b.width,b.height)};
mxGraphLayout.prototype.arrangeGroups=function(a,b){this.graph.getModel().beginUpdate();try{for(var c=a.length-1;0<=c;c--){var d=a[c],e=this.graph.getChildVertices(d),f=this.graph.getBoundingBoxFromGeometry(e),g=this.graph.getCellGeometry(d),h=0,k=0;if(this.graph.isSwimlane(d)){var l=this.graph.getStartSize(d);h=l.width;k=l.height}null!=f&&null!=g&&(g=g.clone(),g.x=g.x+f.x-b-h,g.y=g.y+f.y-b-k,g.width=f.width+2*b+h,g.height=f.height+2*b+k,this.graph.getModel().setGeometry(d,g),this.graph.moveCells(e,
b+h-f.x,b+k-f.y))}}finally{this.graph.getModel().endUpdate()}};function mxStackLayout(a,b,c,d,e,f){mxGraphLayout.call(this,a);this.horizontal=null!=b?b:true;this.spacing=null!=c?c:0;this.x0=null!=d?d:0;this.y0=null!=e?e:0;this.border=null!=f?f:0}mxStackLayout.prototype=new mxGraphLayout;mxStackLayout.prototype.constructor=mxStackLayout;mxStackLayout.prototype.horizontal=null;mxStackLayout.prototype.spacing=null;mxStackLayout.prototype.x0=null;mxStackLayout.prototype.y0=null;
mxStackLayout.prototype.border=0;mxStackLayout.prototype.keepFirstLocation=false;mxStackLayout.prototype.fill=false;mxStackLayout.prototype.resizeParent=false;mxStackLayout.prototype.resizeLast=false;mxStackLayout.prototype.wrap=null;mxStackLayout.prototype.isHorizontal=function(){return this.horizontal};
mxStackLayout.prototype.moveCell=function(a,b,c){var d=this.graph.getModel(),e=d.getParent(a),f=this.isHorizontal();if(null!=a&&null!=e){var g=0,h=0,k=d.getChildCount(e);b=f?b:c;g=this.graph.getView().getState(e);null!=g&&(b-=f?g.x:g.y);for(g=0;g<k;g++)if(c=d.getChildAt(e,g),c!=a&&(c=d.getGeometry(c),null!=c)){c=f?c.x+c.width/2:c.y+c.height/2;if(h<b&&c>b)break;h=c}f=e.getIndex(a);f=Math.max(0,g-(g>f?1:0));d.add(e,a,f)}};
mxStackLayout.prototype.getParentSize=function(a){var b=this.graph.getModel(),c=b.getGeometry(a);if(null!=this.graph.container&&(null==c&&b.isLayer(a)||a==this.graph.getView().currentRoot))c=new mxRectangle(0,0,this.graph.container.offsetWidth-1,this.graph.container.offsetHeight-1);return c};
mxStackLayout.prototype.execute=function(a){if(null!=a){var b=this.isHorizontal(),c=this.graph.getModel(),d=this.getParentSize(a),e=null;null!=d&&(e=b?d.height:d.width);e-=2*this.spacing+2*this.border;var f=this.x0+this.border,g=this.y0+this.border;if(this.graph.isSwimlane(a)){var h=this.graph.getCellStyle(a),k=mxUtils.getNumber(h,mxConstants.STYLE_STARTSIZE,mxConstants.DEFAULT_STARTSIZE);h=1==mxUtils.getValue(h,mxConstants.STYLE_HORIZONTAL,true);null!=d&&(k=h?Math.min(k,d.height):Math.min(k,d.width));
b==h&&(e-=k);h?g+=k:f+=k}c.beginUpdate();try{k=0;h=null;for(var l=c.getChildCount(a),m=0;m<l;m++){var p=c.getChildAt(a,m);if(!this.isVertexIgnored(p)&&this.isVertexMovable(p)){var o=c.getGeometry(p);if(null!=o){o=o.clone();if(null!=this.wrap&&null!=h&&(b&&h.x+h.width+o.width+2*this.spacing>this.wrap||!b&&h.y+h.height+o.height+2*this.spacing>this.wrap)){h=null;b?g+=k+this.spacing:f+=k+this.spacing;k=0}k=Math.max(k,b?o.height:o.width);null!=h?b?o.x=h.x+h.width+this.spacing:o.y=h.y+h.height+this.spacing:
this.keepFirstLocation||(b?o.x=f:o.y=g);b?o.y=g:o.x=f;this.fill&&null!=e&&(b?o.height=e:o.width=e);c.setGeometry(p,o);h=o}}}this.resizeParent&&null!=d&&null!=h&&!this.graph.isCellCollapsed(a)?(d=d.clone(),b?d.width=h.x+h.width+this.spacing:d.height=h.y+h.height+this.spacing,c.setGeometry(a,d)):this.resizeLast&&null!=d&&null!=h&&(b?h.width=d.width-h.x-this.spacing:h.height=d.height-h.y-this.spacing)}finally{c.endUpdate()}}};
function mxPartitionLayout(a,b,c,d){mxGraphLayout.call(this,a);this.horizontal=null!=b?b:true;this.spacing=c||0;this.border=d||0}mxPartitionLayout.prototype=new mxGraphLayout;mxPartitionLayout.prototype.constructor=mxPartitionLayout;mxPartitionLayout.prototype.horizontal=null;mxPartitionLayout.prototype.spacing=null;mxPartitionLayout.prototype.border=null;mxPartitionLayout.prototype.resizeVertices=true;mxPartitionLayout.prototype.isHorizontal=function(){return this.horizontal};
mxPartitionLayout.prototype.moveCell=function(a,b,c){c=this.graph.getModel();var d=c.getParent(a);if(null!=a&&null!=d){var e=0,f=0,g=c.getChildCount(d);for(e=0;e<g;e++){var h=c.getChildAt(d,e);h=this.getVertexBounds(h);if(null!=h){h=h.x+h.width/2;if(f<b&&h>b)break;f=h}}b=d.getIndex(a);b=Math.max(0,e-(e>b?1:0));c.add(d,a,b)}};
mxPartitionLayout.prototype.execute=function(a){var b=this.isHorizontal(),c=this.graph.getModel(),d=c.getGeometry(a);if(null!=this.graph.container&&(null==d&&c.isLayer(a)||a==this.graph.getView().currentRoot))d=new mxRectangle(0,0,this.graph.container.offsetWidth-1,this.graph.container.offsetHeight-1);if(null!=d){for(var e=[],f=c.getChildCount(a),g=0;g<f;g++){var h=c.getChildAt(a,g);!this.isVertexIgnored(h)&&this.isVertexMovable(h)&&e.push(h)}f=e.length;if(0<f){var k=this.border,l=this.border,m=b?
d.height:d.width;m-=2*this.border;a=this.graph.isSwimlane(a)?this.graph.getStartSize(a):new mxRectangle;m-=b?a.height:a.width;k+=a.width;l+=a.height;a=this.border+(f-1)*this.spacing;d=b?(d.width-k-a)/f:(d.height-l-a)/f;if(0<d){c.beginUpdate();try{for(g=0;g<f;g++){h=e[g];var p=c.getGeometry(h);null!=p&&(p=p.clone(),p.x=k,p.y=l,b?(this.resizeVertices&&(p.width=d,p.height=m),k+=d+this.spacing):(this.resizeVertices&&(p.height=d,p.width=m),l+=d+this.spacing),c.setGeometry(h,p))}}finally{c.endUpdate()}}}}};
function mxCompactTreeLayout(a,b,c){mxGraphLayout.call(this,a);this.horizontal=null!=b?b:true;this.invert=null!=c?c:false}mxCompactTreeLayout.prototype=new mxGraphLayout;mxCompactTreeLayout.prototype.constructor=mxCompactTreeLayout;mxCompactTreeLayout.prototype.horizontal=null;mxCompactTreeLayout.prototype.invert=null;mxCompactTreeLayout.prototype.resizeParent=true;mxCompactTreeLayout.prototype.groupPadding=10;mxCompactTreeLayout.prototype.parentsChanged=null;
mxCompactTreeLayout.prototype.moveTree=false;mxCompactTreeLayout.prototype.levelDistance=10;mxCompactTreeLayout.prototype.nodeDistance=20;mxCompactTreeLayout.prototype.resetEdges=true;mxCompactTreeLayout.prototype.prefHozEdgeSep=5;mxCompactTreeLayout.prototype.prefVertEdgeOff=4;mxCompactTreeLayout.prototype.minEdgeJetty=8;mxCompactTreeLayout.prototype.channelBuffer=4;mxCompactTreeLayout.prototype.edgeRouting=true;mxCompactTreeLayout.prototype.sortEdges=false;
mxCompactTreeLayout.prototype.isVertexIgnored=function(a){return mxGraphLayout.prototype.isVertexIgnored.apply(this,arguments)||0==this.graph.getConnections(a).length};mxCompactTreeLayout.prototype.isHorizontal=function(){return this.horizontal};
mxCompactTreeLayout.prototype.execute=function(a,b){this.parent=a;var c=this.graph.getModel();if(null==b)if(0<this.graph.getEdges(a,c.getParent(a),this.invert,!this.invert,false).length)b=a;else{var d=this.graph.findTreeRoots(a,true,this.invert);if(0<d.length)for(var e=0;e<d.length;e++)if(!this.isVertexIgnored(d[e])&&0<this.graph.getEdges(d[e],null,this.invert,!this.invert,false).length){b=d[e];break}}if(null!=b){this.parentsChanged=this.resizeParent?{}:null;c.beginUpdate();try{var f=this.dfs(b,a);
if(null!=f){this.layout(f);var g=this.graph.gridSize;d=g;if(!this.moveTree){var h=this.getVertexBounds(b);null!=h&&(g=h.x,d=h.y)}h=null;h=this.isHorizontal()?this.horizontalLayout(f,g,d):this.verticalLayout(f,null,g,d);if(null!=h){var k=e=0;0>h.x&&(e=Math.abs(g-h.x));0>h.y&&(k=Math.abs(d-h.y));(0!=e||0!=k)&&this.moveNode(f,e,k);this.resizeParent&&this.adjustParents();this.edgeRouting&&this.localEdgeProcessing(f)}}}finally{c.endUpdate()}}};
mxCompactTreeLayout.prototype.moveNode=function(a,b,c){a.x+=b;a.y+=c;this.apply(a);for(a=a.child;null!=a;){this.moveNode(a,b,c);a=a.next}};
mxCompactTreeLayout.prototype.sortOutgoingEdges=function(a,b){var c=new mxDictionary;b.sort(function(d,e){var f=d.getTerminal(d.getTerminal(false)==a),g=c.get(f);null==g&&(g=mxCellPath.create(f).split(mxCellPath.PATH_SEPARATOR),c.put(f,g));f=e.getTerminal(e.getTerminal(false)==a);var h=c.get(f);null==h&&(h=mxCellPath.create(f).split(mxCellPath.PATH_SEPARATOR),c.put(f,h));return mxCellPath.compare(g,h)})};
mxCompactTreeLayout.prototype.dfs=function(a,b,c){c=null!=c?c:[];var d=mxCellPath.create(a),e=null;if(null!=a&&null==c[d]&&!this.isVertexIgnored(a)){c[d]=a;e=this.createNode(a);d=this.graph.getModel();var f=null,g=this.graph.getEdges(a,b,this.invert,!this.invert,false,true),h=this.graph.getView();this.sortEdges&&this.sortOutgoingEdges(a,g);for(a=0;a<g.length;a++){var k=g[a];if(!this.isEdgeIgnored(k)){this.resetEdges&&this.setEdgePoints(k,null);this.edgeRouting&&(this.setEdgeStyleEnabled(k,false),
this.setEdgePoints(k,null));var l=h.getState(k);k=null!=l?l.getVisibleTerminal(this.invert):h.getVisibleTerminal(k,this.invert);l=this.dfs(k,b,c);null!=l&&null!=d.getGeometry(k)&&(null==f?e.child=l:f.next=l,f=l)}}}return e};mxCompactTreeLayout.prototype.layout=function(a){if(null!=a){for(var b=a.child;null!=b;){this.layout(b);b=b.next}null!=a.child?this.attachParent(a,this.join(a)):this.layoutLeaf(a)}};
mxCompactTreeLayout.prototype.horizontalLayout=function(a,b,c,d){a.x+=b+a.offsetX;a.y+=c+a.offsetY;d=this.apply(a,d);b=a.child;if(null!=b){d=this.horizontalLayout(b,a.x,a.y,d);c=a.y+b.offsetY;for(var e=b.next;null!=e;){d=this.horizontalLayout(e,a.x+b.offsetX,c,d);c+=e.offsetY;e=e.next}}return d};
mxCompactTreeLayout.prototype.verticalLayout=function(a,b,c,d,e){a.x+=c+a.offsetY;a.y+=d+a.offsetX;e=this.apply(a,e);b=a.child;if(null!=b){e=this.verticalLayout(b,a,a.x,a.y,e);c=a.x+b.offsetY;for(d=b.next;null!=d;){e=this.verticalLayout(d,a,c,a.y+b.offsetX,e);c+=d.offsetY;d=d.next}}return e};
mxCompactTreeLayout.prototype.attachParent=function(a,b){var c=this.nodeDistance+this.levelDistance,d=(b-a.width)/2-this.nodeDistance,e=d+a.width+2*this.nodeDistance-b;a.child.offsetX=c+a.height;a.child.offsetY=e;a.contour.upperHead=this.createLine(a.height,0,this.createLine(c,e,a.contour.upperHead));a.contour.lowerHead=this.createLine(a.height,0,this.createLine(c,d,a.contour.lowerHead))};
mxCompactTreeLayout.prototype.layoutLeaf=function(a){var b=2*this.nodeDistance;a.contour.upperTail=this.createLine(a.height+b,0);a.contour.upperHead=a.contour.upperTail;a.contour.lowerTail=this.createLine(0,-a.width-b);a.contour.lowerHead=this.createLine(a.height+b,0,a.contour.lowerTail)};
mxCompactTreeLayout.prototype.join=function(a){var b=2*this.nodeDistance,c=a.child;a.contour=c.contour;var d=c.width+b,e=d;for(c=c.next;null!=c;){var f=this.merge(a.contour,c.contour);c.offsetY=f+d;c.offsetX=0;d=c.width+b;e+=f+d;c=c.next}return e};
mxCompactTreeLayout.prototype.merge=function(a,b){for(var c=0,d=0,e=0,f=a.lowerHead,g=b.upperHead;null!=g&&null!=f;){var h=this.offset(c,d,g.dx,g.dy,f.dx,f.dy);d+=h;e+=h;c+g.dx<=f.dx?(c+=g.dx,d+=g.dy,g=g.next):(c-=f.dx,d-=f.dy,f=f.next)}null!=g?(c=this.bridge(a.upperTail,0,0,g,c,d),a.upperTail=null!=c.next?b.upperTail:c,a.lowerTail=b.lowerTail):(c=this.bridge(b.lowerTail,c,d,f,0,0),null==c.next&&(a.lowerTail=c));a.lowerHead=b.lowerHead;return e};
mxCompactTreeLayout.prototype.offset=function(a,b,c,d,e,f){var g=0;if(e<=a||0>=a+c)return 0;g=0<e*d-c*f?0>a?a*d/c-b:0<a?a*f/e-b:-b:e<a+c?f-(b+(e-a)*d/c):e>a+c?(c+a)*f/e-(b+d):f-(b+d);return 0<g?g:0};mxCompactTreeLayout.prototype.bridge=function(a,b,c,d,e,f){b=e+d.dx-b;e=e=0;0==d.dx?e=d.dy:(e=b*d.dy,e/=d.dx);b=this.createLine(b,e,d.next);a.next=this.createLine(0,f+d.dy-e-c,b);return b};
mxCompactTreeLayout.prototype.createNode=function(a){var b={};b.cell=a;b.x=0;b.y=0;b.width=0;b.height=0;a=this.getVertexBounds(a);null!=a&&(this.isHorizontal()?(b.width=a.height,b.height=a.width):(b.width=a.width,b.height=a.height));b.offsetX=0;b.offsetY=0;b.contour={};return b};
mxCompactTreeLayout.prototype.apply=function(a,b){var c=this.graph.getModel(),d=a.cell,e=c.getGeometry(d);null!=d&&null!=e&&(this.isVertexMovable(d)&&(e=this.setVertexLocation(d,a.x,a.y),this.resizeParent&&(c=c.getParent(d),d=mxCellPath.create(c),null==this.parentsChanged[d]&&(this.parentsChanged[d]=c))),b=null==b?new mxRectangle(e.x,e.y,e.width,e.height):new mxRectangle(Math.min(b.x,e.x),Math.min(b.y,e.y),Math.max(b.x+b.width,e.x+e.width),Math.max(b.y+b.height,e.y+e.height)));return b};
mxCompactTreeLayout.prototype.createLine=function(a,b,c){var d={};d.dx=a;d.dy=b;d.next=c;return d};mxCompactTreeLayout.prototype.adjustParents=function(){var a=[],b;for(b in this.parentsChanged)a.push(this.parentsChanged[b]);this.arrangeGroups(mxUtils.sortCells(a,true),this.groupPadding)};mxCompactTreeLayout.prototype.localEdgeProcessing=function(a){this.processNodeOutgoing(a);for(a=a.child;null!=a;){this.localEdgeProcessing(a);a=a.next}};
mxCompactTreeLayout.prototype.processNodeOutgoing=function(a){for(var b=a.child,c=a.cell,d=0,e=[];null!=b;){d++;var f=b.x;this.horizontal&&(f=b.y);e.push(new WeightedCellSorter(b,f));b=b.next}e.sort(WeightedCellSorter.prototype.compare);f=a.width;var g=(d+1)*this.prefHozEdgeSep;f>g+2*this.prefHozEdgeSep&&(f-=2*this.prefHozEdgeSep);a=f/d;b=a/2;f>g+2*this.prefHozEdgeSep&&(b+=this.prefHozEdgeSep);f=this.minEdgeJetty-this.prefVertEdgeOff;g=0;for(var h=this.getVertexBounds(c),k=0;k<e.length;k++){var l=
e[k].cell.cell,m=this.getVertexBounds(l);l=this.graph.getEdgesBetween(c,l,false);for(var p=[],o=0,n=0,s=0;s<l.length;s++){this.horizontal?(o=h.x+h.width,n=h.y+b,p.push(new mxPoint(o,n)),o=h.x+h.width+f,p.push(new mxPoint(o,n)),n=m.y+m.height/2):(o=h.x+b,n=h.y+h.height,p.push(new mxPoint(o,n)),n=h.y+h.height+f,p.push(new mxPoint(o,n)),o=m.x+m.width/2);p.push(new mxPoint(o,n));this.setEdgePoints(l[s],p)}k<d/2?f+=this.prefVertEdgeOff:k>d/2&&(f-=this.prefVertEdgeOff);b+=a;g=Math.max(g,f)}};
function WeightedCellSorter(a,b){this.cell=a;this.weightedValue=b}WeightedCellSorter.prototype.weightedValue=0;WeightedCellSorter.prototype.nudge=false;WeightedCellSorter.prototype.visited=false;WeightedCellSorter.prototype.rankIndex=null;WeightedCellSorter.prototype.cell=null;WeightedCellSorter.prototype.compare=function(a,b){return null!=a&&null!=b?b.weightedValue>a.weightedValue?1:b.weightedValue<a.weightedValue?-1:b.nudge?1:-1:0};function mxFastOrganicLayout(a){mxGraphLayout.call(this,a)}
mxFastOrganicLayout.prototype=new mxGraphLayout;mxFastOrganicLayout.prototype.constructor=mxFastOrganicLayout;mxFastOrganicLayout.prototype.useInputOrigin=true;mxFastOrganicLayout.prototype.resetEdges=true;mxFastOrganicLayout.prototype.disableEdgeStyle=true;mxFastOrganicLayout.prototype.forceConstant=50;mxFastOrganicLayout.prototype.forceConstantSquared=0;mxFastOrganicLayout.prototype.minDistanceLimit=2;mxFastOrganicLayout.prototype.maxDistanceLimit=500;
mxFastOrganicLayout.prototype.minDistanceLimitSquared=4;mxFastOrganicLayout.prototype.initialTemp=200;mxFastOrganicLayout.prototype.temperature=0;mxFastOrganicLayout.prototype.maxIterations=0;mxFastOrganicLayout.prototype.iteration=0;mxFastOrganicLayout.prototype.allowedToRun=true;mxFastOrganicLayout.prototype.isVertexIgnored=function(a){return mxGraphLayout.prototype.isVertexIgnored.apply(this,arguments)||0==this.graph.getConnections(a).length};
mxFastOrganicLayout.prototype.execute=function(a){var b=this.graph.getModel();this.vertexArray=[];for(var c=this.graph.getChildVertices(a),d=0;d<c.length;d++)this.isVertexIgnored(c[d])||this.vertexArray.push(c[d]);var e=this.useInputOrigin?this.graph.getBoundingBoxFromGeometry(this.vertexArray):null,f=this.vertexArray.length;this.indices=[];this.dispX=[];this.dispY=[];this.cellLocation=[];this.isMoveable=[];this.neighbours=[];this.radius=[];this.radiusSquared=[];0.0010>this.forceConstant&&(this.forceConstant=
0.0010);this.forceConstantSquared=this.forceConstant*this.forceConstant;for(d=0;d<this.vertexArray.length;d++){var g=this.vertexArray[d];this.cellLocation[d]=[];var h=mxCellPath.create(g);this.indices[h]=d;var k=this.getVertexBounds(g),l=k.width,m=k.height,p=k.x,o=k.y;this.cellLocation[d][0]=p+l/2;this.cellLocation[d][1]=o+m/2;this.radius[d]=Math.min(l,m);this.radiusSquared[d]=this.radius[d]*this.radius[d]}b.beginUpdate();try{for(d=0;d<f;d++){this.dispX[d]=0;this.dispY[d]=0;this.isMoveable[d]=this.isVertexMovable(this.vertexArray[d]);
var n=this.graph.getConnections(this.vertexArray[d],a);c=this.graph.getOpposites(n,this.vertexArray[d]);this.neighbours[d]=[];for(l=0;l<c.length;l++){this.resetEdges&&this.graph.resetEdge(n[l]);this.disableEdgeStyle&&this.setEdgeStyleEnabled(n[l],false);h=mxCellPath.create(c[l]);var s=this.indices[h];this.neighbours[d][l]=null!=s?s:d}}this.temperature=this.initialTemp;0==this.maxIterations&&(this.maxIterations=20*Math.sqrt(f));for(this.iteration=0;this.iteration<this.maxIterations;this.iteration++){if(!this.allowedToRun)return;
this.calcRepulsion();this.calcAttraction();this.calcPositions();this.reduceTemperature()}a=c=null;for(d=0;d<this.vertexArray.length;d++){g=this.vertexArray[d];this.isVertexMovable(g)&&(k=this.getVertexBounds(g),null!=k&&(this.cellLocation[d][0]-=k.width/2,this.cellLocation[d][1]-=k.height/2,p=this.graph.snap(this.cellLocation[d][0]),o=this.graph.snap(this.cellLocation[d][1]),this.setVertexLocation(g,p,o),c=null==c?p:Math.min(c,p),a=null==a?o:Math.min(a,o)))}d=-(c||0)+1;g=-(a||0)+1;null!=e&&(d+=e.x,
g+=e.y);this.graph.moveCells(this.vertexArray,d,g)}finally{b.endUpdate()}};mxFastOrganicLayout.prototype.calcPositions=function(){for(var a=0;a<this.vertexArray.length;a++)if(this.isMoveable[a]){var b=Math.sqrt(this.dispX[a]*this.dispX[a]+this.dispY[a]*this.dispY[a]);0.0010>b&&(b=0.0010);var c=this.dispX[a]/b*Math.min(b,this.temperature);b=this.dispY[a]/b*Math.min(b,this.temperature);this.dispX[a]=0;this.dispY[a]=0;this.cellLocation[a][0]+=c;this.cellLocation[a][1]+=b}};
mxFastOrganicLayout.prototype.calcAttraction=function(){for(var a=0;a<this.vertexArray.length;a++)for(var b=0;b<this.neighbours[a].length;b++){var c=this.neighbours[a][b];if(a!=c&&this.isMoveable[a]&&this.isMoveable[c]){var d=this.cellLocation[a][0]-this.cellLocation[c][0],e=this.cellLocation[a][1]-this.cellLocation[c][1],f=d*d+e*e-this.radiusSquared[a]-this.radiusSquared[c];f<this.minDistanceLimitSquared&&(f=this.minDistanceLimitSquared);var g=Math.sqrt(f);f/=this.forceConstant;d=d/g*f;e=e/g*f;this.dispX[a]-=
d;this.dispY[a]-=e;this.dispX[c]+=d;this.dispY[c]+=e}}};
mxFastOrganicLayout.prototype.calcRepulsion=function(){for(var a=this.vertexArray.length,b=0;b<a;b++)for(var c=b;c<a;c++){if(!this.allowedToRun)return;if(c!=b&&this.isMoveable[b]&&this.isMoveable[c]){var d=this.cellLocation[b][0]-this.cellLocation[c][0],e=this.cellLocation[b][1]-this.cellLocation[c][1];0==d&&(d=0.01+Math.random());0==e&&(e=0.01+Math.random());var f=Math.sqrt(d*d+e*e),g=f-this.radius[b]-this.radius[c];g>this.maxDistanceLimit||(g<this.minDistanceLimit&&(g=this.minDistanceLimit),g=this.forceConstantSquared/
g,d=d/f*g,e=e/f*g,this.dispX[b]+=d,this.dispY[b]+=e,this.dispX[c]-=d,this.dispY[c]-=e)}}};mxFastOrganicLayout.prototype.reduceTemperature=function(){this.temperature=this.initialTemp*(1-this.iteration/this.maxIterations)};function mxCircleLayout(a,b){mxGraphLayout.call(this,a);this.radius=null!=b?b:100}mxCircleLayout.prototype=new mxGraphLayout;mxCircleLayout.prototype.constructor=mxCircleLayout;mxCircleLayout.prototype.radius=null;mxCircleLayout.prototype.moveCircle=false;
mxCircleLayout.prototype.x0=0;mxCircleLayout.prototype.y0=0;mxCircleLayout.prototype.resetEdges=true;mxCircleLayout.prototype.disableEdgeStyle=true;
mxCircleLayout.prototype.execute=function(a){var b=this.graph.getModel();b.beginUpdate();try{for(var c=0,d=null,e=null,f=[],g=b.getChildCount(a),h=0;h<g;h++){var k=b.getChildAt(a,h);if(this.isVertexIgnored(k))this.isEdgeIgnored(k)||(this.resetEdges&&this.graph.resetEdge(k),this.disableEdgeStyle&&this.setEdgeStyleEnabled(k,false));else{f.push(k);var l=this.getVertexBounds(k);d=null==d?l.y:Math.min(d,l.y);e=null==e?l.x:Math.min(e,l.x);c=Math.max(c,Math.max(l.width,l.height))}}var m=this.getRadius(f.length,
c);this.moveCircle&&(e=this.x0,d=this.y0);this.circle(f,m,e,d)}finally{b.endUpdate()}};mxCircleLayout.prototype.getRadius=function(a,b){return Math.max(a*b/Math.PI,this.radius)};mxCircleLayout.prototype.circle=function(a,b,c,d){for(var e=a.length,f=2*Math.PI/e,g=0;g<e;g++)this.isVertexMovable(a[g])&&this.setVertexLocation(a[g],c+b+b*Math.sin(g*f),d+b+b*Math.cos(g*f))};function mxParallelEdgeLayout(a){mxGraphLayout.call(this,a)}mxParallelEdgeLayout.prototype=new mxGraphLayout;
mxParallelEdgeLayout.prototype.constructor=mxParallelEdgeLayout;mxParallelEdgeLayout.prototype.spacing=20;mxParallelEdgeLayout.prototype.execute=function(a){a=this.findParallels(a);this.graph.model.beginUpdate();try{for(var b in a){var c=a[b];1<c.length&&this.layout(c)}}finally{this.graph.model.endUpdate()}};
mxParallelEdgeLayout.prototype.findParallels=function(a){for(var b=this.graph.getModel(),c=[],d=b.getChildCount(a),e=0;e<d;e++){var f=b.getChildAt(a,e);if(!this.isEdgeIgnored(f)){var g=this.getEdgeId(f);null!=g&&(null==c[g]&&(c[g]=[]),c[g].push(f))}}return c};
mxParallelEdgeLayout.prototype.getEdgeId=function(a){var b=this.graph.getView(),c=b.getState(a),d=null!=c?c.getVisibleTerminal(true):b.getVisibleTerminal(a,true);a=null!=c?c.getVisibleTerminal(false):b.getVisibleTerminal(a,false);return null!=d&&null!=a?(d=mxCellPath.create(d),a=mxCellPath.create(a),d>a?a+"-"+d:d+"-"+a):null};
mxParallelEdgeLayout.prototype.layout=function(a){var b=a[0],c=this.graph.getModel(),d=c.getGeometry(c.getTerminal(b,true)),e=c.getGeometry(c.getTerminal(b,false));if(d==e){b=d.x+d.width+this.spacing;c=d.y+d.height/2;for(var f=0;f<a.length;f++){this.route(a[f],b,c);b+=this.spacing}}else if(null!=d&&null!=e){b=d.x+d.width/2;c=d.y+d.height/2;f=e.x+e.width/2-b;var g=e.y+e.height/2-c;e=Math.sqrt(f*f+g*g);d=g*this.spacing/e;e=f*this.spacing/e;b=b+f/2+d*(a.length-1)/2;c=c+g/2-e*(a.length-1)/2;for(f=0;f<
a.length;f++){this.route(a[f],b,c);b-=d;c+=e}}};mxParallelEdgeLayout.prototype.route=function(a,b,c){this.graph.isCellMovable(a)&&this.setEdgePoints(a,[new mxPoint(b,c)])};function mxCompositeLayout(a,b,c){mxGraphLayout.call(this,a);this.layouts=b;this.master=c}mxCompositeLayout.prototype=new mxGraphLayout;mxCompositeLayout.prototype.constructor=mxCompositeLayout;mxCompositeLayout.prototype.layouts=null;mxCompositeLayout.prototype.master=null;
mxCompositeLayout.prototype.moveCell=function(){null!=this.master?this.master.move.apply(this.master,arguments):this.layouts[0].move.apply(this.layouts[0],arguments)};mxCompositeLayout.prototype.execute=function(){var a=this.graph.getModel();a.beginUpdate();try{for(var b=0;b<this.layouts.length;b++)this.layouts[b].execute.apply(this.layouts[b],arguments)}finally{a.endUpdate()}};function mxEdgeLabelLayout(a){mxGraphLayout.call(this,a)}mxEdgeLabelLayout.prototype=new mxGraphLayout;
mxEdgeLabelLayout.prototype.constructor=mxEdgeLabelLayout;mxEdgeLabelLayout.prototype.execute=function(a){for(var b=this.graph.view,c=this.graph.getModel(),d=[],e=[],f=c.getChildCount(a),g=0;g<f;g++){var h=c.getChildAt(a,g),k=b.getState(h);null!=k&&(this.isVertexIgnored(h)?this.isEdgeIgnored(h)||d.push(k):e.push(k))}this.placeLabels(e,d)};
mxEdgeLabelLayout.prototype.placeLabels=function(a,b){var c=this.graph.getModel();c.beginUpdate();try{for(var d=0;d<b.length;d++){var e=b[d];if(null!=e&&null!=e.text&&null!=e.text.boundingBox)for(var f=0;f<a.length;f++){var g=a[f];null!=g&&this.avoid(e,g)}}}finally{c.endUpdate()}};
mxEdgeLabelLayout.prototype.avoid=function(a,b){var c=this.graph.getModel(),d=a.text.boundingBox;if(mxUtils.intersects(d,b)){var e=-d.y-d.height+b.y,f=-d.y+b.y+b.height;e=Math.abs(e)<Math.abs(f)?e:f;f=-d.x-d.width+b.x;d=-d.x+b.x+b.width;d=Math.abs(f)<Math.abs(d)?f:d;Math.abs(d)<Math.abs(e)?e=0:d=0;f=c.getGeometry(a.cell);null!=f&&(f=f.clone(),null!=f.offset?(f.offset.x+=d,f.offset.y+=e):f.offset=new mxPoint(d,e),c.setGeometry(a.cell,f))}};
function mxGraphAbstractHierarchyCell(){this.x=[];this.y=[];this.temp=[]}mxGraphAbstractHierarchyCell.prototype.maxRank=-1;mxGraphAbstractHierarchyCell.prototype.minRank=-1;mxGraphAbstractHierarchyCell.prototype.x=null;mxGraphAbstractHierarchyCell.prototype.y=null;mxGraphAbstractHierarchyCell.prototype.width=0;mxGraphAbstractHierarchyCell.prototype.height=0;mxGraphAbstractHierarchyCell.prototype.nextLayerConnectedCells=null;mxGraphAbstractHierarchyCell.prototype.previousLayerConnectedCells=null;
mxGraphAbstractHierarchyCell.prototype.temp=null;mxGraphAbstractHierarchyCell.prototype.getNextLayerConnectedCells=function(){return null};mxGraphAbstractHierarchyCell.prototype.getPreviousLayerConnectedCells=function(){return null};mxGraphAbstractHierarchyCell.prototype.isEdge=function(){return false};mxGraphAbstractHierarchyCell.prototype.isVertex=function(){return false};mxGraphAbstractHierarchyCell.prototype.getGeneralPurposeVariable=function(){return null};
mxGraphAbstractHierarchyCell.prototype.setGeneralPurposeVariable=function(){return null};mxGraphAbstractHierarchyCell.prototype.setX=function(a,b){this.isVertex()?this.x[0]=b:this.isEdge()&&(this.x[a-this.minRank-1]=b)};mxGraphAbstractHierarchyCell.prototype.getX=function(a){return this.isVertex()?this.x[0]:this.isEdge()?this.x[a-this.minRank-1]:0};mxGraphAbstractHierarchyCell.prototype.setY=function(a,b){this.isVertex()?this.y[0]=b:this.isEdge()&&(this.y[a-this.minRank-1]=b)};
function mxGraphHierarchyNode(a){mxGraphAbstractHierarchyCell.apply(this,arguments);this.cell=a}mxGraphHierarchyNode.prototype=new mxGraphAbstractHierarchyCell;mxGraphHierarchyNode.prototype.constructor=mxGraphHierarchyNode;mxGraphHierarchyNode.prototype.cell=null;mxGraphHierarchyNode.prototype.connectsAsTarget=[];mxGraphHierarchyNode.prototype.connectsAsSource=[];mxGraphHierarchyNode.prototype.hashCode=false;mxGraphHierarchyNode.prototype.getRankValue=function(){return this.maxRank};
mxGraphHierarchyNode.prototype.getNextLayerConnectedCells=function(a){if(null==this.nextLayerConnectedCells){this.nextLayerConnectedCells=[];this.nextLayerConnectedCells[0]=[];for(var b=0;b<this.connectsAsTarget.length;b++){var c=this.connectsAsTarget[b];-1==c.maxRank||c.maxRank==a+1?this.nextLayerConnectedCells[0].push(c.source):this.nextLayerConnectedCells[0].push(c)}}return this.nextLayerConnectedCells[0]};
mxGraphHierarchyNode.prototype.getPreviousLayerConnectedCells=function(a){if(null==this.previousLayerConnectedCells){this.previousLayerConnectedCells=[];this.previousLayerConnectedCells[0]=[];for(var b=0;b<this.connectsAsSource.length;b++){var c=this.connectsAsSource[b];-1==c.minRank||c.minRank==a-1?this.previousLayerConnectedCells[0].push(c.target):this.previousLayerConnectedCells[0].push(c)}}return this.previousLayerConnectedCells[0]};mxGraphHierarchyNode.prototype.isVertex=function(){return true};
mxGraphHierarchyNode.prototype.getGeneralPurposeVariable=function(){return this.temp[0]};mxGraphHierarchyNode.prototype.setGeneralPurposeVariable=function(a,b){this.temp[0]=b};
mxGraphHierarchyNode.prototype.isAncestor=function(a){if(null!=a&&null!=this.hashCode&&null!=a.hashCode&&this.hashCode.length<a.hashCode.length){if(this.hashCode==a.hashCode)return true;if(null==this.hashCode||null==this.hashCode)return false;for(var b=0;b<this.hashCode.length;b++)if(this.hashCode[b]!=a.hashCode[b])return false;return true}return false};mxGraphHierarchyNode.prototype.getCoreCell=function(){return this.cell};
function mxGraphHierarchyEdge(a){mxGraphAbstractHierarchyCell.apply(this,arguments);this.edges=a}mxGraphHierarchyEdge.prototype=new mxGraphAbstractHierarchyCell;mxGraphHierarchyEdge.prototype.constructor=mxGraphHierarchyEdge;mxGraphHierarchyEdge.prototype.edges=null;mxGraphHierarchyEdge.prototype.source=null;mxGraphHierarchyEdge.prototype.target=null;mxGraphHierarchyEdge.prototype.isReversed=false;
mxGraphHierarchyEdge.prototype.invert=function(a){a=this.source;this.source=this.target;this.target=a;this.isReversed=!this.isReversed};
mxGraphHierarchyEdge.prototype.getNextLayerConnectedCells=function(a){if(null==this.nextLayerConnectedCells){this.nextLayerConnectedCells=[];for(var b=0;b<this.temp.length;b++){this.nextLayerConnectedCells[b]=[];b==this.temp.length-1?this.nextLayerConnectedCells[b].push(this.source):this.nextLayerConnectedCells[b].push(this)}}return this.nextLayerConnectedCells[a-this.minRank-1]};
mxGraphHierarchyEdge.prototype.getPreviousLayerConnectedCells=function(a){if(null==this.previousLayerConnectedCells){this.previousLayerConnectedCells=[];for(var b=0;b<this.temp.length;b++){this.previousLayerConnectedCells[b]=[];0==b?this.previousLayerConnectedCells[b].push(this.target):this.previousLayerConnectedCells[b].push(this)}}return this.previousLayerConnectedCells[a-this.minRank-1]};mxGraphHierarchyEdge.prototype.isEdge=function(){return true};
mxGraphHierarchyEdge.prototype.getGeneralPurposeVariable=function(a){return this.temp[a-this.minRank-1]};mxGraphHierarchyEdge.prototype.setGeneralPurposeVariable=function(a,b){this.temp[a-this.minRank-1]=b};mxGraphHierarchyEdge.prototype.getCoreCell=function(){return null!=this.edges&&0<this.edges.length?this.edges[0]:null};
function mxGraphHierarchyModel(a,b,c,d,e){a.getGraph();this.tightenToSource=e;this.roots=c;this.parent=d;this.vertexMapper={};this.edgeMapper={};this.maxRank=0;c=[];null==b&&(b=this.graph.getChildVertices(d));this.maxRank=this.SOURCESCANSTARTRANK;this.createInternalCells(a,b,c);for(d=0;d<b.length;d++){e=c[d].connectsAsSource;for(var f=0;f<e.length;f++){var g=e[f],h=g.edges;if(null!=h&&0<h.length){h=h[0];var k=a.getVisibleTerminal(h,false);k=mxCellPath.create(k);k=this.vertexMapper[k];c[d]==k&&(k=
a.getVisibleTerminal(h,true),k=mxCellPath.create(k),k=this.vertexMapper[k]);null!=k&&c[d]!=k&&(g.target=k,0==k.connectsAsTarget.length&&(k.connectsAsTarget=[]),0>mxUtils.indexOf(k.connectsAsTarget,g)&&k.connectsAsTarget.push(g))}}c[d].temp[0]=1}}mxGraphHierarchyModel.prototype.maxRank=null;mxGraphHierarchyModel.prototype.vertexMapper=null;mxGraphHierarchyModel.prototype.edgeMapper=null;mxGraphHierarchyModel.prototype.ranks=null;mxGraphHierarchyModel.prototype.roots=null;
mxGraphHierarchyModel.prototype.parent=null;mxGraphHierarchyModel.prototype.dfsCount=0;mxGraphHierarchyModel.prototype.SOURCESCANSTARTRANK=1E8;mxGraphHierarchyModel.prototype.tightenToSource=false;
mxGraphHierarchyModel.prototype.createInternalCells=function(a,b,c){for(var d=a.getGraph(),e=0;e<b.length;e++){c[e]=new mxGraphHierarchyNode(b[e]);var f=mxCellPath.create(b[e]);this.vertexMapper[f]=c[e];f=a.getEdges(b[e]);c[e].connectsAsSource=[];for(var g=0;g<f.length;g++){var h=a.getVisibleTerminal(f[g],false);if(h!=b[e]&&h!=b[e]&&a.graph.model.isVertex(h)&&!a.isVertexIgnored(h)){var k=a.getEdgesBetween(b[e],h,false),l=a.getEdgesBetween(b[e],h,true);h=mxCellPath.create(k[0]);if(null!=k&&0<k.length&&
null==this.edgeMapper[h]&&2*l.length>=k.length){l=new mxGraphHierarchyEdge(k);for(var m=0;m<k.length;m++){var p=k[m];h=mxCellPath.create(p);this.edgeMapper[h]=l;d.resetEdge(p);a.disableEdgeStyle&&(a.setEdgeStyleEnabled(p,false),a.setOrthogonalEdge(p,true))}l.source=c[e];0>mxUtils.indexOf(c[e].connectsAsSource,l)&&c[e].connectsAsSource.push(l)}}}c[e].temp[0]=0}};
mxGraphHierarchyModel.prototype.initialRank=function(){var a=[];if(null!=this.roots)for(var b=0;b<this.roots.length;b++){var c=mxCellPath.create(this.roots[b]);c=this.vertexMapper[c];null!=c&&a.push(c)}for(var d in this.vertexMapper){c=this.vertexMapper[d];c.temp[0]=-1}for(var e=a.slice();0<a.length;){c=a[0];var f,g;f=c.connectsAsTarget;g=c.connectsAsSource;var h=true,k=this.SOURCESCANSTARTRANK;for(b=0;b<f.length;b++){var l=f[b];if(5270620==l.temp[0]){l=l.source;k=Math.min(k,l.temp[0]-1)}else{h=false;
break}}if(h){c.temp[0]=k;this.maxRank=Math.min(this.maxRank,k);if(null!=g)for(b=0;b<g.length;b++){l=g[b];l.temp[0]=5270620;l=l.target;-1==l.temp[0]&&(a.push(l),l.temp[0]=-2)}a.shift()}else if(b=a.shift(),a.push(c),b==c&&1==a.length)break}for(d in this.vertexMapper){c=this.vertexMapper[d];c.temp[0]-=this.maxRank}for(b=0;b<e.length;b++){c=e[b];a=0;f=c.connectsAsSource;for(d=0;d<f.length;d++){l=f[d];l=l.target;c.temp[0]=Math.max(a,l.temp[0]+1);a=c.temp[0]}}this.maxRank=this.SOURCESCANSTARTRANK-this.maxRank};
mxGraphHierarchyModel.prototype.fixRanks=function(){var a=[];this.ranks=[];for(var b=0;b<this.maxRank+1;b++){a[b]=[];this.ranks[b]=a[b]}var c=null;if(null!=this.roots){var d=this.roots;c=[];for(b=0;b<d.length;b++){var e=mxCellPath.create(d[b]);c[b]=this.vertexMapper[e]}}this.visit(function(f,g,h,k,l){0==l&&0>g.maxRank&&0>g.minRank&&(a[g.temp[0]].push(g),g.maxRank=g.temp[0],g.minRank=g.temp[0],g.temp[0]=a[g.maxRank].length-1);if(null!=f&&null!=h&&1<f.maxRank-g.maxRank){h.maxRank=f.maxRank;h.minRank=
g.maxRank;h.temp=[];h.x=[];h.y=[];for(f=h.minRank+1;f<h.maxRank;f++){a[f].push(h);h.setGeneralPurposeVariable(f,a[f].length-1)}}},c,false,null)};mxGraphHierarchyModel.prototype.visit=function(a,b,c,d){if(null!=b){for(var e=0;e<b.length;e++){var f=b[e];null!=f&&(null==d&&(d={}),c?(f.hashCode=[],f.hashCode[0]=this.dfsCount,f.hashCode[1]=e,this.extendedDfs(null,f,null,a,d,f.hashCode,e,0)):this.dfs(null,f,null,a,d,0))}this.dfsCount++}};
mxGraphHierarchyModel.prototype.dfs=function(a,b,c,d,e,f){if(null!=b){var g=mxCellPath.create(b.cell);if(null==e[g]){e[g]=b;d(a,b,c,f,0);a=b.connectsAsSource.slice();for(c=0;c<a.length;c++){g=a[c];this.dfs(b,g.target,g,d,e,f+1)}}else d(a,b,c,f,1)}};
mxGraphHierarchyModel.prototype.extendedDfs=function(a,b,c,d,e,f,g,h){if(null!=b){if(null!=a&&(null==b.hashCode||b.hashCode[0]!=a.hashCode[0])){f=a.hashCode.length+1;b.hashCode=a.hashCode.slice();b.hashCode[f-1]=g}g=mxCellPath.create(b.cell);if(null==e[g]){e[g]=b;d(a,b,c,h,0);a=b.connectsAsSource.slice();for(c=0;c<a.length;c++){g=a[c];this.extendedDfs(b,g.target,g,d,e,b.hashCode,c,h+1)}}else d(a,b,c,h,1)}};function mxHierarchicalLayoutStage(){}mxHierarchicalLayoutStage.prototype.execute=function(){};
function mxMedianHybridCrossingReduction(a){this.layout=a}mxMedianHybridCrossingReduction.prototype=new mxHierarchicalLayoutStage;mxMedianHybridCrossingReduction.prototype.constructor=mxMedianHybridCrossingReduction;mxMedianHybridCrossingReduction.prototype.layout=null;mxMedianHybridCrossingReduction.prototype.maxIterations=24;mxMedianHybridCrossingReduction.prototype.nestedBestRanks=null;mxMedianHybridCrossingReduction.prototype.currentBestCrossings=0;
mxMedianHybridCrossingReduction.prototype.iterationsWithoutImprovement=0;mxMedianHybridCrossingReduction.prototype.maxNoImprovementIterations=2;
mxMedianHybridCrossingReduction.prototype.execute=function(a){a=this.layout.getModel();this.nestedBestRanks=[];for(var b=0;b<a.ranks.length;b++)this.nestedBestRanks[b]=a.ranks[b].slice();var c=0,d=this.calculateCrossings(a);for(b=0;b<this.maxIterations&&c<this.maxNoImprovementIterations;b++){this.weightedMedian(b,a);this.transpose(b,a);var e=this.calculateCrossings(a);if(e<d){d=e;for(e=c=0;e<this.nestedBestRanks.length;e++)for(var f=a.ranks[e],g=0;g<f.length;g++){var h=f[g];this.nestedBestRanks[e][h.getGeneralPurposeVariable(e)]=
h}}else{c++;for(e=0;e<this.nestedBestRanks.length;e++){f=a.ranks[e];for(g=0;g<f.length;g++){h=f[g];h.setGeneralPurposeVariable(e,g)}}}if(0==d)break}c=[];d=[];for(b=0;b<a.maxRank+1;b++){d[b]=[];c[b]=d[b]}for(b=0;b<this.nestedBestRanks.length;b++)for(e=0;e<this.nestedBestRanks[b].length;e++)d[b].push(this.nestedBestRanks[b][e]);a.ranks=c};mxMedianHybridCrossingReduction.prototype.calculateCrossings=function(a){for(var b=a.ranks.length,c=0,d=1;d<b;d++)c+=this.calculateRankCrossing(d,a);return c};
mxMedianHybridCrossingReduction.prototype.calculateRankCrossing=function(a,b){for(var c=0,d=b.ranks[a],e=d.length,f=b.ranks[a-1].length,g=[],h=0;h<e;h++)g[h]=[];for(h=0;h<d.length;h++){var k=d[h],l=k.getGeneralPurposeVariable(a),m=k.getPreviousLayerConnectedCells(a);for(k=0;k<m.length;k++){var p=m[k].getGeneralPurposeVariable(a-1);g[l][p]=201207}}for(h=0;h<e;h++)for(k=0;k<f;k++)if(201207==g[h][k]){for(d=h+1;d<e;d++)for(l=0;l<k;l++)201207==g[d][l]&&c++;for(d=0;d<h;d++)for(l=k+1;l<f;l++)201207==g[d][l]&&
c++}return c/2};
mxMedianHybridCrossingReduction.prototype.transpose=function(a,b){for(var c=true,d=0;c&&10>d++;){var e=1==a%2&&1==d%2;c=false;for(var f=0;f<b.ranks.length;f++){for(var g=b.ranks[f],h=[],k=0;k<g.length;k++){var l=g[k],m=l.getGeneralPurposeVariable(f);0>m&&(m=k);h[m]=l}var p=null,o=null,n=null,s=null,t=null,q=null,r=null,u=null;for(k=0;k<g.length-1;k++){if(0==k){r=h[k];l=r.getNextLayerConnectedCells(f);m=r.getPreviousLayerConnectedCells(f);n=[];s=[];for(var x=0;x<l.length;x++)n[x]=l[x].getGeneralPurposeVariable(f+1);
for(x=0;x<m.length;x++)s[x]=m[x].getGeneralPurposeVariable(f-1)}else{l=p;m=o;n=t;s=q;r=u}u=h[k+1];p=u.getNextLayerConnectedCells(f);o=u.getPreviousLayerConnectedCells(f);t=[];q=[];for(x=0;x<p.length;x++)t[x]=p[x].getGeneralPurposeVariable(f+1);for(x=0;x<o.length;x++)q[x]=o[x].getGeneralPurposeVariable(f-1);var A=0,H=0;for(x=0;x<n.length;x++)for(var D=0;D<t.length;D++){n[x]>t[D]&&A++;n[x]<t[D]&&H++}for(x=0;x<s.length;x++)for(D=0;D<q.length;D++){s[x]>q[D]&&A++;s[x]<q[D]&&H++}if(H<A||H==A&&e){p=r.getGeneralPurposeVariable(f);
r.setGeneralPurposeVariable(f,u.getGeneralPurposeVariable(f));u.setGeneralPurposeVariable(f,p);p=l;o=m;t=n;q=s;u=r;e||(c=true)}}}}};mxMedianHybridCrossingReduction.prototype.weightedMedian=function(a,b){var c=0==a%2;if(c)for(var d=b.maxRank-1;0<=d;d--)this.medianRank(d,c);else for(d=1;d<b.maxRank;d++)this.medianRank(d,c)};
mxMedianHybridCrossingReduction.prototype.medianRank=function(a,b){for(var c=this.nestedBestRanks[a].length,d=[],e=[],f=0;f<c;f++){var g=this.nestedBestRanks[a][f],h=new MedianCellSorter;h.cell=g;var k;k=b?g.getNextLayerConnectedCells(a):g.getPreviousLayerConnectedCells(a);var l;l=b?a+1:a-1;null!=k&&0!=k.length?(h.medianValue=this.medianValue(k,l),d.push(h)):e[g.getGeneralPurposeVariable(a)]=true}d.sort(MedianCellSorter.prototype.compare);for(f=0;f<c;f++)null==e[f]&&(g=d.shift().cell,g.setGeneralPurposeVariable(a,
f))};mxMedianHybridCrossingReduction.prototype.medianValue=function(a,b){for(var c=[],d=0,e=0;e<a.length;e++){var f=a[e];c[d++]=f.getGeneralPurposeVariable(b)}c.sort(function(g,h){return g-h});if(1==d%2)return c[Math.floor(d/2)];if(2==d)return(c[0]+c[1])/2;e=d/2;f=c[e-1]-c[0];d=c[d-1]-c[e];return(c[e-1]*d+c[e]*f)/(f+d)};function MedianCellSorter(){}MedianCellSorter.prototype.medianValue=0;MedianCellSorter.prototype.cell=false;
MedianCellSorter.prototype.compare=function(a,b){return null!=a&&null!=b?b.medianValue>a.medianValue?-1:b.medianValue<a.medianValue?1:0:0};function mxMinimumCycleRemover(a){this.layout=a}mxMinimumCycleRemover.prototype=new mxHierarchicalLayoutStage;mxMinimumCycleRemover.prototype.constructor=mxMinimumCycleRemover;mxMinimumCycleRemover.prototype.layout=null;
mxMinimumCycleRemover.prototype.execute=function(a){var b=this.layout.getModel(),c={},d=mxUtils.clone(b.vertexMapper,null,true),e=null;if(null!=b.roots){var f=b.roots;e=[];for(a=0;a<f.length;a++){var g=mxCellPath.create(f[a]);e[a]=b.vertexMapper[g]}}b.visit(function(h,k,l){k.isAncestor(h)&&(l.invert(),mxUtils.remove(l,h.connectsAsSource),h.connectsAsTarget.push(l),mxUtils.remove(l,k.connectsAsTarget),k.connectsAsSource.push(l));h=mxCellPath.create(k.cell);c[h]=k;delete d[h]},e,true,null);e=null;0<
d.lenth&&(e=mxUtils.clone(d,null,true));a=mxUtils.clone(c,null,true);b.visit(function(h,k,l){k.isAncestor(h)&&(l.invert(),mxUtils.remove(l,h.connectsAsSource),k.connectsAsSource.push(l),h.connectsAsTarget.push(l),mxUtils.remove(l,k.connectsAsTarget));h=mxCellPath.create(k.cell);c[h]=k;delete d[h]},d,true,a);f=this.layout.getGraph();if(null!=e&&0<e.length){b=b.roots;for(a=0;a<e.length;a++){g=e[a].cell;0==f.getIncomingEdges(g).length&&b.push(g)}}};
function mxCoordinateAssignment(a,b,c,d,e,f){this.layout=a;this.intraCellSpacing=b;this.interRankCellSpacing=c;this.orientation=d;this.initialX=e;this.parallelEdgeSpacing=f}var mxHierarchicalEdgeStyle={ORTHOGONAL:1,POLYLINE:2,STRAIGHT:3,CURVE:4};mxCoordinateAssignment.prototype=new mxHierarchicalLayoutStage;mxCoordinateAssignment.prototype.constructor=mxCoordinateAssignment;mxCoordinateAssignment.prototype.layout=null;mxCoordinateAssignment.prototype.intraCellSpacing=30;
mxCoordinateAssignment.prototype.interRankCellSpacing=100;mxCoordinateAssignment.prototype.parallelEdgeSpacing=10;mxCoordinateAssignment.prototype.maxIterations=8;mxCoordinateAssignment.prototype.prefHozEdgeSep=5;mxCoordinateAssignment.prototype.prefVertEdgeOff=2;mxCoordinateAssignment.prototype.minEdgeJetty=12;mxCoordinateAssignment.prototype.channelBuffer=4;mxCoordinateAssignment.prototype.jettyPositions=null;mxCoordinateAssignment.prototype.orientation=mxConstants.DIRECTION_NORTH;
mxCoordinateAssignment.prototype.initialX=null;mxCoordinateAssignment.prototype.limitX=null;mxCoordinateAssignment.prototype.currentXDelta=null;mxCoordinateAssignment.prototype.widestRank=null;mxCoordinateAssignment.prototype.rankTopY=null;mxCoordinateAssignment.prototype.rankBottomY=null;mxCoordinateAssignment.prototype.widestRankValue=null;mxCoordinateAssignment.prototype.rankWidths=null;mxCoordinateAssignment.prototype.rankY=null;mxCoordinateAssignment.prototype.fineTuning=true;
mxCoordinateAssignment.prototype.edgeStyle=mxHierarchicalEdgeStyle.POLYLINE;mxCoordinateAssignment.prototype.nextLayerConnectedCache=null;mxCoordinateAssignment.prototype.previousLayerConnectedCache=null;mxCoordinateAssignment.prototype.groupPadding=10;
mxCoordinateAssignment.prototype.printStatus=function(){var a=this.layout.getModel();mxLog.show();mxLog.writeln("======Coord assignment debug=======");for(var b=0;b<a.ranks.length;b++){mxLog.write("Rank ",b," : ");for(var c=a.ranks[b],d=0;d<c.length;d++)mxLog.write(c[d].getGeneralPurposeVariable(b),"  ");mxLog.writeln()}mxLog.writeln("====================================")};
mxCoordinateAssignment.prototype.execute=function(a){this.jettyPositions=[];a=this.layout.getModel();this.currentXDelta=0;this.initialCoords(this.layout.getGraph(),a);this.fineTuning&&this.minNode(a);var b=1E8;if(this.fineTuning)for(var c=0;c<this.maxIterations;c++){0!=c&&(this.medianPos(c,a),this.minNode(a));if(this.currentXDelta<b){for(var d=0;d<a.ranks.length;d++)for(var e=a.ranks[d],f=0;f<e.length;f++){var g=e[f];g.setX(d,g.getGeneralPurposeVariable(d))}b=this.currentXDelta}else for(d=0;d<a.ranks.length;d++){e=
a.ranks[d];for(f=0;f<e.length;f++){g=e[f];g.setGeneralPurposeVariable(d,g.getX(d))}}this.minPath(this.layout.getGraph(),a);this.currentXDelta=0}this.setCellLocations(this.layout.getGraph(),a)};
mxCoordinateAssignment.prototype.minNode=function(a){for(var b=[],c=[],d=[],e=0;e<=a.maxRank;e++){d[e]=a.ranks[e];for(var f=0;f<d[e].length;f++){var g=d[e][f],h=new WeightedCellSorter(g,e);h.rankIndex=f;h.visited=true;b.push(h);g=mxCellPath.create(g.getCoreCell());c[g]=h}}a=10*b.length;for(f=0;0<b.length&&f<=a;){h=b.shift();e=h.cell;var k=h.weightedValue,l=parseInt(h.rankIndex);g=e.getNextLayerConnectedCells(k);var m=e.getPreviousLayerConnectedCells(k),p=g.length,o=m.length,n=this.medianXValue(g,
k+1),s=this.medianXValue(m,k-1),t=p+o,q=e.getGeneralPurposeVariable(k),r=q;0<t&&(r=(n*p+s*o)/t);p=false;r<q-1?0==l?(e.setGeneralPurposeVariable(k,r),p=true):(l=d[k][l-1],q=l.getGeneralPurposeVariable(k),q=q+l.width/2+this.intraCellSpacing+e.width/2,q<r?(e.setGeneralPurposeVariable(k,r),p=true):q<e.getGeneralPurposeVariable(k)-1&&(e.setGeneralPurposeVariable(k,q),p=true)):r>q+1&&(l==d[k].length-1?(e.setGeneralPurposeVariable(k,r),p=true):(l=d[k][l+1],q=l.getGeneralPurposeVariable(k),q=q-l.width/2-
this.intraCellSpacing-e.width/2,q>r?(e.setGeneralPurposeVariable(k,r),p=true):q>e.getGeneralPurposeVariable(k)+1&&(e.setGeneralPurposeVariable(k,q),p=true)));if(p){for(e=0;e<g.length;e++){k=g[e];k=mxCellPath.create(k.getCoreCell());k=c[k];null!=k&&false==k.visited&&(k.visited=true,b.push(k))}for(e=0;e<m.length;e++){k=m[e];k=mxCellPath.create(k.getCoreCell());k=c[k];null!=k&&false==k.visited&&(k.visited=true,b.push(k))}}h.visited=false;f++}};
mxCoordinateAssignment.prototype.medianPos=function(a,b){if(0==a%2)for(var c=b.maxRank;0<c;c--)this.rankMedianPosition(c-1,b,c);else for(c=0;c<b.maxRank-1;c++)this.rankMedianPosition(c+1,b,c)};
mxCoordinateAssignment.prototype.rankMedianPosition=function(a,b,c){b=b.ranks[a];for(var d=[],e=[],f=0;f<b.length;f++){var g=b[f];d[f]=new WeightedCellSorter;d[f].cell=g;d[f].rankIndex=f;var h=mxCellPath.create(g.getCoreCell());e[h]=d[f];var k=null;k=c<a?g.getPreviousLayerConnectedCells(a):g.getNextLayerConnectedCells(a);d[f].weightedValue=this.calculatedWeightedValue(g,k)}d.sort(WeightedCellSorter.prototype.compare);for(f=0;f<d.length;f++){g=d[f].cell;h=0;k=c<a?g.getPreviousLayerConnectedCells(a).slice():
g.getNextLayerConnectedCells(a).slice();null!=k&&(h=k.length,h=0<h?this.medianXValue(k,c):g.getGeneralPurposeVariable(a));var l=0;k=-1E8;for(var m=d[f].rankIndex-1;0<=m;){var p=mxCellPath.create(b[m].getCoreCell());p=e[p];if(null!=p){var o=p.cell;p.visited?(k=o.getGeneralPurposeVariable(a)+o.width/2+this.intraCellSpacing+l+g.width/2,m=-1):(l+=o.width+this.intraCellSpacing,m--)}}l=0;o=1E8;for(m=d[f].rankIndex+1;m<d.length;)if(p=mxCellPath.create(b[m].getCoreCell()),p=e[p],null!=p){var n=p.cell;p.visited?
(o=n.getGeneralPurposeVariable(a)-n.width/2-this.intraCellSpacing-l-g.width/2,m=d.length):(l+=n.width+this.intraCellSpacing,m++)}h>=k&&h<=o?g.setGeneralPurposeVariable(a,h):h<k?(g.setGeneralPurposeVariable(a,k),this.currentXDelta+=k-h):h>o&&(g.setGeneralPurposeVariable(a,o),this.currentXDelta+=h-o);d[f].visited=true}};mxCoordinateAssignment.prototype.calculatedWeightedValue=function(a,b){for(var c=0,d=0;d<b.length;d++){var e=b[d];a.isVertex()&&e.isVertex()?c++:c=a.isEdge()&&e.isEdge()?c+8:c+2}return c};
mxCoordinateAssignment.prototype.medianXValue=function(a,b){if(0==a.length)return 0;for(var c=[],d=0;d<a.length;d++)c[d]=a[d].getGeneralPurposeVariable(b);c.sort(function(e,f){return e-f});if(1==a.length%2)return c[Math.floor(a.length/2)];d=a.length/2;return(c[d-1]+c[d])/2};
mxCoordinateAssignment.prototype.initialCoords=function(a,b){this.calculateWidestRank(a,b);for(var c=this.widestRank;0<=c;c--)c<b.maxRank&&this.rankCoordinates(c,a,b);for(c=this.widestRank+1;c<=b.maxRank;c++)0<c&&this.rankCoordinates(c,a,b)};
mxCoordinateAssignment.prototype.rankCoordinates=function(a,b,c){b=c.ranks[a];c=0;for(var d=this.initialX+(this.widestRankValue-this.rankWidths[a])/2,e=false,f=0;f<b.length;f++){var g=b[f];if(g.isVertex()){var h=this.layout.getVertexBounds(g.cell);null!=h?this.orientation==mxConstants.DIRECTION_NORTH||this.orientation==mxConstants.DIRECTION_SOUTH?(g.width=h.width,g.height=h.height):(g.width=h.height,g.height=h.width):e=true;c=Math.max(c,g.height)}else g.isEdge()&&(h=1,null!=g.edges?h=g.edges.length:
mxLog.warn("edge.edges is null"),g.width=(h-1)*this.parallelEdgeSpacing);d+=g.width/2;g.setX(a,d);g.setGeneralPurposeVariable(a,d);d+=g.width/2;d+=this.intraCellSpacing}true==e&&mxLog.warn("At least one cell has no bounds")};
mxCoordinateAssignment.prototype.calculateWidestRank=function(a,b){var c=-this.interRankCellSpacing,d=0;this.rankWidths=[];this.rankY=[];for(var e=b.maxRank;0<=e;e--){for(var f=0,g=b.ranks[e],h=this.initialX,k=false,l=0;l<g.length;l++){var m=g[l];if(m.isVertex()){var p=this.layout.getVertexBounds(m.cell);null!=p?this.orientation==mxConstants.DIRECTION_NORTH||this.orientation==mxConstants.DIRECTION_SOUTH?(m.width=p.width,m.height=p.height):(m.width=p.height,m.height=p.width):k=true;f=Math.max(f,m.height)}else m.isEdge()&&
(p=1,null!=m.edges?p=m.edges.length:mxLog.warn("edge.edges is null"),m.width=(p-1)*this.parallelEdgeSpacing);h+=m.width/2;m.setX(e,h);m.setGeneralPurposeVariable(e,h);h+=m.width/2;h+=this.intraCellSpacing;h>this.widestRankValue&&(this.widestRankValue=h,this.widestRank=e);this.rankWidths[e]=h}true==k&&mxLog.warn("At least one cell has no bounds");this.rankY[e]=c;h=f/2+d/2+this.interRankCellSpacing;d=f;c=this.orientation==mxConstants.DIRECTION_NORTH||this.orientation==mxConstants.DIRECTION_WEST?c+h:
c-h;for(l=0;l<g.length;l++)g[l].setY(e,c)}};
mxCoordinateAssignment.prototype.minPath=function(a,b){var c=b.edgeMapper,d;for(d in c){var e=c[d];if(!(1>e.maxRank-e.minRank-1)){for(var f=e.getGeneralPurposeVariable(e.minRank+1),g=true,h=0,k=e.minRank+2;k<e.maxRank;k++){var l=e.getGeneralPurposeVariable(k);f!=l?(g=false,f=l):h++}if(!g){g=f=0;l=[];var m=[],p=e.getGeneralPurposeVariable(e.minRank+1);for(k=e.minRank+1;k<e.maxRank-1;k++){var o=e.getX(k+1);p==o?(l[k-e.minRank-1]=p,f++):this.repositionValid(b,e,k+1,p)?(l[k-e.minRank-1]=p,f++):p=l[k-
e.minRank-1]=o}p=e.getX(k);for(k=e.maxRank-1;k>e.minRank+1;k--){o=e.getX(k-1);p==o?(m[k-e.minRank-2]=p,g++):this.repositionValid(b,e,k-1,p)?(m[k-e.minRank-2]=p,g++):(m[k-e.minRank-2]=e.getX(k-1),p=o)}if(g>h||f>h)if(g>=f)for(k=e.maxRank-2;k>e.minRank;k--)e.setX(k,m[k-e.minRank-1]);else if(f>g)for(k=e.minRank+2;k<e.maxRank;k++)e.setX(k,l[k-e.minRank-2])}}}};
mxCoordinateAssignment.prototype.repositionValid=function(a,b,c,d){a=a.ranks[c];for(var e=-1,f=0;f<a.length;f++)if(b==a[f]){e=f;break}if(0>e)return false;f=b.getGeneralPurposeVariable(c);if(d<f){if(0==e)return true;a=a[e-1];c=a.getGeneralPurposeVariable(c);c=c+a.width/2+this.intraCellSpacing+b.width/2;if(!(c<=d))return false}else if(d>f){if(e==a.length-1)return true;a=a[e+1];c=a.getGeneralPurposeVariable(c);c=c-a.width/2-this.intraCellSpacing-b.width/2;if(!(c>=d))return false}return true};
mxCoordinateAssignment.prototype.setCellLocations=function(a,b){this.rankTopY=[];this.rankBottomY=[];for(var c=0;c<b.ranks.length;c++){this.rankTopY[c]=Number.MAX_VALUE;this.rankBottomY[c]=0}c=null;this.layout.resizeParent&&(c={});var d=b.edgeMapper,e=b.vertexMapper,f;for(f in e){var g=e[f];this.setVertexLocation(g);if(this.layout.resizeParent){g=a.model.getParent(g.cell);var h=mxCellPath.create(g);null==c[h]&&(c[h]=g)}}this.layout.resizeParent&&null!=c&&this.adjustParents(c);(this.edgeStyle==mxHierarchicalEdgeStyle.ORTHOGONAL||
this.edgeStyle==mxHierarchicalEdgeStyle.POLYLINE||this.edgeStyle==mxHierarchicalEdgeStyle.CURVE)&&this.localEdgeProcessing(b);for(f in d)this.setEdgePosition(d[f])};mxCoordinateAssignment.prototype.adjustParents=function(a){var b=[],c;for(c in a)b.push(a[c]);this.layout.arrangeGroups(mxUtils.sortCells(b,true),this.groupPadding)};
mxCoordinateAssignment.prototype.localEdgeProcessing=function(a){for(var b=0;b<a.ranks.length;b++)for(var c=a.ranks[b],d=0;d<c.length;d++){var e=c[d];if(e.isVertex())for(var f=e.getPreviousLayerConnectedCells(b),g=b-1,h=0;2>h;h++){if(-1<g&&g<a.ranks.length&&null!=f&&0<f.length){for(var k=[],l=0;l<f.length;l++){var m=new WeightedCellSorter(f[l],f[l].getX(g));k.push(m)}k.sort(WeightedCellSorter.prototype.compare);m=e.x[0]-e.width/2;var p=m+e.width,o=f=0;g=[];for(l=0;l<k.length;l++){var n=k[l].cell,
s;if(n.isVertex()){s=0==h?e.connectsAsSource:e.connectsAsTarget;for(var t=0;t<s.length;t++)if(s[t].source==n||s[t].target==n){f+=s[t].edges.length;o++;g.push(s[t])}}else{f+=n.edges.length;o++;g.push(n)}}e.width>(f+1)*this.prefHozEdgeSep+2*this.prefHozEdgeSep&&(m+=this.prefHozEdgeSep,p-=this.prefHozEdgeSep);k=(p-m)/f;m+=k/2;p=this.minEdgeJetty-this.prefVertEdgeOff;for(l=o=0;l<g.length;l++){n=g[l].edges.length;t=mxCellPath.create(g[l].edges[0]);s=this.jettyPositions[t];null==s&&(s=[],this.jettyPositions[t]=
s);l<f/2?p+=this.prefVertEdgeOff:l>f/2&&(p-=this.prefVertEdgeOff);for(t=0;t<n;t++){s[4*t+2*h]=m;m+=k;s[4*t+2*h+1]=p}o=Math.max(o,p)}}f=e.getNextLayerConnectedCells(b);g=b+1}}};
mxCoordinateAssignment.prototype.setEdgePosition=function(a){var b=0;if(101207!=a.temp[0]){var c=a.maxRank,d=a.minRank;c==d&&(c=a.source.maxRank,d=a.target.minRank);var e=0,f=mxCellPath.create(a.edges[0]);f=this.jettyPositions[f];for(var g=a.isReversed?a.target.cell:a.source.cell,h=this.layout.graph,k=0;k<a.edges.length;k++){var l=a.edges[k],m=this.layout.getVisibleTerminal(l,true),p=h.model.getTerminal(l,true),o=[],n=a.isReversed;m!=g&&(n=!n);if(null!=f){var s=n?2:0,t=n?this.rankTopY[d]:this.rankBottomY[c],
q=f[4*e+1+s];n&&(q=-q);t+=q;s=f[4*e+s];p=h.model.getTerminal(l,true);this.layout.isPort(p)&&h.model.getParent(p)==m&&(s=h.view.getState(p),s=null!=s?s.x:m.geometry.x+a.source.width*p.geometry.x);this.orientation==mxConstants.DIRECTION_NORTH||this.orientation==mxConstants.DIRECTION_SOUTH?(o.push(new mxPoint(s,t)),this.edgeStyle==mxHierarchicalEdgeStyle.CURVE&&o.push(new mxPoint(s,t+q))):(o.push(new mxPoint(t,s)),this.edgeStyle==mxHierarchicalEdgeStyle.CURVE&&o.push(new mxPoint(t+q,s)))}s=a.x.length-
1;t=q=-1;m=a.maxRank-1;for(n&&(s=0,q=a.x.length,t=1,m=a.minRank+1);a.maxRank!=a.minRank&&s!=q;s+=t){p=a.x[s]+b;var r=(this.rankTopY[m]+this.rankBottomY[m+1])/2,u=(this.rankTopY[m-1]+this.rankBottomY[m])/2;if(n){var x=r;r=u;u=x}this.orientation==mxConstants.DIRECTION_NORTH||this.orientation==mxConstants.DIRECTION_SOUTH?(o.push(new mxPoint(p,r)),o.push(new mxPoint(p,u))):(o.push(new mxPoint(r,p)),o.push(new mxPoint(u,p)));this.limitX=Math.max(this.limitX,p);m+=t}null!=f&&(s=n?2:0,t=n?this.rankBottomY[c]:
this.rankTopY[d],q=f[4*e+3-s],n&&(q=-q),t-=q,n=h.model.getTerminal(l,false),m=this.layout.getVisibleTerminal(l,false),this.layout.isPort(n)&&h.model.getParent(n)==m&&(s=h.view.getState(n),s=null!=s?s.x:m.geometry.x+a.target.width*n.geometry.x),this.orientation==mxConstants.DIRECTION_NORTH||this.orientation==mxConstants.DIRECTION_SOUTH?(this.edgeStyle==mxHierarchicalEdgeStyle.CURVE&&o.push(new mxPoint(s,t-q)),o.push(new mxPoint(s,t))):(this.edgeStyle==mxHierarchicalEdgeStyle.CURVE&&o.push(new mxPoint(t-
q,s)),o.push(new mxPoint(t,s))));a.isReversed&&this.processReversedEdge(a,l);this.layout.setEdgePoints(l,o);b=0==b?this.parallelEdgeSpacing:0<b?-b:-b+this.parallelEdgeSpacing;e++}a.temp[0]=101207}};
mxCoordinateAssignment.prototype.setVertexLocation=function(a){var b=a.cell,c=a.x[0]-a.width/2,d=a.y[0]-a.height/2;this.rankTopY[a.minRank]=Math.min(this.rankTopY[a.minRank],d);this.rankBottomY[a.minRank]=Math.max(this.rankBottomY[a.minRank],d+a.height);this.orientation==mxConstants.DIRECTION_NORTH||this.orientation==mxConstants.DIRECTION_SOUTH?this.layout.setVertexLocation(b,c,d):this.layout.setVertexLocation(b,d,c);this.limitX=Math.max(this.limitX,c+a.width)};
mxCoordinateAssignment.prototype.processReversedEdge=function(){};function WeightedCellSorter(a,b){this.cell=a;this.weightedValue=b}WeightedCellSorter.prototype.weightedValue=0;WeightedCellSorter.prototype.nudge=false;WeightedCellSorter.prototype.visited=false;WeightedCellSorter.prototype.rankIndex=null;WeightedCellSorter.prototype.cell=null;
WeightedCellSorter.prototype.compare=function(a,b){return null!=a&&null!=b?b.weightedValue>a.weightedValue?-1:b.weightedValue<a.weightedValue?1:b.nudge?-1:1:0};function mxHierarchicalLayout(a,b,c){mxGraphLayout.call(this,a);this.orientation=null!=b?b:mxConstants.DIRECTION_NORTH;this.deterministic=null!=c?c:true}mxHierarchicalLayout.prototype=new mxGraphLayout;mxHierarchicalLayout.prototype.constructor=mxHierarchicalLayout;mxHierarchicalLayout.prototype.roots=null;
mxHierarchicalLayout.prototype.resizeParent=false;mxHierarchicalLayout.prototype.moveParent=false;mxHierarchicalLayout.prototype.parentBorder=0;mxHierarchicalLayout.prototype.intraCellSpacing=30;mxHierarchicalLayout.prototype.interRankCellSpacing=100;mxHierarchicalLayout.prototype.interHierarchySpacing=60;mxHierarchicalLayout.prototype.parallelEdgeSpacing=10;mxHierarchicalLayout.prototype.orientation=mxConstants.DIRECTION_NORTH;mxHierarchicalLayout.prototype.fineTuning=true;
mxHierarchicalLayout.prototype.tightenToSource=true;mxHierarchicalLayout.prototype.disableEdgeStyle=true;mxHierarchicalLayout.prototype.traverseAncestors=true;mxHierarchicalLayout.prototype.model=null;mxHierarchicalLayout.prototype.edgesCache=null;mxHierarchicalLayout.prototype.getModel=function(){return this.model};
mxHierarchicalLayout.prototype.execute=function(a,b){this.parent=a;var c=this.graph.model;this.edgesCache={};null!=b&&"array"!==typeof b&&(b=[b]);if(!(null==b&&null==a)){if(null!=b&&null!=a){for(var d=[],e=0;e<b.length;e++)c.isAncestor(a,b[e])&&d.push(b[e]);this.roots=d}else this.roots=b;c.beginUpdate();try{this.run(a);this.resizeParent&&!this.graph.isCellCollapsed(a)&&this.graph.updateGroupBounds([a],this.parentBorder,this.moveParent)}finally{c.endUpdate()}}};
mxHierarchicalLayout.prototype.findRoots=function(a,b){var c=[];if(null!=a&&null!=b){var d=this.graph.model,e=null,f=-1E5,g;for(g in b){var h=b[g];if(d.isVertex(h)&&this.graph.isCellVisible(h)){for(var k=this.getEdges(h),l=0,m=0,p=0;p<k.length;p++)this.getVisibleTerminal(k[p],true)==h?l++:m++;0==m&&0<l&&c.push(h);k=l-m;k>f&&(f=k,e=h)}}0==c.length&&null!=e&&c.push(e)}return c};
mxHierarchicalLayout.prototype.getEdges=function(a){var b=mxCellPath.create(a);if(null!=this.edgesCache[b])return this.edgesCache[b];for(var c=this.graph.model,d=[],e=this.graph.isCellCollapsed(a),f=c.getChildCount(a),g=0;g<f;g++){var h=c.getChildAt(a,g);if(this.isPort(h))d=d.concat(c.getEdges(h,true,true));else if(e||!this.graph.isCellVisible(h))d=d.concat(c.getEdges(h,true,true))}d=d.concat(c.getEdges(a,true,true));c=[];for(g=0;g<d.length;g++){e=this.getVisibleTerminal(d[g],true);f=this.getVisibleTerminal(d[g],
false);(e==f||e!=f&&(f==a&&(null==this.parent||this.graph.isValidAncestor(e,this.parent,this.traverseAncestors))||e==a&&(null==this.parent||this.graph.isValidAncestor(f,this.parent,this.traverseAncestors))))&&c.push(d[g])}return this.edgesCache[b]=c};mxHierarchicalLayout.prototype.getVisibleTerminal=function(a,b){var c=this.graph.view.getState(a);c=null!=c?c.getVisibleTerminal(b):this.graph.view.getVisibleTerminal(a,b);this.isPort(c)&&(c=this.graph.model.getParent(c));return c};
mxHierarchicalLayout.prototype.run=function(a){var b=[],c=[];if(null==this.roots&&null!=a){var d={};this.filterDescendants(a,d);this.roots=[];var e=true,f;for(f in d)if(null!=d[f]){e=false;break}for(;!e;){var g=this.findRoots(a,d);for(e=0;e<g.length;e++){var h={};b.push(h);this.traverse(g[e],true,null,c,h,b,d)}for(e=0;e<g.length;e++)this.roots.push(g[e]);e=true;for(f in d)if(null!=d[f]){e=false;break}}}else for(e=0;e<this.roots.length;e++){h={};b.push(h);this.traverse(this.roots[e],true,null,c,h,
b,null)}for(e=c=0;e<b.length;e++){h=b[e];d=[];for(f in h)d.push(h[f]);this.model=new mxGraphHierarchyModel(this,d,this.roots,a,this.tightenToSource);this.cycleStage(a);this.layeringStage();this.crossingStage(a);c=this.placementStage(c,a)}};
mxHierarchicalLayout.prototype.filterDescendants=function(a,b){var c=this.graph.model;c.isVertex(a)&&a!=this.parent&&this.graph.isCellVisible(a)&&(b[mxCellPath.create(a)]=a);if(this.traverseAncestors||a==this.parent&&this.graph.isCellVisible(a))for(var d=c.getChildCount(a),e=0;e<d;e++){var f=c.getChildAt(a,e);this.isPort(f)||this.filterDescendants(f,b)}};mxHierarchicalLayout.prototype.isPort=function(a){return a.geometry.relative?true:false};
mxHierarchicalLayout.prototype.getEdgesBetween=function(a,b,c){c=null!=c?c:false;for(var d=this.getEdges(a),e=[],f=0;f<d.length;f++){var g=this.getVisibleTerminal(d[f],true),h=this.getVisibleTerminal(d[f],false);(g==a&&h==b||!c&&g==b&&h==a)&&e.push(d[f])}return e};
mxHierarchicalLayout.prototype.traverse=function(a,b,c,d,e,f,g){if(null!=a&&null!=d){var h=mxCellPath.create(a);if(null==d[h]&&(null==g||null!=g[h])){null==e[h]&&(e[h]=a);null==d[h]&&(d[h]=a);null!==g&&delete g[h];var k=this.getEdges(a);for(c=0;c<k.length;c++)if(h=this.getVisibleTerminal(k[c],true)==a,!b||h){h=this.getVisibleTerminal(k[c],!h);e=this.traverse(h,b,k[c],d,e,f,g)}}else if(null==e[h])for(c=0;c<f.length;c++)if(a=f[c],null!=a[h]){for(k in e)a[k]=e[k];f.pop();return a}}return e};
mxHierarchicalLayout.prototype.cycleStage=function(a){(new mxMinimumCycleRemover(this)).execute(a)};mxHierarchicalLayout.prototype.layeringStage=function(){this.model.initialRank();this.model.fixRanks()};mxHierarchicalLayout.prototype.crossingStage=function(a){(new mxMedianHybridCrossingReduction(this)).execute(a)};
mxHierarchicalLayout.prototype.placementStage=function(a,b){var c=new mxCoordinateAssignment(this,this.intraCellSpacing,this.interRankCellSpacing,this.orientation,a,this.parallelEdgeSpacing);c.fineTuning=this.fineTuning;c.execute(b);return c.limitX+this.interHierarchySpacing};function mxGraphModel(a){this.currentEdit=this.createUndoableEdit();null!=a?this.setRoot(a):this.clear()}mxGraphModel.prototype=new mxEventSource;mxGraphModel.prototype.constructor=mxGraphModel;mxGraphModel.prototype.root=null;
mxGraphModel.prototype.cells=null;mxGraphModel.prototype.maintainEdgeParent=true;mxGraphModel.prototype.createIds=true;mxGraphModel.prototype.prefix="";mxGraphModel.prototype.postfix="";mxGraphModel.prototype.nextId=0;mxGraphModel.prototype.currentEdit=null;mxGraphModel.prototype.updateLevel=0;mxGraphModel.prototype.endingUpdate=false;mxGraphModel.prototype.clear=function(){this.setRoot(this.createRoot())};mxGraphModel.prototype.isCreateIds=function(){return this.createIds};
mxGraphModel.prototype.setCreateIds=function(a){this.createIds=a};mxGraphModel.prototype.createRoot=function(){var a=new mxCell;a.insert(new mxCell);return a};mxGraphModel.prototype.getCell=function(a){return null!=this.cells?this.cells[a]:null};mxGraphModel.prototype.filterCells=function(a,b){var c=null;if(null!=a){c=[];for(var d=0;d<a.length;d++)b(a[d])&&c.push(a[d])}return c};mxGraphModel.prototype.getDescendants=function(a){return this.filterDescendants(null,a)};
mxGraphModel.prototype.filterDescendants=function(a,b){var c=[];b=b||this.getRoot();(null==a||a(b))&&c.push(b);for(var d=this.getChildCount(b),e=0;e<d;e++){var f=this.getChildAt(b,e);c=c.concat(this.filterDescendants(a,f))}return c};mxGraphModel.prototype.getRoot=function(a){var b=a||this.root;if(null!=a)for(;null!=a;){b=a;a=this.getParent(a)}return b};mxGraphModel.prototype.setRoot=function(a){this.execute(new mxRootChange(this,a));return a};
mxGraphModel.prototype.rootChanged=function(a){var b=this.root;this.root=a;this.nextId=0;this.cells=null;this.cellAdded(a);return b};mxGraphModel.prototype.isRoot=function(a){return null!=a&&this.root==a};mxGraphModel.prototype.isLayer=function(a){return this.isRoot(this.getParent(a))};mxGraphModel.prototype.isAncestor=function(a,b){for(;null!=b&&b!=a;)b=this.getParent(b);return b==a};mxGraphModel.prototype.contains=function(a){return this.isAncestor(this.root,a)};
mxGraphModel.prototype.getParent=function(a){return null!=a?a.getParent():null};mxGraphModel.prototype.add=function(a,b,c){if(b!=a&&null!=a&&null!=b){null==c&&(c=this.getChildCount(a));var d=a!=this.getParent(b);this.execute(new mxChildChange(this,a,b,c));this.maintainEdgeParent&&d&&this.updateEdgeParents(b)}return b};
mxGraphModel.prototype.cellAdded=function(a){if(null!=a){null==a.getId()&&this.createIds&&a.setId(this.createId(a));if(null!=a.getId()){var b=this.getCell(a.getId());if(b!=a){for(;null!=b;){a.setId(this.createId(a));b=this.getCell(a.getId())}null==this.cells&&(this.cells={});this.cells[a.getId()]=a}}mxUtils.isNumeric(a.getId())&&(this.nextId=Math.max(this.nextId,a.getId()));b=this.getChildCount(a);for(var c=0;c<b;c++)this.cellAdded(this.getChildAt(a,c))}};
mxGraphModel.prototype.createId=function(a){a=this.nextId;this.nextId++;return this.prefix+a+this.postfix};mxGraphModel.prototype.updateEdgeParents=function(a,b){b=b||this.getRoot(a);for(var c=this.getChildCount(a),d=0;d<c;d++){var e=this.getChildAt(a,d);this.updateEdgeParents(e,b)}e=this.getEdgeCount(a);c=[];for(d=0;d<e;d++)c.push(this.getEdgeAt(a,d));for(d=0;d<c.length;d++){e=c[d];this.isAncestor(b,e)&&this.updateEdgeParent(e,b)}};
mxGraphModel.prototype.updateEdgeParent=function(a,b){for(var c=this.getTerminal(a,true),d=this.getTerminal(a,false),e=null;null!=c&&!this.isEdge(c)&&null!=c.geometry&&c.geometry.relative;)c=this.getParent(c);for(;null!=d&&!this.isEdge(d)&&null!=d.geometry&&d.geometry.relative;)d=this.getParent(d);if(this.isAncestor(b,c)&&this.isAncestor(b,d)&&(e=c==d?this.getParent(c):this.getNearestCommonAncestor(c,d),null!=e&&(this.getParent(e)!=this.root||this.isAncestor(e,a))&&this.getParent(a)!=e)){c=this.getGeometry(a);
if(null!=c){var f=this.getOrigin(this.getParent(a)),g=this.getOrigin(e);d=g.x-f.x;f=g.y-f.y;c=c.clone();c.translate(-d,-f);this.setGeometry(a,c)}this.add(e,a,this.getChildCount(e))}};mxGraphModel.prototype.getOrigin=function(a){var b=null;null!=a?(b=this.getOrigin(this.getParent(a)),this.isEdge(a)||(a=this.getGeometry(a),null!=a&&(b.x+=a.x,b.y+=a.y))):b=new mxPoint;return b};
mxGraphModel.prototype.getNearestCommonAncestor=function(a,b){if(null!=a&&null!=b){var c=mxCellPath.create(b);if(null!=c&&0<c.length){var d=a,e=mxCellPath.create(d);if(c.length<e.length){d=b;var f=e;e=c;c=f}for(;null!=d;){f=this.getParent(d);if(0==c.indexOf(e+mxCellPath.PATH_SEPARATOR)&&null!=f)return d;e=mxCellPath.getParentPath(e);d=f}}}return null};mxGraphModel.prototype.remove=function(a){a==this.root?this.setRoot(null):null!=this.getParent(a)&&this.execute(new mxChildChange(this,null,a));return a};
mxGraphModel.prototype.cellRemoved=function(a){if(null!=a&&null!=this.cells){for(var b=this.getChildCount(a)-1;0<=b;b--)this.cellRemoved(this.getChildAt(a,b));null!=this.cells&&null!=a.getId()&&delete this.cells[a.getId()]}};mxGraphModel.prototype.parentForCellChanged=function(a,b,c){var d=this.getParent(a);null!=b?(b!=d||d.getIndex(a)!=c)&&b.insert(a,c):null!=d&&(c=d.getIndex(a),d.remove(c));!this.contains(d)&&null!=b?this.cellAdded(a):null==b&&this.cellRemoved(a);return d};
mxGraphModel.prototype.getChildCount=function(a){return null!=a?a.getChildCount():0};mxGraphModel.prototype.getChildAt=function(a,b){return null!=a?a.getChildAt(b):null};mxGraphModel.prototype.getChildren=function(a){return null!=a?a.children:null};mxGraphModel.prototype.getChildVertices=function(a){return this.getChildCells(a,true,false)};mxGraphModel.prototype.getChildEdges=function(a){return this.getChildCells(a,false,true)};
mxGraphModel.prototype.getChildCells=function(a,b,c){b=null!=b?b:false;c=null!=c?c:false;for(var d=this.getChildCount(a),e=[],f=0;f<d;f++){var g=this.getChildAt(a,f);(!c&&!b||c&&this.isEdge(g)||b&&this.isVertex(g))&&e.push(g)}return e};mxGraphModel.prototype.getTerminal=function(a,b){return null!=a?a.getTerminal(b):null};
mxGraphModel.prototype.setTerminal=function(a,b,c){var d=b!=this.getTerminal(a,c);this.execute(new mxTerminalChange(this,a,b,c));this.maintainEdgeParent&&d&&this.updateEdgeParent(a,this.getRoot());return b};mxGraphModel.prototype.setTerminals=function(a,b,c){this.beginUpdate();try{this.setTerminal(a,b,true);this.setTerminal(a,c,false)}finally{this.endUpdate()}};
mxGraphModel.prototype.terminalForCellChanged=function(a,b,c){var d=this.getTerminal(a,c);null!=b?b.insertEdge(a,c):null!=d&&d.removeEdge(a,c);return d};mxGraphModel.prototype.getEdgeCount=function(a){return null!=a?a.getEdgeCount():0};mxGraphModel.prototype.getEdgeAt=function(a,b){return null!=a?a.getEdgeAt(b):null};mxGraphModel.prototype.getDirectedEdgeCount=function(a,b,c){for(var d=0,e=this.getEdgeCount(a),f=0;f<e;f++){var g=this.getEdgeAt(a,f);g!=c&&this.getTerminal(g,b)==a&&d++}return d};
mxGraphModel.prototype.getConnections=function(a){return this.getEdges(a,true,true,false)};mxGraphModel.prototype.getIncomingEdges=function(a){return this.getEdges(a,true,false,false)};mxGraphModel.prototype.getOutgoingEdges=function(a){return this.getEdges(a,false,true,false)};
mxGraphModel.prototype.getEdges=function(a,b,c,d){b=null!=b?b:true;c=null!=c?c:true;d=null!=d?d:true;for(var e=this.getEdgeCount(a),f=[],g=0;g<e;g++){var h=this.getEdgeAt(a,g),k=this.getTerminal(h,true),l=this.getTerminal(h,false);(d&&k==l||k!=l&&(b&&l==a||c&&k==a))&&f.push(h)}return f};
mxGraphModel.prototype.getEdgesBetween=function(a,b,c){c=null!=c?c:false;var d=this.getEdgeCount(a),e=this.getEdgeCount(b),f=a,g=d;e<d&&(g=e,f=b);d=[];for(e=0;e<g;e++){var h=this.getEdgeAt(f,e),k=this.getTerminal(h,true),l=this.getTerminal(h,false),m=l==a&&k==b;(k==a&&l==b||!c&&m)&&d.push(h)}return d};
mxGraphModel.prototype.getOpposites=function(a,b,c,d){c=null!=c?c:true;d=null!=d?d:true;var e=[];if(null!=a)for(var f=0;f<a.length;f++){var g=this.getTerminal(a[f],true),h=this.getTerminal(a[f],false);g==b&&null!=h&&h!=b&&d?e.push(h):h==b&&null!=g&&g!=b&&c&&e.push(g)}return e};mxGraphModel.prototype.getTopmostCells=function(a){for(var b=[],c=0;c<a.length;c++){for(var d=a[c],e=true,f=this.getParent(d);null!=f;){if(0<=mxUtils.indexOf(a,f)){e=false;break}f=this.getParent(f)}e&&b.push(d)}return b};
mxGraphModel.prototype.isVertex=function(a){return null!=a?a.isVertex():false};mxGraphModel.prototype.isEdge=function(a){return null!=a?a.isEdge():false};mxGraphModel.prototype.isConnectable=function(a){return null!=a?a.isConnectable():false};mxGraphModel.prototype.getValue=function(a){return null!=a?a.getValue():null};mxGraphModel.prototype.setValue=function(a,b){this.execute(new mxValueChange(this,a,b));return b};mxGraphModel.prototype.valueForCellChanged=function(a,b){return a.valueChanged(b)};
mxGraphModel.prototype.getGeometry=function(a){return null!=a?a.getGeometry():null};mxGraphModel.prototype.setGeometry=function(a,b){b!=this.getGeometry(a)&&this.execute(new mxGeometryChange(this,a,b));return b};mxGraphModel.prototype.geometryForCellChanged=function(a,b){var c=this.getGeometry(a);a.setGeometry(b);return c};mxGraphModel.prototype.getStyle=function(a){return null!=a?a.getStyle():null};
mxGraphModel.prototype.setStyle=function(a,b){b!=this.getStyle(a)&&this.execute(new mxStyleChange(this,a,b));return b};mxGraphModel.prototype.styleForCellChanged=function(a,b){var c=this.getStyle(a);a.setStyle(b);return c};mxGraphModel.prototype.isCollapsed=function(a){return null!=a?a.isCollapsed():false};mxGraphModel.prototype.setCollapsed=function(a,b){b!=this.isCollapsed(a)&&this.execute(new mxCollapseChange(this,a,b));return b};
mxGraphModel.prototype.collapsedStateForCellChanged=function(a,b){var c=this.isCollapsed(a);a.setCollapsed(b);return c};mxGraphModel.prototype.isVisible=function(a){return null!=a?a.isVisible():false};mxGraphModel.prototype.setVisible=function(a,b){b!=this.isVisible(a)&&this.execute(new mxVisibleChange(this,a,b));return b};mxGraphModel.prototype.visibleStateForCellChanged=function(a,b){var c=this.isVisible(a);a.setVisible(b);return c};
mxGraphModel.prototype.execute=function(a){a.execute();this.beginUpdate();this.currentEdit.add(a);this.fireEvent(new mxEventObject(mxEvent.EXECUTE,"change",a));this.fireEvent(new mxEventObject(mxEvent.EXECUTED,"change",a));this.endUpdate()};mxGraphModel.prototype.beginUpdate=function(){this.updateLevel++;this.fireEvent(new mxEventObject(mxEvent.BEGIN_UPDATE));1==this.updateLevel&&this.fireEvent(new mxEventObject(mxEvent.START_EDIT))};
mxGraphModel.prototype.endUpdate=function(){this.updateLevel--;0==this.updateLevel&&this.fireEvent(new mxEventObject(mxEvent.END_EDIT));if(!this.endingUpdate){this.endingUpdate=0==this.updateLevel;this.fireEvent(new mxEventObject(mxEvent.END_UPDATE,"edit",this.currentEdit));try{if(this.endingUpdate&&!this.currentEdit.isEmpty()){this.fireEvent(new mxEventObject(mxEvent.BEFORE_UNDO,"edit",this.currentEdit));var a=this.currentEdit;this.currentEdit=this.createUndoableEdit();a.notify();this.fireEvent(new mxEventObject(mxEvent.UNDO,
"edit",a))}}finally{this.endingUpdate=false}}};mxGraphModel.prototype.createUndoableEdit=function(){var a=new mxUndoableEdit(this,true);a.notify=function(){a.source.fireEvent(new mxEventObject(mxEvent.CHANGE,"edit",a,"changes",a.changes));a.source.fireEvent(new mxEventObject(mxEvent.NOTIFY,"edit",a,"changes",a.changes))};return a};
mxGraphModel.prototype.mergeChildren=function(a,b,c){c=null!=c?c:true;this.beginUpdate();try{var d={};this.mergeChildrenImpl(a,b,c,d);for(var e in d){var f=d[e],g=this.getTerminal(f,true);null!=g&&(g=d[mxCellPath.create(g)],this.setTerminal(f,g,true));g=this.getTerminal(f,false);null!=g&&(g=d[mxCellPath.create(g)],this.setTerminal(f,g,false))}}finally{this.endUpdate()}};
mxGraphModel.prototype.mergeChildrenImpl=function(a,b,c,d){this.beginUpdate();try{for(var e=a.getChildCount(),f=0;f<e;f++){var g=a.getChildAt(f);if("function"==typeof g.getId){var h=g.getId(),k=null!=h&&(!this.isEdge(g)||!c)?this.getCell(h):null;if(null==k){var l=g.clone();l.setId(h);l.setTerminal(g.getTerminal(true),true);l.setTerminal(g.getTerminal(false),false);k=b.insert(l);this.cellAdded(k)}d[mxCellPath.create(g)]=k;this.mergeChildrenImpl(g,k,c,d)}}}finally{this.endUpdate()}};
mxGraphModel.prototype.getParents=function(a){var b=[];if(null!=a)for(var c={},d=0;d<a.length;d++){var e=this.getParent(a[d]);if(null!=e){var f=mxCellPath.create(e);null==c[f]&&(c[f]=e,b.push(e))}}return b};mxGraphModel.prototype.cloneCell=function(a){return null!=a?this.cloneCells([a],true)[0]:null};
mxGraphModel.prototype.cloneCells=function(a,b){for(var c={},d=[],e=0;e<a.length;e++)null!=a[e]?d.push(this.cloneCellImpl(a[e],c,b)):d.push(null);for(e=0;e<d.length;e++)null!=d[e]&&this.restoreClone(d[e],a[e],c);return d};mxGraphModel.prototype.cloneCellImpl=function(a,b,c){var d=this.cellCloned(a);b[mxObjectIdentity.get(a)]=d;if(c){c=this.getChildCount(a);for(var e=0;e<c;e++){var f=this.cloneCellImpl(this.getChildAt(a,e),b,true);d.insert(f)}}return d};mxGraphModel.prototype.cellCloned=function(a){return a.clone()};
mxGraphModel.prototype.restoreClone=function(a,b,c){var d=this.getTerminal(b,true);null!=d&&(d=c[mxObjectIdentity.get(d)],null!=d&&d.insertEdge(a,true));d=this.getTerminal(b,false);null!=d&&(d=c[mxObjectIdentity.get(d)],null!=d&&d.insertEdge(a,false));d=this.getChildCount(a);for(var e=0;e<d;e++)this.restoreClone(this.getChildAt(a,e),this.getChildAt(b,e),c)};function mxRootChange(a,b){this.model=a;this.previous=this.root=b}
mxRootChange.prototype.execute=function(){this.root=this.previous;this.previous=this.model.rootChanged(this.previous)};function mxChildChange(a,b,c,d){this.model=a;this.previous=this.parent=b;this.child=c;this.previousIndex=this.index=d}
mxChildChange.prototype.execute=function(){var a=this.model.getParent(this.child),b=null!=a?a.getIndex(this.child):0;null==this.previous&&this.connect(this.child,false);a=this.model.parentForCellChanged(this.child,this.previous,this.previousIndex);null!=this.previous&&this.connect(this.child,true);this.parent=this.previous;this.previous=a;this.index=this.previousIndex;this.previousIndex=b};
mxChildChange.prototype.connect=function(a,b){b=null!=b?b:true;var c=a.getTerminal(true),d=a.getTerminal(false);null!=c&&(b?this.model.terminalForCellChanged(a,c,true):this.model.terminalForCellChanged(a,null,true));null!=d&&(b?this.model.terminalForCellChanged(a,d,false):this.model.terminalForCellChanged(a,null,false));a.setTerminal(c,true);a.setTerminal(d,false);c=this.model.getChildCount(a);for(d=0;d<c;d++)this.connect(this.model.getChildAt(a,d),b)};
function mxTerminalChange(a,b,c,d){this.model=a;this.cell=b;this.previous=this.terminal=c;this.source=d}mxTerminalChange.prototype.execute=function(){this.terminal=this.previous;this.previous=this.model.terminalForCellChanged(this.cell,this.previous,this.source)};function mxValueChange(a,b,c){this.model=a;this.cell=b;this.previous=this.value=c}mxValueChange.prototype.execute=function(){this.value=this.previous;this.previous=this.model.valueForCellChanged(this.cell,this.previous)};
function mxStyleChange(a,b,c){this.model=a;this.cell=b;this.previous=this.style=c}mxStyleChange.prototype.execute=function(){this.style=this.previous;this.previous=this.model.styleForCellChanged(this.cell,this.previous)};function mxGeometryChange(a,b,c){this.model=a;this.cell=b;this.previous=this.geometry=c}mxGeometryChange.prototype.execute=function(){this.geometry=this.previous;this.previous=this.model.geometryForCellChanged(this.cell,this.previous)};
function mxCollapseChange(a,b,c){this.model=a;this.cell=b;this.previous=this.collapsed=c}mxCollapseChange.prototype.execute=function(){this.collapsed=this.previous;this.previous=this.model.collapsedStateForCellChanged(this.cell,this.previous)};function mxVisibleChange(a,b,c){this.model=a;this.cell=b;this.previous=this.visible=c}mxVisibleChange.prototype.execute=function(){this.visible=this.previous;this.previous=this.model.visibleStateForCellChanged(this.cell,this.previous)};
function mxCellAttributeChange(a,b,c){this.cell=a;this.attribute=b;this.previous=this.value=c}mxCellAttributeChange.prototype.execute=function(){var a=this.cell.getAttribute(this.attribute);null==this.previous?this.cell.value.removeAttribute(this.attribute):this.cell.setAttribute(this.attribute,this.previous);this.previous=a};function mxCell(a,b,c){this.value=a;this.setGeometry(b);this.setStyle(c);if(null!=this.onInit)this.onInit()}mxCell.prototype.id=null;mxCell.prototype.value=null;
mxCell.prototype.geometry=null;mxCell.prototype.style=null;mxCell.prototype.vertex=false;mxCell.prototype.edge=false;mxCell.prototype.connectable=true;mxCell.prototype.visible=true;mxCell.prototype.collapsed=false;mxCell.prototype.parent=null;mxCell.prototype.source=null;mxCell.prototype.target=null;mxCell.prototype.children=null;mxCell.prototype.edges=null;mxCell.prototype.mxTransient="id value parent source target children edges".split(" ");mxCell.prototype.getId=function(){return this.id};
mxCell.prototype.setId=function(a){this.id=a};mxCell.prototype.getValue=function(){return this.value};mxCell.prototype.setValue=function(a){this.value=a};mxCell.prototype.valueChanged=function(a){var b=this.getValue();this.setValue(a);return b};mxCell.prototype.getGeometry=function(){return this.geometry};mxCell.prototype.setGeometry=function(a){this.geometry=a};mxCell.prototype.getStyle=function(){return this.style};mxCell.prototype.setStyle=function(a){this.style=a};mxCell.prototype.isVertex=function(){return this.vertex};
mxCell.prototype.setVertex=function(a){this.vertex=a};mxCell.prototype.isEdge=function(){return this.edge};mxCell.prototype.setEdge=function(a){this.edge=a};mxCell.prototype.isConnectable=function(){return this.connectable};mxCell.prototype.setConnectable=function(a){this.connectable=a};mxCell.prototype.isVisible=function(){return this.visible};mxCell.prototype.setVisible=function(a){this.visible=a};mxCell.prototype.isCollapsed=function(){return this.collapsed};
mxCell.prototype.setCollapsed=function(a){this.collapsed=a};mxCell.prototype.getParent=function(){return this.parent};mxCell.prototype.setParent=function(a){this.parent=a};mxCell.prototype.getTerminal=function(a){return a?this.source:this.target};mxCell.prototype.setTerminal=function(a,b){b?this.source=a:this.target=a;return a};mxCell.prototype.getChildCount=function(){return null==this.children?0:this.children.length};mxCell.prototype.getIndex=function(a){return mxUtils.indexOf(this.children,a)};
mxCell.prototype.getChildAt=function(a){return null==this.children?null:this.children[a]};mxCell.prototype.insert=function(a,b){null!=a&&(null==b&&(b=this.getChildCount(),a.getParent()==this&&b--),a.removeFromParent(),a.setParent(this),null==this.children?(this.children=[],this.children.push(a)):this.children.splice(b,0,a));return a};mxCell.prototype.remove=function(a){var b=null;null!=this.children&&0<=a&&(b=this.getChildAt(a),null!=b&&(this.children.splice(a,1),b.setParent(null)));return b};
mxCell.prototype.removeFromParent=function(){null!=this.parent&&this.parent.remove(this.parent.getIndex(this))};mxCell.prototype.getEdgeCount=function(){return null==this.edges?0:this.edges.length};mxCell.prototype.getEdgeIndex=function(a){return mxUtils.indexOf(this.edges,a)};mxCell.prototype.getEdgeAt=function(a){return null==this.edges?null:this.edges[a]};
mxCell.prototype.insertEdge=function(a,b){if(null!=a&&(a.removeFromTerminal(b),a.setTerminal(this,b),null==this.edges||a.getTerminal(!b)!=this||0>mxUtils.indexOf(this.edges,a))){null==this.edges&&(this.edges=[]);this.edges.push(a)}return a};mxCell.prototype.removeEdge=function(a,b){if(null!=a){if(a.getTerminal(!b)!=this&&null!=this.edges){var c=this.getEdgeIndex(a);0<=c&&this.edges.splice(c,1)}a.setTerminal(null,b)}return a};
mxCell.prototype.removeFromTerminal=function(a){var b=this.getTerminal(a);null!=b&&b.removeEdge(this,a)};mxCell.prototype.getAttribute=function(a,b){var c=this.getValue();return(null!=c&&c.nodeType==mxConstants.NODETYPE_ELEMENT?c.getAttribute(a):null)||b};mxCell.prototype.setAttribute=function(a,b){var c=this.getValue();null!=c&&c.nodeType==mxConstants.NODETYPE_ELEMENT&&c.setAttribute(a,b)};
mxCell.prototype.clone=function(){var a=mxUtils.clone(this,this.mxTransient);a.setValue(this.cloneValue());return a};mxCell.prototype.cloneValue=function(){var a=this.getValue();null!=a&&("function"==typeof a.clone?a=a.clone():isNaN(a.nodeType)||(a=a.cloneNode(true)));return a};function mxGeometry(a,b,c,d){mxRectangle.call(this,a,b,c,d)}mxGeometry.prototype=new mxRectangle;mxGeometry.prototype.constructor=mxGeometry;mxGeometry.prototype.TRANSLATE_CONTROL_POINTS=true;
mxGeometry.prototype.alternateBounds=null;mxGeometry.prototype.sourcePoint=null;mxGeometry.prototype.targetPoint=null;mxGeometry.prototype.points=null;mxGeometry.prototype.offset=null;mxGeometry.prototype.relative=false;
mxGeometry.prototype.swap=function(){if(null!=this.alternateBounds){var a=new mxRectangle(this.x,this.y,this.width,this.height);this.x=this.alternateBounds.x;this.y=this.alternateBounds.y;this.width=this.alternateBounds.width;this.height=this.alternateBounds.height;this.alternateBounds=a}};mxGeometry.prototype.getTerminalPoint=function(a){return a?this.sourcePoint:this.targetPoint};mxGeometry.prototype.setTerminalPoint=function(a,b){b?this.sourcePoint=a:this.targetPoint=a;return a};
mxGeometry.prototype.translate=function(a,b){this.clone();this.relative||(this.x+=a,this.y+=b);null!=this.sourcePoint&&(this.sourcePoint.x+=a,this.sourcePoint.y+=b);null!=this.targetPoint&&(this.targetPoint.x+=a,this.targetPoint.y+=b);if(this.TRANSLATE_CONTROL_POINTS&&null!=this.points)for(var c=this.points.length,d=0;d<c;d++){var e=this.points[d];null!=e&&(e.x+=a,e.y+=b)}};
var mxCellPath={PATH_SEPARATOR:".",create:function(a){var b="";if(null!=a)for(var c=a.getParent();null!=c;){b=c.getIndex(a)+mxCellPath.PATH_SEPARATOR+b;a=c;c=a.getParent()}a=b.length;1<a&&(b=b.substring(0,a-1));return b},getParentPath:function(a){if(null!=a){var b=a.lastIndexOf(mxCellPath.PATH_SEPARATOR);if(0<=b)return a.substring(0,b);if(0<a.length)return""}return null},resolve:function(a,b){var c=a;if(null!=b)for(var d=b.split(mxCellPath.PATH_SEPARATOR),e=0;e<d.length;e++)c=c.getChildAt(parseInt(d[e]));
return c},compare:function(a,b){for(var c=Math.min(a.length,b.length),d=0,e=0;e<c;e++)if(a[e]!=b[e]){0==a[e].length||0==b[e].length?d=a[e]==b[e]?0:a[e]>b[e]?1:-1:(c=parseInt(a[e]),e=parseInt(b[e]),d=c==e?0:c>e?1:-1);break}0==d&&(c=a.length,e=b.length,c!=e&&(d=c>e?1:-1));return d}},mxPerimeter={RectanglePerimeter:function(a,b,c,d){b=a.getCenterX();var e=a.getCenterY(),f=Math.atan2(c.y-e,c.x-b),g=new mxPoint(0,0),h=Math.PI,k=Math.PI/2-f,l=Math.atan2(a.height,a.width);f<-h+l||f>h-l?(g.x=a.x,g.y=e-a.width*
Math.tan(f)/2):f<-l?(g.y=a.y,g.x=b-a.height*Math.tan(k)/2):f<l?(g.x=a.x+a.width,g.y=e+a.width*Math.tan(f)/2):(g.y=a.y+a.height,g.x=b+a.height*Math.tan(k)/2);d&&(c.x>=a.x&&c.x<=a.x+a.width?g.x=c.x:c.y>=a.y&&c.y<=a.y+a.height&&(g.y=c.y),c.x<a.x?g.x=a.x:c.x>a.x+a.width&&(g.x=a.x+a.width),c.y<a.y?g.y=a.y:c.y>a.y+a.height&&(g.y=a.y+a.height));return g},EllipsePerimeter:function(a,b,c,d){var e=a.x,f=a.y,g=a.width/2,h=a.height/2,k=e+g,l=f+h;b=c.x;c=c.y;var m=parseInt(b-k),p=parseInt(c-l);if(0==m&&0!=p)return new mxPoint(k,
l+h*p/Math.abs(p));if(0==m&&0==p)return new mxPoint(b,c);if(d){if(c>=f&&c<=f+a.height)return a=c-l,a=Math.sqrt(g*g*(1-a*a/(h*h)))||0,b<=e&&(a=-a),new mxPoint(k+a,c);if(b>=e&&b<=e+a.width)return a=b-k,a=Math.sqrt(h*h*(1-a*a/(g*g)))||0,c<=f&&(a=-a),new mxPoint(b,l+a)}e=p/m;l-=e*k;f=g*g*e*e+h*h;a=-2*k*f;h=Math.sqrt(a*a-4*f*(g*g*e*e*k*k+h*h*k*k-g*g*h*h));g=(-a+h)/(2*f);h=(-a-h)/(2*f);k=e*g+l;l=e*h+l;e=Math.sqrt(Math.pow(g-b,2)+Math.pow(k-c,2));b=Math.sqrt(Math.pow(h-b,2)+Math.pow(l-c,2));f=c=0;e<b?(c=
g,f=k):(c=h,f=l);return new mxPoint(c,f)},RhombusPerimeter:function(a,b,c,d){b=a.x;var e=a.y,f=a.width;a=a.height;var g=b+f/2,h=e+a/2,k=c.x;c=c.y;if(g==k)return h>c?new mxPoint(g,e):new mxPoint(g,e+a);if(h==c)return g>k?new mxPoint(b,h):new mxPoint(b+f,h);var l=g,m=h;d&&(k>=b&&k<=b+f?l=k:c>=e&&c<=e+a&&(m=c));return k<g?c<h?mxUtils.intersection(k,c,l,m,g,e,b,h):mxUtils.intersection(k,c,l,m,g,e+a,b,h):c<h?mxUtils.intersection(k,c,l,m,g,e,b+f,h):mxUtils.intersection(k,c,l,m,g,e+a,b+f,h)},TrianglePerimeter:function(a,
b,c,d){b=null!=b?b.style[mxConstants.STYLE_DIRECTION]:null;var e=b==mxConstants.DIRECTION_NORTH||b==mxConstants.DIRECTION_SOUTH,f=a.x,g=a.y,h=a.width;a=a.height;var k=f+h/2,l=g+a/2,m=new mxPoint(f,g),p=new mxPoint(f+h,l),o=new mxPoint(f,g+a);b==mxConstants.DIRECTION_NORTH?(m=o,p=new mxPoint(k,g),o=new mxPoint(f+h,g+a)):b==mxConstants.DIRECTION_SOUTH?(p=new mxPoint(k,g+a),o=new mxPoint(f+h,g)):b==mxConstants.DIRECTION_WEST&&(m=new mxPoint(f+h,g),p=new mxPoint(f,l),o=new mxPoint(f+h,g+a));var n=c.x-
k,s=c.y-l;n=e?Math.atan2(n,s):Math.atan2(s,n);var t=e?Math.atan2(h,a):Math.atan2(a,h);s=b==mxConstants.DIRECTION_NORTH||b==mxConstants.DIRECTION_WEST?n>-t&&n<t:n<-Math.PI+t||n>Math.PI-t;t=null;s?t=d&&(e&&c.x>=m.x&&c.x<=o.x||!e&&c.y>=m.y&&c.y<=o.y)?e?new mxPoint(c.x,m.y):new mxPoint(m.x,c.y):b==mxConstants.DIRECTION_NORTH?new mxPoint(f+h/2+a*Math.tan(n)/2,g+a):b==mxConstants.DIRECTION_SOUTH?new mxPoint(f+h/2-a*Math.tan(n)/2,g):b==mxConstants.DIRECTION_WEST?new mxPoint(f+h,g+a/2+h*Math.tan(n)/2):new mxPoint(f,
g+a/2-h*Math.tan(n)/2):(d&&(d=new mxPoint(k,l),c.y>=g&&c.y<=g+a?(d.x=e?k:b==mxConstants.DIRECTION_WEST?f+h:f,d.y=c.y):c.x>=f&&c.x<=f+h&&(d.x=c.x,d.y=!e?l:b==mxConstants.DIRECTION_NORTH?g+a:g),k=d.x,l=d.y),t=e&&c.x<=f+h/2||!e&&c.y<=g+a/2?mxUtils.intersection(c.x,c.y,k,l,m.x,m.y,p.x,p.y):mxUtils.intersection(c.x,c.y,k,l,p.x,p.y,o.x,o.y));null==t&&(t=new mxPoint(k,l));return t}};
function mxPrintPreview(a,b,c,d,e,f,g,h,k){this.graph=a;this.scale=null!=b?b:1/a.pageScale;this.border=null!=d?d:0;this.pageFormat=null!=c?c:a.pageFormat;this.title=null!=h?h:"Printer-friendly version";this.x0=null!=e?e:0;this.y0=null!=f?f:0;this.borderColor=g;this.pageSelector=null!=k?k:true}mxPrintPreview.prototype.graph=null;mxPrintPreview.prototype.pageFormat=null;mxPrintPreview.prototype.scale=null;mxPrintPreview.prototype.border=0;mxPrintPreview.prototype.x0=0;mxPrintPreview.prototype.y0=0;
mxPrintPreview.prototype.autoOrigin=true;mxPrintPreview.prototype.printOverlays=false;mxPrintPreview.prototype.borderColor=null;mxPrintPreview.prototype.title=null;mxPrintPreview.prototype.pageSelector=null;mxPrintPreview.prototype.wnd=null;mxPrintPreview.prototype.pageCount=0;mxPrintPreview.prototype.getWindow=function(){return this.wnd};mxPrintPreview.prototype.getDoctype=function(){var a="";8==document.documentMode&&(a='<meta http-equiv="X-UA-Compatible" content="IE=8">');return a};
mxPrintPreview.prototype.open=function(a){var b=this.graph.cellRenderer.initializeOverlay,c=null;try{this.printOverlays&&(this.graph.cellRenderer.initializeOverlay=function(H,D){D.init(H.view.getDrawPane())});if(null==this.wnd){this.wnd=window.open();var d=this.wnd.document,e=this.getDoctype();null!=e&&0<e.length&&d.writeln(e);d.writeln("<html>");d.writeln("<head>");this.writeHead(d,a);d.writeln("</head>");d.writeln('<body class="mxPage">');mxClient.link("stylesheet",mxClient.basePath+"/css/common.css",
d);mxClient.IS_VML&&(d.namespaces.add("v","urn:schemas-microsoft-com:vml"),d.namespaces.add("o","urn:schemas-microsoft-com:office:office"),d.createStyleSheet().cssText="v\\:*{behavior:url(#default#VML)}o\\:*{behavior:url(#default#VML)}",mxClient.link("stylesheet",mxClient.basePath+"/css/explorer.css",d));var f=this.graph.getGraphBounds().clone(),g=this.graph.getView().getScale(),h=g/this.scale,k=this.graph.getView().getTranslate();this.autoOrigin||(this.x0=-k.x*this.scale,this.y0=-k.y*this.scale,
f.width+=f.x,f.height+=f.y,f.x=0,this.border=f.y=0);f.width/=h;f.height/=h;var l=this.pageFormat.width-2*this.border,m=this.pageFormat.height-2*this.border,p=Math.max(1,Math.ceil((f.width+this.x0)/l)),o=Math.max(1,Math.ceil((f.height+this.y0)/m));this.pageCount=p*o;var n=mxUtils.bind(this,function(){if(this.pageSelector&&(1<o||1<p)){var H=this.createPageSelector(o,p);d.body.appendChild(H);if(mxClient.IS_IE){H.style.position="absolute";var D=function(){H.style.top=d.body.scrollTop+10+"px"};mxEvent.addListener(this.wnd,
"scroll",function(){D()});mxEvent.addListener(this.wnd,"resize",function(){D()})}}});a=function(H,D){null!=this.borderColor&&(H.style.borderColor=this.borderColor,H.style.borderStyle="solid",H.style.borderWidth="1px");H.style.background="white";D&&(H.style.pageBreakAfter="always");mxClient.IS_IE?(d.writeln(H.outerHTML),H.parentNode.removeChild(H)):(H.parentNode.removeChild(H),d.body.appendChild(H));if(D){var y=d.createElement("hr");y.className="mxPageBreak";d.body.appendChild(y)}};var s=this.getCoverPages(this.pageFormat.width,
this.pageFormat.height);if(null!=s)for(var t=0;t<s.length;t++)a(s[t],true);var q=this.getAppendices(this.pageFormat.width,this.pageFormat.height);for(t=0;t<o;t++){var r=t*m/this.scale-this.y0/this.scale+(f.y-k.y*g)/g;for(s=0;s<p;s++){if(null==this.wnd)return null;var u=s*l/this.scale-this.x0/this.scale+(f.x-k.x*g)/g,x=t*p+s+1;c=this.renderPage(this.pageFormat.width,this.pageFormat.height,mxUtils.bind(this,function(H){this.addGraphFragment(-u,-r,this.scale,x,H)}));c.setAttribute("id","mxPage-"+x);
a(c,null!=q||t<o-1||s<p-1)}}if(null!=q)for(t=0;t<q.length;t++)a(q[t],t<q.length);d.writeln("</body>");d.writeln("</html>");d.close();n();mxEvent.release(d.body)}this.wnd.focus()}catch(A){null!=c&&null!=c.parentNode&&c.parentNode.removeChild(c)}finally{this.graph.cellRenderer.initializeOverlay=b}return this.wnd};
mxPrintPreview.prototype.writeHead=function(a,b){null!=this.title&&a.writeln("<title>"+this.title+"</title>");a.writeln('<style type="text/css">');a.writeln("@media print {");a.writeln("  table.mxPageSelector { display: none; }");a.writeln("  hr.mxPageBreak { display: none; }");a.writeln("}");a.writeln("@media screen {");a.writeln("  table.mxPageSelector { position: fixed; right: 10px; top: 10px;font-family: Arial; font-size:10pt; border: solid 1px darkgray;background: white; border-collapse:collapse; }");
a.writeln("  table.mxPageSelector td { border: solid 1px gray; padding:4px; }");a.writeln("  body.mxPage { background: gray; }");a.writeln("}");null!=b&&a.writeln(b);a.writeln("</style>")};
mxPrintPreview.prototype.createPageSelector=function(a,b){var c=this.wnd.document,d=c.createElement("table");d.className="mxPageSelector";d.setAttribute("border","0");for(var e=c.createElement("tbody"),f=0;f<a;f++){for(var g=c.createElement("tr"),h=0;h<b;h++){var k=f*b+h+1,l=c.createElement("td");if(!mxClient.IS_NS||mxClient.IS_SF||mxClient.IS_GC){var m=c.createElement("a");m.setAttribute("href","#mxPage-"+k);mxUtils.write(m,k,c);l.appendChild(m)}else mxUtils.write(l,k,c);g.appendChild(l)}e.appendChild(g)}d.appendChild(e);
return d};
mxPrintPreview.prototype.renderPage=function(a,b,c){var d=document.createElement("div");try{d.style.width=a+"px";d.style.height=b+"px";d.style.overflow="hidden";d.style.pageBreakInside="avoid";d.style.position="relative";var e=document.createElement("div");e.style.top=this.border+"px";e.style.left=this.border+"px";e.style.width=a-2*this.border+"px";e.style.height=b-2*this.border+"px";e.style.overflow="hidden";this.graph.dialect==mxConstants.DIALECT_VML&&(e.style.position="absolute");d.appendChild(e);document.body.appendChild(d);
c(e)}catch(f){throw d.parentNode.removeChild(d),f;}return d};mxPrintPreview.prototype.getRoot=function(){var a=this.graph.view.currentRoot;null==a&&(a=this.graph.getModel().getRoot());return a};
mxPrintPreview.prototype.addGraphFragment=function(a,b,c,d,e){d=this.graph.getView();var f=this.graph.container;this.graph.container=e;var g=d.getCanvas(),h=d.getBackgroundPane(),k=d.getDrawPane(),l=d.getOverlayPane();this.graph.dialect==mxConstants.DIALECT_SVG?d.createSvg():this.graph.dialect==mxConstants.DIALECT_VML?d.createVml():d.createHtml();var m=d.isEventsEnabled();d.setEventsEnabled(false);var p=this.graph.isEnabled();this.graph.setEnabled(false);var o=d.getTranslate();d.translate=new mxPoint(a,
b);a=null;try{var n=[this.getRoot()];a=new mxTemporaryCellStates(d,c,n)}finally{if(mxClient.IS_IE)d.overlayPane.innerHTML="";else for(c=e.firstChild;null!=c;){n=c.nextSibling;b=c.nodeName.toLowerCase();"svg"==b?(c.setAttribute("width",parseInt(e.style.width)),c.setAttribute("height",parseInt(e.style.height))):"default"!=c.style.cursor&&"table"!=b&&c.parentNode.removeChild(c);c=n}d.overlayPane.parentNode.removeChild(d.overlayPane);this.graph.setEnabled(p);this.graph.container=f;d.canvas=g;d.backgroundPane=
h;d.drawPane=k;d.overlayPane=l;d.translate=o;a.destroy();d.setEventsEnabled(m)}};mxPrintPreview.prototype.getCoverPages=function(){return null};mxPrintPreview.prototype.getAppendices=function(){return null};mxPrintPreview.prototype.print=function(){var a=this.open();null!=a&&a.print()};mxPrintPreview.prototype.close=function(){null!=this.wnd&&(this.wnd.close(),this.wnd=null)};
function mxStylesheet(){this.styles={};this.putDefaultVertexStyle(this.createDefaultVertexStyle());this.putDefaultEdgeStyle(this.createDefaultEdgeStyle())}
mxStylesheet.prototype.createDefaultVertexStyle=function(){var a={};a[mxConstants.STYLE_SHAPE]=mxConstants.SHAPE_RECTANGLE;a[mxConstants.STYLE_PERIMETER]=mxPerimeter.RectanglePerimeter;a[mxConstants.STYLE_VERTICAL_ALIGN]=mxConstants.ALIGN_MIDDLE;a[mxConstants.STYLE_ALIGN]=mxConstants.ALIGN_CENTER;a[mxConstants.STYLE_FILLCOLOR]="#C3D9FF";a[mxConstants.STYLE_STROKECOLOR]="#6482B9";a[mxConstants.STYLE_FONTCOLOR]="#774400";return a};
mxStylesheet.prototype.createDefaultEdgeStyle=function(){var a={};a[mxConstants.STYLE_SHAPE]=mxConstants.SHAPE_CONNECTOR;a[mxConstants.STYLE_ENDARROW]=mxConstants.ARROW_CLASSIC;a[mxConstants.STYLE_VERTICAL_ALIGN]=mxConstants.ALIGN_MIDDLE;a[mxConstants.STYLE_ALIGN]=mxConstants.ALIGN_CENTER;a[mxConstants.STYLE_STROKECOLOR]="#6482B9";a[mxConstants.STYLE_FONTCOLOR]="#446299";return a};mxStylesheet.prototype.putDefaultVertexStyle=function(a){this.putCellStyle("defaultVertex",a)};
mxStylesheet.prototype.putDefaultEdgeStyle=function(a){this.putCellStyle("defaultEdge",a)};mxStylesheet.prototype.getDefaultVertexStyle=function(){return this.styles.defaultVertex};mxStylesheet.prototype.getDefaultEdgeStyle=function(){return this.styles.defaultEdge};mxStylesheet.prototype.putCellStyle=function(a,b){this.styles[a]=b};
mxStylesheet.prototype.getCellStyle=function(a,b){var c=b;if(null!=a&&0<a.length){var d=a.split(";");c=null!=c&&";"!=a.charAt(0)?mxUtils.clone(c):{};for(var e=0;e<d.length;e++){var f=d[e],g=f.indexOf("=");if(0<=g){var h=f.substring(0,g);f=f.substring(g+1);f==mxConstants.NONE?delete c[h]:mxUtils.isNumeric(f)?c[h]=parseFloat(f):c[h]=f}else if(f=this.styles[f],null!=f)for(h in f)c[h]=f[h]}}return c};
function mxCellState(a,b,c){this.view=a;this.cell=b;this.style=c;this.origin=new mxPoint;this.absoluteOffset=new mxPoint}mxCellState.prototype=new mxRectangle;mxCellState.prototype.constructor=mxCellState;mxCellState.prototype.view=null;mxCellState.prototype.cell=null;mxCellState.prototype.style=null;mxCellState.prototype.invalid=true;mxCellState.prototype.invalidOrder=false;mxCellState.prototype.orderChanged=false;mxCellState.prototype.origin=null;mxCellState.prototype.absolutePoints=null;
mxCellState.prototype.absoluteOffset=null;mxCellState.prototype.visibleSourceState=null;mxCellState.prototype.visibleTargetState=null;mxCellState.prototype.terminalDistance=0;mxCellState.prototype.length=0;mxCellState.prototype.segments=null;mxCellState.prototype.shape=null;mxCellState.prototype.text=null;
mxCellState.prototype.getPerimeterBounds=function(a,b){a=a||0;b=null!=b?b:new mxRectangle(this.x,this.y,this.width,this.height);if(null!=this.shape&&null!=this.shape.stencil){var c=this.shape.stencil.computeAspect(this.style,b.x,b.y,b.width,b.height);b.x=c.x;b.y=c.y;b.width=this.shape.stencil.w0*c.width;b.height=this.shape.stencil.h0*c.height}0!=a&&b.grow(a);return b};
mxCellState.prototype.setAbsoluteTerminalPoint=function(a,b){b?(null==this.absolutePoints&&(this.absolutePoints=[]),0==this.absolutePoints.length?this.absolutePoints.push(a):this.absolutePoints[0]=a):null==this.absolutePoints?(this.absolutePoints=[],this.absolutePoints.push(null),this.absolutePoints.push(a)):1==this.absolutePoints.length?this.absolutePoints.push(a):this.absolutePoints[this.absolutePoints.length-1]=a};
mxCellState.prototype.setCursor=function(a){null!=this.shape&&this.shape.setCursor(a);null!=this.text&&this.text.setCursor(a)};mxCellState.prototype.getVisibleTerminal=function(a){a=this.getVisibleTerminalState(a);return null!=a?a.cell:null};mxCellState.prototype.getVisibleTerminalState=function(a){return a?this.visibleSourceState:this.visibleTargetState};mxCellState.prototype.setVisibleTerminalState=function(a,b){b?this.visibleSourceState=a:this.visibleTargetState=a};
mxCellState.prototype.destroy=function(){this.view.graph.cellRenderer.destroy(this)};
mxCellState.prototype.clone=function(){var a=new mxCellState(this.view,this.cell,this.style);if(null!=this.absolutePoints){a.absolutePoints=[];for(var b=0;b<this.absolutePoints.length;b++)a.absolutePoints[b]=this.absolutePoints[b].clone()}null!=this.origin&&(a.origin=this.origin.clone());null!=this.absoluteOffset&&(a.absoluteOffset=this.absoluteOffset.clone());null!=this.boundingBox&&(a.boundingBox=this.boundingBox.clone());a.terminalDistance=this.terminalDistance;a.segments=this.segments;a.length=
this.length;a.x=this.x;a.y=this.y;a.width=this.width;a.height=this.height;return a};function mxGraphSelectionModel(a){this.graph=a;this.cells=[]}mxGraphSelectionModel.prototype=new mxEventSource;mxGraphSelectionModel.prototype.constructor=mxGraphSelectionModel;mxGraphSelectionModel.prototype.doneResource="none"!=mxClient.language?"done":"";mxGraphSelectionModel.prototype.updatingSelectionResource="none"!=mxClient.language?"updatingSelection":"";mxGraphSelectionModel.prototype.graph=null;
mxGraphSelectionModel.prototype.singleSelection=false;mxGraphSelectionModel.prototype.isSingleSelection=function(){return this.singleSelection};mxGraphSelectionModel.prototype.setSingleSelection=function(a){this.singleSelection=a};mxGraphSelectionModel.prototype.isSelected=function(a){return null!=a?0<=mxUtils.indexOf(this.cells,a):false};mxGraphSelectionModel.prototype.isEmpty=function(){return 0==this.cells.length};mxGraphSelectionModel.prototype.clear=function(){this.changeSelection(null,this.cells)};
mxGraphSelectionModel.prototype.setCell=function(a){null!=a&&this.setCells([a])};mxGraphSelectionModel.prototype.setCells=function(a){if(null!=a){this.singleSelection&&(a=[this.getFirstSelectableCell(a)]);for(var b=[],c=0;c<a.length;c++)this.graph.isCellSelectable(a[c])&&b.push(a[c]);this.changeSelection(b,this.cells)}};mxGraphSelectionModel.prototype.getFirstSelectableCell=function(a){if(null!=a)for(var b=0;b<a.length;b++)if(this.graph.isCellSelectable(a[b]))return a[b];return null};
mxGraphSelectionModel.prototype.addCell=function(a){null!=a&&this.addCells([a])};mxGraphSelectionModel.prototype.addCells=function(a){if(null!=a){var b=null;this.singleSelection&&(b=this.cells,a=[this.getFirstSelectableCell(a)]);for(var c=[],d=0;d<a.length;d++)!this.isSelected(a[d])&&this.graph.isCellSelectable(a[d])&&c.push(a[d]);this.changeSelection(c,b)}};mxGraphSelectionModel.prototype.removeCell=function(a){null!=a&&this.removeCells([a])};
mxGraphSelectionModel.prototype.removeCells=function(a){if(null!=a){for(var b=[],c=0;c<a.length;c++)this.isSelected(a[c])&&b.push(a[c]);this.changeSelection(null,b)}};mxGraphSelectionModel.prototype.changeSelection=function(a,b){if(null!=a&&0<a.length&&null!=a[0]||null!=b&&0<b.length&&null!=b[0]){var c=new mxSelectionChange(this,a,b);c.execute();var d=new mxUndoableEdit(this,false);d.add(c);this.fireEvent(new mxEventObject(mxEvent.UNDO,"edit",d))}};
mxGraphSelectionModel.prototype.cellAdded=function(a){null!=a&&!this.isSelected(a)&&this.cells.push(a)};mxGraphSelectionModel.prototype.cellRemoved=function(a){null!=a&&(a=mxUtils.indexOf(this.cells,a),0<=a&&this.cells.splice(a,1))};function mxSelectionChange(a,b,c){this.selectionModel=a;this.added=null!=b?b.slice():null;this.removed=null!=c?c.slice():null}
mxSelectionChange.prototype.execute=function(){var a=mxLog.enter("mxSelectionChange.execute");window.status=mxResources.get(this.selectionModel.updatingSelectionResource)||this.selectionModel.updatingSelectionResource;if(null!=this.removed)for(var b=0;b<this.removed.length;b++)this.selectionModel.cellRemoved(this.removed[b]);if(null!=this.added)for(b=0;b<this.added.length;b++)this.selectionModel.cellAdded(this.added[b]);b=this.added;this.added=this.removed;this.removed=b;window.status=mxResources.get(this.selectionModel.doneResource)||
this.selectionModel.doneResource;mxLog.leave("mxSelectionChange.execute",a);this.selectionModel.fireEvent(new mxEventObject(mxEvent.CHANGE,"added",this.added,"removed",this.removed))};function mxCellEditor(a){this.graph=a}mxCellEditor.prototype.graph=null;mxCellEditor.prototype.textarea=null;mxCellEditor.prototype.editingCell=null;mxCellEditor.prototype.trigger=null;mxCellEditor.prototype.modified=false;mxCellEditor.prototype.autoSize=true;mxCellEditor.prototype.emptyLabelText="";
mxCellEditor.prototype.textNode="";
mxCellEditor.prototype.init=function(){this.textarea=document.createElement("textarea");this.textarea.className="mxCellEditor";this.textarea.id="mxCellEditor";this.textarea.style.position="absolute";this.textarea.style.overflow="auto";this.textarea.setAttribute("cols","20");this.textarea.setAttribute("rows","4");mxClient.IS_NS&&(this.textarea.style.resize="none");mxEvent.addListener(this.textarea,"blur",mxUtils.bind(this,function(){if(window.remove_editor==1){window.remove_editor=0;document.removeEventListener("click",
editor_lost_focus,true);this.focusLostTinyMce()}else if(window.remove_editor==-1){window.remove_editor=0;this.focusLost()}else return false}));mxEvent.addListener(this.textarea,"keydown",mxUtils.bind(this,function(a){mxEvent.isConsumed(a)||(113==a.keyCode||this.graph.isEnterStopsCellEditing()&&13==a.keyCode&&!mxEvent.isControlDown(a)&&!mxEvent.isShiftDown(a)?(this.graph.stopEditing(false),mxEvent.consume(a)):27==a.keyCode?(this.graph.stopEditing(true),mxEvent.consume(a)):(this.clearOnChange&&(this.clearOnChange=
false,this.textarea.value=""),this.setModified(true)))}));this.changeHandler=mxUtils.bind(this,function(){null!=this.editingCell&&null==this.graph.getView().getState(this.editingCell)&&this.stopEditing(true)});this.graph.getModel().addListener(mxEvent.CHANGE,this.changeHandler);mxEvent.addListener(this.textarea,"keypress",mxUtils.bind(this,function(a){this.autoSize&&!mxEvent.isConsumed(a)&&setTimeout(mxUtils.bind(this,function(){this.resize()}),0)}))};
mxCellEditor.prototype.resize=function(){if(null!=this.textDiv){var a=this.graph.getView().getState(this.editingCell);if(null==a)this.stopEditing(true);else{var b=this.graph.isLabelClipped(a.cell),c=this.graph.isWrapping(a.cell);if(this.graph.getModel().isEdge(a.cell)){this.bounds.x=a.absoluteOffset.x;this.bounds.y=a.absoluteOffset.y;this.bounds.width=0;this.bounds.height=0}else if(null!=this.bounds){this.bounds.x=a.x;this.bounds.y=a.y;this.bounds.width=a.width;this.bounds.height=a.height;var d=mxUtils.getValue(a.style,
mxConstants.STYLE_LABEL_POSITION,mxConstants.ALIGN_CENTER);d==mxConstants.ALIGN_LEFT?this.bounds.x-=a.width:d==mxConstants.ALIGN_RIGHT&&(this.bounds.x+=a.width);d=mxUtils.getValue(a.style,mxConstants.STYLE_VERTICAL_LABEL_POSITION,mxConstants.ALIGN_MIDDLE);d==mxConstants.ALIGN_TOP?this.bounds.y-=a.height:d==mxConstants.ALIGN_BOTTOM&&(this.bounds.y+=a.height)}d=this.textarea.value;if("\n"==d.charAt(d.length-1)||""==d)d+="&nbsp;";d=mxUtils.htmlEntities(d,false);c?(this.textDiv.style.whiteSpace="normal",
this.textDiv.style.width=this.bounds.width+"px"):d=d.replace(/ /g,"&nbsp;");d=d.replace(/\n/g,"<br/>");this.textDiv.innerHTML=d;d=this.textDiv.offsetWidth+30;var e=this.textDiv.offsetHeight+16;d=Math.max(d,40);e=Math.max(e,20);b&&(d=Math.min(this.bounds.width-4,d),e=Math.min(this.bounds.height,e));var f=null!=a.text?a.text.margin:null;null==f&&(f=mxUtils.getValue(a.style,mxConstants.STYLE_ALIGN,mxConstants.ALIGN_CENTER),a=mxUtils.getValue(a.style,mxConstants.STYLE_VERTICAL_ALIGN,mxConstants.ALIGN_MIDDLE),
f=mxUtils.getAlignmentAsPoint(f,a));if(null!=f){if(b||!c)this.textarea.style.left=Math.max(0,Math.round(this.bounds.x-f.x*this.bounds.width+f.x*d)-3)+"px";this.textarea.style.top=Math.max(0,Math.round(this.bounds.y-f.y*this.bounds.height+f.y*e)+4)+"px"}if(b||!c)this.textarea.style.width=d+"px";this.textarea.style.height=e+"px"}}};mxCellEditor.prototype.isModified=function(){return this.modified};mxCellEditor.prototype.setModified=function(a){this.modified=a};mxCellEditor.prototype.focusLost=function(){this.stopEditing(!this.graph.isInvokesStopCellEditing())};
mxCellEditor.prototype.focusLostTinyMce=function(){tinyMCE.triggerSave();tinyMCE.execCommand("mceRemoveControl",false,"mxCellEditor1");this.textarea.value=this.text_tiny.value;this.modified=1;this.div.removeChild(this.text_tiny);this.graph.container.removeChild(this.div);this.stopEditing(!this.graph.isInvokesStopCellEditing())};
mxCellEditor.prototype.startEditing=function(a,b){null==this.textarea&&this.init();this.stopEditing(true);var c=this.graph.getView().getState(a);if(null!=c){this.editingCell=a;this.trigger=b;this.textNode=null;null!=c.text&&this.isHideLabel(c)&&(this.textNode=c.text.node,this.textNode.style.visibility="hidden");var d=this.graph.getView().scale;d*=mxUtils.getValue(c.style,mxConstants.STYLE_FONTSIZE,mxConstants.DEFAULT_FONTSIZE);var e=mxUtils.getValue(c.style,mxConstants.STYLE_FONTFAMILY,mxConstants.DEFAULT_FONTFAMILY),
f=mxUtils.getValue(c.style,mxConstants.STYLE_FONTCOLOR,"black"),g=mxUtils.getValue(c.style,mxConstants.STYLE_ALIGN,mxConstants.ALIGN_LEFT),h=(mxUtils.getValue(c.style,mxConstants.STYLE_FONTSTYLE,0)&mxConstants.FONT_BOLD)==mxConstants.FONT_BOLD,k=(mxUtils.getValue(c.style,mxConstants.STYLE_FONTSTYLE,0)&mxConstants.FONT_ITALIC)==mxConstants.FONT_ITALIC,l=(mxUtils.getValue(c.style,mxConstants.STYLE_FONTSTYLE,0)&mxConstants.FONT_UNDERLINE)==mxConstants.FONT_UNDERLINE;this.textarea.style.fontSize=Math.round(d)+
"px";this.textarea.style.lineHeight=Math.round(d*mxConstants.LINE_HEIGHT)+"px";this.textarea.style.fontFamily=e;this.textarea.style.textAlign=g;this.textarea.style.color=f;this.textarea.style.fontWeight=h?"bold":"normal";this.textarea.style.fontStyle=k?"italic":"";this.textarea.style.textDecoration=l?"underline":"";this.textarea.style.overflow="auto";this.textarea.style.outline="none";this.bounds=d=this.getEditorBounds(c);this.textarea.style.left=d.x+"px";this.textarea.style.top=d.y+"px";this.textarea.style.width=
d.width+"px";this.textarea.style.height=d.height+"px";this.textarea.style.zIndex=5;c=this.getInitialValue(c,b);null==c||0==c.length?(c=this.getEmptyLabelText(),this.clearOnChange=true):this.clearOnChange=false;this.setModified(false);this.textarea.value="";this.graph.container.appendChild(this.textarea);if(c.match(".*\\<[^>]+>.*")!=null){this.textarea.value="";this.textarea.visibility="hidden";this.div=document.createElement("div");this.div.id="mxCellEditor-Div";this.div.style.position="absolute";
this.div.style.left=d.x-2+"px";this.div.style.top=d.y-32+"px";this.div.style.zIndex=5;this.text_tiny=document.createElement("textarea");this.text_tiny.id="mxCellEditor1";this.text_tiny.className="mxCellEditor";this.text_tiny.style.position="absolute";this.text_tiny.style.visibility="hidden";this.text_tiny.style.width=d.width+"px";this.text_tiny.style.height=d.height+44+"px";this.text_tiny.value=c;this.div.appendChild(this.text_tiny);this.graph.container.appendChild(this.div);tinyMCE.execCommand("mceAddControl",
false,"mxCellEditor1");document.addEventListener("click",editor_lost_focus,true)}else{this.textarea.value=c;window.remove_editor=-1}"none"!=this.textarea.style.display&&(this.autoSize&&(this.textDiv=this.createTextDiv(),document.body.appendChild(this.textDiv)),this.textarea.focus(),this.textarea.select())}};
mxCellEditor.prototype.createTextDiv=function(){var a=document.createElement("div"),b=a.style;b.position="absolute";b.whiteSpace="nowrap";b.visibility="hidden";b.display=mxClient.IS_QUIRKS?"inline":"inline-block";b.zoom="1";b.verticalAlign="top";b.lineHeight=this.textarea.style.lineHeight;b.fontSize=this.textarea.style.fontSize;b.fontFamily=this.textarea.style.fontFamily;b.fontWeight=this.textarea.style.fontWeight;b.textAlign=this.textarea.style.textAlign;b.fontStyle=this.textarea.style.fontStyle;
b.textDecoration=this.textarea.style.textDecoration;return a};mxCellEditor.prototype.stopEditing=function(a){null!=this.editingCell&&(null!=this.textNode&&(this.textNode.style.visibility="visible",this.textNode=null),!a&&this.isModified()&&this.graph.labelChanged(this.editingCell,this.getCurrentValue(),this.trigger),null!=this.textDiv&&(document.body.removeChild(this.textDiv),this.textDiv=null),this.bounds=this.trigger=this.editingCell=null,this.textarea.blur(),this.textarea.parentNode.removeChild(this.textarea))};
mxCellEditor.prototype.getInitialValue=function(a,b){return this.graph.getEditingValue(a.cell,b)};mxCellEditor.prototype.getCurrentValue=function(){return this.textarea.value.replace(/\r/g,"")};mxCellEditor.prototype.isHideLabel=function(){return true};mxCellEditor.prototype.getMinimumSize=function(a){var b=this.graph.getView().scale;return new mxRectangle(0,0,null==a.text?30:a.text.size*b+20,"left"==this.textarea.style.textAlign?120:40)};
mxCellEditor.prototype.getEditorBounds=function(a){var b=this.graph.getModel().isEdge(a.cell),c=this.graph.getView().scale,d=this.getMinimumSize(a),e=d.width;d=d.height;var f=parseInt(a.style[mxConstants.STYLE_SPACING]||2)*c,g=parseInt(a.style[mxConstants.STYLE_SPACING_TOP]||0)*c+f,h=parseInt(a.style[mxConstants.STYLE_SPACING_RIGHT]||0)*c+f,k=parseInt(a.style[mxConstants.STYLE_SPACING_BOTTOM]||0)*c+f;c=parseInt(a.style[mxConstants.STYLE_SPACING_LEFT]||0)*c+f;h=new mxRectangle(a.x,a.y,Math.max(e,a.width-
c-h),Math.max(d,a.height-g-k));b?(h.x=a.absoluteOffset.x,h.y=a.absoluteOffset.y,null!=a.text&&null!=a.text.boundingBox&&(0<a.text.boundingBox.x&&(h.x=a.text.boundingBox.x),0<a.text.boundingBox.y&&(h.y=a.text.boundingBox.y))):null!=a.text&&null!=a.text.boundingBox&&(h.x=Math.min(h.x,a.text.boundingBox.x),h.y=Math.min(h.y,a.text.boundingBox.y));h.x+=c;h.y+=g;null!=a.text&&null!=a.text.boundingBox&&(b?(h.width=Math.max(e,a.text.boundingBox.width),h.height=Math.max(d,a.text.boundingBox.height)):(h.width=
Math.max(h.width,a.text.boundingBox.width),h.height=Math.max(h.height,a.text.boundingBox.height)));this.graph.getModel().isVertex(a.cell)&&(b=mxUtils.getValue(a.style,mxConstants.STYLE_LABEL_POSITION,mxConstants.ALIGN_CENTER),b==mxConstants.ALIGN_LEFT?h.x-=a.width:b==mxConstants.ALIGN_RIGHT&&(h.x+=a.width),b=mxUtils.getValue(a.style,mxConstants.STYLE_VERTICAL_LABEL_POSITION,mxConstants.ALIGN_MIDDLE),b==mxConstants.ALIGN_TOP?h.y-=a.height:b==mxConstants.ALIGN_BOTTOM&&(h.y+=a.height));return h};
mxCellEditor.prototype.getEmptyLabelText=function(){return this.emptyLabelText};mxCellEditor.prototype.getEditingCell=function(){return this.editingCell};mxCellEditor.prototype.destroy=function(){null!=this.textarea&&(mxEvent.release(this.textarea),null!=this.textarea.parentNode&&this.textarea.parentNode.removeChild(this.textarea),this.textarea=null,null!=this.changeHandler&&(this.graph.getModel().removeListener(this.changeHandler),this.changeHandler=null))};function mxCellRenderer(){}
mxCellRenderer.prototype.defaultEdgeShape=mxConnector;mxCellRenderer.prototype.defaultVertexShape=mxRectangleShape;mxCellRenderer.prototype.defaultTextShape=mxText;mxCellRenderer.prototype.legacyControlPosition=true;mxCellRenderer.prototype.defaultShapes={};mxCellRenderer.registerShape=function(a,b){mxCellRenderer.prototype.defaultShapes[a]=b};mxCellRenderer.registerShape(mxConstants.SHAPE_RECTANGLE,mxRectangleShape);mxCellRenderer.registerShape(mxConstants.SHAPE_ELLIPSE,mxEllipse);
mxCellRenderer.registerShape(mxConstants.SHAPE_RHOMBUS,mxRhombus);mxCellRenderer.registerShape(mxConstants.SHAPE_CYLINDER,mxCylinder);mxCellRenderer.registerShape(mxConstants.SHAPE_CONNECTOR,mxConnector);mxCellRenderer.registerShape(mxConstants.SHAPE_ACTOR,mxActor);mxCellRenderer.registerShape(mxConstants.SHAPE_TRIANGLE,mxTriangle);mxCellRenderer.registerShape(mxConstants.SHAPE_HEXAGON,mxHexagon);mxCellRenderer.registerShape(mxConstants.SHAPE_CLOUD,mxCloud);
mxCellRenderer.registerShape(mxConstants.SHAPE_LINE,mxLine);mxCellRenderer.registerShape(mxConstants.SHAPE_ARROW,mxArrow);mxCellRenderer.registerShape(mxConstants.SHAPE_DOUBLE_ELLIPSE,mxDoubleEllipse);mxCellRenderer.registerShape(mxConstants.SHAPE_SWIMLANE,mxSwimlane);mxCellRenderer.registerShape(mxConstants.SHAPE_IMAGE,mxImageShape);mxCellRenderer.registerShape(mxConstants.SHAPE_LABEL,mxLabel);
mxCellRenderer.prototype.initialize=function(a,b){var c=a.view.graph.getModel();if(null!=a.view.graph.container&&null==a.shape&&a.cell!=a.view.currentRoot&&(c.isVertex(a.cell)||c.isEdge(a.cell)))if(this.createShape(a),null!=a.shape&&(null==b||b)){this.initializeShape(a);a.view.graph.ordered||c.isEdge(a.cell)?a.invalidOrder=true:a.view.graph.keepEdgesInForeground&&null!=this.firstEdge&&(this.firstEdge.parentNode==a.shape.node.parentNode?this.insertState(a,this.firstEdge):this.firstEdge=null);a.shape.scale=
a.view.scale;this.createCellOverlays(a);this.installListeners(a)}};mxCellRenderer.prototype.initializeShape=function(a){a.shape.init(a.view.getDrawPane())};mxCellRenderer.prototype.getPreviousStateInContainer=function(a,b){for(var c=null,d=a.view.graph,e=d.getModel(),f=a.cell,g=e.getParent(f);null!=g&&null==c;){c=this.findPreviousStateInContainer(d,g,f,b);f=g;g=e.getParent(f)}return c};
mxCellRenderer.prototype.findPreviousStateInContainer=function(a,b,c,d){var e=null,f=a.getModel();for(c=null!=c?b.getIndex(c)-1:f.getChildCount(b)-1;0<=c&&null==e;c--)e=this.findPreviousStateInContainer(a,f.getChildAt(b,c),null,d);if(null==e&&(e=a.view.getState(b),null!=e&&(null==e.shape||null==e.shape.node||e.shape.node.parentNode!=d)))e=null;return e};
mxCellRenderer.prototype.order=function(a){var b=a.shape.node.parentNode,c=this.getPreviousStateInContainer(a,b),d=b.firstChild;null!=c&&(d=c.shape.node,null!=c.text&&null!=c.text.node&&c.text.node.parentNode==b&&(d=c.text.node),d=d.nextSibling);this.insertState(a,d)};
mxCellRenderer.prototype.orderEdge=function(a){var b=a.view,c=b.graph.getModel();if(b.graph.keepEdgesInForeground){if(null==this.firstEdge||null==this.firstEdge.parentNode||this.firstEdge.parentNode!=a.shape.node.parentNode)this.firstEdge=a.shape.node}else if(b.graph.keepEdgesInBackground){var d=a.shape.node,e=d.parentNode;c=c.getParent(a.cell);b=b.getState(c);e=null!=b&&null!=b.shape&&null!=b.shape.node?b.shape.node.nextSibling:e.firstChild;null!=e&&e!=d&&this.insertState(a,e)}};
mxCellRenderer.prototype.insertState=function(a,b){a.shape.node.parentNode.insertBefore(a.shape.node,b);null!=a.text&&null!=a.text.node&&a.text.node.parentNode==a.shape.node.parentNode&&a.shape.node.parentNode.insertBefore(a.text.node,a.shape.node.nextSibling)};
mxCellRenderer.prototype.createShape=function(a){if(null!=a.style){var b=mxStencilRegistry.getStencil(a.style[mxConstants.STYLE_SHAPE]);null!=b?a.shape=new mxShape(b):(b=this.getShapeConstructor(a),a.shape=new b);a.shape.points=a.absolutePoints;a.shape.bounds=new mxRectangle(a.x,a.y,a.width,a.height);a.shape.dialect=a.view.graph.dialect;this.configureShape(a)}};mxCellRenderer.prototype.getShape=function(a){return null!=a?mxCellRenderer.prototype.defaultShapes[a]:null};
mxCellRenderer.prototype.getShapeConstructor=function(a){var b=this.getShape(a.style[mxConstants.STYLE_SHAPE]);null==b&&(b=a.view.graph.getModel().isEdge(a.cell)?this.defaultEdgeShape:this.defaultVertexShape);return b};
mxCellRenderer.prototype.configureShape=function(a){a.shape.apply(a);a.shape.image=a.view.graph.getImage(a);a.shape.indicatorShape=this.getShape(a.view.graph.getIndicatorShape(a));a.shape.indicatorColor=a.view.graph.getIndicatorColor(a);a.shape.indicatorGradientColor=a.view.graph.getIndicatorGradientColor(a);a.shape.indicatorDirection=a.style[mxConstants.STYLE_INDICATOR_DIRECTION];a.shape.indicatorImage=a.view.graph.getIndicatorImage(a);this.postConfigureShape(a)};
mxCellRenderer.prototype.postConfigureShape=function(a){null!=a.shape&&(this.resolveColor(a,"indicatorColor",mxConstants.STYLE_FILLCOLOR),this.resolveColor(a,"indicatorGradientColor",mxConstants.STYLE_GRADIENTCOLOR),this.resolveColor(a,"fill",mxConstants.STYLE_FILLCOLOR),this.resolveColor(a,"stroke",mxConstants.STYLE_STROKECOLOR),this.resolveColor(a,"gradient",mxConstants.STYLE_GRADIENTCOLOR))};
mxCellRenderer.prototype.resolveColor=function(a,b,c){var d=a.shape[b],e=a.view.graph,f=null;"inherit"==d?f=e.model.getParent(a.cell):"swimlane"==d?(f=null!=e.model.getTerminal(a.cell,false)?e.model.getTerminal(a.cell,false):a.cell,f=e.getSwimlane(f),c=e.swimlaneIndicatorColorAttribute):"indicated"==d&&(a.shape[b]=a.shape.indicatorColor);null!=f&&(d=e.getView().getState(f),a.shape[b]=null,null!=d&&(a.shape[b]=null!=d.shape&&"indicatorColor"!=b?d.shape[b]:d.style[c]))};
mxCellRenderer.prototype.getLabelValue=function(a){return a.view.graph.getLabel(a.cell)};
mxCellRenderer.prototype.createLabel=function(a,b){var c=a.view.graph;c.getModel().isEdge(a.cell);if(0<a.style[mxConstants.STYLE_FONTSIZE]||null==a.style[mxConstants.STYLE_FONTSIZE]){var d=c.isHtmlLabel(a.cell)||null!=b&&mxUtils.isNode(b);a.text=new this.defaultTextShape(b,new mxRectangle,a.style[mxConstants.STYLE_ALIGN]||mxConstants.ALIGN_CENTER,c.getVerticalAlign(a),a.style[mxConstants.STYLE_FONTCOLOR],a.style[mxConstants.STYLE_FONTFAMILY],a.style[mxConstants.STYLE_FONTSIZE],a.style[mxConstants.STYLE_FONTSTYLE],
a.style[mxConstants.STYLE_SPACING],a.style[mxConstants.STYLE_SPACING_TOP],a.style[mxConstants.STYLE_SPACING_RIGHT],a.style[mxConstants.STYLE_SPACING_BOTTOM],a.style[mxConstants.STYLE_SPACING_LEFT],a.style[mxConstants.STYLE_HORIZONTAL],a.style[mxConstants.STYLE_LABEL_BACKGROUNDCOLOR],a.style[mxConstants.STYLE_LABEL_BORDERCOLOR],c.isWrapping(a.cell)&&c.isHtmlLabel(a.cell),c.isLabelClipped(a.cell),a.style[mxConstants.STYLE_OVERFLOW],a.style[mxConstants.STYLE_LABEL_PADDING]);a.text.opacity=mxUtils.getValue(a.style,
mxConstants.STYLE_TEXT_OPACITY,100);a.text.dialect=d?mxConstants.DIALECT_STRICTHTML:a.view.graph.dialect;a.text.state=a;this.initializeLabel(a);var e=false,f=function(g){var h=a;if(mxClient.IS_TOUCH||e){h=mxEvent.getClientX(g);g=mxEvent.getClientY(g);g=mxUtils.convertPoint(c.container,h,g);h=c.view.getState(c.getCellAt(g.x,g.y))}return h};mxEvent.addGestureListeners(a.text.node,mxUtils.bind(this,function(g){this.isLabelEvent(a,g)&&(c.fireMouseEvent(mxEvent.MOUSE_DOWN,new mxMouseEvent(g,a)),e=c.dialect!=
mxConstants.DIALECT_SVG&&"IMG"==mxEvent.getSource(g).nodeName)}),mxUtils.bind(this,function(g){this.isLabelEvent(a,g)&&c.fireMouseEvent(mxEvent.MOUSE_MOVE,new mxMouseEvent(g,f(g)))}),mxUtils.bind(this,function(g){this.isLabelEvent(a,g)&&(c.fireMouseEvent(mxEvent.MOUSE_UP,new mxMouseEvent(g,f(g))),e=false)}));mxEvent.addListener(a.text.node,"dblclick",mxUtils.bind(this,function(g){this.isLabelEvent(a,g)&&(c.dblClick(g,a.cell),mxEvent.consume(g))}))}};
mxCellRenderer.prototype.initializeLabel=function(a){var b=a.view.graph;a.text.dialect!=mxConstants.DIALECT_SVG&&(mxClient.IS_SVG&&mxClient.NO_FO?a.text.init(b.container):mxUtils.isVml(a.view.getDrawPane())&&(null!=a.shape.label?a.text.init(a.shape.label):a.text.init(a.shape.node)));null==a.text.node&&(a.text.init(a.view.getDrawPane()),null!=a.shape&&null!=a.text&&a.shape.node.parentNode.insertBefore(a.text.node,a.shape.node.nextSibling))};
mxCellRenderer.prototype.createCellOverlays=function(a){var b=a.view.graph.getCellOverlays(a.cell),c=null;if(null!=b){c=new mxDictionary;for(var d=0;d<b.length;d++){var e=null!=a.overlays?a.overlays.remove(b[d]):null;null==e&&(e=new mxImageShape(new mxRectangle,b[d].image.src),e.dialect=a.view.graph.dialect,e.preserveImageAspect=false,e.overlay=b[d],this.initializeOverlay(a,e),this.installCellOverlayListeners(a,b[d],e),null!=b[d].cursor&&(e.node.style.cursor=b[d].cursor));c.put(b[d],e)}}null!=a.overlays&&
a.overlays.visit(function(f,g){g.destroy()});a.overlays=c};mxCellRenderer.prototype.initializeOverlay=function(a,b){b.init(a.view.getOverlayPane())};
mxCellRenderer.prototype.installCellOverlayListeners=function(a,b,c){var d=a.view.graph;mxEvent.addListener(c.node,"click",function(e){d.isEditing()&&d.stopEditing(!d.isInvokesStopCellEditing());b.fireEvent(new mxEventObject(mxEvent.CLICK,"event",e,"cell",a.cell))});mxEvent.addGestureListeners(c.node,function(e){mxEvent.consume(e)},function(e){d.fireMouseEvent(mxEvent.MOUSE_MOVE,new mxMouseEvent(e,a))});mxClient.IS_TOUCH&&mxEvent.addListener(c.node,"touchend",function(e){b.fireEvent(new mxEventObject(mxEvent.CLICK,
"event",e,"cell",a.cell))})};
mxCellRenderer.prototype.createControl=function(a){var b=a.view.graph,c=b.getFoldingImage(a);if(b.foldingEnabled&&null!=c){if(null==a.control){var d=new mxRectangle(0,0,c.width,c.height);a.control=new mxImageShape(d,c.src);a.control.preserveImageAspect=false;a.control.dialect=b.dialect;this.initControl(a,a.control,true,function(e){if(b.isEnabled()){var f=!b.isCellCollapsed(a.cell);b.foldCells(f,false,[a.cell]);mxEvent.consume(e)}})}}else null!=a.control&&(a.control.destroy(),a.control=null)};
mxCellRenderer.prototype.initControl=function(a,b,c,d){var e=a.view.graph;e.isHtmlLabel(a.cell)&&mxClient.NO_FO&&e.dialect==mxConstants.DIALECT_SVG?(b.dialect=mxConstants.DIALECT_PREFERHTML,b.init(e.container),b.node.style.zIndex=1):b.init(a.view.getOverlayPane());b=b.innerNode||b.node;d&&(e.isEnabled()&&(b.style.cursor="pointer"),mxEvent.addListener(b,"click",d));c&&mxEvent.addGestureListeners(b,function(f){e.fireMouseEvent(mxEvent.MOUSE_DOWN,new mxMouseEvent(f,a));mxEvent.consume(f)},function(f){e.fireMouseEvent(mxEvent.MOUSE_MOVE,
new mxMouseEvent(f,a))});return b};mxCellRenderer.prototype.isShapeEvent=function(){return true};mxCellRenderer.prototype.isLabelEvent=function(){return true};
mxCellRenderer.prototype.installListeners=function(a){var b=a.view.graph,c=function(f){var g=a;if(b.dialect!=mxConstants.DIALECT_SVG&&"IMG"==mxEvent.getSource(f).nodeName||mxClient.IS_TOUCH){g=mxEvent.getClientX(f);f=mxEvent.getClientY(f);f=mxUtils.convertPoint(b.container,g,f);g=b.view.getState(b.getCellAt(f.x,f.y))}return g},d=false;mxEvent.addListener(a.shape.node,"gesturestart",mxUtils.bind(this,function(f){b.lastTouchTime=0;d=true;mxEvent.consume(f)}));mxEvent.addGestureListeners(a.shape.node,
mxUtils.bind(this,function(f){this.isShapeEvent(a,f)&&!d?b.fireMouseEvent(mxEvent.MOUSE_DOWN,new mxMouseEvent(f,null!=a.shape&&mxEvent.getSource(f)==a.shape.content?null:a)):d&&mxEvent.consume(f)}),mxUtils.bind(this,function(f){this.isShapeEvent(a,f)&&!d?b.fireMouseEvent(mxEvent.MOUSE_MOVE,new mxMouseEvent(f,null!=a.shape&&mxEvent.getSource(f)==a.shape.content?null:c(f))):d&&mxEvent.consume(f)}),mxUtils.bind(this,function(f){this.isShapeEvent(a,f)&&!d?b.fireMouseEvent(mxEvent.MOUSE_UP,new mxMouseEvent(f,
null!=a.shape&&mxEvent.getSource(f)==a.shape.content?null:c(f))):d&&mxEvent.consume(f)}));var e=mxClient.IS_TOUCH?"gestureend":"dblclick";mxEvent.addListener(a.shape.node,e,mxUtils.bind(this,function(f){d=false;"gestureend"==e?(b.lastTouchTime=0,b.gestureEnabled&&(b.handleGesture(a,f),mxEvent.consume(f))):this.isShapeEvent(a,f)&&(b.dblClick(f,null!=a.shape&&mxEvent.getSource(f)==a.shape.content?null:a.cell),mxEvent.consume(f))}))};
mxCellRenderer.prototype.redrawLabel=function(a,b){var c=this.getLabelValue(a);if(null==a.text&&null!=c&&(mxUtils.isNode(c)||0<c.length))this.createLabel(a,c);else if(null!=a.text&&(null==c||0==c.length)){a.text.destroy();a.text=null}if(null!=a.text){var d=a.view.graph,e=d.isWrapping(a.cell);d=d.isLabelClipped(a.cell);var f=this.getLabelBounds(a);if(b||a.text.value!=c||a.text.isWrapping!=e||a.text.isClipping!=d||a.text.scale!=a.view.scale||!a.text.bounds.equals(f)){a.text.value=c;a.text.bounds=f;
a.text.scale=this.getTextScale(a);a.text.isWrapping=e;a.text.isClipping=d;a.text.redraw()}}};mxCellRenderer.prototype.getTextScale=function(a){return a.view.scale};
mxCellRenderer.prototype.getLabelBounds=function(a){var b=a.view.graph,c=a.view.scale,d=b.getModel().isEdge(a.cell),e=new mxRectangle(a.absoluteOffset.x,a.absoluteOffset.y);a.text.updateMargin();if(d){var f=a.text.getSpacing();e.x+=f.x*c;e.y+=f.y*c;b=b.getCellGeometry(a.cell);null!=b&&(e.width=Math.max(0,b.width*c),e.height=Math.max(0,b.height*c))}else{a.text.isPaintBoundsInverted()&&(f=e.x,e.x=e.y,e.y=f);e.x+=a.x;e.y+=a.y;e.width=Math.max(1,a.width);e.height=Math.max(1,a.height);b.isSwimlane(a.cell)&&
(b=b.getStartSize(a.cell),0<b.width?(f=Math.min(e.width,b.width*c),a.shape.flipH&&(e.x+=e.width-f),e.width=f):0<b.height&&(f=Math.min(e.height,b.height*c),a.shape.flipV&&(e.y+=e.height-f),e.height=f))}null!=a.shape&&(e=a.shape.getLabelBounds(e));d||this.rotateLabelBounds(a,e);return e};
mxCellRenderer.prototype.rotateLabelBounds=function(a,b){if(a.text.isPaintBoundsInverted()){var c=(a.width-a.height)/2;b.x+=c;b.y-=c;c=b.width;b.width=b.height;b.height=c}b.x-=a.text.margin.x*b.width;b.y-=a.text.margin.y*b.height;if("fill"!=a.style[mxConstants.STYLE_OVERFLOW]&&"width"!=a.style[mxConstants.STYLE_OVERFLOW]){c=a.view.scale;var d=a.text.getSpacing();b.x+=d.x*c;b.y+=d.y*c;b.width=Math.max(0,b.width-a.text.spacingLeft*c-a.text.spacingRight*c);b.height=Math.max(0,b.height-a.text.spacingTop*
c-a.text.spacingBottom*c)}var e=a.text.getTextRotation();if(0!=e&&null!=a&&a.view.graph.model.isVertex(a.cell)&&(c=a.getCenterX(),d=a.getCenterY(),b.x!=c||b.y!=d)){e*=Math.PI/180;pt=mxUtils.getRotatedPoint(new mxPoint(b.x,b.y),Math.cos(e),Math.sin(e),new mxPoint(c,d));b.x=pt.x;b.y=pt.y}};
mxCellRenderer.prototype.redrawCellOverlays=function(a,b){this.createCellOverlays(a);if(null!=a.overlays){var c=mxUtils.mod(mxUtils.getValue(a.style,mxConstants.STYLE_ROTATION,0),90),d=mxUtils.toRadians(c),e=Math.cos(d),f=Math.sin(d);a.overlays.visit(function(g,h){var k=h.overlay.getBounds(a);if(!a.view.graph.getModel().isEdge(a.cell)&&null!=a.shape&&0!=c){var l=k.getCenterX(),m=k.getCenterY();m=mxUtils.getRotatedPoint(new mxPoint(l,m),e,f,new mxPoint(a.getCenterX(),a.getCenterY()));l=m.x;m=m.y;k.x=
Math.round(l-k.width/2);k.y=Math.round(m-k.height/2)}if(b||null==h.bounds||h.scale!=a.view.scale||!h.bounds.equals(k)){h.bounds=k;h.scale=a.view.scale;h.redraw()}})}};
mxCellRenderer.prototype.redrawControl=function(a,b){if(null!=a.control){var c=this.getControlBounds(a),d=this.legacyControlPosition?mxUtils.getValue(a.style,mxConstants.STYLE_ROTATION,0):a.shape.getTextRotation(),e=a.view.scale;if(b||a.control.scale!=e||!a.control.bounds.equals(c)||a.control.rotation!=d){a.control.rotation=d;a.control.bounds=c;a.control.scale=e;a.control.redraw()}}};
mxCellRenderer.prototype.getControlBounds=function(a){if(null!=a.control){var b=a.control.scale,c=a.control.bounds.width/b;b=a.control.bounds.height/b;var d=a.view.scale,e=a.getCenterX(),f=a.getCenterY();if(!a.view.graph.getModel().isEdge(a.cell)&&(e=a.x+c*d,f=a.y+b*d,null!=a.shape)){var g=a.shape.getShapeRotation();if(this.legacyControlPosition)g=mxUtils.getValue(a.style,mxConstants.STYLE_ROTATION,0);else if(a.shape.isPaintBoundsInverted()){var h=(a.width-a.height)/2;e+=h;f-=h}0!=g&&(h=mxUtils.toRadians(g),
g=Math.cos(h),h=Math.sin(h),f=mxUtils.getRotatedPoint(new mxPoint(e,f),g,h,new mxPoint(a.getCenterX(),a.getCenterY())),e=f.x,f=f.y)}return a.view.graph.getModel().isEdge(a.cell),new mxRectangle(Math.round(e-c/2*d),Math.round(f-b/2*d),Math.round(c*d),Math.round(b*d))}return null};
mxCellRenderer.prototype.redraw=function(a,b,c){if(null!=a.shape){var d=false;a.view.graph.getModel().isEdge(a.cell);reconfigure=null!=b?b:false;this.createControl(a);if(a.orderChanged||a.invalidOrder)a.view.graph.ordered?this.order(a):this.orderEdge(a);if(a.orderChanged||!mxUtils.equalEntries(a.shape.style,a.style)){this.configureShape(a);b=true}delete a.invalidOrder;delete a.orderChanged;if(b||null==a.shape.bounds||a.shape.scale!=a.view.scale||!a.shape.bounds.equals(a)||!mxUtils.equalPoints(a.shape.points,
a.absolutePoints)){d=true;a.shape.points=null!=a.absolutePoints?a.absolutePoints.slice():null;a.shape.bounds=new mxRectangle(a.x,a.y,a.width,a.height);a.shape.scale=a.view.scale;null==c||c?a.shape.redraw():a.shape.updateBoundingBox()}if(null==c||c){this.redrawLabel(a,d);this.redrawCellOverlays(a,d);this.redrawControl(a,d)}}};
mxCellRenderer.prototype.destroy=function(a){null!=a.shape&&(null!=a.text&&(a.text.destroy(),a.text=null),null!=a.overlays&&(a.overlays.visit(function(b,c){c.destroy()}),a.overlays=null),null!=a.control&&(a.control.destroy(),a.control=null),a.shape.destroy(),a.shape=null)};
var mxEdgeStyle={EntityRelation:function(a,b,c,d,e){var f=a.view,g=f.graph;d=mxUtils.getValue(a.style,mxConstants.STYLE_SEGMENT,mxConstants.ENTITY_SEGMENT)*f.scale;var h=a.absolutePoints,k=h[0],l=h[h.length-1];h=false;if(null!=k){b=new mxCellState;b.x=k.x;b.y=k.y}else if(null!=b){var m=mxUtils.getPortConstraints(b,a,true,mxConstants.DIRECTION_MASK_NONE);m!=mxConstants.DIRECTION_MASK_NONE?h=m==mxConstants.DIRECTION_MASK_WEST:(k=g.getCellGeometry(b.cell),k.relative?h=0.5>=k.x:null!=c&&(h=c.x+c.width<
b.x))}else return;k=true;null!=l?(c=new mxCellState,c.x=l.x,c.y=l.y):null!=c&&(m=mxUtils.getPortConstraints(c,a,false,mxConstants.DIRECTION_MASK_NONE),m!=mxConstants.DIRECTION_MASK_NONE?k=m==mxConstants.DIRECTION_MASK_WEST:(a=g.getCellGeometry(c.cell),a.relative?k=0.5>=a.x:null!=b&&(k=b.x+b.width<c.x)));null!=b&&null!=c&&(a=h?b.x:b.x+b.width,b=f.getRoutingCenterY(b),g=k?c.x:c.x+c.width,c=f.getRoutingCenterY(c),f=new mxPoint(a+(h?-d:d),b),l=new mxPoint(g+(k?-d:d),c),h==k?(d=h?Math.min(a,g)-d:Math.max(a,
g)+d,e.push(new mxPoint(d,b)),e.push(new mxPoint(d,c))):(f.x<l.x==h?(d=b+(c-b)/2,e.push(f),e.push(new mxPoint(f.x,d)),e.push(new mxPoint(l.x,d))):e.push(f),e.push(l)))},Loop:function(a,b,c,d,e){if(null!=b){c=a.view;var f=c.graph;d=null!=d&&0<d.length?d[0]:null;null!=d&&(d=c.transformControlPoint(a,d),mxUtils.contains(b,d.x,d.y)&&(d=null));var g=0,h=0,k=0,l=0;f=mxUtils.getValue(a.style,mxConstants.STYLE_SEGMENT,f.gridSize)*c.scale;a=mxUtils.getValue(a.style,mxConstants.STYLE_DIRECTION,mxConstants.DIRECTION_WEST);
a==mxConstants.DIRECTION_NORTH||a==mxConstants.DIRECTION_SOUTH?(g=c.getRoutingCenterX(b),h=f):(k=c.getRoutingCenterY(b),l=f);null==d||d.x<b.x||d.x>b.x+b.width?null!=d?(g=d.x,l=Math.max(Math.abs(k-d.y),l)):a==mxConstants.DIRECTION_NORTH?k=b.y-2*h:a==mxConstants.DIRECTION_SOUTH?k=b.y+b.height+2*h:g=a==mxConstants.DIRECTION_EAST?b.x-2*l:b.x+b.width+2*l:null!=d&&(g=c.getRoutingCenterX(b),h=Math.max(Math.abs(g-d.x),l),k=d.y,l=0);e.push(new mxPoint(g-h,k-l));e.push(new mxPoint(g+h,k+l))}},ElbowConnector:function(a,
b,c,d,e){var f=null!=d&&0<d.length?d[0]:null,g=false,h=false;if(null!=b&&null!=c)if(null!=f){var k=Math.min(b.x,c.x),l=Math.max(b.x+b.width,c.x+c.width);h=Math.min(b.y,c.y);var m=Math.max(b.y+b.height,c.y+c.height);f=a.view.transformControlPoint(a,f);g=f.y<h||f.y>m;h=f.x<k||f.x>l}else{k=Math.max(b.x,c.x);l=Math.min(b.x+b.width,c.x+c.width);(g=k==l)||(h=Math.max(b.y,c.y),m=Math.min(b.y+b.height,c.y+c.height),h=h==m)}!h&&(g||a.style[mxConstants.STYLE_ELBOW]==mxConstants.ELBOW_VERTICAL)?mxEdgeStyle.TopToBottom(a,
b,c,d,e):mxEdgeStyle.SideToSide(a,b,c,d,e)},SideToSide:function(a,b,c,d,e){var f=a.view;d=null!=d&&0<d.length?d[0]:null;var g=a.absolutePoints,h=g[0];g=g[g.length-1];null!=d&&(d=f.transformControlPoint(a,d));null!=h&&(b=new mxCellState,b.x=h.x,b.y=h.y);null!=g&&(c=new mxCellState,c.x=g.x,c.y=g.y);null!=b&&null!=c&&(a=Math.max(b.x,c.x),h=Math.min(b.x+b.width,c.x+c.width),a=null!=d?d.x:h+(a-h)/2,f.getRoutingCenterY(b),f.getRoutingCenterY(c),null!=d&&(d.y>=b.y&&d.y<=b.y+b.height&&(h=d.y),d.y>=c.y&&d.y<=
c.y+c.height&&(f=d.y)),!mxUtils.contains(c,a,h)&&!mxUtils.contains(b,a,h)&&e.push(new mxPoint(a,h)),!mxUtils.contains(c,a,f)&&!mxUtils.contains(b,a,f)&&e.push(new mxPoint(a,f)),1==e.length&&(null!=d?!mxUtils.contains(c,a,d.y)&&!mxUtils.contains(b,a,d.y)&&e.push(new mxPoint(a,d.y)):(f=Math.max(b.y,c.y),b=Math.min(b.y+b.height,c.y+c.height),e.push(new mxPoint(a,f+(b-f)/2)))))},TopToBottom:function(a,b,c,d,e){var f=a.view;d=null!=d&&0<d.length?d[0]:null;var g=a.absolutePoints,h=g[0];g=g[g.length-1];
null!=d&&(d=f.transformControlPoint(a,d));null!=h&&(b=new mxCellState,b.x=h.x,b.y=h.y);null!=g&&(c=new mxCellState,c.x=g.x,c.y=g.y);null!=b&&null!=c&&(h=Math.max(b.y,c.y),g=Math.min(b.y+b.height,c.y+c.height),f.getRoutingCenterX(b),null!=d&&d.x>=b.x&&d.x<=b.x+b.width&&(a=d.x),h=null!=d?d.y:g+(h-g)/2,!mxUtils.contains(c,a,h)&&!mxUtils.contains(b,a,h)&&e.push(new mxPoint(a,h)),a=null!=d&&d.x>=c.x&&d.x<=c.x+c.width?d.x:f.getRoutingCenterX(c),!mxUtils.contains(c,a,h)&&!mxUtils.contains(b,a,h)&&e.push(new mxPoint(a,
h)),1==e.length&&(null!=d&&1==e.length?!mxUtils.contains(c,d.x,h)&&!mxUtils.contains(b,d.x,h)&&e.push(new mxPoint(d.x,h)):(f=Math.max(b.x,c.x),b=Math.min(b.x+b.width,c.x+c.width),e.push(new mxPoint(f+(b-f)/2,h)))))},SegmentConnector:function(a,b,c,d,e){var f=a.absolutePoints,g=true,h=null,k=f[0];null==k&&null!=b?k=new mxPoint(a.view.getRoutingCenterX(b),a.view.getRoutingCenterY(b)):null!=k&&(k=k.clone());var l=f.length-1;if(null!=d&&0<d.length){h=a.view.transformControlPoint(a,d[0]);var m=b,p=f[0],
o=false,n=false;o=h;for(var s=d.length,t=0;2>t;t++){var q=null!=p&&p.x==o.x,r=null!=p&&p.y==o.y,u=null!=m&&o.y>=m.y&&o.y<=m.y+m.height;m=null!=m&&o.x>=m.x&&o.x<=m.x+m.width;o=r||null==p&&u;n=q||null==p&&m;if(null!=p&&!r&&!q&&(u||m)){g=u?false:true;break}if(n||o){g=o;1==t&&(g=0==d.length%2?o:n);break}m=c;p=f[l];o=a.view.transformControlPoint(a,d[s-1])}g&&(null!=f[0]&&f[0].y!=h.y||null==f[0]&&null!=b&&(h.y<b.y||h.y>b.y+b.height))?e.push(new mxPoint(k.x,h.y)):!g&&(null!=f[0]&&f[0].x!=h.x||null==f[0]&&
null!=b&&(h.x<b.x||h.x>b.x+b.width))&&e.push(new mxPoint(h.x,k.y));g?k.y=h.y:k.x=h.x;for(t=0;t<d.length;t++){g=!g;h=a.view.transformControlPoint(a,d[t]);g?k.y=h.y:k.x=h.x;e.push(k.clone())}}else{h=k;g=true}k=f[l];null==k&&null!=c&&(k=new mxPoint(a.view.getRoutingCenterX(c),a.view.getRoutingCenterY(c)));g&&(null!=f[l]&&f[l].y!=h.y||null==f[l]&&null!=c&&(h.y<c.y||h.y>c.y+c.height))?e.push(new mxPoint(k.x,h.y)):!g&&(null!=f[l]&&f[l].x!=h.x||null==f[l]&&null!=c&&(h.x<c.x||h.x>c.x+c.width))&&e.push(new mxPoint(h.x,
k.y));if(null==f[0]&&null!=b)for(;1<e.length&&mxUtils.contains(b,e[1].x,e[1].y);)e=e.splice(1,1);if(null==f[l]&&null!=c)for(;1<e.length&&mxUtils.contains(c,e[e.length-1].x,e[e.length-1].y);)e=e.splice(e.length-1,1)},orthBuffer:10,dirVectors:[[-1,0],[0,-1],[1,0],[0,1],[-1,0],[0,-1],[1,0]],wayPoints1:[[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0]],routePatterns:[[[513,2308,2081,2562],[513,1090,514,2184,2114,2561],[513,1090,514,2564,2184,2562],[513,2308,2561,1090,514,2568,2308]],
[[514,1057,513,2308,2081,2562],[514,2184,2114,2561],[514,2184,2562,1057,513,2564,2184],[514,1057,513,2568,2308,2561]],[[1090,514,1057,513,2308,2081,2562],[2114,2561],[1090,2562,1057,513,2564,2184],[1090,514,1057,513,2308,2561,2568]],[[2081,2562],[1057,513,1090,514,2184,2114,2561],[1057,513,1090,514,2184,2562,2564],[1057,2561,1090,514,2568,2308]]],inlineRoutePatterns:[[null,[2114,2568],null,null],[null,[514,2081,2114,2568],null,null],[null,[2114,2561],null,null],[[2081,2562],[1057,2114,2568],[2184,
2562],null]],vertexSeperations:[],limits:[[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0]],LEFT_MASK:32,TOP_MASK:64,RIGHT_MASK:128,BOTTOM_MASK:256,LEFT:1,TOP:2,RIGHT:4,BOTTOM:8,SIDE_MASK:480,CENTER_MASK:512,SOURCE_MASK:1024,TARGET_MASK:2048,VERTEX_MASK:3072,OrthConnector:function(a,b,c,d,e){var f=a.view.graph,g=null==b?false:f.getModel().isEdge(b.cell);f=null==c?false:f.getModel().isEdge(c.cell);if(null!=d&&0<d.length||g||f)mxEdgeStyle.SegmentConnector(a,b,c,d,e);else{d=a.absolutePoints;var h=d[0],k=d[d.length-
1];d=null!=b?b.x:h.x;g=null!=b?b.y:h.y;var l=null!=b?b.width:1,m=null!=b?b.height:1,p=null!=c?c.x:k.x,o=null!=c?c.y:k.y,n=null!=c?c.width:1,s=null!=c?c.height:1;f=a.view.scale*mxEdgeStyle.orthBuffer;var t=[mxConstants.DIRECTION_MASK_ALL,mxConstants.DIRECTION_MASK_ALL];null!=b&&(t[0]=mxUtils.getPortConstraints(b,a,true,mxConstants.DIRECTION_MASK_ALL));null!=c&&(t[1]=mxUtils.getPortConstraints(c,a,false,mxConstants.DIRECTION_MASK_ALL));a=[0,0];d=[[d,g,l,m],[p,o,n,s]];for(l=0;2>l;l++){mxEdgeStyle.limits[l][1]=
d[l][0]-f;mxEdgeStyle.limits[l][2]=d[l][1]-f;mxEdgeStyle.limits[l][4]=d[l][0]+d[l][2]+f;mxEdgeStyle.limits[l][8]=d[l][1]+d[l][3]+f}l=d[0][0]+d[0][2]/2-(d[1][0]+d[1][2]/2);m=d[0][1]+d[0][3]/2-(d[1][1]+d[1][3]/2);g=0;0>l?g=0>m?2:1:0>=m&&(g=3,0==l&&(g=2));m=null;null!=b&&(m=h);b=[[0.5,0.5],[0.5,0.5]];for(l=0;2>l;l++){null!=m&&(b[l][0]=(m.x-d[l][0])/d[l][2],0.01>b[l][0]?a[l]=mxConstants.DIRECTION_MASK_WEST:0.99<b[l][0]&&(a[l]=mxConstants.DIRECTION_MASK_EAST),b[l][1]=(m.y-d[l][1])/d[l][3],0.01>b[l][1]?
a[l]=mxConstants.DIRECTION_MASK_NORTH:0.99<b[l][1]&&(a[l]=mxConstants.DIRECTION_MASK_SOUTH));m=null;null!=c&&(m=k)}l=d[0][1]-(d[1][1]+d[1][3]);m=d[0][0]-(d[1][0]+d[1][2]);p=d[1][1]-(d[0][1]+d[0][3]);o=d[1][0]-(d[0][0]+d[0][2]);mxEdgeStyle.vertexSeperations[1]=Math.max(m-2*f,0);mxEdgeStyle.vertexSeperations[2]=Math.max(l-2*f,0);mxEdgeStyle.vertexSeperations[4]=Math.max(p-2*f,0);mxEdgeStyle.vertexSeperations[3]=Math.max(o-2*f,0);c=[];h=[];k=[];h[0]=m>=o?mxConstants.DIRECTION_MASK_WEST:mxConstants.DIRECTION_MASK_EAST;
k[0]=l>=p?mxConstants.DIRECTION_MASK_NORTH:mxConstants.DIRECTION_MASK_SOUTH;h[1]=mxUtils.reversePortConstraints(h[0]);k[1]=mxUtils.reversePortConstraints(k[0]);m=m>=o?m:o;p=l>=p?l:p;o=[[0,0],[0,0]];n=false;for(l=0;2>l;l++)0==a[l]&&(0==(h[l]&t[l])&&(h[l]=mxUtils.reversePortConstraints(h[l])),0==(k[l]&t[l])&&(k[l]=mxUtils.reversePortConstraints(k[l])),o[l][0]=k[l],o[l][1]=h[l]);p>2*f&&m>2*f&&(0<(h[0]&t[0])&&0<(k[1]&t[1])?(o[0][0]=h[0],o[0][1]=k[0],o[1][0]=k[1],o[1][1]=h[1],n=true):0<(k[0]&t[0])&&0<
(h[1]&t[1])&&(o[0][0]=k[0],o[0][1]=h[0],o[1][0]=h[1],o[1][1]=k[1],n=true));p>2*f&&!n&&(o[0][0]=k[0],o[0][1]=h[0],o[1][0]=k[1],o[1][1]=h[1],n=true);m>2*f&&!n&&(o[0][0]=h[0],o[0][1]=k[0],o[1][0]=h[1],o[1][1]=k[1]);for(l=0;2>l;l++)if(0==a[l]&&(0==(o[l][0]&t[l])&&(o[l][0]=o[l][1]),c[l]=o[l][0]&t[l],c[l]|=(o[l][1]&t[l])<<8,c[l]|=(o[1-l][l]&t[l])<<16,c[l]|=(o[1-l][1-l]&t[l])<<24,0==(c[l]&15)&&(c[l]<<=8),0==(c[l]&3840)&&(c[l]=c[l]&15|c[l]>>8),0==(c[l]&983040)&&(c[l]=c[l]&65535|(c[l]&251658240)>>8),a[l]=
c[l]&15,t[l]==mxConstants.DIRECTION_MASK_WEST||t[l]==mxConstants.DIRECTION_MASK_NORTH||t[l]==mxConstants.DIRECTION_MASK_EAST||t[l]==mxConstants.DIRECTION_MASK_SOUTH))a[l]=t[l];l=a[0]==mxConstants.DIRECTION_MASK_EAST?3:a[0];t=a[1]==mxConstants.DIRECTION_MASK_EAST?3:a[1];l-=g;t-=g;1>l&&(l+=4);1>t&&(t+=4);t=mxEdgeStyle.routePatterns[l-1][t-1];mxEdgeStyle.wayPoints1[0][0]=d[0][0];mxEdgeStyle.wayPoints1[0][1]=d[0][1];switch(a[0]){case mxConstants.DIRECTION_MASK_WEST:mxEdgeStyle.wayPoints1[0][0]-=f;mxEdgeStyle.wayPoints1[0][1]+=
b[0][1]*d[0][3];break;case mxConstants.DIRECTION_MASK_SOUTH:mxEdgeStyle.wayPoints1[0][0]+=b[0][0]*d[0][2];mxEdgeStyle.wayPoints1[0][1]+=d[0][3]+f;break;case mxConstants.DIRECTION_MASK_EAST:mxEdgeStyle.wayPoints1[0][0]+=d[0][2]+f;mxEdgeStyle.wayPoints1[0][1]+=b[0][1]*d[0][3];break;case mxConstants.DIRECTION_MASK_NORTH:mxEdgeStyle.wayPoints1[0][0]+=b[0][0]*d[0][2];mxEdgeStyle.wayPoints1[0][1]-=f}f=0;h=c=0<(a[0]&(mxConstants.DIRECTION_MASK_EAST|mxConstants.DIRECTION_MASK_WEST))?0:1;for(l=0;l<t.length;l++){k=
t[l]&15;s=k==mxConstants.DIRECTION_MASK_EAST?3:k;s+=g;4<s&&(s-=4);m=mxEdgeStyle.dirVectors[s-1];k=0<s%2?0:1;k!=c&&(f++,mxEdgeStyle.wayPoints1[f][0]=mxEdgeStyle.wayPoints1[f-1][0],mxEdgeStyle.wayPoints1[f][1]=mxEdgeStyle.wayPoints1[f-1][1]);var q=0<(t[l]&mxEdgeStyle.TARGET_MASK);n=0<(t[l]&mxEdgeStyle.SOURCE_MASK);p=(t[l]&mxEdgeStyle.SIDE_MASK)>>5;p<<=g;15<p&&(p>>=4);o=0<(t[l]&mxEdgeStyle.CENTER_MASK);(n||q)&&9>p?(n=n?0:1,s=o&&0==k?d[n][0]+b[n][0]*d[n][2]:o?d[n][1]+b[n][1]*d[n][3]:mxEdgeStyle.limits[n][p],
0==k?(p=(s-mxEdgeStyle.wayPoints1[f][0])*m[0],0<p&&(mxEdgeStyle.wayPoints1[f][0]+=m[0]*p)):(p=(s-mxEdgeStyle.wayPoints1[f][1])*m[1],0<p&&(mxEdgeStyle.wayPoints1[f][1]+=m[1]*p))):o&&(mxEdgeStyle.wayPoints1[f][0]+=m[0]*Math.abs(mxEdgeStyle.vertexSeperations[s]/2),mxEdgeStyle.wayPoints1[f][1]+=m[1]*Math.abs(mxEdgeStyle.vertexSeperations[s]/2));0<f&&mxEdgeStyle.wayPoints1[f][k]==mxEdgeStyle.wayPoints1[f-1][k]?f--:c=k}for(l=0;l<=f&&!(l==f&&((0<(a[1]&(mxConstants.DIRECTION_MASK_EAST|mxConstants.DIRECTION_MASK_WEST))?
0:1)==h?0:1)!=(f+1)%2);l++)e.push(new mxPoint(mxEdgeStyle.wayPoints1[l][0],mxEdgeStyle.wayPoints1[l][1]))}},getRoutePattern:function(a,b,c,d){var e=a[0]==mxConstants.DIRECTION_MASK_EAST?3:a[0];a=a[1]==mxConstants.DIRECTION_MASK_EAST?3:a[1];e-=b;a-=b;1>e&&(e+=4);1>a&&(a+=4);b=routePatterns[e-1][a-1];if(0==c||0==d)null!=inlineRoutePatterns[e-1][a-1]&&(b=inlineRoutePatterns[e-1][a-1]);return b}},mxStyleRegistry={values:[],putValue:function(a,b){mxStyleRegistry.values[a]=b},getValue:function(a){return mxStyleRegistry.values[a]},
getName:function(a){for(var b in mxStyleRegistry.values)if(mxStyleRegistry.values[b]==a)return b;return null}};mxStyleRegistry.putValue(mxConstants.EDGESTYLE_ELBOW,mxEdgeStyle.ElbowConnector);mxStyleRegistry.putValue(mxConstants.EDGESTYLE_ENTITY_RELATION,mxEdgeStyle.EntityRelation);mxStyleRegistry.putValue(mxConstants.EDGESTYLE_LOOP,mxEdgeStyle.Loop);mxStyleRegistry.putValue(mxConstants.EDGESTYLE_SIDETOSIDE,mxEdgeStyle.SideToSide);mxStyleRegistry.putValue(mxConstants.EDGESTYLE_TOPTOBOTTOM,mxEdgeStyle.TopToBottom);
mxStyleRegistry.putValue(mxConstants.EDGESTYLE_ORTHOGONAL,mxEdgeStyle.OrthConnector);mxStyleRegistry.putValue(mxConstants.EDGESTYLE_SEGMENT,mxEdgeStyle.SegmentConnector);mxStyleRegistry.putValue(mxConstants.PERIMETER_ELLIPSE,mxPerimeter.EllipsePerimeter);mxStyleRegistry.putValue(mxConstants.PERIMETER_RECTANGLE,mxPerimeter.RectanglePerimeter);mxStyleRegistry.putValue(mxConstants.PERIMETER_RHOMBUS,mxPerimeter.RhombusPerimeter);mxStyleRegistry.putValue(mxConstants.PERIMETER_TRIANGLE,mxPerimeter.TrianglePerimeter);
function mxGraphView(a){this.graph=a;this.translate=new mxPoint;this.graphBounds=new mxRectangle;this.states=new mxDictionary}mxGraphView.prototype=new mxEventSource;mxGraphView.prototype.constructor=mxGraphView;mxGraphView.prototype.EMPTY_POINT=new mxPoint;mxGraphView.prototype.doneResource="none"!=mxClient.language?"done":"";mxGraphView.prototype.updatingDocumentResource="none"!=mxClient.language?"updatingDocument":"";mxGraphView.prototype.allowEval=false;
mxGraphView.prototype.captureDocumentGesture=true;mxGraphView.prototype.optimizeVmlReflows=true;mxGraphView.prototype.rendering=true;mxGraphView.prototype.graph=null;mxGraphView.prototype.currentRoot=null;mxGraphView.prototype.graphBounds=null;mxGraphView.prototype.scale=1;mxGraphView.prototype.translate=null;mxGraphView.prototype.updateStyle=false;mxGraphView.prototype.getGraphBounds=function(){return this.graphBounds};mxGraphView.prototype.setGraphBounds=function(a){this.graphBounds=a};
mxGraphView.prototype.getBounds=function(a){var b=null;if(null!=a&&0<a.length)for(var c=this.graph.getModel(),d=0;d<a.length;d++)if(c.isVertex(a[d])||c.isEdge(a[d])){var e=this.getState(a[d]);null!=e&&(null==b?b=new mxRectangle(e.x,e.y,e.width,e.height):b.add(e))}return b};mxGraphView.prototype.setCurrentRoot=function(a){if(this.currentRoot!=a){var b=new mxCurrentRootChange(this,a);b.execute();var c=new mxUndoableEdit(this,false);c.add(b);this.fireEvent(new mxEventObject(mxEvent.UNDO,"edit",c));this.graph.sizeDidChange()}return a};
mxGraphView.prototype.scaleAndTranslate=function(a,b,c){var d=this.scale,e=new mxPoint(this.translate.x,this.translate.y);if(this.scale!=a||this.translate.x!=b||this.translate.y!=c){this.scale=a;this.translate.x=b;this.translate.y=c;this.isEventsEnabled()&&(this.revalidate(),this.graph.sizeDidChange())}this.fireEvent(new mxEventObject(mxEvent.SCALE_AND_TRANSLATE,"scale",a,"previousScale",d,"translate",this.translate,"previousTranslate",e))};mxGraphView.prototype.getScale=function(){return this.scale};
mxGraphView.prototype.setScale=function(a){var b=this.scale;this.scale!=a&&(this.scale=a,this.isEventsEnabled()&&(this.revalidate(),this.graph.sizeDidChange()));this.fireEvent(new mxEventObject(mxEvent.SCALE,"scale",a,"previousScale",b))};mxGraphView.prototype.getTranslate=function(){return this.translate};
mxGraphView.prototype.setTranslate=function(a,b){var c=new mxPoint(this.translate.x,this.translate.y);if(this.translate.x!=a||this.translate.y!=b){this.translate.x=a;this.translate.y=b;this.isEventsEnabled()&&(this.revalidate(),this.graph.sizeDidChange())}this.fireEvent(new mxEventObject(mxEvent.TRANSLATE,"translate",this.translate,"previousTranslate",c))};mxGraphView.prototype.refresh=function(){null!=this.currentRoot&&this.clear();this.revalidate()};
mxGraphView.prototype.revalidate=function(){this.invalidate();this.validate()};mxGraphView.prototype.clear=function(a,b,c){var d=this.graph.getModel();a=a||d.getRoot();b=null!=b?b:false;c=null!=c?c:true;this.removeState(a);if(c&&(b||a!=this.currentRoot)){c=d.getChildCount(a);for(var e=0;e<c;e++)this.clear(d.getChildAt(a,e),b)}else this.invalidate(a)};
mxGraphView.prototype.invalidate=function(a,b,c,d){var e=this.graph.getModel();a=a||e.getRoot();b=null!=b?b:true;c=null!=c?c:true;d=null!=d?d:false;var f=this.getState(a);null!=f&&(f.invalid=true,d&&(f.orderChanged=true));if(b){var g=e.getChildCount(a);for(f=0;f<g;f++)this.invalidate(e.getChildAt(a,f),b,c,d)}if(c){d=e.getEdgeCount(a);for(f=0;f<d;f++)this.invalidate(e.getEdgeAt(a,f),b,c)}};
mxGraphView.prototype.validate=function(a){var b=mxLog.enter("mxGraphView.validate");window.status=mxResources.get(this.updatingDocumentResource)||this.updatingDocumentResource;var c=null;if(this.optimizeVmlReflows&&null!=this.canvas&&null==this.textDiv&&(8==document.documentMode||mxClient.IS_QUIRKS)){c=this.canvas.style.display;this.canvas.style.display="none";var d=document.createElement("div");d.style.position="absolute";d.style.whiteSpace="nowrap";d.style.visibility="hidden";d.style.display=mxClient.IS_QUIRKS?
"inline":"inline-block";d.style.zoom="1";document.body.appendChild(d);this.textDiv=d}a=a||(null!=this.currentRoot?this.currentRoot:this.graph.getModel().getRoot());this.validateBounds(null,a);a=this.validatePoints(null,a);null==a&&(a=new mxRectangle);this.setGraphBounds(a);this.validateBackground();null!=c&&(this.canvas.style.display=c,document.body.removeChild(this.textDiv),this.textDiv=null);window.status=mxResources.get(this.doneResource)||this.doneResource;mxLog.leave("mxGraphView.validate",b)};
mxGraphView.prototype.createBackgroundPageShape=function(a){return new mxRectangleShape(a,"white","black")};
mxGraphView.prototype.validateBackground=function(){var a=this.graph.getBackgroundImage();if(null!=a){if(null==this.backgroundImage||this.backgroundImage.image!=a.src){null!=this.backgroundImage&&this.backgroundImage.destroy();var b=new mxRectangle(0,0,1,1);this.backgroundImage=new mxImageShape(b,a.src);this.backgroundImage.dialect=this.graph.dialect;this.backgroundImage.init(this.backgroundPane);this.backgroundImage.redraw()}this.redrawBackgroundImage(this.backgroundImage,a)}else null!=this.backgroundImage&&
(this.backgroundImage.destroy(),this.backgroundImage=null);this.graph.pageVisible?(b=this.getBackgroundPageBounds(),null==this.backgroundPageShape?(this.backgroundPageShape=this.createBackgroundPageShape(b),this.backgroundPageShape.scale=this.scale,this.backgroundPageShape.isShadow=true,this.backgroundPageShape.dialect=this.graph.dialect,this.backgroundPageShape.init(this.backgroundPane),this.backgroundPageShape.redraw(),mxEvent.addListener(this.backgroundPageShape.node,"dblclick",mxUtils.bind(this,
function(c){this.graph.dblClick(c)})),mxEvent.addGestureListeners(this.backgroundPageShape.node,mxUtils.bind(this,function(c){this.graph.fireMouseEvent(mxEvent.MOUSE_DOWN,new mxMouseEvent(c))}),mxUtils.bind(this,function(c){null!=this.graph.tooltipHandler&&this.graph.tooltipHandler.isHideOnHover()&&this.graph.tooltipHandler.hide();this.graph.isMouseDown&&!mxEvent.isConsumed(c)&&this.graph.fireMouseEvent(mxEvent.MOUSE_MOVE,new mxMouseEvent(c))}),mxUtils.bind(this,function(c){this.graph.fireMouseEvent(mxEvent.MOUSE_UP,
new mxMouseEvent(c))}))):(this.backgroundPageShape.scale=this.scale,this.backgroundPageShape.bounds=b,this.backgroundPageShape.redraw())):null!=this.backgroundPageShape&&(this.backgroundPageShape.destroy(),this.backgroundPageShape=null)};mxGraphView.prototype.getBackgroundPageBounds=function(){var a=this.graph.pageFormat,b=this.scale*this.graph.pageScale;return new mxRectangle(this.scale*this.translate.x,this.scale*this.translate.y,a.width*b,a.height*b)};
mxGraphView.prototype.redrawBackgroundImage=function(a,b){a.scale=this.scale;a.bounds.x=this.scale*this.translate.x;a.bounds.y=this.scale*this.translate.y;a.bounds.width=this.scale*b.width;a.bounds.height=this.scale*b.height;a.redraw()};
mxGraphView.prototype.validateBounds=function(a,b){var c=this.graph.getModel(),d=this.getState(b,true);if(null!=d&&d.invalid){if(this.graph.isCellVisible(b)){if(b!=this.currentRoot&&null!=a){d.absoluteOffset.x=0;d.absoluteOffset.y=0;d.origin.x=a.origin.x;d.origin.y=a.origin.y;var e=this.graph.getCellGeometry(b);if(null!=e){if(!c.isEdge(b)){var f=e.offset||this.EMPTY_POINT;e.relative?(d.origin.x+=e.x*a.width/this.scale+f.x,d.origin.y+=e.y*a.height/this.scale+f.y):(d.absoluteOffset.x=this.scale*f.x,
d.absoluteOffset.y=this.scale*f.y,d.origin.x+=e.x,d.origin.y+=e.y)}d.x=this.scale*(this.translate.x+d.origin.x);d.y=this.scale*(this.translate.y+d.origin.y);d.width=this.scale*e.width;d.height=this.scale*e.height;if(c.isVertex(b)){if(e.relative&&(f=mxUtils.toRadians(a.style[mxConstants.STYLE_ROTATION]||"0"),0!=f)){e=Math.cos(f);f=Math.sin(f);var g=new mxPoint(d.getCenterX(),d.getCenterY()),h=new mxPoint(a.getCenterX(),a.getCenterY());e=mxUtils.getRotatedPoint(g,e,f,h);d.x=e.x-d.width/2;d.y=e.y-d.height/
2}this.updateVertexLabelOffset(d)}}}}else this.removeState(b);f=this.graph.getChildOffsetForCell(b);null!=f&&(d.origin.x+=f.x,d.origin.y+=f.y)}if(null!=d&&(!this.graph.isCellCollapsed(b)||b==this.currentRoot)){e=c.getChildCount(b);for(f=0;f<e;f++){g=c.getChildAt(b,f);this.validateBounds(d,g)}}};
mxGraphView.prototype.updateVertexLabelOffset=function(a){var b=mxUtils.getValue(a.style,mxConstants.STYLE_LABEL_POSITION,mxConstants.ALIGN_CENTER);b==mxConstants.ALIGN_LEFT?a.absoluteOffset.x-=a.width:b==mxConstants.ALIGN_RIGHT&&(a.absoluteOffset.x+=a.width);b=mxUtils.getValue(a.style,mxConstants.STYLE_VERTICAL_LABEL_POSITION,mxConstants.ALIGN_MIDDLE);b==mxConstants.ALIGN_TOP?a.absoluteOffset.y-=a.height:b==mxConstants.ALIGN_BOTTOM&&(a.absoluteOffset.y+=a.height)};
mxGraphView.prototype.validatePoints=function(a,b){var c=this.graph.getModel(),d=this.getState(b),e=null;if(null!=d){if(d.invalid){var f=this.graph.getCellGeometry(b);if(null!=f&&c.isEdge(b)){var g=this.getState(this.getVisibleTerminal(b,true));d.setVisibleTerminalState(g,true);if(null!=g&&c.isEdge(g.cell)&&!c.isAncestor(g.cell,b)){var h=this.getState(c.getParent(g.cell));this.validatePoints(h,g.cell)}var k=this.getState(this.getVisibleTerminal(b,false));d.setVisibleTerminalState(k,false);null!=k&&
c.isEdge(k.cell)&&!c.isAncestor(k.cell,b)&&(h=this.getState(c.getParent(k.cell)),this.validatePoints(h,k.cell));this.updateFixedTerminalPoints(d,g,k);this.updatePoints(d,f.points,g,k);this.updateFloatingTerminalPoints(d,g,k);this.updateEdgeBounds(d);this.updateEdgeLabelOffset(d)}else null!=f&&f.relative&&null!=a&&c.isEdge(a.cell)&&(f=this.getPoint(a,f),null!=f&&(d.x=f.x,d.y=f.y,f.x=f.x/this.scale-this.translate.x,f.y=f.y/this.scale-this.translate.y,d.origin=f,this.childMoved(a,d)));d.invalid=false;
b!=this.currentRoot&&this.graph.cellRenderer.redraw(d,false,this.isRendering())}if(c.isEdge(b)||c.isVertex(b)){null!=d.shape&&null!=d.shape.boundingBox&&(e=d.shape.boundingBox.clone());null!=d.text&&!this.graph.isLabelClipped(d.cell)&&null!=d.text.boundingBox&&(null!=e?e.add(d.text.boundingBox):e=d.text.boundingBox.clone())}}if(null!=d&&(!this.graph.isCellCollapsed(b)||b==this.currentRoot)){f=c.getChildCount(b);for(g=0;g<f;g++){h=c.getChildAt(b,g);h=this.validatePoints(d,h);null!=h&&(null==e?e=h:
e.add(h))}}return e};mxGraphView.prototype.childMoved=function(a,b){var c=b.cell;if(!this.graph.isCellCollapsed(c)||c==this.currentRoot)for(var d=this.graph.getModel(),e=d.getChildCount(c),f=0;f<e;f++)this.validateBounds(b,d.getChildAt(c,f))};mxGraphView.prototype.updateFixedTerminalPoints=function(a,b,c){this.updateFixedTerminalPoint(a,b,true,this.graph.getConnectionConstraint(a,b,true));this.updateFixedTerminalPoint(a,c,false,this.graph.getConnectionConstraint(a,c,false))};
mxGraphView.prototype.updateFixedTerminalPoint=function(a,b,c,d){var e=null;null!=d&&(e=this.graph.getConnectionPoint(b,d));if(null==e&&null==b){b=this.scale;d=this.translate;var f=a.origin;e=this.graph.getCellGeometry(a.cell).getTerminalPoint(c);null!=e&&(e=new mxPoint(b*(d.x+e.x+f.x),b*(d.y+e.y+f.y)))}a.setAbsoluteTerminalPoint(e,c)};
mxGraphView.prototype.updatePoints=function(a,b,c,d){if(null!=a){var e=[];e.push(a.absolutePoints[0]);var f=this.getEdgeStyle(a,b,c,d);if(null!=f){c=this.getTerminalPort(a,c,true);d=this.getTerminalPort(a,d,false);f(a,c,d,b,e)}else if(null!=b)for(f=0;f<b.length;f++)null!=b[f]&&(d=mxUtils.clone(b[f]),e.push(this.transformControlPoint(a,d)));b=a.absolutePoints;e.push(b[b.length-1]);a.absolutePoints=e}};
mxGraphView.prototype.transformControlPoint=function(a,b){var c=a.origin;return new mxPoint(this.scale*(b.x+this.translate.x+c.x),this.scale*(b.y+this.translate.y+c.y))};
mxGraphView.prototype.getEdgeStyle=function(a,b,c,d){a=null!=c&&c==d?mxUtils.getValue(a.style,mxConstants.STYLE_LOOP,this.graph.defaultLoopStyle):!mxUtils.getValue(a.style,mxConstants.STYLE_NOEDGESTYLE,false)?a.style[mxConstants.STYLE_EDGE]:null;"string"==typeof a&&(b=mxStyleRegistry.getValue(a),null==b&&this.isAllowEval()&&(b=mxUtils.eval(a)),a=b);return"function"==typeof a?a:null};
mxGraphView.prototype.updateFloatingTerminalPoints=function(a,b,c){var d=a.absolutePoints,e=d[0];null==d[d.length-1]&&null!=c&&this.updateFloatingTerminalPoint(a,c,b,false);null==e&&null!=b&&this.updateFloatingTerminalPoint(a,b,c,true)};
mxGraphView.prototype.updateFloatingTerminalPoint=function(a,b,c,d){b=this.getTerminalPort(a,b,d);var e=this.getNextPoint(a,c,d),f=this.graph.isOrthogonal(a);c=mxUtils.toRadians(Number(b.style[mxConstants.STYLE_ROTATION]||"0"));var g=new mxPoint(b.getCenterX(),b.getCenterY());if(0!=c){var h=Math.cos(-c),k=Math.sin(-c);e=mxUtils.getRotatedPoint(e,h,k,g)}h=parseFloat(a.style[mxConstants.STYLE_PERIMETER_SPACING]||0);h+=parseFloat(a.style[d?mxConstants.STYLE_SOURCE_PERIMETER_SPACING:mxConstants.STYLE_TARGET_PERIMETER_SPACING]||
0);b=this.getPerimeterPoint(b,e,0==c&&f,h);0!=c&&(h=Math.cos(c),k=Math.sin(c),b=mxUtils.getRotatedPoint(b,h,k,g));a.setAbsoluteTerminalPoint(b,d)};mxGraphView.prototype.getTerminalPort=function(a,b,c){a=mxUtils.getValue(a.style,c?mxConstants.STYLE_SOURCE_PORT:mxConstants.STYLE_TARGET_PORT);null!=a&&(a=this.getState(this.graph.getModel().getCell(a)),null!=a&&(b=a));return b};
mxGraphView.prototype.getPerimeterPoint=function(a,b,c,d){var e=null;if(null!=a){var f=this.getPerimeterFunction(a);if(null!=f&&null!=b&&(d=this.getPerimeterBounds(a,d),0<d.width||0<d.height))e=f(d,a,b,c);null==e&&(e=this.getPoint(a))}return e};mxGraphView.prototype.getRoutingCenterX=function(a){var b=null!=a.style?parseFloat(a.style[mxConstants.STYLE_ROUTING_CENTER_X])||0:0;return a.getCenterX()+b*a.width};
mxGraphView.prototype.getRoutingCenterY=function(a){var b=null!=a.style?parseFloat(a.style[mxConstants.STYLE_ROUTING_CENTER_Y])||0:0;return a.getCenterY()+b*a.height};mxGraphView.prototype.getPerimeterBounds=function(a,b){b=null!=b?b:0;null!=a&&(b+=parseFloat(a.style[mxConstants.STYLE_PERIMETER_SPACING]||0));return a.getPerimeterBounds(b*this.scale)};
mxGraphView.prototype.getPerimeterFunction=function(a){a=a.style[mxConstants.STYLE_PERIMETER];if("string"==typeof a){var b=mxStyleRegistry.getValue(a);null==b&&this.isAllowEval()&&(b=mxUtils.eval(a));a=b}return"function"==typeof a?a:null};mxGraphView.prototype.getNextPoint=function(a,b,c){a=a.absolutePoints;var d=null;if(null!=a&&(c||2<a.length||null==b)){d=a.length;d=a[c?Math.min(1,d-1):Math.max(0,d-2)]}null==d&&null!=b&&(d=new mxPoint(b.getCenterX(),b.getCenterY()));return d};
mxGraphView.prototype.getVisibleTerminal=function(a,b){for(var c=this.graph.getModel(),d=c.getTerminal(a,b),e=d;null!=d&&d!=this.currentRoot;){if(!this.graph.isCellVisible(e)||this.graph.isCellCollapsed(d))e=d;d=c.getParent(d)}c.getParent(e)==c.getRoot()&&(e=null);return e};
mxGraphView.prototype.updateEdgeBounds=function(a){var b=a.absolutePoints;a.length=0;if(null!=b&&0<b.length){var c=b[0],d=b[b.length-1];if(null==c||null==d)a.cell!=this.currentRoot&&this.clear(a.cell,true);else{if(c.x!=d.x||c.y!=d.y){var e=d.x-c.x,f=d.y-c.y;a.terminalDistance=Math.sqrt(e*e+f*f)}else a.terminalDistance=0;d=0;var g=[];f=c;if(null!=f){c=f.x;for(var h=f.y,k=c,l=h,m=1;m<b.length;m++){var p=b[m];null!=p&&(e=f.x-p.x,f=f.y-p.y,e=Math.sqrt(e*e+f*f),g.push(e),d+=e,f=p,c=Math.min(f.x,c),h=Math.min(f.y,
h),k=Math.max(f.x,k),l=Math.max(f.y,l))}a.length=d;a.segments=g;a.x=c;a.y=h;a.width=Math.max(1,k-c);a.height=Math.max(1,l-h)}}}};
mxGraphView.prototype.getPoint=function(a,b){var c=a.getCenterX(),d=a.getCenterY();if(null!=a.segments&&(null==b||b.relative)){for(var e=a.absolutePoints.length,f=((null!=b?b.x/2:0)+0.5)*a.length,g=a.segments[0],h=0,k=1;f>h+g&&k<e-1;){h+=g;g=a.segments[k++]}e=0==g?0:(f-h)/g;f=a.absolutePoints[k-1];k=a.absolutePoints[k];if(null!=f&&null!=k){h=c=d=0;if(null!=b){d=b.y;var l=b.offset;null!=l&&(c=l.x,h=l.y)}l=k.x-f.x;k=k.y-f.y;c=f.x+l*e+((0==g?0:k/g)*d+c)*this.scale;d=f.y+k*e-((0==g?0:l/g)*d-h)*this.scale}}else null!=
b&&(l=b.offset,null!=l&&(c+=l.x,d+=l.y));return new mxPoint(c,d)};
mxGraphView.prototype.getRelativePoint=function(a,b,c){var d=this.graph.getModel().getGeometry(a.cell);if(null!=d){var e=a.absolutePoints.length;if(d.relative&&1<e){d=a.length;for(var f=a.segments,g=a.absolutePoints[0],h=a.absolutePoints[1],k=mxUtils.ptSegDistSq(g.x,g.y,h.x,h.y,b,c),l=0,m=0,p=0,o=2;o<e;o++){m+=f[o-2];h=a.absolutePoints[o];g=mxUtils.ptSegDistSq(g.x,g.y,h.x,h.y,b,c);g<=k&&(k=g,l=o-1,p=m);g=h}e=f[l];g=a.absolutePoints[l];h=a.absolutePoints[l+1];k=h.x;f=h.y;a=g.x-k;l=g.y-f;f=(a-(b-k))*
a+(l-(c-f))*l;a=Math.sqrt(0>=f?0:f*f/(a*a+l*l));a>e&&(a=e);e=Math.sqrt(mxUtils.ptSegDistSq(g.x,g.y,h.x,h.y,b,c));-1==mxUtils.relativeCcw(g.x,g.y,h.x,h.y,b,c)&&(e=-e);return new mxPoint(-2*((d/2-p-a)/d),e/this.scale)}}return new mxPoint};
mxGraphView.prototype.updateEdgeLabelOffset=function(a){var b=a.absolutePoints;a.absoluteOffset.x=a.getCenterX();a.absoluteOffset.y=a.getCenterY();if(null!=b&&0<b.length&&null!=a.segments){var c=this.graph.getCellGeometry(a.cell);if(c.relative){var d=this.getPoint(a,c);null!=d&&(a.absoluteOffset=d)}else{d=b[0];var e=b[b.length-1];if(null!=d&&null!=e){b=e.x-d.x;var f=e.y-d.y,g=e=0;c=c.offset;null!=c&&(e=c.x,g=c.y);c=d.y+f/2+g*this.scale;a.absoluteOffset.x=d.x+b/2+e*this.scale;a.absoluteOffset.y=c}}}};
mxGraphView.prototype.getState=function(a,b){b=b||false;var c=null;null!=a&&(c=this.states.get(a),this.graph.isCellVisible(a)&&(null==c&&b&&this.graph.isCellVisible(a)?(c=this.createState(a),this.states.put(a,c)):b&&null!=c&&this.updateStyle&&(c.style=this.graph.getCellStyle(a))));return c};mxGraphView.prototype.isRendering=function(){return this.rendering};mxGraphView.prototype.setRendering=function(a){this.rendering=a};mxGraphView.prototype.isAllowEval=function(){return this.allowEval};
mxGraphView.prototype.setAllowEval=function(a){this.allowEval=a};mxGraphView.prototype.getStates=function(){return this.states};mxGraphView.prototype.setStates=function(a){this.states=a};mxGraphView.prototype.getCellStates=function(a){if(null==a)return this.states;for(var b=[],c=0;c<a.length;c++){var d=this.getState(a[c]);null!=d&&b.push(d)}return b};
mxGraphView.prototype.removeState=function(a){var b=null;null!=a&&(b=this.states.remove(a),null!=b&&(this.graph.cellRenderer.destroy(b),b.destroy()));return b};mxGraphView.prototype.createState=function(a){var b=this.graph.getCellStyle(a);a=new mxCellState(this,a,b);this.graph.cellRenderer.initialize(a,this.isRendering());return a};mxGraphView.prototype.getCanvas=function(){return this.canvas};mxGraphView.prototype.getBackgroundPane=function(){return this.backgroundPane};
mxGraphView.prototype.getDrawPane=function(){return this.drawPane};mxGraphView.prototype.getOverlayPane=function(){return this.overlayPane};mxGraphView.prototype.isContainerEvent=function(a){a=mxEvent.getSource(a);return a==this.graph.container||a.parentNode==this.backgroundPane||null!=a.parentNode&&a.parentNode.parentNode==this.backgroundPane||a==this.canvas.parentNode||a==this.canvas||a==this.backgroundPane||a==this.drawPane||a==this.overlayPane};
mxGraphView.prototype.isScrollEvent=function(a){var b=mxUtils.getOffset(this.graph.container);a=new mxPoint(a.clientX-b.x,a.clientY-b.y);b=this.graph.container.offsetWidth;var c=this.graph.container.clientWidth;if(b>c&&a.x>c+2&&a.x<=b)return true;b=this.graph.container.offsetHeight;c=this.graph.container.clientHeight;return b>c&&a.y>c+2&&a.y<=b?true:false};
mxGraphView.prototype.init=function(){this.installListeners();var a=this.graph;a.dialect==mxConstants.DIALECT_SVG?this.createSvg():a.dialect==mxConstants.DIALECT_VML?this.createVml():this.createHtml()};
mxGraphView.prototype.installListeners=function(){var a=this.graph,b=a.container;if(null!=b){mxEvent.addGestureListeners(b,mxUtils.bind(this,function(d){mxClient.IS_TOUCH&&a.isEditing()&&a.stopEditing(!a.isInvokesStopCellEditing());this.isContainerEvent(d)&&(!mxClient.IS_IE&&!mxClient.IS_GC&&!mxClient.IS_OP&&!mxClient.IS_SF||!this.isScrollEvent(d))&&a.fireMouseEvent(mxEvent.MOUSE_DOWN,new mxMouseEvent(d))}),mxUtils.bind(this,function(d){this.isContainerEvent(d)&&a.fireMouseEvent(mxEvent.MOUSE_MOVE,
new mxMouseEvent(d))}),mxUtils.bind(this,function(d){this.isContainerEvent(d)&&a.fireMouseEvent(mxEvent.MOUSE_UP,new mxMouseEvent(d))}));mxEvent.addListener(b,"dblclick",mxUtils.bind(this,function(d){a.dblClick(d)}));var c=function(d){var e=null;mxClient.IS_TOUCH&&(e=mxEvent.getClientX(d),d=mxEvent.getClientY(d),d=mxUtils.convertPoint(b,e,d),e=a.view.getState(a.getCellAt(d.x,d.y)));return e};a.addMouseListener({mouseDown:function(){a.panningHandler.hideMenu()},mouseMove:function(){},mouseUp:function(){}});
this.moveHandler=mxUtils.bind(this,function(d){null!=a.tooltipHandler&&a.tooltipHandler.isHideOnHover()&&a.tooltipHandler.hide();this.captureDocumentGesture&&a.isMouseDown&&!mxEvent.isConsumed(d)&&a.fireMouseEvent(mxEvent.MOUSE_MOVE,new mxMouseEvent(d,c(d)))});this.endHandler=mxUtils.bind(this,function(d){this.captureDocumentGesture&&a.fireMouseEvent(mxEvent.MOUSE_UP,new mxMouseEvent(d))});mxEvent.addGestureListeners(document,null,this.moveHandler,this.endHandler)}};
mxGraphView.prototype.createHtml=function(){var a=this.graph.container;null!=a&&(this.canvas=this.createHtmlPane("100%","100%"),this.backgroundPane=this.createHtmlPane("1px","1px"),this.drawPane=this.createHtmlPane("1px","1px"),this.overlayPane=this.createHtmlPane("1px","1px"),this.canvas.appendChild(this.backgroundPane),this.canvas.appendChild(this.drawPane),this.canvas.appendChild(this.overlayPane),a.appendChild(this.canvas),mxClient.IS_QUIRKS&&(a=mxUtils.bind(this,function(b){b=this.getGraphBounds();
this.updateHtmlCanvasSize(b.x+b.width+this.graph.border,b.y+b.height+this.graph.border)}),mxEvent.addListener(window,"resize",a)))};mxGraphView.prototype.updateHtmlCanvasSize=function(a,b){if(null!=this.graph.container){var c=this.graph.container.offsetHeight;this.canvas.style.width=this.graph.container.offsetWidth<a?a+"px":"100%";this.canvas.style.height=c<b?b+"px":"100%"}};
mxGraphView.prototype.createHtmlPane=function(a,b){var c=document.createElement("DIV");null!=a&&null!=b?(c.style.position="absolute",c.style.left="0px",c.style.top="0px",c.style.width=a,c.style.height=b):c.style.position="relative";return c};
mxGraphView.prototype.createVml=function(){var a=this.graph.container;if(null!=a){var b=a.offsetWidth,c=a.offsetHeight;this.canvas=this.createVmlPane(b,c);this.backgroundPane=this.createVmlPane(b,c);this.drawPane=this.createVmlPane(b,c);this.overlayPane=this.createVmlPane(b,c);this.canvas.appendChild(this.backgroundPane);this.canvas.appendChild(this.drawPane);this.canvas.appendChild(this.overlayPane);a.appendChild(this.canvas)}};
mxGraphView.prototype.createVmlPane=function(a,b){var c=document.createElement(mxClient.VML_PREFIX+":group");c.style.position="absolute";c.style.left="0px";c.style.top="0px";c.style.width=a+"px";c.style.height=b+"px";c.setAttribute("coordsize",a+","+b);c.setAttribute("coordorigin","0,0");return c};
mxGraphView.prototype.createSvg=function(){var a=this.graph.container;this.canvas=document.createElementNS(mxConstants.NS_SVG,"g");this.backgroundPane=document.createElementNS(mxConstants.NS_SVG,"g");this.canvas.appendChild(this.backgroundPane);this.drawPane=document.createElementNS(mxConstants.NS_SVG,"g");this.canvas.appendChild(this.drawPane);this.overlayPane=document.createElementNS(mxConstants.NS_SVG,"g");this.canvas.appendChild(this.overlayPane);var b=document.createElementNS(mxConstants.NS_SVG,
"svg");b.style.width="100%";b.style.height="100%";b.style.display="block";b.appendChild(this.canvas);null!=a&&(a.appendChild(b),this.updateContainerStyle(a))};mxGraphView.prototype.updateContainerStyle=function(a){"static"==mxUtils.getCurrentStyle(a).position&&(a.style.position="relative");mxClient.IS_POINTER&&(a.style.msTouchAction="none")};
mxGraphView.prototype.destroy=function(){var a=null!=this.canvas?this.canvas.ownerSVGElement:null;null==a&&(a=this.canvas);null!=a&&null!=a.parentNode&&(this.clear(this.currentRoot,true),mxEvent.removeGestureListeners(document,null,this.moveHandler,this.endHandler),mxEvent.release(this.graph.container),a.parentNode.removeChild(a),this.overlayPane=this.drawPane=this.backgroundPane=this.canvas=this.endHandler=this.moveHandler=null)};
function mxCurrentRootChange(a,b){this.view=a;this.previous=this.root=b;this.isUp=null==b;if(!this.isUp)for(var c=this.view.currentRoot,d=this.view.graph.getModel();null!=c;){if(c==b){this.isUp=true;break}c=d.getParent(c)}}
mxCurrentRootChange.prototype.execute=function(){var a=this.view.currentRoot;this.view.currentRoot=this.previous;this.previous=a;a=this.view.graph.getTranslateForRoot(this.view.currentRoot);null!=a&&(this.view.translate=new mxPoint(-a.x,-a.y));this.view.fireEvent(new mxEventObject(this.isUp?mxEvent.UP:mxEvent.DOWN,"root",this.view.currentRoot,"previous",this.previous));this.isUp?(this.view.clear(this.view.currentRoot,true),this.view.validate()):this.view.refresh();this.isUp=!this.isUp};
function mxGraph(a,b,c,d){this.mouseListeners=null;this.renderHint=c;this.dialect=mxClient.IS_SVG?mxConstants.DIALECT_SVG:c==mxConstants.RENDERING_HINT_EXACT&&mxClient.IS_VML?mxConstants.DIALECT_VML:c==mxConstants.RENDERING_HINT_FASTEST?mxConstants.DIALECT_STRICTHTML:c==mxConstants.RENDERING_HINT_FASTER?mxConstants.DIALECT_PREFERHTML:mxConstants.DIALECT_MIXEDHTML;this.model=null!=b?b:new mxGraphModel;this.multiplicities=[];this.imageBundles=[];this.cellRenderer=this.createCellRenderer();this.setSelectionModel(this.createSelectionModel());
this.setStylesheet(null!=d?d:this.createStylesheet());this.view=this.createGraphView();this.graphModelChangeListener=mxUtils.bind(this,function(e,f){this.graphModelChanged(f.getProperty("edit").changes)});this.model.addListener(mxEvent.CHANGE,this.graphModelChangeListener);this.createHandlers();null!=a&&this.init(a);this.view.revalidate()}mxLoadResources&&mxResources.add(mxClient.basePath+"/resources/graph");mxGraph.prototype=new mxEventSource;mxGraph.prototype.constructor=mxGraph;
mxGraph.prototype.EMPTY_ARRAY=[];mxGraph.prototype.mouseListeners=null;mxGraph.prototype.isMouseDown=false;mxGraph.prototype.model=null;mxGraph.prototype.view=null;mxGraph.prototype.stylesheet=null;mxGraph.prototype.selectionModel=null;mxGraph.prototype.cellEditor=null;mxGraph.prototype.cellRenderer=null;mxGraph.prototype.multiplicities=null;mxGraph.prototype.renderHint=null;mxGraph.prototype.dialect=null;mxGraph.prototype.gridSize=10;mxGraph.prototype.gridEnabled=true;
mxGraph.prototype.portsEnabled=true;mxGraph.prototype.doubleTapEnabled=true;mxGraph.prototype.doubleTapTimeout=700;mxGraph.prototype.doubleTapTolerance=25;mxGraph.prototype.lastTouchY=0;mxGraph.prototype.lastTouchY=0;mxGraph.prototype.lastTouchTime=0;mxGraph.prototype.gestureEnabled=true;mxGraph.prototype.tolerance=4;mxGraph.prototype.defaultOverlap=0.5;mxGraph.prototype.defaultParent=null;mxGraph.prototype.alternateEdgeStyle=null;mxGraph.prototype.backgroundImage=null;
mxGraph.prototype.pageVisible=false;mxGraph.prototype.pageBreaksVisible=false;mxGraph.prototype.pageBreakColor="gray";mxGraph.prototype.pageBreakDashed=true;mxGraph.prototype.minPageBreakDist=20;mxGraph.prototype.preferPageSize=false;mxGraph.prototype.pageFormat=mxConstants.PAGE_FORMAT_A4_PORTRAIT;mxGraph.prototype.pageScale=1.5;mxGraph.prototype.enabled=true;mxGraph.prototype.escapeEnabled=true;mxGraph.prototype.invokesStopCellEditing=true;mxGraph.prototype.enterStopsCellEditing=false;
mxGraph.prototype.useScrollbarsForPanning=true;mxGraph.prototype.exportEnabled=true;mxGraph.prototype.importEnabled=true;mxGraph.prototype.cellsLocked=false;mxGraph.prototype.cellsCloneable=true;mxGraph.prototype.foldingEnabled=true;mxGraph.prototype.cellsEditable=true;mxGraph.prototype.cellsDeletable=true;mxGraph.prototype.cellsMovable=true;mxGraph.prototype.edgeLabelsMovable=true;mxGraph.prototype.vertexLabelsMovable=false;mxGraph.prototype.dropEnabled=false;mxGraph.prototype.splitEnabled=true;
mxGraph.prototype.cellsResizable=true;mxGraph.prototype.cellsBendable=true;mxGraph.prototype.cellsSelectable=true;mxGraph.prototype.cellsDisconnectable=true;mxGraph.prototype.autoSizeCells=false;mxGraph.prototype.autoScroll=true;mxGraph.prototype.timerAutoScroll=false;mxGraph.prototype.allowAutoPanning=false;mxGraph.prototype.ignoreScrollbars=false;mxGraph.prototype.autoExtend=true;mxGraph.prototype.maximumGraphBounds=null;mxGraph.prototype.minimumGraphSize=null;
mxGraph.prototype.minimumContainerSize=null;mxGraph.prototype.maximumContainerSize=null;mxGraph.prototype.resizeContainer=false;mxGraph.prototype.border=0;mxGraph.prototype.ordered=true;mxGraph.prototype.keepEdgesInForeground=false;mxGraph.prototype.keepEdgesInBackground=true;mxGraph.prototype.allowNegativeCoordinates=true;mxGraph.prototype.constrainChildren=true;mxGraph.prototype.extendParents=true;mxGraph.prototype.extendParentsOnAdd=true;mxGraph.prototype.collapseToPreferredSize=true;
mxGraph.prototype.zoomFactor=1.2;mxGraph.prototype.keepSelectionVisibleOnZoom=false;mxGraph.prototype.centerZoom=true;mxGraph.prototype.resetViewOnRootChange=true;mxGraph.prototype.resetEdgesOnResize=false;mxGraph.prototype.resetEdgesOnMove=false;mxGraph.prototype.resetEdgesOnConnect=true;mxGraph.prototype.allowLoops=false;mxGraph.prototype.defaultLoopStyle=mxEdgeStyle.Loop;mxGraph.prototype.multigraph=true;mxGraph.prototype.connectableEdges=false;mxGraph.prototype.allowDanglingEdges=true;
mxGraph.prototype.cloneInvalidEdges=false;mxGraph.prototype.disconnectOnMove=true;mxGraph.prototype.labelsVisible=true;mxGraph.prototype.htmlLabels=false;mxGraph.prototype.swimlaneSelectionEnabled=true;mxGraph.prototype.swimlaneNesting=true;mxGraph.prototype.swimlaneIndicatorColorAttribute=mxConstants.STYLE_FILLCOLOR;mxGraph.prototype.imageBundles=null;mxGraph.prototype.minFitScale=0.1;mxGraph.prototype.maxFitScale=8;mxGraph.prototype.panDx=0;mxGraph.prototype.panDy=0;
mxGraph.prototype.collapsedImage=new mxImage(mxClient.imageBasePath+"/collapsed.gif",9,9);mxGraph.prototype.expandedImage=new mxImage(mxClient.imageBasePath+"/expanded.gif",9,9);mxGraph.prototype.warningImage=new mxImage(mxClient.imageBasePath+"/warning"+(mxClient.IS_MAC?".png":".gif"),16,16);mxGraph.prototype.alreadyConnectedResource="none"!=mxClient.language?"alreadyConnected":"";mxGraph.prototype.containsValidationErrorsResource="none"!=mxClient.language?"containsValidationErrors":"";
mxGraph.prototype.collapseExpandResource="none"!=mxClient.language?"collapse-expand":"";mxGraph.prototype.init=function(a){this.container=a;this.cellEditor=this.createCellEditor();this.view.init();this.sizeDidChange();mxClient.IS_IE&&(mxEvent.addListener(window,"unload",mxUtils.bind(this,function(){this.destroy()})),mxEvent.addListener(a,"selectstart",mxUtils.bind(this,function(){return this.isEditing()})));8==document.documentMode&&a.insertAdjacentHTML("beforeend",'<v:group style="DISPLAY: none;"></v:group>')};
mxGraph.prototype.createHandlers=function(){this.tooltipHandler=new mxTooltipHandler(this);this.tooltipHandler.setEnabled(false);this.panningHandler=new mxPanningHandler(this);this.panningHandler.panningEnabled=false;this.selectionCellsHandler=new mxSelectionCellsHandler(this);this.connectionHandler=new mxConnectionHandler(this);this.connectionHandler.setEnabled(false);this.graphHandler=new mxGraphHandler(this)};mxGraph.prototype.createSelectionModel=function(){return new mxGraphSelectionModel(this)};
mxGraph.prototype.createStylesheet=function(){return new mxStylesheet};mxGraph.prototype.createGraphView=function(){return new mxGraphView(this)};mxGraph.prototype.createCellRenderer=function(){return new mxCellRenderer};mxGraph.prototype.createCellEditor=function(){return new mxCellEditor(this)};mxGraph.prototype.getModel=function(){return this.model};mxGraph.prototype.getView=function(){return this.view};mxGraph.prototype.getStylesheet=function(){return this.stylesheet};
mxGraph.prototype.setStylesheet=function(a){this.stylesheet=a};mxGraph.prototype.getSelectionModel=function(){return this.selectionModel};mxGraph.prototype.setSelectionModel=function(a){this.selectionModel=a};mxGraph.prototype.getSelectionCellsForChanges=function(a){for(var b=[],c=0;c<a.length;c++){var d=a[c];if(d.constructor!=mxRootChange){var e=null;d instanceof mxChildChange&&null==d.previous?e=d.child:null!=d.cell&&d.cell instanceof mxCell&&(e=d.cell);null!=e&&0>mxUtils.indexOf(b,e)&&b.push(e)}}return this.getModel().getTopmostCells(b)};
mxGraph.prototype.graphModelChanged=function(a){for(var b=0;b<a.length;b++)this.processChange(a[b]);this.removeSelectionCells(this.getRemovedCellsForChanges(a));this.view.validate();this.sizeDidChange()};mxGraph.prototype.getRemovedCellsForChanges=function(a){for(var b=[],c=0;c<a.length;c++){var d=a[c];if(d instanceof mxRootChange)break;else d instanceof mxChildChange?null!=d.previous&&null==d.parent&&(b=b.concat(this.model.getDescendants(d.child))):d instanceof mxVisibleChange&&(b=b.concat(this.model.getDescendants(d.cell)))}return b};
mxGraph.prototype.processChange=function(a){if(a instanceof mxRootChange){this.clearSelection();this.removeStateForCell(a.previous);this.resetViewOnRootChange&&(this.view.scale=1,this.view.translate.x=0,this.view.translate.y=0);this.fireEvent(new mxEventObject(mxEvent.ROOT))}else if(a instanceof mxChildChange){var b=this.model.getParent(a.child);null!=b?this.view.invalidate(a.child,true,false,null!=a.previous):(this.removeStateForCell(a.child),this.view.currentRoot==a.child&&this.home());b!=a.previous&&
(null!=b&&this.view.invalidate(b,false,false),null!=a.previous&&this.view.invalidate(a.previous,false,false))}else a instanceof mxTerminalChange||a instanceof mxGeometryChange?this.view.invalidate(a.cell):a instanceof mxValueChange?this.view.invalidate(a.cell,false,false):a instanceof mxStyleChange?(this.view.invalidate(a.cell,true,true,false),this.view.removeState(a.cell)):null!=a.cell&&a.cell instanceof mxCell&&this.removeStateForCell(a.cell)};
mxGraph.prototype.removeStateForCell=function(a){for(var b=this.model.getChildCount(a),c=0;c<b;c++)this.removeStateForCell(this.model.getChildAt(a,c));this.view.removeState(a)};mxGraph.prototype.addCellOverlay=function(a,b){null==a.overlays&&(a.overlays=[]);a.overlays.push(b);var c=this.view.getState(a);null!=c&&this.cellRenderer.redraw(c);this.fireEvent(new mxEventObject(mxEvent.ADD_OVERLAY,"cell",a,"overlay",b));return b};mxGraph.prototype.getCellOverlays=function(a){return a.overlays};
mxGraph.prototype.removeCellOverlay=function(a,b){if(null==b)this.removeCellOverlays(a);else{var c=mxUtils.indexOf(a.overlays,b);0<=c?(a.overlays.splice(c,1),0==a.overlays.length&&(a.overlays=null),c=this.view.getState(a),null!=c&&this.cellRenderer.redraw(c),this.fireEvent(new mxEventObject(mxEvent.REMOVE_OVERLAY,"cell",a,"overlay",b))):b=null}return b};
mxGraph.prototype.removeCellOverlays=function(a){var b=a.overlays;if(null!=b){a.overlays=null;var c=this.view.getState(a);null!=c&&this.cellRenderer.redraw(c);for(c=0;c<b.length;c++)this.fireEvent(new mxEventObject(mxEvent.REMOVE_OVERLAY,"cell",a,"overlay",b[c]))}return b};mxGraph.prototype.clearCellOverlays=function(a){a=null!=a?a:this.model.getRoot();this.removeCellOverlays(a);for(var b=this.model.getChildCount(a),c=0;c<b;c++)this.clearCellOverlays(this.model.getChildAt(a,c))};
mxGraph.prototype.setCellWarning=function(a,b,c,d){if(null!=b&&0<b.length)return c=null!=c?c:this.warningImage,b=new mxCellOverlay(c,"<font color=red>"+b+"</font>"),d&&b.addListener(mxEvent.CLICK,mxUtils.bind(this,function(){this.isEnabled()&&this.setSelectionCell(a)})),this.addCellOverlay(a,b);this.removeCellOverlays(a);return null};mxGraph.prototype.startEditing=function(a){this.startEditingAtCell(null,a)};
mxGraph.prototype.startEditingAtCell=function(a,b){null==a&&(a=this.getSelectionCell(),null!=a&&!this.isCellEditable(a)&&(a=null));null!=a&&(this.fireEvent(new mxEventObject(mxEvent.START_EDITING,"cell",a,"event",b)),this.cellEditor.startEditing(a,b))};mxGraph.prototype.getEditingValue=function(a){return this.convertValueToString(a)};mxGraph.prototype.stopEditing=function(a){this.cellEditor.stopEditing(a)};
mxGraph.prototype.labelChanged=function(a,b,c){this.model.beginUpdate();try{this.cellLabelChanged(a,b,this.isAutoSizeCell(a));this.fireEvent(new mxEventObject(mxEvent.LABEL_CHANGED,"cell",a,"value",b,"event",c))}finally{this.model.endUpdate()}return a};mxGraph.prototype.cellLabelChanged=function(a,b,c){this.model.beginUpdate();try{this.model.setValue(a,b);c&&this.cellSizeUpdated(a,false)}finally{this.model.endUpdate()}};
mxGraph.prototype.escape=function(a){this.stopEditing(true);this.connectionHandler.reset();this.graphHandler.reset();a=this.getSelectionCells();for(var b=0;b<a.length;b++){var c=this.view.getState(a[b]);null!=c&&null!=c.handler&&c.handler.reset()}};
mxGraph.prototype.click=function(a){var b=a.getEvent(),c=a.getCell(),d=new mxEventObject(mxEvent.CLICK,"event",b,"cell",c);a.isConsumed()&&d.consume();this.fireEvent(d);this.isEnabled()&&!mxEvent.isConsumed(b)&&!d.isConsumed()&&(null!=c?this.selectCellForEvent(c,b):(this.isSwimlaneSelectionEnabled()&&(c=this.getSwimlaneAt(a.getGraphX(),a.getGraphY())),null!=c?this.selectCellForEvent(c,b):this.isToggleEvent(b)||this.clearSelection()))};
mxGraph.prototype.dblClick=function(a,b){var c=new mxEventObject(mxEvent.DOUBLE_CLICK,"event",a,"cell",b);this.fireEvent(c);this.isEnabled()&&!mxEvent.isConsumed(a)&&!c.isConsumed()&&null!=b&&this.isCellEditable(b)&&this.startEditingAtCell(b,a)};
mxGraph.prototype.scrollPointToVisible=function(a,b,c,d){if(!this.timerAutoScroll&&(this.ignoreScrollbars||mxUtils.hasScrollbars(this.container))){var e=this.container;d=null!=d?d:20;if(a>=e.scrollLeft&&b>=e.scrollTop&&a<=e.scrollLeft+e.clientWidth&&b<=e.scrollTop+e.clientHeight){var f=e.scrollLeft+e.clientWidth-a;if(f<d){if(a=e.scrollLeft,e.scrollLeft+=d-f,c&&a==e.scrollLeft){if(this.dialect==mxConstants.DIALECT_SVG){a=this.view.getDrawPane().ownerSVGElement;var g=this.container.scrollWidth+d-f}else{g=
Math.max(e.clientWidth,e.scrollWidth)+d-f;a=this.view.getCanvas()}a.style.width=g+"px";e.scrollLeft+=d-f}}else{f=a-e.scrollLeft;f<d&&(e.scrollLeft-=d-f)}f=e.scrollTop+e.clientHeight-b;f<d?(a=e.scrollTop,e.scrollTop+=d-f,a==e.scrollTop&&c&&(this.dialect==mxConstants.DIALECT_SVG?this.view.getDrawPane():(b=Math.max(e.clientHeight,e.scrollHeight)+d-f,a=this.view.getCanvas()),a.style.height=b+"px",e.scrollTop+=d-f)):(f=b-e.scrollTop,f<d&&(e.scrollTop-=d-f))}}else this.allowAutoPanning&&!this.panningHandler.active&&
(null==this.panningManager&&(this.panningManager=this.createPanningManager()),this.panningManager.panTo(a+this.panDx,b+this.panDy))};mxGraph.prototype.createPanningManager=function(){return new mxPanningManager(this)};
mxGraph.prototype.getBorderSizes=function(){function a(d){var e=0;e="thin"==d?2:"medium"==d?4:"thick"==d?6:parseInt(d);isNaN(e)&&(e=0);return e}var b=mxUtils.getCurrentStyle(this.container),c=new mxRectangle;c.x=a(b.borderLeftWidth)+parseInt(b.paddingLeft||0);c.y=a(b.borderTopWidth)+parseInt(b.paddingTop||0);c.width=a(b.borderRightWidth)+parseInt(b.paddingRight||0);c.height=a(b.borderBottomWidth)+parseInt(b.paddingBottom||0);return c};
mxGraph.prototype.getPreferredPageSize=function(a,b,c){a=this.view.scale;var d=this.view.translate,e=this.pageFormat,f=a*this.pageScale;e=new mxRectangle(0,0,e.width*f,e.height*f);b=this.pageBreaksVisible?Math.ceil(b/e.width):1;c=this.pageBreaksVisible?Math.ceil(c/e.height):1;return new mxRectangle(0,0,b*e.width+2+d.x/a,c*e.height+2+d.y/a)};
mxGraph.prototype.sizeDidChange=function(){var a=this.getGraphBounds();if(null!=this.container){var b=this.getBorder(),c=Math.max(0,a.x+a.width+1+b);b=Math.max(0,a.y+a.height+1+b);null!=this.minimumContainerSize&&(c=Math.max(c,this.minimumContainerSize.width),b=Math.max(b,this.minimumContainerSize.height));this.resizeContainer&&this.doResizeContainer(c,b);if(this.preferPageSize||!mxClient.IS_IE&&this.pageVisible){var d=this.getPreferredPageSize(a,c,b);null!=d&&(c=d.width,b=d.height)}null!=this.minimumGraphSize&&
(c=Math.max(c,this.minimumGraphSize.width*this.view.scale),b=Math.max(b,this.minimumGraphSize.height*this.view.scale));c=Math.ceil(c-1);b=Math.ceil(b-1);this.dialect==mxConstants.DIALECT_SVG?(d=this.view.getDrawPane().ownerSVGElement,d.style.minWidth=Math.max(1,c)+"px",d.style.minHeight=Math.max(1,b)+"px",d.style.width="100%",d.style.height="100%"):mxClient.IS_QUIRKS?this.view.updateHtmlCanvasSize(Math.max(1,c),Math.max(1,b)):(this.view.canvas.style.minWidth=Math.max(1,c)+"px",this.view.canvas.style.minHeight=
Math.max(1,b)+"px");this.updatePageBreaks(this.pageBreaksVisible,c-1,b-1)}this.fireEvent(new mxEventObject(mxEvent.SIZE,"bounds",a))};
mxGraph.prototype.doResizeContainer=function(a,b){if(mxClient.IS_IE)if(mxClient.IS_QUIRKS){var c=this.getBorderSizes();a+=Math.max(2,c.x+c.width+1);b+=Math.max(2,c.y+c.height+1)}else 9<=document.documentMode?(a+=3,b+=5):(a+=1,b+=1);else b+=1;null!=this.maximumContainerSize&&(a=Math.min(this.maximumContainerSize.width,a),b=Math.min(this.maximumContainerSize.height,b));this.container.style.width=Math.ceil(a)+"px";this.container.style.height=Math.ceil(b)+"px"};
mxGraph.prototype.updatePageBreaks=function(a,b,c){var d=this.view.scale,e=this.view.translate,f=this.pageFormat,g=d*this.pageScale;e=new mxRectangle(d*e.x,d*e.y,f.width*g,f.height*g);a=a&&Math.min(e.width,e.height)>this.minPageBreakDist;e.x=mxUtils.mod(e.x,e.width);e.y=mxUtils.mod(e.y,e.height);f=a?Math.ceil((b-e.x)/e.width):0;a=a?Math.ceil((c-e.y)/e.height):0;null==this.horizontalPageBreaks&&0<f&&(this.horizontalPageBreaks=[]);if(null!=this.horizontalPageBreaks){for(g=0;g<=f;g++){var h=[new mxPoint(e.x+
g*e.width,1),new mxPoint(e.x+g*e.width,c)];null!=this.horizontalPageBreaks[g]?(this.horizontalPageBreaks[g].scale=1,this.horizontalPageBreaks[g].points=h,this.horizontalPageBreaks[g].redraw()):(h=new mxPolyline(h,this.pageBreakColor,this.scale),h.dialect=this.dialect,h.isDashed=this.pageBreakDashed,h.scale=d,h.init(this.view.backgroundPane),h.redraw(),this.horizontalPageBreaks[g]=h)}for(g=f;g<this.horizontalPageBreaks.length;g++)this.horizontalPageBreaks[g].destroy();this.horizontalPageBreaks.splice(f,
this.horizontalPageBreaks.length-f)}null==this.verticalPageBreaks&&0<a&&(this.verticalPageBreaks=[]);if(null!=this.verticalPageBreaks){for(g=0;g<=a;g++){h=[new mxPoint(1,e.y+g*e.height),new mxPoint(b,e.y+g*e.height)];null!=this.verticalPageBreaks[g]?(this.verticalPageBreaks[g].scale=1,this.verticalPageBreaks[g].points=h,this.verticalPageBreaks[g].redraw()):(h=new mxPolyline(h,this.pageBreakColor,d),h.dialect=this.dialect,h.isDashed=this.pageBreakDashed,h.scale=d,h.init(this.view.backgroundPane),h.redraw(),
this.verticalPageBreaks[g]=h)}for(g=a;g<this.verticalPageBreaks.length;g++)this.verticalPageBreaks[g].destroy();this.verticalPageBreaks.splice(a,this.verticalPageBreaks.length-a)}};mxGraph.prototype.getCellStyle=function(a){var b=this.model.getStyle(a),c=null;c=this.model.isEdge(a)?this.stylesheet.getDefaultEdgeStyle():this.stylesheet.getDefaultVertexStyle();null!=b&&(c=this.postProcessCellStyle(this.stylesheet.getCellStyle(b,c)));null==c&&(c=mxGraph.prototype.EMPTY_ARRAY);return c};
mxGraph.prototype.postProcessCellStyle=function(a){if(null!=a){var b=a[mxConstants.STYLE_IMAGE],c=this.getImageFromBundles(b);null!=c?a[mxConstants.STYLE_IMAGE]=c:c=b;null!=c&&"data:image/"==c.substring(0,11)&&("data:image/svg+xml,"!=c.substring(0,19)&&(b=c.indexOf(","),0<b&&(c=c.substring(0,b)+";base64,"+c.substring(b+1))),a[mxConstants.STYLE_IMAGE]=c)}return a};
mxGraph.prototype.setCellStyle=function(a,b){b=b||this.getSelectionCells();if(null!=b){this.model.beginUpdate();try{for(var c=0;c<b.length;c++)this.model.setStyle(b[c],a)}finally{this.model.endUpdate()}}};mxGraph.prototype.toggleCellStyle=function(a,b,c){c=c||this.getSelectionCell();this.toggleCellStyles(a,b,[c])};
mxGraph.prototype.toggleCellStyles=function(a,b,c){b=null!=b?b:false;c=c||this.getSelectionCells();if(null!=c&&0<c.length){var d=this.view.getState(c[0]);d=null!=d?d.style:this.getCellStyle(c[0]);null!=d&&(b=mxUtils.getValue(d,a,b)?0:1,this.setCellStyles(a,b,c))}};mxGraph.prototype.setCellStyles=function(a,b,c){c=c||this.getSelectionCells();mxUtils.setCellStyles(this.model,c,a,b)};mxGraph.prototype.toggleCellStyleFlags=function(a,b,c){this.setCellStyleFlags(a,b,null,c)};
mxGraph.prototype.setCellStyleFlags=function(a,b,c,d){d=d||this.getSelectionCells();if(null!=d&&0<d.length){if(null==c){var e=this.view.getState(d[0]);e=null!=e?e.style:this.getCellStyle(d[0]);null!=e&&(c=(parseInt(e[a]||0)&b)!=b)}mxUtils.setCellStyleFlags(this.model,d,a,b,c)}};
mxGraph.prototype.alignCells=function(a,b,c){null==b&&(b=this.getSelectionCells());if(null!=b&&1<b.length){if(null==c)for(var d=0;d<b.length;d++){var e=this.getCellGeometry(b[d]);if(null!=e&&!this.model.isEdge(b[d]))if(null==c)if(a==mxConstants.ALIGN_CENTER){c=e.x+e.width/2;break}else if(a==mxConstants.ALIGN_RIGHT)c=e.x+e.width;else if(a==mxConstants.ALIGN_TOP)c=e.y;else if(a==mxConstants.ALIGN_MIDDLE){c=e.y+e.height/2;break}else c=a==mxConstants.ALIGN_BOTTOM?e.y+e.height:e.x;else c=a==mxConstants.ALIGN_RIGHT?
Math.max(c,e.x+e.width):a==mxConstants.ALIGN_TOP?Math.min(c,e.y):a==mxConstants.ALIGN_BOTTOM?Math.max(c,e.y+e.height):Math.min(c,e.x)}if(null!=c){this.model.beginUpdate();try{for(d=0;d<b.length;d++){e=this.getCellGeometry(b[d]);null!=e&&!this.model.isEdge(b[d])&&(e=e.clone(),a==mxConstants.ALIGN_CENTER?e.x=c-e.width/2:a==mxConstants.ALIGN_RIGHT?e.x=c-e.width:a==mxConstants.ALIGN_TOP?e.y=c:a==mxConstants.ALIGN_MIDDLE?e.y=c-e.height/2:a==mxConstants.ALIGN_BOTTOM?e.y=c-e.height:e.x=c,this.model.setGeometry(b[d],
e))}this.fireEvent(new mxEventObject(mxEvent.ALIGN_CELLS,"align",a,"cells",b))}finally{this.model.endUpdate()}}}return b};mxGraph.prototype.flipEdge=function(a){if(null!=a&&null!=this.alternateEdgeStyle){this.model.beginUpdate();try{var b=this.model.getStyle(a);null==b||0==b.length?this.model.setStyle(a,this.alternateEdgeStyle):this.model.setStyle(a,null);this.resetEdge(a);this.fireEvent(new mxEventObject(mxEvent.FLIP_EDGE,"edge",a))}finally{this.model.endUpdate()}}return a};
mxGraph.prototype.addImageBundle=function(a){this.imageBundles.push(a)};mxGraph.prototype.removeImageBundle=function(a){for(var b=[],c=0;c<this.imageBundles.length;c++)this.imageBundles[c]!=a&&b.push(this.imageBundles[c]);this.imageBundles=b};mxGraph.prototype.getImageFromBundles=function(a){if(null!=a)for(var b=0;b<this.imageBundles.length;b++){var c=this.imageBundles[b].getImage(a);if(null!=c)return c}return null};
mxGraph.prototype.orderCells=function(a,b){null==b&&(b=mxUtils.sortCells(this.getSelectionCells(),true));this.model.beginUpdate();try{this.cellsOrdered(b,a);this.fireEvent(new mxEventObject(mxEvent.ORDER_CELLS,"back",a,"cells",b))}finally{this.model.endUpdate()}return b};
mxGraph.prototype.cellsOrdered=function(a,b){if(null!=a){this.model.beginUpdate();try{for(var c=0;c<a.length;c++){var d=this.model.getParent(a[c]);b?this.model.add(d,a[c],c):this.model.add(d,a[c],this.model.getChildCount(d)-1)}this.fireEvent(new mxEventObject(mxEvent.CELLS_ORDERED,"back",b,"cells",a))}finally{this.model.endUpdate()}}};
mxGraph.prototype.groupCells=function(a,b,c){null==c&&(c=mxUtils.sortCells(this.getSelectionCells(),true));c=this.getCellsForGroup(c);null==a&&(a=this.createGroupCell(c));var d=this.getBoundsForGroup(a,c,b);if(0<c.length&&null!=d){var e=this.model.getParent(a);null==e&&(e=this.model.getParent(c[0]));this.model.beginUpdate();try{null==this.getCellGeometry(a)&&this.model.setGeometry(a,new mxGeometry);var f=this.model.getChildCount(e);this.cellsAdded([a],e,f,null,null,false);f=this.model.getChildCount(a);
this.cellsAdded(c,a,f,null,null,false,false);this.cellsMoved(c,-d.x,-d.y,false,true);this.cellsResized([a],[d]);this.fireEvent(new mxEventObject(mxEvent.GROUP_CELLS,"group",a,"border",b,"cells",c))}finally{this.model.endUpdate()}}return a};mxGraph.prototype.getCellsForGroup=function(a){var b=[];if(null!=a&&0<a.length){var c=this.model.getParent(a[0]);b.push(a[0]);for(var d=1;d<a.length;d++)this.model.getParent(a[d])==c&&b.push(a[d])}return b};
mxGraph.prototype.getBoundsForGroup=function(a,b,c){b=this.getBoundingBoxFromGeometry(b);null!=b&&(this.isSwimlane(a)&&(a=this.getStartSize(a),b.x-=a.width,b.y-=a.height,b.width+=a.width,b.height+=a.height),b.x-=c,b.y-=c,b.width+=2*c,b.height+=2*c);return b};mxGraph.prototype.createGroupCell=function(a){a=new mxCell("");a.setVertex(true);a.setConnectable(false);return a};
mxGraph.prototype.ungroupCells=function(a){var b=[];if(null==a){a=this.getSelectionCells();for(var c=[],d=0;d<a.length;d++)0<this.model.getChildCount(a[d])&&c.push(a[d]);a=c}if(null!=a&&0<a.length){this.model.beginUpdate();try{for(d=0;d<a.length;d++){var e=this.model.getChildren(a[d]);if(null!=e&&0<e.length){e=e.slice();var f=this.model.getParent(a[d]),g=this.model.getChildCount(f);this.cellsAdded(e,f,g,null,null,true);b=b.concat(e)}}this.cellsRemoved(this.addAllEdges(a));this.fireEvent(new mxEventObject(mxEvent.UNGROUP_CELLS,
"cells",a))}finally{this.model.endUpdate()}}return b};mxGraph.prototype.removeCellsFromParent=function(a){null==a&&(a=this.getSelectionCells());this.model.beginUpdate();try{var b=this.getDefaultParent(),c=this.model.getChildCount(b);this.cellsAdded(a,b,c,null,null,true);this.fireEvent(new mxEventObject(mxEvent.REMOVE_CELLS_FROM_PARENT,"cells",a))}finally{this.model.endUpdate()}return a};
mxGraph.prototype.updateGroupBounds=function(a,b,c){null==a&&(a=this.getSelectionCells());b=null!=b?b:0;c=null!=c?c:false;this.model.beginUpdate();try{for(var d=0;d<a.length;d++){var e=this.getCellGeometry(a[d]);if(null!=e){var f=this.getChildCells(a[d]);if(null!=f&&0<f.length){var g=this.getBoundingBoxFromGeometry(f);if(0<g.width&&0<g.height){var h=this.isSwimlane(a[d])?this.getStartSize(a[d]):new mxRectangle;e=e.clone();c&&(e.x+=g.x-h.width-b,e.y+=g.y-h.height-b);e.width=g.width+h.width+2*b;e.height=
g.height+h.height+2*b;this.model.setGeometry(a[d],e);this.moveCells(f,-g.x+h.width+b,-g.y+h.height+b)}}}}}finally{this.model.endUpdate()}return a};
mxGraph.prototype.cloneCells=function(a,b){b=null!=b?b:true;var c=null;if(null!=a){var d={};c=[];for(var e=0;e<a.length;e++){var f=mxCellPath.create(a[e]);d[f]=a[e];c.push(a[e])}if(0<c.length){f=this.view.scale;var g=this.view.translate;c=this.model.cloneCells(a,true);for(e=0;e<a.length;e++)if(!b&&this.model.isEdge(c[e])&&null!=this.getEdgeValidationError(c[e],this.model.getTerminal(c[e],true),this.model.getTerminal(c[e],false)))c[e]=null;else{var h=this.model.getGeometry(c[e]);if(null!=h){var k=
this.view.getState(a[e]),l=this.view.getState(this.model.getParent(a[e]));if(null!=k&&null!=l){var m=l.origin.x;l=l.origin.y;if(this.model.isEdge(c[e])){k=k.absolutePoints;for(var p=this.model.getTerminal(a[e],true),o=mxCellPath.create(p);null!=p&&null==d[o];){p=this.model.getParent(p);o=mxCellPath.create(p)}null==p&&h.setTerminalPoint(new mxPoint(k[0].x/f-g.x,k[0].y/f-g.y),true);p=this.model.getTerminal(a[e],false);for(o=mxCellPath.create(p);null!=p&&null==d[o];){p=this.model.getParent(p);o=mxCellPath.create(p)}null==
p&&(p=k.length-1,h.setTerminalPoint(new mxPoint(k[p].x/f-g.x,k[p].y/f-g.y),false));h=h.points;if(null!=h)for(k=0;k<h.length;k++){h[k].x+=m;h[k].y+=l}}else{h.x+=m;h.y+=l}}}}}else c=[]}return c};mxGraph.prototype.insertVertex=function(a,b,c,d,e,f,g,h,k){b=this.createVertex(a,b,c,d,e,f,g,h,k);return this.addCell(b,a)};
mxGraph.prototype.createVertex=function(a,b,c,d,e,f,g,h,k){a=new mxGeometry(d,e,f,g);a.relative=null!=k?k:false;c=new mxCell(c,a,h);c.setId(b);c.setVertex(true);c.setConnectable(true);return c};mxGraph.prototype.insertEdge=function(a,b,c,d,e,f){b=this.createEdge(a,b,c,d,e,f);return this.addEdge(b,a,d,e)};mxGraph.prototype.createEdge=function(a,b,c,d,e,f){a=new mxCell(c,new mxGeometry,f);a.setId(b);a.setEdge(true);a.geometry.relative=true;return a};
mxGraph.prototype.addEdge=function(a,b,c,d,e){return this.addCell(a,b,e,c,d)};mxGraph.prototype.addCell=function(a,b,c,d,e){return this.addCells([a],b,c,d,e)[0]};mxGraph.prototype.addCells=function(a,b,c,d,e){null==b&&(b=this.getDefaultParent());null==c&&(c=this.model.getChildCount(b));this.model.beginUpdate();try{this.cellsAdded(a,b,c,d,e,false,true);this.fireEvent(new mxEventObject(mxEvent.ADD_CELLS,"cells",a,"parent",b,"index",c,"source",d,"target",e))}finally{this.model.endUpdate()}return a};
mxGraph.prototype.cellsAdded=function(a,b,c,d,e,f,g){if(null!=a&&null!=b&&null!=c){this.model.beginUpdate();try{var h=f?this.view.getState(b):null,k=null!=h?h.origin:null,l=new mxPoint(0,0);for(h=0;h<a.length;h++)if(null==a[h])c--;else{var m=this.model.getParent(a[h]);if(null!=k&&a[h]!=b&&b!=m){var p=this.view.getState(m),o=null!=p?p.origin:l,n=this.model.getGeometry(a[h]);if(null!=n){var s=o.x-k.x,t=o.y-k.y;n=n.clone();n.translate(s,t);!n.relative&&this.model.isVertex(a[h])&&!this.isAllowNegativeCoordinates()&&
(n.x=Math.max(0,n.x),n.y=Math.max(0,n.y));this.model.setGeometry(a[h],n)}}b==m&&c+h>this.model.getChildCount(b)&&c--;this.model.add(b,a[h],c+h);this.isExtendParentsOnAdd()&&this.isExtendParent(a[h])&&this.extendParent(a[h]);(null==g||g)&&this.constrainChild(a[h]);null!=d&&this.cellConnected(a[h],d,true);null!=e&&this.cellConnected(a[h],e,false)}this.fireEvent(new mxEventObject(mxEvent.CELLS_ADDED,"cells",a,"parent",b,"index",c,"source",d,"target",e,"absolute",f))}finally{this.model.endUpdate()}}};
mxGraph.prototype.removeCells=function(a,b){b=null!=b?b:true;null==a&&(a=this.getDeletableCells(this.getSelectionCells()));b&&(a=this.getDeletableCells(this.addAllEdges(a)));this.model.beginUpdate();try{this.cellsRemoved(a);this.fireEvent(new mxEventObject(mxEvent.REMOVE_CELLS,"cells",a,"includeEdges",b))}finally{this.model.endUpdate()}return a};
mxGraph.prototype.cellsRemoved=function(a){if(null!=a&&0<a.length){var b=this.view.scale,c=this.view.translate;this.model.beginUpdate();try{for(var d={},e=0;e<a.length;e++){var f=mxCellPath.create(a[e]);d[f]=a[e]}for(e=0;e<a.length;e++){for(var g=this.getConnections(a[e]),h=0;h<g.length;h++)if(f=mxCellPath.create(g[h]),null==d[f]){var k=this.model.getGeometry(g[h]);if(null!=k){var l=this.view.getState(g[h]);if(null!=l){k=k.clone();var m=l.getVisibleTerminal(true)==a[e],p=l.absolutePoints,o=m?0:p.length-
1;k.setTerminalPoint(new mxPoint(p[o].x/b-c.x,p[o].y/b-c.y),m);this.model.setTerminal(g[h],null,m);this.model.setGeometry(g[h],k)}}}this.model.remove(a[e])}this.fireEvent(new mxEventObject(mxEvent.CELLS_REMOVED,"cells",a))}finally{this.model.endUpdate()}}};
mxGraph.prototype.splitEdge=function(a,b,c,d,e){d=d||0;e=e||0;null==c&&(c=this.cloneCells([a])[0]);var f=this.model.getParent(a),g=this.model.getTerminal(a,true);this.model.beginUpdate();try{this.cellsMoved(b,d,e,false,false);this.cellsAdded(b,f,this.model.getChildCount(f),null,null,true);this.cellsAdded([c],f,this.model.getChildCount(f),g,b[0],false);this.cellConnected(a,b[0],true);this.fireEvent(new mxEventObject(mxEvent.SPLIT_EDGE,"edge",a,"cells",b,"newEdge",c,"dx",d,"dy",e))}finally{this.model.endUpdate()}return c};
mxGraph.prototype.toggleCells=function(a,b,c){null==b&&(b=this.getSelectionCells());c&&(b=this.addAllEdges(b));this.model.beginUpdate();try{this.cellsToggled(b,a);this.fireEvent(new mxEventObject(mxEvent.TOGGLE_CELLS,"show",a,"cells",b,"includeEdges",c))}finally{this.model.endUpdate()}return b};mxGraph.prototype.cellsToggled=function(a,b){if(null!=a&&0<a.length){this.model.beginUpdate();try{for(var c=0;c<a.length;c++)this.model.setVisible(a[c],b)}finally{this.model.endUpdate()}}};
mxGraph.prototype.foldCells=function(a,b,c,d){b=null!=b?b:false;null==c&&(c=this.getFoldableCells(this.getSelectionCells(),a));this.stopEditing(false);this.model.beginUpdate();try{this.cellsFolded(c,a,b,d);this.fireEvent(new mxEventObject(mxEvent.FOLD_CELLS,"collapse",a,"recurse",b,"cells",c))}finally{this.model.endUpdate()}return c};
mxGraph.prototype.cellsFolded=function(a,b,c,d){if(null!=a&&0<a.length){this.model.beginUpdate();try{for(var e=0;e<a.length;e++)if((!d||this.isCellFoldable(a[e],b))&&b!=this.isCellCollapsed(a[e]))if(this.model.setCollapsed(a[e],b),this.swapBounds(a[e],b),this.isExtendParent(a[e])&&this.extendParent(a[e]),c)this.foldCells(this.model.getChildren(a[e]),b,c);this.fireEvent(new mxEventObject(mxEvent.CELLS_FOLDED,"cells",a,"collapse",b,"recurse",c))}finally{this.model.endUpdate()}}};
mxGraph.prototype.swapBounds=function(a,b){if(null!=a){var c=this.model.getGeometry(a);null!=c&&(c=c.clone(),this.updateAlternateBounds(a,c,b),c.swap(),this.model.setGeometry(a,c))}};
mxGraph.prototype.updateAlternateBounds=function(a,b,c){if(null!=a&&null!=b){c=this.view.getState(a);c=null!=c?c.style:this.getCellStyle(a);if(null==b.alternateBounds){var d=b;this.collapseToPreferredSize&&(a=this.getPreferredSizeForCell(a),null!=a&&(d=a,a=mxUtils.getValue(c,mxConstants.STYLE_STARTSIZE),0<a&&(d.height=Math.max(d.height,a))));b.alternateBounds=new mxRectangle(0,0,d.width,d.height)}if(null!=b.alternateBounds){b.alternateBounds.x=b.x;b.alternateBounds.y=b.y;var e=mxUtils.toRadians(c[mxConstants.STYLE_ROTATION]||
"0");0!=e&&(a=b.alternateBounds.getCenterX()-b.getCenterX(),c=b.alternateBounds.getCenterY()-b.getCenterY(),d=Math.cos(e),e=Math.sin(e),b.alternateBounds.x+=d*a-e*c-a,b.alternateBounds.y+=e*a+d*c-c)}}};mxGraph.prototype.addAllEdges=function(a){return a.slice().concat(this.getAllEdges(a))};
mxGraph.prototype.getAllEdges=function(a){var b=[];if(null!=a)for(var c=0;c<a.length;c++){for(var d=this.model.getEdgeCount(a[c]),e=0;e<d;e++)b.push(this.model.getEdgeAt(a[c],e));d=this.model.getChildren(a[c]);b=b.concat(this.getAllEdges(d))}return b};mxGraph.prototype.updateCellSize=function(a,b){b=null!=b?b:false;this.model.beginUpdate();try{this.cellSizeUpdated(a,b);this.fireEvent(new mxEventObject(mxEvent.UPDATE_CELL_SIZE,"cell",a,"ignoreChildren",b))}finally{this.model.endUpdate()}return a};
mxGraph.prototype.cellSizeUpdated=function(a,b){if(null!=a){this.model.beginUpdate();try{var c=this.getPreferredSizeForCell(a),d=this.model.getGeometry(a);if(null!=c&&null!=d){var e=this.isCellCollapsed(a);d=d.clone();if(this.isSwimlane(a)){var f=this.view.getState(a),g=null!=f?f.style:this.getCellStyle(a),h=this.model.getStyle(a);null==h&&(h="");mxUtils.getValue(g,mxConstants.STYLE_HORIZONTAL,true)?(h=mxUtils.setStyle(h,mxConstants.STYLE_STARTSIZE,c.height+8),e&&(d.height=c.height+8),d.width=c.width):
(h=mxUtils.setStyle(h,mxConstants.STYLE_STARTSIZE,c.width+8),e&&(d.width=c.width+8),d.height=c.height);this.model.setStyle(a,h)}else{d.width=c.width;d.height=c.height}if(!b&&!e){var k=this.view.getBounds(this.model.getChildren(a));if(null!=k){var l=this.view.translate,m=this.view.scale,p=(k.y+k.height)/m-d.y-l.y;d.width=Math.max(d.width,(k.x+k.width)/m-d.x-l.x);d.height=Math.max(d.height,p)}}this.cellsResized([a],[d])}}finally{this.model.endUpdate()}}};
mxGraph.prototype.getPreferredSizeForCell=function(a){var b=null;if(null!=a){var c=this.view.getState(a),d=null!=c?c.style:this.getCellStyle(a);if(null!=d&&!this.model.isEdge(a)){var e=d[mxConstants.STYLE_FONTSIZE]||mxConstants.DEFAULT_FONTSIZE,f=0;b=0;if((null!=this.getImage(c)||null!=d[mxConstants.STYLE_IMAGE])&&d[mxConstants.STYLE_SHAPE]==mxConstants.SHAPE_LABEL){d[mxConstants.STYLE_VERTICAL_ALIGN]==mxConstants.ALIGN_MIDDLE&&(f+=parseFloat(d[mxConstants.STYLE_IMAGE_WIDTH])||mxLabel.prototype.imageSize);
d[mxConstants.STYLE_ALIGN]!=mxConstants.ALIGN_CENTER&&(b+=parseFloat(d[mxConstants.STYLE_IMAGE_HEIGHT])||mxLabel.prototype.imageSize)}f+=2*(d[mxConstants.STYLE_SPACING]||0);f+=d[mxConstants.STYLE_SPACING_LEFT]||0;f+=d[mxConstants.STYLE_SPACING_RIGHT]||0;b+=2*(d[mxConstants.STYLE_SPACING]||0);b+=d[mxConstants.STYLE_SPACING_TOP]||0;b+=d[mxConstants.STYLE_SPACING_BOTTOM]||0;c=this.getFoldingImage(c);null!=c&&(f+=c.width+8);c=this.getLabel(a);null!=c&&0<c.length?(this.isHtmlLabel(a)||(c=c.replace(/\n/g,
"<br>")),e=mxUtils.getSizeForString(c,e,d[mxConstants.STYLE_FONTFAMILY]),a=e.width+f,b=e.height+b,mxUtils.getValue(d,mxConstants.STYLE_HORIZONTAL,true)||(d=b,b=a,a=d),this.gridEnabled&&(a=this.snap(a+this.gridSize/2),b=this.snap(b+this.gridSize/2)),b=new mxRectangle(0,0,a,b)):(d=4*this.gridSize,b=new mxRectangle(0,0,d,d))}}return b};
mxGraph.prototype.handleGesture=function(a,b){if(this.isEnabled()&&this.isCellResizable(a.cell)&&0.2<Math.abs(1-b.scale)){var c=this.view.scale,d=this.view.translate,e=a.width*b.scale,f=a.height*b.scale,g=a.y-(f-a.height)/2;c=new mxRectangle(this.snap((a.x-(e-a.width)/2)/c)-d.x,this.snap(g/c)-d.y,this.snap(e/c),this.snap(f/c));this.resizeCell(a.cell,c)}};mxGraph.prototype.resizeCell=function(a,b){return this.resizeCells([a],[b])[0]};
mxGraph.prototype.resizeCells=function(a,b){this.model.beginUpdate();try{this.cellsResized(a,b);this.fireEvent(new mxEventObject(mxEvent.RESIZE_CELLS,"cells",a,"bounds",b))}finally{this.model.endUpdate()}return a};
mxGraph.prototype.cellsResized=function(a,b){if(null!=a&&null!=b&&a.length==b.length){this.model.beginUpdate();try{for(var c=0;c<a.length;c++){var d=b[c],e=this.model.getGeometry(a[c]);if(null!=e&&(e.x!=d.x||e.y!=d.y||e.width!=d.width||e.height!=d.height)){e=e.clone();if(e.relative){var f=e.offset;null!=f&&(f.x+=d.x-e.x,f.y+=d.y-e.y)}else{e.x=d.x;e.y=d.y}e.width=d.width;e.height=d.height;!e.relative&&this.model.isVertex(a[c])&&!this.isAllowNegativeCoordinates()&&(e.x=Math.max(0,e.x),e.y=Math.max(0,
e.y));this.model.setGeometry(a[c],e);this.isExtendParent(a[c])&&this.extendParent(a[c])}}this.resetEdgesOnResize&&this.resetEdges(a);this.fireEvent(new mxEventObject(mxEvent.CELLS_RESIZED,"cells",a,"bounds",b))}finally{this.model.endUpdate()}}};
mxGraph.prototype.extendParent=function(a){if(null!=a){var b=this.model.getParent(a),c=this.model.getGeometry(b);if(null!=b&&null!=c&&!this.isCellCollapsed(b)&&(a=this.model.getGeometry(a),null!=a&&(c.width<a.x+a.width||c.height<a.y+a.height))){c=c.clone();c.width=Math.max(c.width,a.x+a.width);c.height=Math.max(c.height,a.y+a.height);this.cellsResized([b],[c])}}};mxGraph.prototype.importCells=function(a,b,c,d,e){return this.moveCells(a,b,c,true,d,e)};
mxGraph.prototype.moveCells=function(a,b,c,d,e,f){b=null!=b?b:0;c=null!=c?c:0;d=null!=d?d:false;if(null!=a&&(0!=b||0!=c||d||null!=e)){this.model.beginUpdate();try{d&&(a=this.cloneCells(a,this.isCloneInvalidEdges()),null==e&&(e=this.getDefaultParent()));var g=this.isAllowNegativeCoordinates();null!=e&&this.setAllowNegativeCoordinates(true);this.cellsMoved(a,b,c,!d&&this.isDisconnectOnMove()&&this.isAllowDanglingEdges(),null==e);this.setAllowNegativeCoordinates(g);if(null!=e){var h=this.model.getChildCount(e);
this.cellsAdded(a,e,h,null,null,true)}this.fireEvent(new mxEventObject(mxEvent.MOVE_CELLS,"cells",a,"dx",b,"dy",c,"clone",d,"target",e,"event",f))}finally{this.model.endUpdate()}}return a};
mxGraph.prototype.cellsMoved=function(a,b,c,d,e){if(null!=a&&(0!=b||0!=c)){this.model.beginUpdate();try{d&&this.disconnectGraph(a);for(var f=0;f<a.length;f++){this.translateCell(a[f],b,c);e&&this.constrainChild(a[f])}this.resetEdgesOnMove&&this.resetEdges(a);this.fireEvent(new mxEventObject(mxEvent.CELLS_MOVED,"cells",a,"dx",c,"dy",c,"disconnect",d))}finally{this.model.endUpdate()}}};
mxGraph.prototype.translateCell=function(a,b,c){var d=this.model.getGeometry(a);null!=d&&(d=d.clone(),d.translate(b,c),!d.relative&&this.model.isVertex(a)&&!this.isAllowNegativeCoordinates()&&(d.x=Math.max(0,d.x),d.y=Math.max(0,d.y)),d.relative&&!this.model.isEdge(a)&&(null==d.offset?d.offset=new mxPoint(b,c):(d.offset.x+=b,d.offset.y+=c)),this.model.setGeometry(a,d))};
mxGraph.prototype.getCellContainmentArea=function(a){if(null!=a&&!this.model.isEdge(a)){var b=this.model.getParent(a);if(b==this.getDefaultParent()||b==this.getCurrentRoot())return this.getMaximumGraphBounds();if(null!=b&&b!=this.getDefaultParent()){var c=this.model.getGeometry(b);if(null!=c){var d=a=0,e=c.width;c=c.height;this.isSwimlane(b)&&(b=this.getStartSize(b),a=b.width,e-=b.width,d=b.height,c-=b.height);return new mxRectangle(a,d,e,c)}}}return null};
mxGraph.prototype.getMaximumGraphBounds=function(){return this.maximumGraphBounds};
mxGraph.prototype.constrainChild=function(a){if(null!=a){var b=this.model.getGeometry(a),c=this.isConstrainChild(a)?this.getCellContainmentArea(a):this.getMaximumGraphBounds();if(null!=b&&null!=c&&!b.relative&&(b.x<c.x||b.y<c.y||c.width<b.x+b.width||c.height<b.y+b.height)){a=this.getOverlap(a);0<c.width&&(b.x=Math.min(b.x,c.x+c.width-(1-a)*b.width));0<c.height&&(b.y=Math.min(b.y,c.y+c.height-(1-a)*b.height));b.x=Math.max(b.x,c.x-b.width*a);b.y=Math.max(b.y,c.y-b.height*a)}}};
mxGraph.prototype.resetEdges=function(a){if(null!=a){for(var b={},c=0;c<a.length;c++){var d=mxCellPath.create(a[c]);b[d]=a[c]}this.model.beginUpdate();try{for(c=0;c<a.length;c++){var e=this.model.getEdges(a[c]);if(null!=e)for(d=0;d<e.length;d++){var f=this.view.getState(e[d]),g=null!=f?f.getVisibleTerminal(true):this.view.getVisibleTerminal(e[d],true),h=null!=f?f.getVisibleTerminal(false):this.view.getVisibleTerminal(e[d],false),k=mxCellPath.create(g),l=mxCellPath.create(h);(null==b[k]||null==b[l])&&
this.resetEdge(e[d])}this.resetEdges(this.model.getChildren(a[c]))}}finally{this.model.endUpdate()}}};mxGraph.prototype.resetEdge=function(a){var b=this.model.getGeometry(a);null!=b&&null!=b.points&&0<b.points.length&&(b=b.clone(),b.points=[],this.model.setGeometry(a,b));return a};mxGraph.prototype.getAllConnectionConstraints=function(a){return null!=a&&null!=a.shape&&null!=a.shape.stencil?a.shape.stencil.constraints:null};
mxGraph.prototype.getConnectionConstraint=function(a,b,c){b=null;var d=a.style[c?mxConstants.STYLE_EXIT_X:mxConstants.STYLE_ENTRY_X];if(null!=d){var e=a.style[c?mxConstants.STYLE_EXIT_Y:mxConstants.STYLE_ENTRY_Y];null!=e&&(b=new mxPoint(parseFloat(d),parseFloat(e)))}d=false;null!=b&&(d=mxUtils.getValue(a.style,c?mxConstants.STYLE_EXIT_PERIMETER:mxConstants.STYLE_ENTRY_PERIMETER,true));return new mxConnectionConstraint(b,d)};
mxGraph.prototype.setConnectionConstraint=function(a,b,c,d){if(null!=d){this.model.beginUpdate();try{null==d||null==d.point?(this.setCellStyles(c?mxConstants.STYLE_EXIT_X:mxConstants.STYLE_ENTRY_X,null,[a]),this.setCellStyles(c?mxConstants.STYLE_EXIT_Y:mxConstants.STYLE_ENTRY_Y,null,[a]),this.setCellStyles(c?mxConstants.STYLE_EXIT_PERIMETER:mxConstants.STYLE_ENTRY_PERIMETER,null,[a])):null!=d.point&&(this.setCellStyles(c?mxConstants.STYLE_EXIT_X:mxConstants.STYLE_ENTRY_X,d.point.x,[a]),this.setCellStyles(c?
mxConstants.STYLE_EXIT_Y:mxConstants.STYLE_ENTRY_Y,d.point.y,[a]),d.perimeter?this.setCellStyles(c?mxConstants.STYLE_EXIT_PERIMETER:mxConstants.STYLE_ENTRY_PERIMETER,null,[a]):this.setCellStyles(c?mxConstants.STYLE_EXIT_PERIMETER:mxConstants.STYLE_ENTRY_PERIMETER,"0",[a]))}finally{this.model.endUpdate()}}};
mxGraph.prototype.getConnectionPoint=function(a,b){var c=null;if(null!=a){var d=this.view.getPerimeterBounds(a),e=new mxPoint(d.getCenterX(),d.getCenterY()),f=a.style[mxConstants.STYLE_DIRECTION],g=0;if(null!=f&&("north"==f?g+=270:"west"==f?g+=180:"south"==f&&(g+=90),"north"==f||"south"==f)){d.x+=d.width/2-d.height/2;d.y+=d.height/2-d.width/2;var h=d.width;d.width=d.height;d.height=h}if(null!=b.point){var k=c=1,l=0,m=0;if(this.getModel().isVertex(a.cell)){var p=a.style[mxConstants.STYLE_FLIPH],o=
a.style[mxConstants.STYLE_FLIPV];null!=a.shape.stencil&&(p=1==mxUtils.getValue(a.style,"stencilFlipH",0)||p,o=1==mxUtils.getValue(a.style,"stencilFlipV",0)||o);if("north"==f||"south"==f){h=p;p=o;o=h}p&&(c=-1,l=-d.width);o&&(k=-1,m=-d.height)}c=new mxPoint(d.x+b.point.x*d.width*c-l,d.y+b.point.y*d.height*k-m)}f=a.style[mxConstants.STYLE_ROTATION]||0;b.perimeter?(0!=g&&null!=c&&(h=d=0,90==g?h=1:180==g?d=-1:270==f&&(h=-1),c=mxUtils.getRotatedPoint(c,d,h,e)),null!=c&&b.perimeter&&(c=this.view.getPerimeterPoint(a,
c,false))):f+=g;0!=f&&null!=c&&(g=mxUtils.toRadians(f),d=Math.cos(g),h=Math.sin(g),c=mxUtils.getRotatedPoint(c,d,h,e))}return c};mxGraph.prototype.connectCell=function(a,b,c,d){this.model.beginUpdate();try{var e=this.model.getTerminal(a,c);this.cellConnected(a,b,c,d);this.fireEvent(new mxEventObject(mxEvent.CONNECT_CELL,"edge",a,"terminal",b,"source",c,"previous",e))}finally{this.model.endUpdate()}return a};
mxGraph.prototype.cellConnected=function(a,b,c,d){if(null!=a){this.model.beginUpdate();try{var e=this.model.getTerminal(a,c);this.setConnectionConstraint(a,b,c,d);this.isPortsEnabled()&&(this.isPort(b)&&(d=b.getId(),b=this.getTerminalForPort(b,c)),this.setCellStyles(c?mxConstants.STYLE_SOURCE_PORT:mxConstants.STYLE_TARGET_PORT,d,[a]));this.model.setTerminal(a,b,c);this.resetEdgesOnConnect&&this.resetEdge(a);this.fireEvent(new mxEventObject(mxEvent.CELL_CONNECTED,"edge",a,"terminal",b,"source",c,"previous",
e))}finally{this.model.endUpdate()}}};
mxGraph.prototype.disconnectGraph=function(a){if(null!=a){this.model.beginUpdate();try{for(var b=this.view.scale,c=this.view.translate,d={},e=0;e<a.length;e++){var f=mxCellPath.create(a[e]);d[f]=a[e]}for(e=0;e<a.length;e++)if(this.model.isEdge(a[e])){var g=this.model.getGeometry(a[e]);if(null!=g){var h=this.view.getState(a[e]),k=this.view.getState(this.model.getParent(a[e]));if(null!=h&&null!=k){g=g.clone();var l=-k.origin.x,m=-k.origin.y,p=h.absolutePoints,o=this.model.getTerminal(a[e],true);if(null!=
o&&this.isCellDisconnectable(a[e],o,true)){for(var n=mxCellPath.create(o);null!=o&&null==d[n];){o=this.model.getParent(o);n=mxCellPath.create(o)}null==o&&(g.setTerminalPoint(new mxPoint(p[0].x/b-c.x+l,p[0].y/b-c.y+m),true),this.model.setTerminal(a[e],null,true))}var s=this.model.getTerminal(a[e],false);if(null!=s&&this.isCellDisconnectable(a[e],s,false)){for(var t=mxCellPath.create(s);null!=s&&null==d[t];){s=this.model.getParent(s);t=mxCellPath.create(s)}if(null==s){var q=p.length-1;g.setTerminalPoint(new mxPoint(p[q].x/
b-c.x+l,p[q].y/b-c.y+m),false);this.model.setTerminal(a[e],null,false)}}this.model.setGeometry(a[e],g)}}}}finally{this.model.endUpdate()}}};mxGraph.prototype.getCurrentRoot=function(){return this.view.currentRoot};mxGraph.prototype.getTranslateForRoot=function(){return null};mxGraph.prototype.isPort=function(){return false};mxGraph.prototype.getTerminalForPort=function(a){return this.model.getParent(a)};mxGraph.prototype.getChildOffsetForCell=function(){return null};
mxGraph.prototype.enterGroup=function(a){a=a||this.getSelectionCell();null!=a&&this.isValidRoot(a)&&(this.view.setCurrentRoot(a),this.clearSelection())};mxGraph.prototype.exitGroup=function(){var a=this.model.getRoot(),b=this.getCurrentRoot();if(null!=b){for(var c=this.model.getParent(b);c!=a&&!this.isValidRoot(c)&&this.model.getParent(c)!=a;)c=this.model.getParent(c);c==a||this.model.getParent(c)==a?this.view.setCurrentRoot(null):this.view.setCurrentRoot(c);null!=this.view.getState(b)&&this.setSelectionCell(b)}};
mxGraph.prototype.home=function(){var a=this.getCurrentRoot();null!=a&&(this.view.setCurrentRoot(null),null!=this.view.getState(a)&&this.setSelectionCell(a))};mxGraph.prototype.isValidRoot=function(a){return null!=a};mxGraph.prototype.getGraphBounds=function(){return this.view.getGraphBounds()};
mxGraph.prototype.getCellBounds=function(a,b,c){var d=[a];b&&(d=d.concat(this.model.getEdges(a)));d=this.view.getBounds(d);if(c){c=this.model.getChildCount(a);for(var e=0;e<c;e++){var f=this.getCellBounds(this.model.getChildAt(a,e),b,true);null!=d?d.add(f):d=f}}return d};
mxGraph.prototype.getBoundingBoxFromGeometry=function(a,b){b=null!=b?b:false;var c=null;if(null!=a)for(var d=0;d<a.length;d++)if(b||this.model.isVertex(a[d])){var e=this.getCellGeometry(a[d]);if(null!=e){var f=e.points;if(null!=f&&0<f.length){for(var g=new mxRectangle(f[0].x,f[0].y,0,0),h=function(l){null!=l&&g.add(new mxRectangle(l.x,l.y,0,0))},k=1;k<f.length;k++)h(f[k]);h(e.getTerminalPoint(true));h(e.getTerminalPoint(false))}null==c?c=new mxRectangle(e.x,e.y,e.width,e.height):c.add(e)}}return c};
mxGraph.prototype.refresh=function(a){this.view.clear(a,null==a);this.view.validate();this.sizeDidChange();this.fireEvent(new mxEventObject(mxEvent.REFRESH))};mxGraph.prototype.snap=function(a){this.gridEnabled&&(a=Math.round(a/this.gridSize)*this.gridSize);return a};
mxGraph.prototype.panGraph=function(a,b){if(this.useScrollbarsForPanning&&mxUtils.hasScrollbars(this.container)){this.container.scrollLeft=-a;this.container.scrollTop=-b}else{var c=this.view.getCanvas();if(this.dialect==mxConstants.DIALECT_SVG)if(0==a&&0==b){if(mxClient.IS_IE?c.setAttribute("transform","translate("+a+","+b+")"):c.removeAttribute("transform"),null!=this.shiftPreview1){for(var d=this.shiftPreview1.firstChild;null!=d;){var e=d.nextSibling;this.container.appendChild(d);d=e}this.shiftPreview1.parentNode.removeChild(this.shiftPreview1);
this.shiftPreview1=null;this.container.appendChild(c.parentNode);for(d=this.shiftPreview2.firstChild;null!=d;){e=d.nextSibling;this.container.appendChild(d);d=e}this.shiftPreview2.parentNode.removeChild(this.shiftPreview2);this.shiftPreview2=null}}else{c.setAttribute("transform","translate("+a+","+b+")");if(null==this.shiftPreview1){this.shiftPreview1=document.createElement("div");this.shiftPreview1.style.position="absolute";this.shiftPreview1.style.overflow="visible";this.shiftPreview2=document.createElement("div");
this.shiftPreview2.style.position="absolute";this.shiftPreview2.style.overflow="visible";var f=this.shiftPreview1;for(d=this.container.firstChild;null!=d;){e=d.nextSibling;d!=c.parentNode?f.appendChild(d):f=this.shiftPreview2;d=e}this.container.insertBefore(this.shiftPreview1,c.parentNode);this.container.appendChild(this.shiftPreview2)}this.shiftPreview1.style.left=a+"px";this.shiftPreview1.style.top=b+"px";this.shiftPreview2.style.left=a+"px";this.shiftPreview2.style.top=b+"px"}else{c.style.left=
a+"px";c.style.top=b+"px"}this.panDx=a;this.panDy=b;this.fireEvent(new mxEventObject(mxEvent.PAN))}};mxGraph.prototype.zoomIn=function(){this.zoom(this.zoomFactor)};mxGraph.prototype.zoomOut=function(){this.zoom(1/this.zoomFactor)};mxGraph.prototype.zoomActual=function(){1==this.view.scale?this.view.setTranslate(0,0):(this.view.translate.x=0,this.view.translate.y=0,this.view.setScale(1))};mxGraph.prototype.zoomTo=function(a,b){this.zoom(a/this.view.scale,b)};
mxGraph.prototype.zoom=function(a,b){b=null!=b?b:this.centerZoom;var c=this.view.scale*a,d=this.view.getState(this.getSelectionCell());if(this.keepSelectionVisibleOnZoom&&null!=d){d=new mxRectangle(d.x*a,d.y*a,d.width*a,d.height*a);this.view.scale=c;this.scrollRectToVisible(d)||(this.view.revalidate(),this.view.setScale(c))}else if(b&&!mxUtils.hasScrollbars(this.container)){d=this.container.offsetWidth;var e=this.container.offsetHeight;if(1<a){var f=(a-1)/(2*c);d*=-f;e*=-f}else{f=(1/a-1)/(2*this.view.scale);
d*=f;e*=f}this.view.scaleAndTranslate(c,this.view.translate.x+d,this.view.translate.y+e)}else{this.view.setScale(c);mxUtils.hasScrollbars(this.container)&&(b&&(d=this.container.offsetWidth*(a-1)/2,e=this.container.offsetHeight*(a-1)/2),this.container.scrollLeft=Math.round(this.container.scrollLeft*a+d),this.container.scrollTop=Math.round(this.container.scrollTop*a+e))}};
mxGraph.prototype.zoomToRect=function(a){var b=this.container.clientWidth/a.width/(this.container.clientHeight/a.height);a.x=Math.max(0,a.x);a.y=Math.max(0,a.y);var c=Math.min(this.container.scrollWidth,a.x+a.width),d=Math.min(this.container.scrollHeight,a.y+a.height);a.width=c-a.x;a.height=d-a.y;1>b?(b=a.height/b,c=(b-a.height)/2,a.height=b,b=Math.min(a.y,c),a.y-=b,d=Math.min(this.container.scrollHeight,a.y+a.height),a.height=d-a.y):(b*=a.width,c=(b-a.width)/2,a.width=b,b=Math.min(a.x,c),a.x-=b,
c=Math.min(this.container.scrollWidth,a.x+a.width),a.width=c-a.x);b=this.container.clientWidth/a.width;c=this.view.scale*b;mxUtils.hasScrollbars(this.container)?(this.view.setScale(c),this.container.scrollLeft=Math.round(a.x*b),this.container.scrollTop=Math.round(a.y*b)):this.view.scaleAndTranslate(c,this.view.translate.x-a.x/this.view.scale,this.view.translate.y-a.y/this.view.scale)};
mxGraph.prototype.fit=function(a,b){if(null!=this.container){a=null!=a?a:0;b=null!=b?b:false;var c=this.container.clientWidth,d=this.container.clientHeight,e=this.view.getGraphBounds();b&&null!=e.x&&null!=e.y&&(e.width+=e.x,e.height+=e.y,e.x=0,e.y=0);var f=this.view.scale,g=e.width/f,h=e.height/f;null!=this.backgroundImage&&(g=Math.max(g,this.backgroundImage.width-e.x/f),h=Math.max(h,this.backgroundImage.height-e.y/f));var k=b?a:2*a;c=Math.floor(100*Math.min(c/(g+k),d/(h+k)))/100;null!=this.minFitScale&&
(c=Math.max(c,this.minFitScale));null!=this.maxFitScale&&(c=Math.min(c,this.maxFitScale));b?this.view.scale!=c&&this.view.setScale(c):mxUtils.hasScrollbars(this.container)?(this.view.setScale(c),null!=e.x&&(this.container.scrollLeft=Math.round(e.x/f)*c-a-Math.max(0,(this.container.clientWidth-g*c)/2)),null!=e.y&&(this.container.scrollTop=Math.round(e.y/f)*c-a-Math.max(0,(this.container.clientHeight-h*c)/2))):this.view.scaleAndTranslate(c,null!=e.x?Math.floor(this.view.translate.x-e.x/f+a+1):a,null!=
e.y?Math.floor(this.view.translate.y-e.y/f+a+1):a)}return this.view.scale};mxGraph.prototype.scrollCellToVisible=function(a,b){var c=-this.view.translate.x,d=-this.view.translate.y,e=this.view.getState(a);null!=e&&(c=new mxRectangle(c+e.x,d+e.y,e.width,e.height),b&&null!=this.container&&(d=this.container.clientWidth,e=this.container.clientHeight,c.x=c.getCenterX()-d/2,c.width=d,c.y=c.getCenterY()-e/2,c.height=e),this.scrollRectToVisible(c)&&this.view.setTranslate(this.view.translate.x,this.view.translate.y))};
mxGraph.prototype.scrollRectToVisible=function(a){var b=false;if(null!=a){var c=this.container.offsetWidth,d=this.container.offsetHeight,e=Math.min(c,a.width),f=Math.min(d,a.height);if(mxUtils.hasScrollbars(this.container)){c=this.container;a.x+=this.view.translate.x;a.y+=this.view.translate.y;var g=c.scrollLeft-a.x;d=Math.max(g-c.scrollLeft,0);0<g?c.scrollLeft-=g+2:(g=a.x+e-c.scrollLeft-c.clientWidth,0<g&&(c.scrollLeft+=g+2));e=c.scrollTop-a.y;g=Math.max(0,e-c.scrollTop);0<e?c.scrollTop-=e+2:(e=
a.y+f-c.scrollTop-c.clientHeight,0<e&&(c.scrollTop+=e+2));!this.useScrollbarsForPanning&&(0!=d||0!=g)&&this.view.setTranslate(d,g)}else{g=-this.view.translate.x;var h=-this.view.translate.y,k=this.view.scale;a.x+e>g+c&&(this.view.translate.x-=(a.x+e-c-g)/k,b=true);a.y+f>h+d&&(this.view.translate.y-=(a.y+f-d-h)/k,b=true);a.x<g&&(this.view.translate.x+=(g-a.x)/k,b=true);a.y<h&&(this.view.translate.y+=(h-a.y)/k,b=true);b&&(this.view.refresh(),null!=this.selectionCellsHandler&&this.selectionCellsHandler.refresh())}}return b};
mxGraph.prototype.getCellGeometry=function(a){return this.model.getGeometry(a)};mxGraph.prototype.isCellVisible=function(a){return this.model.isVisible(a)};mxGraph.prototype.isCellCollapsed=function(a){return this.model.isCollapsed(a)};mxGraph.prototype.isCellConnectable=function(a){return this.model.isConnectable(a)};
mxGraph.prototype.isOrthogonal=function(a){var b=a.style[mxConstants.STYLE_ORTHOGONAL];if(null!=b)return b;a=this.view.getEdgeStyle(a);return a==mxEdgeStyle.SegmentConnector||a==mxEdgeStyle.ElbowConnector||a==mxEdgeStyle.SideToSide||a==mxEdgeStyle.TopToBottom||a==mxEdgeStyle.EntityRelation||a==mxEdgeStyle.OrthConnector};mxGraph.prototype.isLoop=function(a){var b=a.getVisibleTerminalState(true);a=a.getVisibleTerminalState(false);return null!=b&&b==a};mxGraph.prototype.isCloneEvent=function(a){return mxEvent.isControlDown(a)};
mxGraph.prototype.isToggleEvent=function(a){return mxClient.IS_MAC?mxEvent.isMetaDown(a):mxEvent.isControlDown(a)};mxGraph.prototype.isGridEnabledEvent=function(a){return null!=a&&!mxEvent.isAltDown(a)};mxGraph.prototype.isConstrainedEvent=function(a){return mxEvent.isShiftDown(a)};mxGraph.prototype.isForceMarqueeEvent=function(a){return mxEvent.isAltDown(a)};mxGraph.prototype.validationAlert=function(a){mxUtils.alert(a)};
mxGraph.prototype.isEdgeValid=function(a,b,c){return null==this.getEdgeValidationError(a,b,c)};
mxGraph.prototype.getEdgeValidationError=function(a,b,c){if(null!=a&&!this.isAllowDanglingEdges()&&(null==b||null==c))return"";if(null!=a&&null==this.model.getTerminal(a,true)&&null==this.model.getTerminal(a,false))return null;if(!this.allowLoops&&b==c&&null!=b||!this.isValidConnection(b,c))return"";if(null!=b&&null!=c){var d="";if(!this.multigraph){var e=this.model.getEdgesBetween(b,c,true);if(1<e.length||1==e.length&&e[0]!=a)d+=(mxResources.get(this.alreadyConnectedResource)||this.alreadyConnectedResource)+
"\n"}e=this.model.getDirectedEdgeCount(b,true,a);var f=this.model.getDirectedEdgeCount(c,false,a);if(null!=this.multiplicities)for(var g=0;g<this.multiplicities.length;g++){var h=this.multiplicities[g].check(this,a,b,c,e,f);null!=h&&(d+=h)}h=this.validateEdge(a,b,c);null!=h&&(d+=h);return 0<d.length?d:null}return this.allowDanglingEdges?null:""};mxGraph.prototype.validateEdge=function(){return null};
mxGraph.prototype.validateGraph=function(a,b){a=null!=a?a:this.model.getRoot();b=null!=b?b:{};for(var c=true,d=this.model.getChildCount(a),e=0;e<d;e++){var f=this.model.getChildAt(a,e),g=b;this.isValidRoot(f)&&(g={});g=this.validateGraph(f,g);null!=g?this.setCellWarning(f,g.replace(/\n/g,"<br>")):this.setCellWarning(f,null);c=c&&null==g}d="";this.isCellCollapsed(a)&&!c&&(d+=(mxResources.get(this.containsValidationErrorsResource)||this.containsValidationErrorsResource)+"\n");d=this.model.isEdge(a)?
d+(this.getEdgeValidationError(a,this.model.getTerminal(a,true),this.model.getTerminal(a,false))||""):d+(this.getCellValidationError(a)||"");e=this.validateCell(a,b);null!=e&&(d+=e);null==this.model.getParent(a)&&this.view.validate();return 0<d.length||!c?d:null};
mxGraph.prototype.getCellValidationError=function(a){var b=this.model.getDirectedEdgeCount(a,true),c=this.model.getDirectedEdgeCount(a,false);a=this.model.getValue(a);var d="";if(null!=this.multiplicities)for(var e=0;e<this.multiplicities.length;e++){var f=this.multiplicities[e];if(f.source&&mxUtils.isNode(a,f.type,f.attr,f.value)&&(0==f.max&&0<b||1==f.min&&0==b||1==f.max&&1<b))d+=f.countError+"\n";else if(!f.source&&mxUtils.isNode(a,f.type,f.attr,f.value)&&(0==f.max&&0<c||1==f.min&&0==c||1==f.max&&
1<c))d+=f.countError+"\n"}return 0<d.length?d:null};mxGraph.prototype.validateCell=function(){return null};mxGraph.prototype.getBackgroundImage=function(){return this.backgroundImage};mxGraph.prototype.setBackgroundImage=function(a){this.backgroundImage=a};mxGraph.prototype.getFoldingImage=function(a){if(null!=a&&this.foldingEnabled&&!this.getModel().isEdge(a.cell)){var b=this.isCellCollapsed(a.cell);if(this.isCellFoldable(a.cell,!b))return b?this.collapsedImage:this.expandedImage}return null};
mxGraph.prototype.convertValueToString=function(a){a=this.model.getValue(a);if(null!=a){if(mxUtils.isNode(a))return a.nodeName;if("function"==typeof a.toString)return a.toString()}return""};mxGraph.prototype.getLabel=function(a){var b="";if(this.labelsVisible&&null!=a){var c=this.view.getState(a);c=null!=c?c.style:this.getCellStyle(a);mxUtils.getValue(c,mxConstants.STYLE_NOLABEL,false)||(b=this.convertValueToString(a))}return b};mxGraph.prototype.isHtmlLabel=function(){return this.isHtmlLabels()};
mxGraph.prototype.isHtmlLabels=function(){return this.htmlLabels};mxGraph.prototype.setHtmlLabels=function(a){this.htmlLabels=a};mxGraph.prototype.isWrapping=function(a){var b=this.view.getState(a);a=null!=b?b.style:this.getCellStyle(a);return null!=a?"wrap"==a[mxConstants.STYLE_WHITE_SPACE]:false};mxGraph.prototype.isLabelClipped=function(a){var b=this.view.getState(a);a=null!=b?b.style:this.getCellStyle(a);return null!=a?"hidden"==a[mxConstants.STYLE_OVERFLOW]:false};
mxGraph.prototype.getTooltip=function(a,b,c){var d=null;if(null!=a){if(null!=a.control&&(b==a.control.node||b.parentNode==a.control.node)){d=this.collapseExpandResource;d=mxResources.get(d)||d}null==d&&null!=a.overlays&&a.overlays.visit(function(e,f){if(null==d&&(b==f.node||b.parentNode==f.node))d=f.overlay.toString()});null==d&&(c=this.selectionCellsHandler.getHandler(a.cell),null!=c&&"function"==typeof c.getTooltipForNode&&(d=c.getTooltipForNode(b)));null==d&&(d=this.getTooltipForCell(a.cell))}return d};
mxGraph.prototype.getTooltipForCell=function(a){return null!=a&&null!=a.getTooltip?a.getTooltip():this.convertValueToString(a)};mxGraph.prototype.getCursorForCell=function(){return null};mxGraph.prototype.getStartSize=function(a){var b=new mxRectangle,c=this.view.getState(a);a=null!=c?c.style:this.getCellStyle(a);null!=a&&(c=parseInt(mxUtils.getValue(a,mxConstants.STYLE_STARTSIZE,mxConstants.DEFAULT_STARTSIZE)),mxUtils.getValue(a,mxConstants.STYLE_HORIZONTAL,true)?b.height=c:b.width=c);return b};
mxGraph.prototype.getImage=function(a){return null!=a&&null!=a.style?a.style[mxConstants.STYLE_IMAGE]:null};mxGraph.prototype.getVerticalAlign=function(a){return null!=a&&null!=a.style?a.style[mxConstants.STYLE_VERTICAL_ALIGN]||mxConstants.ALIGN_MIDDLE:null};mxGraph.prototype.getIndicatorColor=function(a){return null!=a&&null!=a.style?a.style[mxConstants.STYLE_INDICATOR_COLOR]:null};
mxGraph.prototype.getIndicatorGradientColor=function(a){return null!=a&&null!=a.style?a.style[mxConstants.STYLE_INDICATOR_GRADIENTCOLOR]:null};mxGraph.prototype.getIndicatorShape=function(a){return null!=a&&null!=a.style?a.style[mxConstants.STYLE_INDICATOR_SHAPE]:null};mxGraph.prototype.getIndicatorImage=function(a){return null!=a&&null!=a.style?a.style[mxConstants.STYLE_INDICATOR_IMAGE]:null};mxGraph.prototype.getBorder=function(){return this.border};
mxGraph.prototype.setBorder=function(a){this.border=a};mxGraph.prototype.isSwimlane=function(a){if(null!=a&&this.model.getParent(a)!=this.model.getRoot()){var b=this.view.getState(a);b=null!=b?b.style:this.getCellStyle(a);if(null!=b&&!this.model.isEdge(a))return b[mxConstants.STYLE_SHAPE]==mxConstants.SHAPE_SWIMLANE}return false};mxGraph.prototype.isResizeContainer=function(){return this.resizeContainer};mxGraph.prototype.setResizeContainer=function(a){this.resizeContainer=a};
mxGraph.prototype.isEnabled=function(){return this.enabled};mxGraph.prototype.setEnabled=function(a){this.enabled=a};mxGraph.prototype.isEscapeEnabled=function(){return this.escapeEnabled};mxGraph.prototype.setEscapeEnabled=function(a){this.escapeEnabled=a};mxGraph.prototype.isInvokesStopCellEditing=function(){return this.invokesStopCellEditing};mxGraph.prototype.setInvokesStopCellEditing=function(a){this.invokesStopCellEditing=a};mxGraph.prototype.isEnterStopsCellEditing=function(){return this.enterStopsCellEditing};
mxGraph.prototype.setEnterStopsCellEditing=function(a){this.enterStopsCellEditing=a};mxGraph.prototype.isCellLocked=function(a){var b=this.model.getGeometry(a);return this.isCellsLocked()||null!=b&&this.model.isVertex(a)&&b.relative};mxGraph.prototype.isCellsLocked=function(){return this.cellsLocked};mxGraph.prototype.setCellsLocked=function(a){this.cellsLocked=a};mxGraph.prototype.getCloneableCells=function(a){return this.model.filterCells(a,mxUtils.bind(this,function(b){return this.isCellCloneable(b)}))};
mxGraph.prototype.isCellCloneable=function(a){var b=this.view.getState(a);a=null!=b?b.style:this.getCellStyle(a);return this.isCellsCloneable()&&0!=a[mxConstants.STYLE_CLONEABLE]};mxGraph.prototype.isCellsCloneable=function(){return this.cellsCloneable};mxGraph.prototype.setCellsCloneable=function(a){this.cellsCloneable=a};mxGraph.prototype.getExportableCells=function(a){return this.model.filterCells(a,mxUtils.bind(this,function(b){return this.canExportCell(b)}))};
mxGraph.prototype.canExportCell=function(){return this.exportEnabled};mxGraph.prototype.getImportableCells=function(a){return this.model.filterCells(a,mxUtils.bind(this,function(b){return this.canImportCell(b)}))};mxGraph.prototype.canImportCell=function(){return this.importEnabled};mxGraph.prototype.isCellSelectable=function(){return this.isCellsSelectable()};mxGraph.prototype.isCellsSelectable=function(){return this.cellsSelectable};
mxGraph.prototype.setCellsSelectable=function(a){this.cellsSelectable=a};mxGraph.prototype.getDeletableCells=function(a){return this.model.filterCells(a,mxUtils.bind(this,function(b){return this.isCellDeletable(b)}))};mxGraph.prototype.isCellDeletable=function(a){var b=this.view.getState(a);a=null!=b?b.style:this.getCellStyle(a);return this.isCellsDeletable()&&0!=a[mxConstants.STYLE_DELETABLE]};mxGraph.prototype.isCellsDeletable=function(){return this.cellsDeletable};
mxGraph.prototype.setCellsDeletable=function(a){this.cellsDeletable=a};mxGraph.prototype.isLabelMovable=function(a){return!this.isCellLocked(a)&&(this.model.isEdge(a)&&this.edgeLabelsMovable||this.model.isVertex(a)&&this.vertexLabelsMovable)};mxGraph.prototype.isCellRotatable=function(a){var b=this.view.getState(a);return 0!=(null!=b?b.style:this.getCellStyle(a))[mxConstants.STYLE_ROTATABLE]};mxGraph.prototype.getMovableCells=function(a){return this.model.filterCells(a,mxUtils.bind(this,function(b){return this.isCellMovable(b)}))};
mxGraph.prototype.isCellMovable=function(a){var b=this.view.getState(a);b=null!=b?b.style:this.getCellStyle(a);return this.isCellsMovable()&&!this.isCellLocked(a)&&0!=b[mxConstants.STYLE_MOVABLE]};mxGraph.prototype.isCellsMovable=function(){return this.cellsMovable};mxGraph.prototype.setCellsMovable=function(a){this.cellsMovable=a};mxGraph.prototype.isGridEnabled=function(){return this.gridEnabled};mxGraph.prototype.setGridEnabled=function(a){this.gridEnabled=a};mxGraph.prototype.isPortsEnabled=function(){return this.portsEnabled};
mxGraph.prototype.setPortsEnabled=function(a){this.portsEnabled=a};mxGraph.prototype.getGridSize=function(){return this.gridSize};mxGraph.prototype.setGridSize=function(a){this.gridSize=a};mxGraph.prototype.getTolerance=function(){return this.tolerance};mxGraph.prototype.setTolerance=function(a){this.tolerance=a};mxGraph.prototype.isVertexLabelsMovable=function(){return this.vertexLabelsMovable};mxGraph.prototype.setVertexLabelsMovable=function(a){this.vertexLabelsMovable=a};
mxGraph.prototype.isEdgeLabelsMovable=function(){return this.edgeLabelsMovable};mxGraph.prototype.setEdgeLabelsMovable=function(a){this.edgeLabelsMovable=a};mxGraph.prototype.isSwimlaneNesting=function(){return this.swimlaneNesting};mxGraph.prototype.setSwimlaneNesting=function(a){this.swimlaneNesting=a};mxGraph.prototype.isSwimlaneSelectionEnabled=function(){return this.swimlaneSelectionEnabled};mxGraph.prototype.setSwimlaneSelectionEnabled=function(a){this.swimlaneSelectionEnabled=a};
mxGraph.prototype.isMultigraph=function(){return this.multigraph};mxGraph.prototype.setMultigraph=function(a){this.multigraph=a};mxGraph.prototype.isAllowLoops=function(){return this.allowLoops};mxGraph.prototype.setAllowDanglingEdges=function(a){this.allowDanglingEdges=a};mxGraph.prototype.isAllowDanglingEdges=function(){return this.allowDanglingEdges};mxGraph.prototype.setConnectableEdges=function(a){this.connectableEdges=a};mxGraph.prototype.isConnectableEdges=function(){return this.connectableEdges};
mxGraph.prototype.setCloneInvalidEdges=function(a){this.cloneInvalidEdges=a};mxGraph.prototype.isCloneInvalidEdges=function(){return this.cloneInvalidEdges};mxGraph.prototype.setAllowLoops=function(a){this.allowLoops=a};mxGraph.prototype.isDisconnectOnMove=function(){return this.disconnectOnMove};mxGraph.prototype.setDisconnectOnMove=function(a){this.disconnectOnMove=a};mxGraph.prototype.isDropEnabled=function(){return this.dropEnabled};
mxGraph.prototype.setDropEnabled=function(a){this.dropEnabled=a};mxGraph.prototype.isSplitEnabled=function(){return this.splitEnabled};mxGraph.prototype.setSplitEnabled=function(a){this.splitEnabled=a};mxGraph.prototype.isCellResizable=function(a){var b=this.view.getState(a);b=null!=b?b.style:this.getCellStyle(a);return this.isCellsResizable()&&!this.isCellLocked(a)&&0!=b[mxConstants.STYLE_RESIZABLE]};mxGraph.prototype.isCellsResizable=function(){return this.cellsResizable};
mxGraph.prototype.setCellsResizable=function(a){this.cellsResizable=a};mxGraph.prototype.isTerminalPointMovable=function(){return true};mxGraph.prototype.isCellBendable=function(a){var b=this.view.getState(a);b=null!=b?b.style:this.getCellStyle(a);return this.isCellsBendable()&&!this.isCellLocked(a)&&0!=b[mxConstants.STYLE_BENDABLE]};mxGraph.prototype.isCellsBendable=function(){return this.cellsBendable};mxGraph.prototype.setCellsBendable=function(a){this.cellsBendable=a};
mxGraph.prototype.isCellEditable=function(a){var b=this.view.getState(a);b=null!=b?b.style:this.getCellStyle(a);return this.isCellsEditable()&&!this.isCellLocked(a)&&0!=b[mxConstants.STYLE_EDITABLE]};mxGraph.prototype.isCellsEditable=function(){return this.cellsEditable};mxGraph.prototype.setCellsEditable=function(a){this.cellsEditable=a};mxGraph.prototype.isCellDisconnectable=function(a){return this.isCellsDisconnectable()&&!this.isCellLocked(a)};mxGraph.prototype.isCellsDisconnectable=function(){return this.cellsDisconnectable};
mxGraph.prototype.setCellsDisconnectable=function(a){this.cellsDisconnectable=a};mxGraph.prototype.isValidSource=function(a){return null==a&&this.allowDanglingEdges||null!=a&&(!this.model.isEdge(a)||this.connectableEdges)&&this.isCellConnectable(a)};mxGraph.prototype.isValidTarget=function(a){return this.isValidSource(a)};mxGraph.prototype.isValidConnection=function(a,b){return this.isValidSource(a)&&this.isValidTarget(b)};mxGraph.prototype.setConnectable=function(a){this.connectionHandler.setEnabled(a)};
mxGraph.prototype.isConnectable=function(){return this.connectionHandler.isEnabled()};mxGraph.prototype.setTooltips=function(a){this.tooltipHandler.setEnabled(a)};mxGraph.prototype.setPanning=function(a){this.panningHandler.panningEnabled=a};mxGraph.prototype.isEditing=function(a){if(null!=this.cellEditor){var b=this.cellEditor.getEditingCell();return null==a?null!=b:a==b}return false};
mxGraph.prototype.isAutoSizeCell=function(a){var b=this.view.getState(a);a=null!=b?b.style:this.getCellStyle(a);return this.isAutoSizeCells()||1==a[mxConstants.STYLE_AUTOSIZE]};mxGraph.prototype.isAutoSizeCells=function(){return this.autoSizeCells};mxGraph.prototype.setAutoSizeCells=function(a){this.autoSizeCells=a};mxGraph.prototype.isExtendParent=function(a){return!this.getModel().isEdge(a)&&this.isExtendParents()};mxGraph.prototype.isExtendParents=function(){return this.extendParents};
mxGraph.prototype.setExtendParents=function(a){this.extendParents=a};mxGraph.prototype.isExtendParentsOnAdd=function(){return this.extendParentsOnAdd};mxGraph.prototype.setExtendParentsOnAdd=function(a){this.extendParentsOnAdd=a};mxGraph.prototype.isConstrainChild=function(a){return this.isConstrainChildren()&&!this.getModel().isEdge(this.getModel().getParent(a))};mxGraph.prototype.isConstrainChildren=function(){return this.constrainChildren};
mxGraph.prototype.setConstrainChildren=function(a){this.constrainChildren=a};mxGraph.prototype.isAllowNegativeCoordinates=function(){return this.allowNegativeCoordinates};mxGraph.prototype.setAllowNegativeCoordinates=function(a){this.allowNegativeCoordinates=a};mxGraph.prototype.getOverlap=function(a){return this.isAllowOverlapParent(a)?this.defaultOverlap:0};mxGraph.prototype.isAllowOverlapParent=function(){return false};
mxGraph.prototype.getFoldableCells=function(a,b){return this.model.filterCells(a,mxUtils.bind(this,function(c){return this.isCellFoldable(c,b)}))};mxGraph.prototype.isCellFoldable=function(a){var b=this.view.getState(a);b=null!=b?b.style:this.getCellStyle(a);return 0<this.model.getChildCount(a)&&0!=b[mxConstants.STYLE_FOLDABLE]};
mxGraph.prototype.isValidDropTarget=function(a,b,c){return null!=a&&(this.isSplitEnabled()&&this.isSplitTarget(a,b,c)||!this.model.isEdge(a)&&(this.isSwimlane(a)||0<this.model.getChildCount(a)&&!this.isCellCollapsed(a)))};
mxGraph.prototype.isSplitTarget=function(a,b,c){return this.model.isEdge(a)&&null!=b&&1==b.length&&this.isCellConnectable(b[0])&&null==this.getEdgeValidationError(a,this.model.getTerminal(a,true),b[0])?(c=this.model.getTerminal(a,true),a=this.model.getTerminal(a,false),!this.model.isAncestor(b[0],c)&&!this.model.isAncestor(b[0],a)):false};
mxGraph.prototype.getDropTarget=function(a,b,c){if(!this.isSwimlaneNesting())for(var d=0;d<a.length;d++)if(this.isSwimlane(a[d]))return null;d=mxUtils.convertPoint(this.container,mxEvent.getClientX(b),mxEvent.getClientY(b));d.x-=this.panDx;d.y-=this.panDy;d=this.getSwimlaneAt(d.x,d.y);if(null==c)c=d;else if(null!=d){for(var e=this.model.getParent(d);null!=e&&this.isSwimlane(e)&&e!=c;)e=this.model.getParent(e);e==c&&(c=d)}for(;null!=c&&!this.isValidDropTarget(c,a,b)&&!this.model.isLayer(c);)c=this.model.getParent(c);
return!this.model.isLayer(c)&&0>mxUtils.indexOf(a,c)?c:null};mxGraph.prototype.getDefaultParent=function(){var a=this.getCurrentRoot();null==a&&(a=this.defaultParent,null==a&&(a=this.model.getRoot(),a=this.model.getChildAt(a,0)));return a};mxGraph.prototype.setDefaultParent=function(a){this.defaultParent=a};mxGraph.prototype.getSwimlane=function(a){for(;null!=a&&!this.isSwimlane(a);)a=this.model.getParent(a);return a};
mxGraph.prototype.getSwimlaneAt=function(a,b,c){c=c||this.getDefaultParent();if(null!=c)for(var d=this.model.getChildCount(c),e=0;e<d;e++){var f=this.model.getChildAt(c,e),g=this.getSwimlaneAt(a,b,f);if(null!=g)return g;if(this.isSwimlane(f)&&(g=this.view.getState(f),this.intersects(g,a,b)))return f}return null};
mxGraph.prototype.getCellAt=function(a,b,c,d,e){d=null!=d?d:true;e=null!=e?e:true;c=null!=c?c:this.getDefaultParent();if(null!=c)for(var f=this.model.getChildCount(c)-1;0<=f;f--){var g=this.model.getChildAt(c,f),h=this.getCellAt(a,b,g,d,e);if(null!=h)return h;if(this.isCellVisible(g)&&(e&&this.model.isEdge(g)||d&&this.model.isVertex(g)))if(h=this.view.getState(g),this.intersects(h,a,b))return g}return null};
mxGraph.prototype.intersects=function(a,b,c){if(null!=a){var d=a.absolutePoints;if(null!=d){a=this.tolerance*this.tolerance;for(var e=d[0],f=1;f<d.length;f++){var g=d[f];if(mxUtils.ptSegDistSq(e.x,e.y,g.x,g.y,b,c)<=a)return true;e=g}}else if(e=mxUtils.toRadians(mxUtils.getValue(a.style,mxConstants.STYLE_ROTATION)||0),0!=e&&(d=Math.cos(-e),e=Math.sin(-e),f=new mxPoint(a.getCenterX(),a.getCenterY()),e=mxUtils.getRotatedPoint(new mxPoint(b,c),d,e,f),b=e.x,c=e.y),mxUtils.contains(a,b,c))return true}return false};
mxGraph.prototype.hitsSwimlaneContent=function(a,b,c){var d=this.getView().getState(a);a=this.getStartSize(a);if(null!=d){var e=this.getView().getScale();b-=d.x;c-=d.y;if(0<a.width&&0<b&&b>a.width*e||0<a.height&&0<c&&c>a.height*e)return true}return false};mxGraph.prototype.getChildVertices=function(a){return this.getChildCells(a,true,false)};mxGraph.prototype.getChildEdges=function(a){return this.getChildCells(a,false,true)};
mxGraph.prototype.getChildCells=function(a,b,c){a=null!=a?a:this.getDefaultParent();a=this.model.getChildCells(a,null!=b?b:false,null!=c?c:false);b=[];for(c=0;c<a.length;c++)this.isCellVisible(a[c])&&b.push(a[c]);return b};mxGraph.prototype.getConnections=function(a,b){return this.getEdges(a,b,true,true,false)};mxGraph.prototype.getIncomingEdges=function(a,b){return this.getEdges(a,b,true,false,false)};mxGraph.prototype.getOutgoingEdges=function(a,b){return this.getEdges(a,b,false,true,false)};
mxGraph.prototype.getEdges=function(a,b,c,d,e,f){c=null!=c?c:true;d=null!=d?d:true;e=null!=e?e:true;f=null!=f?f:false;for(var g=[],h=this.isCellCollapsed(a),k=this.model.getChildCount(a),l=0;l<k;l++){var m=this.model.getChildAt(a,l);if(h||!this.isCellVisible(m))g=g.concat(this.model.getEdges(m,c,d))}g=g.concat(this.model.getEdges(a,c,d));h=[];for(l=0;l<g.length;l++){m=this.view.getState(g[l]);k=null!=m?m.getVisibleTerminal(true):this.view.getVisibleTerminal(g[l],true);m=null!=m?m.getVisibleTerminal(false):
this.view.getVisibleTerminal(g[l],false);(e&&k==m||k!=m&&(c&&m==a&&(null==b||this.isValidAncestor(k,b,f))||d&&k==a&&(null==b||this.isValidAncestor(m,b,f))))&&h.push(g[l])}return h};mxGraph.prototype.isValidAncestor=function(a,b,c){return c?this.model.isAncestor(b,a):this.model.getParent(a)==b};
mxGraph.prototype.getOpposites=function(a,b,c,d){c=null!=c?c:true;d=null!=d?d:true;var e=[],f={};if(null!=a)for(var g=0;g<a.length;g++){var h=this.view.getState(a[g]),k=null!=h?h.getVisibleTerminal(true):this.view.getVisibleTerminal(a[g],true);h=null!=h?h.getVisibleTerminal(false):this.view.getVisibleTerminal(a[g],false);if(k==b&&null!=h&&h!=b&&d){var l=mxCellPath.create(h);null==f[l]&&(f[l]=h,e.push(h))}else h==b&&null!=k&&k!=b&&c&&(l=mxCellPath.create(k),null==f[l]&&(f[l]=k,e.push(k)))}return e};
mxGraph.prototype.getEdgesBetween=function(a,b,c){c=null!=c?c:false;for(var d=this.getEdges(a),e=[],f=0;f<d.length;f++){var g=this.view.getState(d[f]),h=null!=g?g.getVisibleTerminal(true):this.view.getVisibleTerminal(d[f],true);g=null!=g?g.getVisibleTerminal(false):this.view.getVisibleTerminal(d[f],false);(h==a&&g==b||!c&&h==b&&g==a)&&e.push(d[f])}return e};
mxGraph.prototype.getPointForEvent=function(a,b){var c=mxUtils.convertPoint(this.container,mxEvent.getClientX(a),mxEvent.getClientY(a)),d=this.view.scale,e=this.view.translate,f=false!=b?this.gridSize/2:0;c.x=this.snap(c.x/d-e.x-f);c.y=this.snap(c.y/d-e.y-f);return c};
mxGraph.prototype.getCells=function(a,b,c,d,e,f){f=null!=f?f:[];if(0<c||0<d){var g=a+c,h=b+d;e=e||this.getDefaultParent();if(null!=e)for(var k=this.model.getChildCount(e),l=0;l<k;l++){var m=this.model.getChildAt(e,l),p=this.view.getState(m);if(this.isCellVisible(m)&&null!=p){var o=p;p=mxUtils.getValue(p.style,mxConstants.STYLE_ROTATION)||0;0!=p&&(o=mxUtils.getBoundingBox(o,p));o.x>=a&&o.y+o.height<=h&&o.y>=b&&o.x+o.width<=g?f.push(m):this.getCells(a,b,c,d,m,f)}}}return f};
mxGraph.prototype.getCellsBeyond=function(a,b,c,d,e){var f=[];if(d||e)if(null==c&&(c=this.getDefaultParent()),null!=c)for(var g=this.model.getChildCount(c),h=0;h<g;h++){var k=this.model.getChildAt(c,h),l=this.view.getState(k);this.isCellVisible(k)&&null!=l&&(!d||l.x>=a)&&(!e||l.y>=b)&&f.push(k)}return f};
mxGraph.prototype.findTreeRoots=function(a,b,c){b=null!=b?b:false;c=null!=c?c:false;var d=[];if(null!=a){for(var e=this.getModel(),f=e.getChildCount(a),g=null,h=0,k=0;k<f;k++){var l=e.getChildAt(a,k);if(this.model.isVertex(l)&&this.isCellVisible(l)){for(var m=this.getConnections(l,b?a:null),p=0,o=0,n=0;n<m.length;n++)this.view.getVisibleTerminal(m[n],true)==l?p++:o++;(c&&0==p&&0<o||!c&&0==o&&0<p)&&d.push(l);m=c?o-p:p-o;m>h&&(h=m,g=l)}}0==d.length&&null!=g&&d.push(g)}return d};
mxGraph.prototype.traverse=function(a,b,c,d,e){if(null!=c&&null!=a){b=null!=b?b:true;e=e||[];var f=mxCellPath.create(a);if(null==e[f]&&(e[f]=a,d=c(a,d),null==d||d))if(d=this.model.getEdgeCount(a),0<d)for(f=0;f<d;f++){var g=this.model.getEdgeAt(a,f),h=this.model.getTerminal(g,true)==a;if(!b||h){h=this.model.getTerminal(g,!h);this.traverse(h,b,c,g,e)}}}};mxGraph.prototype.isCellSelected=function(a){return this.getSelectionModel().isSelected(a)};mxGraph.prototype.isSelectionEmpty=function(){return this.getSelectionModel().isEmpty()};
mxGraph.prototype.clearSelection=function(){return this.getSelectionModel().clear()};mxGraph.prototype.getSelectionCount=function(){return this.getSelectionModel().cells.length};mxGraph.prototype.getSelectionCell=function(){return this.getSelectionModel().cells[0]};mxGraph.prototype.getSelectionCells=function(){return this.getSelectionModel().cells.slice()};mxGraph.prototype.setSelectionCell=function(a){this.getSelectionModel().setCell(a)};mxGraph.prototype.setSelectionCells=function(a){this.getSelectionModel().setCells(a)};
mxGraph.prototype.addSelectionCell=function(a){this.getSelectionModel().addCell(a)};mxGraph.prototype.addSelectionCells=function(a){this.getSelectionModel().addCells(a)};mxGraph.prototype.removeSelectionCell=function(a){this.getSelectionModel().removeCell(a)};mxGraph.prototype.removeSelectionCells=function(a){this.getSelectionModel().removeCells(a)};mxGraph.prototype.selectRegion=function(a,b){var c=this.getCells(a.x,a.y,a.width,a.height);this.selectCellsForEvent(c,b);return c};
mxGraph.prototype.selectNextCell=function(){this.selectCell(true)};mxGraph.prototype.selectPreviousCell=function(){this.selectCell()};mxGraph.prototype.selectParentCell=function(){this.selectCell(false,true)};mxGraph.prototype.selectChildCell=function(){this.selectCell(false,false,true)};
mxGraph.prototype.selectCell=function(a,b,c){var d=this.selectionModel,e=0<d.cells.length?d.cells[0]:null;1<d.cells.length&&d.clear();d=null!=e?this.model.getParent(e):this.getDefaultParent();var f=this.model.getChildCount(d);null==e&&0<f?(a=this.model.getChildAt(d,0),this.setSelectionCell(a)):(null==e||b)&&null!=this.view.getState(d)&&null!=this.model.getGeometry(d)?this.getCurrentRoot()!=d&&this.setSelectionCell(d):null!=e&&c?0<this.model.getChildCount(e)&&(a=this.model.getChildAt(e,0),this.setSelectionCell(a)):
0<f&&(b=d.getIndex(e),a?(b++,this.model.getChildAt(d,b%f)):(b--,a=this.model.getChildAt(d,0>b?f-1:b)),this.setSelectionCell(a))};mxGraph.prototype.selectAll=function(a){a=a||this.getDefaultParent();a=this.model.getChildren(a);null!=a&&this.setSelectionCells(a)};mxGraph.prototype.selectVertices=function(a){this.selectCells(true,false,a)};mxGraph.prototype.selectEdges=function(a){this.selectCells(false,true,a)};
mxGraph.prototype.selectCells=function(a,b,c){c=c||this.getDefaultParent();c=this.model.filterDescendants(mxUtils.bind(this,function(d){return null!=this.view.getState(d)&&0==this.model.getChildCount(d)&&(this.model.isVertex(d)&&a||this.model.isEdge(d)&&b)}),c);this.setSelectionCells(c)};mxGraph.prototype.selectCellForEvent=function(a,b){var c=this.isCellSelected(a);this.isToggleEvent(b)?c?this.removeSelectionCell(a):this.addSelectionCell(a):(!c||1!=this.getSelectionCount())&&this.setSelectionCell(a)};
mxGraph.prototype.selectCellsForEvent=function(a,b){this.isToggleEvent(b)?this.addSelectionCells(a):this.setSelectionCells(a)};
mxGraph.prototype.createHandler=function(a){var b=null;null!=a&&(this.model.isEdge(a.cell)?(b=this.view.getEdgeStyle(a),b=this.isLoop(a)||b==mxEdgeStyle.ElbowConnector||b==mxEdgeStyle.SideToSide||b==mxEdgeStyle.TopToBottom?new mxElbowEdgeHandler(a):b==mxEdgeStyle.SegmentConnector||b==mxEdgeStyle.OrthConnector?new mxEdgeSegmentHandler(a):new mxEdgeHandler(a)):b=new mxVertexHandler(a));return b};mxGraph.prototype.addMouseListener=function(a){null==this.mouseListeners&&(this.mouseListeners=[]);this.mouseListeners.push(a)};
mxGraph.prototype.removeMouseListener=function(a){if(null!=this.mouseListeners)for(var b=0;b<this.mouseListeners.length;b++)if(this.mouseListeners[b]==a){this.mouseListeners.splice(b,1);break}};mxGraph.prototype.updateMouseEvent=function(a){if(null==a.graphX||null==a.graphY){var b=mxUtils.convertPoint(this.container,a.getX(),a.getY());a.graphX=b.x-this.panDx;a.graphY=b.y-this.panDy}};
mxGraph.prototype.fireMouseEvent=function(a,b,c){null==c&&(c=this);this.updateMouseEvent(b);a==mxEvent.MOUSE_DOWN&&(this.isMouseDown=true);if(mxClient.IS_TOUCH&&this.doubleTapEnabled&&a==mxEvent.MOUSE_DOWN){var d=(new Date).getTime();d-this.lastTouchTime<this.doubleTapTimeout&&Math.abs(this.lastTouchX-b.getX())<this.doubleTapTolerance&&Math.abs(this.lastTouchY-b.getY())<this.doubleTapTolerance?(this.lastTouchTime=0,this.dblClick(b.getEvent(),b.getCell()),b.getEvent().cancelBubble=true):(this.lastTouchX=
b.getX(),this.lastTouchY=b.getY(),this.lastTouchTime=d)}d=2!=b.getEvent().detail;if(mxClient.IS_IE&&"CSS1Compat"==document.compatMode){if(null!=this.lastMouseX&&Math.abs(this.lastMouseX-b.getX())>this.doubleTapTolerance||null!=this.lastMouseY&&Math.abs(this.lastMouseY-b.getY())>this.doubleTapTolerance)d=true;a==mxEvent.MOUSE_UP&&(this.lastMouseX=b.getX(),this.lastMouseY=b.getY())}if((a!=mxEvent.MOUSE_UP||this.isMouseDown)&&d){if(a==mxEvent.MOUSE_UP&&(this.isMouseDown=false),!this.isEditing()&&(mxClient.IS_OP||
mxClient.IS_SF||mxClient.IS_GC||mxClient.IS_IE&&mxClient.IS_SVG||b.getEvent().target!=this.container)){a==mxEvent.MOUSE_MOVE&&this.isMouseDown&&this.autoScroll&&this.scrollPointToVisible(b.getGraphX(),b.getGraphY(),this.autoExtend);if(null!=this.mouseListeners){c=[c,b];b.getEvent().returnValue=true;for(d=0;d<this.mouseListeners.length;d++){var e=this.mouseListeners[d];a==mxEvent.MOUSE_DOWN?e.mouseDown.apply(e,c):a==mxEvent.MOUSE_MOVE?e.mouseMove.apply(e,c):a==mxEvent.MOUSE_UP&&e.mouseUp.apply(e,c)}}a==
mxEvent.MOUSE_UP&&this.click(b)}}else a==mxEvent.MOUSE_UP&&(this.isMouseDown=false)};
mxGraph.prototype.destroy=function(){this.destroyed||(this.destroyed=true,null!=this.tooltipHandler&&this.tooltipHandler.destroy(),null!=this.selectionCellsHandler&&this.selectionCellsHandler.destroy(),null!=this.panningHandler&&this.panningHandler.destroy(),null!=this.connectionHandler&&this.connectionHandler.destroy(),null!=this.graphHandler&&this.graphHandler.destroy(),null!=this.cellEditor&&this.cellEditor.destroy(),null!=this.view&&this.view.destroy(),null!=this.model&&null!=this.graphModelChangeListener&&
(this.model.removeListener(this.graphModelChangeListener),this.graphModelChangeListener=null),this.container=null)};function mxCellOverlay(a,b,c,d,e,f){this.image=a;this.tooltip=b;this.align=null!=c?c:this.align;this.verticalAlign=null!=d?d:this.verticalAlign;this.offset=null!=e?e:new mxPoint;this.cursor=null!=f?f:"help"}mxCellOverlay.prototype=new mxEventSource;mxCellOverlay.prototype.constructor=mxCellOverlay;mxCellOverlay.prototype.image=null;mxCellOverlay.prototype.tooltip=null;
mxCellOverlay.prototype.align=mxConstants.ALIGN_RIGHT;mxCellOverlay.prototype.verticalAlign=mxConstants.ALIGN_BOTTOM;mxCellOverlay.prototype.offset=null;mxCellOverlay.prototype.cursor=null;mxCellOverlay.prototype.defaultOverlap=0.5;
mxCellOverlay.prototype.getBounds=function(a){var b=a.view.graph.getModel().isEdge(a.cell),c=a.view.scale,d=null,e=this.image.width,f=this.image.height;b?(b=a.absolutePoints,1==b.length%2?d=b[Math.floor(b.length/2)]:(d=b.length/2,a=b[d-1],b=b[d],d=new mxPoint(a.x+(b.x-a.x)/2,a.y+(b.y-a.y)/2))):(d=new mxPoint,d.x=this.align==mxConstants.ALIGN_LEFT?a.x:this.align==mxConstants.ALIGN_CENTER?a.x+a.width/2:a.x+a.width,d.y=this.verticalAlign==mxConstants.ALIGN_TOP?a.y:this.verticalAlign==mxConstants.ALIGN_MIDDLE?
a.y+a.height/2:a.y+a.height);return new mxRectangle(Math.round(d.x-(e*this.defaultOverlap-this.offset.x)*c),Math.round(d.y-(f*this.defaultOverlap-this.offset.y)*c),e*c,f*c)};mxCellOverlay.prototype.toString=function(){return this.tooltip};function mxOutline(a,b){this.source=a;null!=b&&this.init(b)}mxOutline.prototype.source=null;mxOutline.prototype.outline=null;mxOutline.prototype.graphRenderHint=mxConstants.RENDERING_HINT_FASTER;mxOutline.prototype.enabled=true;mxOutline.prototype.showViewport=true;
mxOutline.prototype.border=10;mxOutline.prototype.sizerSize=8;mxOutline.prototype.updateOnPan=false;mxOutline.prototype.sizerImage=null;mxOutline.prototype.suspended=false;
mxOutline.prototype.init=function(a){this.outline=new mxGraph(a,this.source.getModel(),this.graphRenderHint,this.source.getStylesheet());this.outline.foldingEnabled=false;this.outline.autoScroll=false;var b=this.outline.graphModelChanged;this.outline.graphModelChanged=mxUtils.bind(this,function(){!this.suspended&&null!=this.outline&&b.apply(this.outline,arguments)});mxClient.IS_SVG&&(a=this.outline.getView().getCanvas().parentNode,a.setAttribute("shape-rendering","optimizeSpeed"),a.setAttribute("image-rendering",
"optimizeSpeed"));this.outline.labelsVisible=false;this.outline.setEnabled(false);this.updateHandler=mxUtils.bind(this,function(){!this.suspended&&!this.active&&this.update()});this.source.getModel().addListener(mxEvent.CHANGE,this.updateHandler);this.outline.addMouseListener(this);a=this.source.getView();a.addListener(mxEvent.SCALE,this.updateHandler);a.addListener(mxEvent.TRANSLATE,this.updateHandler);a.addListener(mxEvent.SCALE_AND_TRANSLATE,this.updateHandler);a.addListener(mxEvent.DOWN,this.updateHandler);
a.addListener(mxEvent.UP,this.updateHandler);mxEvent.addListener(this.source.container,"scroll",this.updateHandler);this.panHandler=mxUtils.bind(this,function(){this.updateOnPan&&this.updateHandler.apply(this,arguments)});this.source.addListener(mxEvent.PAN,this.panHandler);this.refreshHandler=mxUtils.bind(this,function(){this.outline.setStylesheet(this.source.getStylesheet());this.outline.refresh()});this.source.addListener(mxEvent.REFRESH,this.refreshHandler);this.bounds=new mxRectangle(0,0,0,0);
this.selectionBorder=new mxRectangleShape(this.bounds,null,mxConstants.OUTLINE_COLOR,mxConstants.OUTLINE_STROKEWIDTH);this.selectionBorder.dialect=this.outline.dialect!=mxConstants.DIALECT_SVG?mxConstants.DIALECT_VML:mxConstants.DIALECT_SVG;this.selectionBorder.init(this.outline.getView().getOverlayPane());a=mxUtils.bind(this,function(c){var d=mxEvent.getSource(c),e=mxUtils.bind(this,function(g){this.outline.fireMouseEvent(mxEvent.MOUSE_MOVE,new mxMouseEvent(g))}),f=mxUtils.bind(this,function(g){mxEvent.removeGestureListeners(d,
null,e,f);this.outline.fireMouseEvent(mxEvent.MOUSE_UP,new mxMouseEvent(g))});mxEvent.addGestureListeners(d,null,e,f);this.outline.fireMouseEvent(mxEvent.MOUSE_DOWN,new mxMouseEvent(c))});mxEvent.addGestureListeners(this.selectionBorder.node,a);this.sizer=this.createSizer();this.sizer.init(this.outline.getView().getOverlayPane());this.enabled&&(this.sizer.node.style.cursor="pointer");mxEvent.addGestureListeners(this.sizer.node,a);this.selectionBorder.node.style.display=this.showViewport?"":"none";
this.sizer.node.style.display=this.selectionBorder.node.style.display;this.selectionBorder.node.style.cursor="move";this.update(false)};mxOutline.prototype.isEnabled=function(){return this.enabled};mxOutline.prototype.setEnabled=function(a){this.enabled=a};mxOutline.prototype.setZoomEnabled=function(a){this.sizer.node.style.visibility=a?"visible":"hidden"};mxOutline.prototype.refresh=function(){this.update(true)};
mxOutline.prototype.createSizer=function(){var a=null!=this.sizerImage?new mxImageShape(new mxRectangle(0,0,this.sizerImage.width,this.sizerImage.height),this.sizerImage.src):new mxRectangleShape(new mxRectangle(0,0,this.sizerSize,this.sizerSize),mxConstants.OUTLINE_HANDLE_FILLCOLOR,mxConstants.OUTLINE_HANDLE_STROKECOLOR);a.dialect=this.outline.dialect;return a};mxOutline.prototype.getSourceContainerSize=function(){return new mxRectangle(0,0,this.source.container.scrollWidth,this.source.container.scrollHeight)};
mxOutline.prototype.getOutlineOffset=function(){return null};
mxOutline.prototype.update=function(a){if(null!=this.source){var b=this.source.view.scale,c=this.source.getGraphBounds();c=new mxRectangle(c.x/b+this.source.panDx,c.y/b+this.source.panDy,c.width/b,c.height/b);var d=new mxRectangle(0,0,this.source.container.clientWidth/b,this.source.container.clientHeight/b),e=c.clone();e.add(d);var f=this.getSourceContainerSize();d=Math.max(f.width/b,e.width);b=Math.max(f.height/b,e.height);e=Math.max(0,this.outline.container.clientWidth-this.border);f=Math.max(0,
this.outline.container.clientHeight-this.border);e=Math.min(e/d,f/b);if(0<e){this.outline.getView().scale!=e&&(this.outline.getView().scale=e,a=true);d=this.outline.getView();d.currentRoot!=this.source.getView().currentRoot&&d.setCurrentRoot(this.source.getView().currentRoot);b=this.source.view.translate;f=b.x+this.source.panDx;var g=b.y+this.source.panDy;e=this.getOutlineOffset(e);null!=e&&(f+=e.x,g+=e.y);0>c.x&&(f-=c.x);0>c.y&&(g-=c.y);if(d.translate.x!=f||d.translate.y!=g){d.translate.x=f;d.translate.y=
g;a=true}c=d.translate;e=this.source.getView().scale;f=e/d.scale;g=1/d.scale;var h=this.source.container;this.bounds=new mxRectangle((c.x-b.x-this.source.panDx)/g,(c.y-b.y-this.source.panDy)/g,h.clientWidth/f,h.clientHeight/f);this.bounds.x+=this.source.container.scrollLeft*d.scale/e;this.bounds.y+=this.source.container.scrollTop*d.scale/e;c=this.selectionBorder.bounds;if(c.x!=this.bounds.x||c.y!=this.bounds.y||c.width!=this.bounds.width||c.height!=this.bounds.height){this.selectionBorder.bounds=
this.bounds;this.selectionBorder.redraw()}c=this.sizer.bounds;d=new mxRectangle(this.bounds.x+this.bounds.width-c.width/2,this.bounds.y+this.bounds.height-c.height/2,c.width,c.height);if(c.x!=d.x||c.y!=d.y||c.width!=d.width||c.height!=d.height){this.sizer.bounds=d;"hidden"!=this.sizer.node.style.visibility&&this.sizer.redraw()}a&&this.outline.view.revalidate()}}};
mxOutline.prototype.mouseDown=function(a,b){this.enabled&&this.showViewport&&(this.zoom=b.isSource(this.sizer),this.startX=b.getX(),this.startY=b.getY(),this.active=true,this.source.useScrollbarsForPanning&&mxUtils.hasScrollbars(this.source.container)?(this.dx0=this.source.container.scrollLeft,this.dy0=this.source.container.scrollTop):this.dy0=this.dx0=0);b.consume()};
mxOutline.prototype.mouseMove=function(a,b){if(this.active){this.selectionBorder.node.style.display=this.showViewport?"":"none";this.sizer.node.style.display=this.selectionBorder.node.style.display;var c=this.getTranslateForEvent(b),d=c.x,e=c.y;if(this.zoom){c=this.source.container;e=d/(c.clientWidth/c.clientHeight);c=new mxRectangle(this.bounds.x,this.bounds.y,Math.max(1,this.bounds.width+d),Math.max(1,this.bounds.height+e));this.selectionBorder.bounds=c;this.selectionBorder.redraw()}else{var f=
this.outline.getView().scale;c=new mxRectangle(this.bounds.x+d,this.bounds.y+e,this.bounds.width,this.bounds.height);this.selectionBorder.bounds=c;this.selectionBorder.redraw();d=d/f*this.source.getView().scale;e=e/f*this.source.getView().scale;this.source.panGraph(-d-this.dx0,-e-this.dy0)}d=this.sizer.bounds;this.sizer.bounds=new mxRectangle(c.x+c.width-d.width/2,c.y+c.height-d.height/2,d.width,d.height);"hidden"!=this.sizer.node.style.visibility&&this.sizer.redraw();b.consume()}};
mxOutline.prototype.getTranslateForEvent=function(a){return new mxPoint(a.getX()-this.startX,a.getY()-this.startY)};
mxOutline.prototype.mouseUp=function(a,b){if(this.active){var c=this.getTranslateForEvent(b),d=c.x;c=c.y;if(0<Math.abs(d)||0<Math.abs(c)){if(this.zoom){c=this.selectionBorder.bounds.width;var e=this.source.getView().scale;this.source.zoomTo(e-d*e/c,false)}else if(!this.source.useScrollbarsForPanning||!mxUtils.hasScrollbars(this.source.container)){this.source.panGraph(0,0);d/=this.outline.getView().scale;c/=this.outline.getView().scale;e=this.source.getView().translate;this.source.getView().setTranslate(e.x-
d,e.y-c)}this.update();b.consume()}this.index=null;this.active=false}};
mxOutline.prototype.destroy=function(){null!=this.source&&(this.source.removeListener(this.panHandler),this.source.removeListener(this.refreshHandler),this.source.getModel().removeListener(this.updateHandler),this.source.getView().removeListener(this.updateHandler),mxEvent.addListener(this.source.container,"scroll",this.updateHandler),this.source=null);null!=this.outline&&(this.outline.removeMouseListener(this),this.outline.destroy(),this.outline=null);null!=this.selectionBorder&&(this.selectionBorder.destroy(),
this.selectionBorder=null);null!=this.sizer&&(this.sizer.destroy(),this.sizer=null)};function mxMultiplicity(a,b,c,d,e,f,g,h,k,l){this.source=a;this.type=b;this.attr=c;this.value=d;this.min=null!=e?e:0;this.max=null!=f?f:"n";this.validNeighbors=g;this.countError=mxResources.get(h)||h;this.typeError=mxResources.get(k)||k;this.validNeighborsAllowed=null!=l?l:true}mxMultiplicity.prototype.type=null;mxMultiplicity.prototype.attr=null;mxMultiplicity.prototype.value=null;
mxMultiplicity.prototype.source=null;mxMultiplicity.prototype.min=null;mxMultiplicity.prototype.max=null;mxMultiplicity.prototype.validNeighbors=null;mxMultiplicity.prototype.validNeighborsAllowed=true;mxMultiplicity.prototype.countError=null;mxMultiplicity.prototype.typeError=null;
mxMultiplicity.prototype.check=function(a,b,c,d,e,f){var g="";if(this.source&&this.checkTerminal(a,c,b)||!this.source&&this.checkTerminal(a,d,b)){if(null!=this.countError&&(this.source&&(0==this.max||e>=this.max)||!this.source&&(0==this.max||f>=this.max)))g+=this.countError+"\n";null!=this.validNeighbors&&null!=this.typeError&&0<this.validNeighbors.length&&(this.checkNeighbors(a,b,c,d)||(g+=this.typeError+"\n"))}return 0<g.length?g:null};
mxMultiplicity.prototype.checkNeighbors=function(a,b,c,d){b=a.model.getValue(c);d=a.model.getValue(d);c=!this.validNeighborsAllowed;for(var e=this.validNeighbors,f=0;f<e.length;f++)if(this.source&&this.checkType(a,d,e[f])){c=this.validNeighborsAllowed;break}else if(!this.source&&this.checkType(a,b,e[f])){c=this.validNeighborsAllowed;break}return c};mxMultiplicity.prototype.checkTerminal=function(a,b){b=a.model.getValue(b);return this.checkType(a,b,this.type,this.attr,this.value)};
mxMultiplicity.prototype.checkType=function(a,b,c,d,e){return null!=b?isNaN(b.nodeType)?b==c:mxUtils.isNode(b,c,d,e):false};function mxLayoutManager(a){this.undoHandler=mxUtils.bind(this,function(b,c){this.isEnabled()&&this.beforeUndo(c.getProperty("edit"))});this.moveHandler=mxUtils.bind(this,function(b,c){this.isEnabled()&&this.cellsMoved(c.getProperty("cells"),c.getProperty("event"))});this.setGraph(a)}mxLayoutManager.prototype=new mxEventSource;mxLayoutManager.prototype.constructor=mxLayoutManager;
mxLayoutManager.prototype.graph=null;mxLayoutManager.prototype.bubbling=true;mxLayoutManager.prototype.enabled=true;mxLayoutManager.prototype.updateHandler=null;mxLayoutManager.prototype.moveHandler=null;mxLayoutManager.prototype.isEnabled=function(){return this.enabled};mxLayoutManager.prototype.setEnabled=function(a){this.enabled=a};mxLayoutManager.prototype.isBubbling=function(){return this.bubbling};mxLayoutManager.prototype.setBubbling=function(a){this.bubbling=a};
mxLayoutManager.prototype.getGraph=function(){return this.graph};mxLayoutManager.prototype.setGraph=function(a){if(null!=this.graph){var b=this.graph.getModel();b.removeListener(this.undoHandler);this.graph.removeListener(this.moveHandler)}this.graph=a;null!=this.graph&&(b=this.graph.getModel(),b.addListener(mxEvent.BEFORE_UNDO,this.undoHandler),this.graph.addListener(mxEvent.MOVE_CELLS,this.moveHandler))};mxLayoutManager.prototype.getLayout=function(){return null};
mxLayoutManager.prototype.beforeUndo=function(a){a=this.getCellsForChanges(a.changes);var b=this.getGraph().getModel();if(this.isBubbling())for(var c=b.getParents(a);0<c.length;){a=a.concat(c);c=b.getParents(c)}this.layoutCells(mxUtils.sortCells(a,false))};
mxLayoutManager.prototype.cellsMoved=function(a,b){if(null!=a&&null!=b)for(var c=mxUtils.convertPoint(this.getGraph().container,mxEvent.getClientX(b),mxEvent.getClientY(b)),d=this.getGraph().getModel(),e=0;e<a.length;e++){var f=this.getLayout(d.getParent(a[e]));null!=f&&f.moveCell(a[e],c.x,c.y)}};
mxLayoutManager.prototype.getCellsForChanges=function(a){for(var b=[],c={},d=0;d<a.length;d++){var e=a[d];if(e instanceof mxRootChange)return[];e=this.getCellsForChange(e);for(var f=0;f<e.length;f++)if(null!=e[f]){var g=mxCellPath.create(e[f]);null==c[g]&&(c[g]=e[f],b.push(e[f]))}}return b};
mxLayoutManager.prototype.getCellsForChange=function(a){var b=this.getGraph().getModel();return a instanceof mxChildChange?[a.child,a.previous,b.getParent(a.child)]:a instanceof mxTerminalChange||a instanceof mxGeometryChange?[a.cell,b.getParent(a.cell)]:[]};
mxLayoutManager.prototype.layoutCells=function(a){if(0<a.length){var b=this.getGraph().getModel();b.beginUpdate();try{for(var c=null,d=0;d<a.length;d++)a[d]!=b.getRoot()&&a[d]!=c&&(c=a[d],this.executeLayout(this.getLayout(c),c));this.fireEvent(new mxEventObject(mxEvent.LAYOUT_CELLS,"cells",a))}finally{b.endUpdate()}}};mxLayoutManager.prototype.executeLayout=function(a,b){null!=a&&null!=b&&a.execute(b)};mxLayoutManager.prototype.destroy=function(){this.setGraph(null)};
function mxSpaceManager(a,b,c,d){this.resizeHandler=mxUtils.bind(this,function(e,f){this.isEnabled()&&this.cellsResized(f.getProperty("cells"))});this.foldHandler=mxUtils.bind(this,function(e,f){this.isEnabled()&&this.cellsResized(f.getProperty("cells"))});this.shiftRightwards=null!=b?b:true;this.shiftDownwards=null!=c?c:true;this.extendParents=null!=d?d:true;this.setGraph(a)}mxSpaceManager.prototype=new mxEventSource;mxSpaceManager.prototype.constructor=mxSpaceManager;
mxSpaceManager.prototype.graph=null;mxSpaceManager.prototype.enabled=true;mxSpaceManager.prototype.shiftRightwards=true;mxSpaceManager.prototype.shiftDownwards=true;mxSpaceManager.prototype.extendParents=true;mxSpaceManager.prototype.resizeHandler=null;mxSpaceManager.prototype.foldHandler=null;mxSpaceManager.prototype.isCellIgnored=function(a){return!this.getGraph().getModel().isVertex(a)};mxSpaceManager.prototype.isCellShiftable=function(a){return this.getGraph().getModel().isVertex(a)&&this.getGraph().isCellMovable(a)};
mxSpaceManager.prototype.isEnabled=function(){return this.enabled};mxSpaceManager.prototype.setEnabled=function(a){this.enabled=a};mxSpaceManager.prototype.isShiftRightwards=function(){return this.shiftRightwards};mxSpaceManager.prototype.setShiftRightwards=function(a){this.shiftRightwards=a};mxSpaceManager.prototype.isShiftDownwards=function(){return this.shiftDownwards};mxSpaceManager.prototype.setShiftDownwards=function(a){this.shiftDownwards=a};mxSpaceManager.prototype.isExtendParents=function(){return this.extendParents};
mxSpaceManager.prototype.setExtendParents=function(a){this.extendParents=a};mxSpaceManager.prototype.getGraph=function(){return this.graph};mxSpaceManager.prototype.setGraph=function(a){null!=this.graph&&(this.graph.removeListener(this.resizeHandler),this.graph.removeListener(this.foldHandler));this.graph=a;null!=this.graph&&(this.graph.addListener(mxEvent.RESIZE_CELLS,this.resizeHandler),this.graph.addListener(mxEvent.FOLD_CELLS,this.foldHandler))};
mxSpaceManager.prototype.cellsResized=function(a){if(null!=a){var b=this.graph.getModel();b.beginUpdate();try{for(var c=0;c<a.length;c++)if(!this.isCellIgnored(a[c])){this.cellResized(a[c]);break}}finally{b.endUpdate()}}};
mxSpaceManager.prototype.cellResized=function(a){var b=this.getGraph(),c=b.getView(),d=b.getModel(),e=c.getState(a),f=c.getState(d.getParent(a));if(null!=e&&null!=f){var g=this.getCellsToShift(e),h=d.getGeometry(a);if(null!=g&&null!=h){var k=c.translate,l=c.scale;c=e.x-f.origin.x-k.x*l;f=e.y-f.origin.y-k.y*l;k=e.x+e.width;var m=e.y+e.height,p=e.width-h.width*l+c-h.x*l,o=e.height-h.height*l+f-h.y*l,n=1-h.width*l/e.width;e=1-h.height*l/e.height;d.beginUpdate();try{for(h=0;h<g.length;h++)g[h]!=a&&this.isCellShiftable(g[h])&&
this.shiftCell(g[h],p,o,c,f,k,m,n,e,this.isExtendParents()&&b.isExtendParent(g[h]))}finally{d.endUpdate()}}}};
mxSpaceManager.prototype.shiftCell=function(a,b,c,d,e,f,g,h,k,l){d=this.getGraph();var m=d.getView().getState(a);if(null!=m){var p=d.getModel(),o=p.getGeometry(a);if(null!=o){p.beginUpdate();try{if(this.isShiftRightwards())if(m.x>=f){o=o.clone();o.translate(-b,0)}else{var n=Math.max(0,m.x-x0);o=o.clone();o.translate(-h*n,0)}if(this.isShiftDownwards())if(m.y>=g){o=o.clone();o.translate(0,-c)}else{var s=Math.max(0,m.y-e);o=o.clone();o.translate(0,-k*s)}o!=p.getGeometry(a)&&(p.setGeometry(a,o),l&&d.extendParent(a))}finally{p.endUpdate()}}}};
mxSpaceManager.prototype.getCellsToShift=function(a){var b=this.getGraph(),c=b.getModel().getParent(a.cell),d=this.isShiftDownwards(),e=this.isShiftRightwards();return b.getCellsBeyond(a.x+(d?0:a.width),a.y+(d&&e?0:a.height),c,e,d)};mxSpaceManager.prototype.destroy=function(){this.setGraph(null)};
function mxSwimlaneManager(a,b,c,d){this.horizontal=null!=b?b:true;this.addEnabled=null!=c?c:true;this.resizeEnabled=null!=d?d:true;this.addHandler=mxUtils.bind(this,function(e,f){this.isEnabled()&&this.isAddEnabled()&&this.cellsAdded(f.getProperty("cells"))});this.resizeHandler=mxUtils.bind(this,function(e,f){this.isEnabled()&&this.isResizeEnabled()&&this.cellsResized(f.getProperty("cells"))});this.setGraph(a)}mxSwimlaneManager.prototype=new mxEventSource;
mxSwimlaneManager.prototype.constructor=mxSwimlaneManager;mxSwimlaneManager.prototype.graph=null;mxSwimlaneManager.prototype.enabled=true;mxSwimlaneManager.prototype.horizontal=true;mxSwimlaneManager.prototype.addEnabled=true;mxSwimlaneManager.prototype.resizeEnabled=true;mxSwimlaneManager.prototype.addHandler=null;mxSwimlaneManager.prototype.resizeHandler=null;mxSwimlaneManager.prototype.isEnabled=function(){return this.enabled};mxSwimlaneManager.prototype.setEnabled=function(a){this.enabled=a};
mxSwimlaneManager.prototype.isHorizontal=function(){return this.horizontal};mxSwimlaneManager.prototype.setHorizontal=function(a){this.horizontal=a};mxSwimlaneManager.prototype.isAddEnabled=function(){return this.addEnabled};mxSwimlaneManager.prototype.setAddEnabled=function(a){this.addEnabled=a};mxSwimlaneManager.prototype.isResizeEnabled=function(){return this.resizeEnabled};mxSwimlaneManager.prototype.setResizeEnabled=function(a){this.resizeEnabled=a};mxSwimlaneManager.prototype.getGraph=function(){return this.graph};
mxSwimlaneManager.prototype.setGraph=function(a){null!=this.graph&&(this.graph.removeListener(this.addHandler),this.graph.removeListener(this.resizeHandler));this.graph=a;null!=this.graph&&(this.graph.addListener(mxEvent.ADD_CELLS,this.addHandler),this.graph.addListener(mxEvent.CELLS_RESIZED,this.resizeHandler))};mxSwimlaneManager.prototype.isSwimlaneIgnored=function(a){return!this.getGraph().isSwimlane(a)};
mxSwimlaneManager.prototype.isCellHorizontal=function(a){if(this.graph.isSwimlane(a)){var b=this.graph.view.getState(a);a=null!=b?b.style:this.graph.getCellStyle(a);return 1==mxUtils.getValue(a,mxConstants.STYLE_HORIZONTAL,1)}return!this.isHorizontal()};mxSwimlaneManager.prototype.cellsAdded=function(a){if(null!=a){var b=this.getGraph().getModel();b.beginUpdate();try{for(var c=0;c<a.length;c++)this.isSwimlaneIgnored(a[c])||this.swimlaneAdded(a[c])}finally{b.endUpdate()}}};
mxSwimlaneManager.prototype.swimlaneAdded=function(a){for(var b=this.getGraph().getModel(),c=b.getParent(a),d=b.getChildCount(c),e=null,f=0;f<d;f++){var g=b.getChildAt(c,f);if(g!=a&&!this.isSwimlaneIgnored(g)&&(e=b.getGeometry(g),null!=e))break}null!=e&&this.resizeSwimlane(a,e.width,e.height)};
mxSwimlaneManager.prototype.cellsResized=function(a){if(null!=a){var b=this.getGraph().getModel();b.beginUpdate();try{for(var c=0;c<a.length;c++)if(!this.isSwimlaneIgnored(a[c])){var d=b.getGeometry(a[c]);if(null!=d){for(var e=new mxRectangle(0,0,d.width,d.height),f=a[c],g=f;null!=g;){f=g;g=b.getParent(g);var h=this.graph.isSwimlane(g)?this.graph.getStartSize(g):new mxRectangle;e.width+=h.width;e.height+=h.height}this.resizeSwimlane(f,e.width,e.height)}}}finally{b.endUpdate()}}};
mxSwimlaneManager.prototype.resizeSwimlane=function(a,b,c){var d=this.getGraph().getModel();d.beginUpdate();try{if(!this.isSwimlaneIgnored(a)){var e=d.getGeometry(a);if(null!=e){var f=this.isCellHorizontal(a);if(f&&e.height!=c||!f&&e.width!=b){e=e.clone();f?e.height=c:e.width=b;d.setGeometry(a,e)}}}var g=this.graph.isSwimlane(a)?this.graph.getStartSize(a):new mxRectangle;b-=g.width;c-=g.height;var h=d.getChildCount(a);for(e=0;e<h;e++)this.resizeSwimlane(d.getChildAt(a,e),b,c)}finally{d.endUpdate()}};
mxSwimlaneManager.prototype.destroy=function(){this.setGraph(null)};function mxTemporaryCellStates(a,b,c){this.view=a;b=null!=b?b:1;this.oldBounds=a.getGraphBounds();this.oldStates=a.getStates();this.oldScale=a.getScale();a.setStates(new mxDictionary);a.setScale(b);if(null!=c){b=a.createState(new mxCell);for(var d=0;d<c.length;d++)a.validateBounds(b,c[d]);var e=null;for(d=0;d<c.length;d++){var f=a.validatePoints(b,c[d]);null==e?e=f:e.add(f)}null==e&&(e=new mxRectangle);a.setGraphBounds(e)}}
mxTemporaryCellStates.prototype.view=null;mxTemporaryCellStates.prototype.oldStates=null;mxTemporaryCellStates.prototype.oldBounds=null;mxTemporaryCellStates.prototype.oldScale=null;mxTemporaryCellStates.prototype.destroy=function(){this.view.setScale(this.oldScale);this.view.setStates(this.oldStates);this.view.setGraphBounds(this.oldBounds)};function mxCellStatePreview(a){this.graph=a;this.deltas={}}mxCellStatePreview.prototype.graph=null;mxCellStatePreview.prototype.deltas=null;
mxCellStatePreview.prototype.count=0;mxCellStatePreview.prototype.isEmpty=function(){return 0==this.count};mxCellStatePreview.prototype.moveState=function(a,b,c,d,e){d=null!=d?d:true;e=null!=e?e:true;var f=mxCellPath.create(a.cell),g=this.deltas[f];null==g?(g=new mxPoint(b,c),this.deltas[f]=g,this.count++):d?(g.X+=b,g.Y+=c):(g.X=b,g.Y=c);e&&this.addEdges(a);return g};
mxCellStatePreview.prototype.show=function(a){var b=this.graph.getModel(),c=b.getRoot(),d;for(d in this.deltas){var e=mxCellPath.resolve(c,d),f=this.graph.view.getState(e),g=this.deltas[d];e=this.graph.view.getState(b.getParent(e));this.translateState(e,f,g.x,g.y)}for(d in this.deltas){e=mxCellPath.resolve(c,d);f=this.graph.view.getState(e);g=this.deltas[d];e=this.graph.view.getState(b.getParent(e));this.revalidateState(e,f,g.x,g.y,a)}};
mxCellStatePreview.prototype.translateState=function(a,b,c,d){if(null!=b){var e=this.graph.getModel();if(e.isVertex(b.cell)){b.invalid=true;this.graph.view.validateBounds(a,b.cell);a=e.getGeometry(b.cell);var f=mxCellPath.create(b.cell);if((0!=c||0!=d)&&null!=a&&(!a.relative||null!=this.deltas[f])){b.x+=c;b.y+=d}}a=e.getChildCount(b.cell);for(f=0;f<a;f++)this.translateState(b,this.graph.view.getState(e.getChildAt(b.cell,f)),c,d)}};
mxCellStatePreview.prototype.revalidateState=function(a,b,c,d,e){if(null!=b){b.invalid=true;this.graph.view.validatePoints(a,b.cell);var f=mxCellPath.create(b.cell),g=this.graph.getModel(),h=this.graph.getCellGeometry(b.cell);if((0!=c||0!=d)&&null!=h&&h.relative&&g.isVertex(b.cell)&&(null==a||g.isVertex(a.cell)||null!=this.deltas[f])){b.x+=c;b.y+=d;this.graph.cellRenderer.redraw(b)}null!=e&&e(b);a=g.getChildCount(b.cell);for(f=0;f<a;f++)this.revalidateState(b,this.graph.view.getState(g.getChildAt(b.cell,
f)),c,d,e)}};mxCellStatePreview.prototype.addEdges=function(a){for(var b=this.graph.getModel(),c=b.getEdgeCount(a.cell),d=0;d<c;d++){var e=this.graph.view.getState(b.getEdgeAt(a.cell,d));null!=e&&this.moveState(e,0,0)}};function mxConnectionConstraint(a,b){this.point=a;this.perimeter=null!=b?b:true}mxConnectionConstraint.prototype.point=null;mxConnectionConstraint.prototype.perimeter=null;
function mxGraphHandler(a){this.graph=a;this.graph.addMouseListener(this);this.panHandler=mxUtils.bind(this,function(){this.updatePreviewShape()});this.graph.addListener(mxEvent.PAN,this.panHandler)}mxGraphHandler.prototype.graph=null;mxGraphHandler.prototype.maxCells=mxClient.IS_IE?20:50;mxGraphHandler.prototype.enabled=true;mxGraphHandler.prototype.highlightEnabled=true;mxGraphHandler.prototype.cloneEnabled=true;mxGraphHandler.prototype.moveEnabled=true;mxGraphHandler.prototype.guidesEnabled=false;
mxGraphHandler.prototype.guide=null;mxGraphHandler.prototype.currentDx=null;mxGraphHandler.prototype.currentDy=null;mxGraphHandler.prototype.updateCursor=true;mxGraphHandler.prototype.selectEnabled=true;mxGraphHandler.prototype.removeCellsFromParent=true;mxGraphHandler.prototype.connectOnDrop=false;mxGraphHandler.prototype.scrollOnMove=true;mxGraphHandler.prototype.minimumSize=6;mxGraphHandler.prototype.previewColor="black";mxGraphHandler.prototype.htmlPreview=false;
mxGraphHandler.prototype.shape=null;mxGraphHandler.prototype.scaleGrid=false;mxGraphHandler.prototype.rotationEnabled=true;mxGraphHandler.prototype.isEnabled=function(){return this.enabled};mxGraphHandler.prototype.setEnabled=function(a){this.enabled=a};mxGraphHandler.prototype.isCloneEnabled=function(){return this.cloneEnabled};mxGraphHandler.prototype.setCloneEnabled=function(a){this.cloneEnabled=a};mxGraphHandler.prototype.isMoveEnabled=function(){return this.moveEnabled};
mxGraphHandler.prototype.setMoveEnabled=function(a){this.moveEnabled=a};mxGraphHandler.prototype.isSelectEnabled=function(){return this.selectEnabled};mxGraphHandler.prototype.setSelectEnabled=function(a){this.selectEnabled=a};mxGraphHandler.prototype.isRemoveCellsFromParent=function(){return this.removeCellsFromParent};mxGraphHandler.prototype.setRemoveCellsFromParent=function(a){this.removeCellsFromParent=a};mxGraphHandler.prototype.getInitialCellForEvent=function(a){return a.getCell()};
mxGraphHandler.prototype.isDelayedSelection=function(a){return this.graph.isCellSelected(a)};
mxGraphHandler.prototype.mouseDown=function(a,b){if(!b.isConsumed()&&this.isEnabled()&&this.graph.isEnabled()&&!this.graph.isForceMarqueeEvent(b.getEvent())&&null!=b.getState()){var c=this.getInitialCellForEvent(b);this.cell=null;this.delayedSelection=this.isDelayedSelection(c);this.isSelectEnabled()&&!this.delayedSelection&&this.graph.selectCellForEvent(c,b.getEvent());if(this.isMoveEnabled()){var d=this.graph.model,e=d.getGeometry(c);this.graph.isCellMovable(c)&&(!d.isEdge(c)||1<this.graph.getSelectionCount()||
null!=e.points&&0<e.points.length||null==d.getTerminal(c,true)||null==d.getTerminal(c,false)||this.graph.allowDanglingEdges||this.graph.isCloneEvent(b.getEvent())&&this.graph.isCellsCloneable())&&this.start(c,b.getX(),b.getY());this.cellWasClicked=true;!mxClient.IS_SF&&!mxClient.IS_GC||"SELECT"!=b.getSource().nodeName?b.consume():mxClient.IS_SF&&"SELECT"==b.getSource().nodeName&&(this.cellWasClicked=false,this.first=null)}}};
mxGraphHandler.prototype.getGuideStates=function(){var a=this.graph.getDefaultParent(),b=this.graph.getModel(),c=mxUtils.bind(this,function(d){return null!=this.graph.view.getState(d)&&b.isVertex(d)&&null!=b.getGeometry(d)&&!b.getGeometry(d).relative});return this.graph.view.getCellStates(b.filterDescendants(c,a))};mxGraphHandler.prototype.getCells=function(a){return!this.delayedSelection&&this.graph.isCellMovable(a)?[a]:this.graph.getMovableCells(this.graph.getSelectionCells())};
mxGraphHandler.prototype.getPreviewBounds=function(a){a=this.getBoundingBox(a);null!=a&&(a.grow(-1,-1),a.width<this.minimumSize&&(a.x-=(this.minimumSize-a.width)/2,a.width=this.minimumSize),a.height<this.minimumSize&&(a.y-=(this.minimumSize-a.height)/2,a.height=this.minimumSize));return a};
mxGraphHandler.prototype.getBoundingBox=function(a){var b=null;if(null!=a&&0<a.length)for(var c=this.graph.getModel(),d=0;d<a.length;d++)if(c.isVertex(a[d])||c.isEdge(a[d])){var e=this.graph.view.getState(a[d]);if(null!=e){var f=e;c.isVertex(a[d])&&null!=e.shape&&null!=e.shape.boundingBox&&(f=e.shape.boundingBox);null==b?b=new mxRectangle(f.x,f.y,f.width,f.height):b.add(f)}}return b};
mxGraphHandler.prototype.createPreviewShape=function(a){a=new mxRectangleShape(a,null,this.previewColor);a.isDashed=true;this.htmlPreview?(a.dialect=mxConstants.DIALECT_STRICTHTML,a.init(this.graph.container)):(a.dialect=this.graph.dialect!=mxConstants.DIALECT_SVG?mxConstants.DIALECT_VML:mxConstants.DIALECT_SVG,a.init(this.graph.getView().getOverlayPane()),a.pointerEvents=false);return a};
mxGraphHandler.prototype.start=function(a,b,c){this.cell=a;this.first=mxUtils.convertPoint(this.graph.container,b,c);this.cells=this.getCells(this.cell);this.bounds=this.graph.getView().getBounds(this.cells);this.pBounds=this.getPreviewBounds(this.cells);this.guidesEnabled&&(this.guide=new mxGuide(this.graph,this.getGuideStates()))};mxGraphHandler.prototype.useGuidesForEvent=function(a){return null!=this.guide?this.guide.isEnabledForEvent(a.getEvent()):true};
mxGraphHandler.prototype.snap=function(a){var b=this.scaleGrid?this.graph.view.scale:1;a.x=this.graph.snap(a.x/b)*b;a.y=this.graph.snap(a.y/b)*b;return a};
mxGraphHandler.prototype.mouseMove=function(a,b){var c=this.graph;if(!b.isConsumed()&&c.isMouseDown&&null!=this.cell&&null!=this.first&&null!=this.bounds){var d=mxUtils.convertPoint(c.container,b.getX(),b.getY()),e=d.x-this.first.x,f=d.y-this.first.y;d=c.tolerance;if(null!=this.shape||Math.abs(e)>d||Math.abs(f)>d){null==this.highlight&&(this.highlight=new mxCellHighlight(this.graph,mxConstants.DROP_TARGET_COLOR,3));null==this.shape&&(this.shape=this.createPreviewShape(this.bounds));var g=c.isGridEnabledEvent(b.getEvent());
d=true;if(null!=this.guide&&this.useGuidesForEvent(b)){f=this.guide.move(this.bounds,new mxPoint(e,f),g);d=false;e=f.x;f=f.y}else if(g){var h=c.getView().translate,k=c.getView().scale;g=this.bounds.x-(c.snap(this.bounds.x/k-h.x)+h.x)*k;h=this.bounds.y-(c.snap(this.bounds.y/k-h.y)+h.y)*k;f=this.snap(new mxPoint(e,f));e=f.x-g;f=f.y-h}null!=this.guide&&d&&this.guide.hide();c.isConstrainedEvent(b.getEvent())&&(Math.abs(e)>Math.abs(f)?f=0:e=0);this.currentDx=e;this.currentDy=f;this.updatePreviewShape();
d=null;f=b.getCell();c.isDropEnabled()&&this.highlightEnabled&&(d=c.getDropTarget(this.cells,b.getEvent(),f));g=d;for(h=c.getModel();null!=g&&g!=this.cells[0];)g=h.getParent(g);k=c.isCloneEvent(b.getEvent())&&c.isCellsCloneable()&&this.isCloneEnabled();e=c.getView().getState(d);var l=false;null!=e&&null==g&&(h.getParent(this.cell)!=d||k)?(this.target!=d&&(this.target=d,this.setHighlightColor(mxConstants.DROP_TARGET_COLOR)),l=true):(this.target=null,this.connectOnDrop&&null!=f&&1==this.cells.length&&
c.getModel().isVertex(f)&&c.isCellConnectable(f)&&(e=c.getView().getState(f),null!=e&&(c=null==c.getEdgeValidationError(null,this.cell,f)?mxConstants.VALID_COLOR:mxConstants.INVALID_CONNECT_TARGET_COLOR,this.setHighlightColor(c),l=true)));null!=e&&l?this.highlight.highlight(e):this.highlight.hide()}b.consume();mxEvent.consume(b.getEvent())}else if((this.isMoveEnabled()||this.isCloneEnabled())&&this.updateCursor&&!b.isConsumed()&&null!=b.getState()&&!c.isMouseDown){e=c.getCursorForCell(b.getCell());
null==e&&c.isEnabled()&&c.isCellMovable(b.getCell())&&(e=c.getModel().isEdge(b.getCell())?mxConstants.CURSOR_MOVABLE_EDGE:mxConstants.CURSOR_MOVABLE_VERTEX);b.getState().setCursor(e);b.consume()}};mxGraphHandler.prototype.updatePreviewShape=function(){null!=this.shape&&(this.shape.bounds=new mxRectangle(Math.round(this.pBounds.x+this.currentDx-this.graph.panDx),Math.round(this.pBounds.y+this.currentDy-this.graph.panDy),this.pBounds.width,this.pBounds.height),this.shape.redraw())};
mxGraphHandler.prototype.setHighlightColor=function(a){null!=this.highlight&&this.highlight.setHighlightColor(a)};
mxGraphHandler.prototype.mouseUp=function(a,b){if(!b.isConsumed()){var c=this.graph;if(null!=this.cell&&null!=this.first&&null!=this.shape&&null!=this.currentDx&&null!=this.currentDy){var d=c.getView().scale,e=c.isCloneEvent(b.getEvent())&&c.isCellsCloneable()&&this.isCloneEnabled(),f=this.currentDx/d;d=this.currentDy/d;var g=b.getCell();this.connectOnDrop&&null==this.target&&null!=g&&c.getModel().isVertex(g)&&c.isCellConnectable(g)&&c.isEdgeValid(null,this.cell,g)?c.connectionHandler.connect(this.cell,
g,b.getEvent()):(g=this.target,c.isSplitEnabled()&&c.isSplitTarget(g,this.cells,b.getEvent())?c.splitEdge(g,this.cells,null,f,d):this.moveCells(this.cells,f,d,e,this.target,b.getEvent()))}else this.isSelectEnabled()&&this.delayedSelection&&null!=this.cell&&this.selectDelayed(b)}this.cellWasClicked&&b.consume();this.reset()};mxGraphHandler.prototype.selectDelayed=function(a){this.graph.selectCellForEvent(this.cell,a.getEvent())};
mxGraphHandler.prototype.reset=function(){this.destroyShapes();this.delayedSelection=this.cellWasClicked=false;this.target=this.cell=this.first=this.guides=this.currentDy=this.currentDx=null};
mxGraphHandler.prototype.shouldRemoveCellsFromParent=function(a,b,c){if(this.graph.getModel().isVertex(a)){a=this.graph.getView().getState(a);c=mxUtils.convertPoint(this.graph.container,mxEvent.getClientX(c),mxEvent.getClientY(c));var d=mxUtils.toRadians(mxUtils.getValue(a.style,mxConstants.STYLE_ROTATION)||0);if(0!=d){b=Math.cos(-d);d=Math.sin(-d);var e=new mxPoint(a.getCenterX(),a.getCenterY());c=mxUtils.getRotatedPoint(c,b,d,e)}return null!=a&&!mxUtils.contains(a,c.x,c.y)}return false};
mxGraphHandler.prototype.moveCells=function(a,b,c,d,e,f){d&&(a=this.graph.getCloneableCells(a));null==e&&this.isRemoveCellsFromParent()&&this.shouldRemoveCellsFromParent(this.graph.getModel().getParent(this.cell),a,f)&&(e=this.graph.getDefaultParent());a=this.graph.moveCells(a,b-this.graph.panDx/this.graph.view.scale,c-this.graph.panDy/this.graph.view.scale,d,e,f);this.isSelectEnabled()&&this.scrollOnMove&&this.graph.scrollCellToVisible(a[0]);d&&this.graph.setSelectionCells(a)};
mxGraphHandler.prototype.destroyShapes=function(){null!=this.shape&&(this.shape.destroy(),this.shape=null);null!=this.guide&&(this.guide.destroy(),this.guide=null);null!=this.highlight&&(this.highlight.destroy(),this.highlight=null)};mxGraphHandler.prototype.destroy=function(){this.graph.removeMouseListener(this);this.graph.removeListener(this.panHandler);this.destroyShapes()};
function mxPanningHandler(a,b){null!=a&&(this.graph=a,this.factoryMethod=b,this.graph.addMouseListener(this),this.init())}mxPanningHandler.prototype=new mxPopupMenu;mxPanningHandler.prototype.constructor=mxPanningHandler;mxPanningHandler.prototype.graph=null;mxPanningHandler.prototype.triggerX=null;mxPanningHandler.prototype.triggerY=null;mxPanningHandler.prototype.usePopupTrigger=true;mxPanningHandler.prototype.useLeftButtonForPanning=false;mxPanningHandler.prototype.selectOnPopup=true;
mxPanningHandler.prototype.clearSelectionOnBackground=true;mxPanningHandler.prototype.ignoreCell=false;mxPanningHandler.prototype.previewEnabled=true;mxPanningHandler.prototype.useGrid=false;mxPanningHandler.prototype.panningEnabled=true;mxPanningHandler.prototype.isPanningEnabled=function(){return this.panningEnabled};mxPanningHandler.prototype.setPanningEnabled=function(a){this.panningEnabled=a};
mxPanningHandler.prototype.init=function(){mxPopupMenu.prototype.init.apply(this);mxEvent.addGestureListeners(this.div,mxUtils.bind(this,function(){this.graph.tooltipHandler.hide()}))};mxPanningHandler.prototype.isPanningTrigger=function(a){var b=a.getEvent();return this.useLeftButtonForPanning&&(this.ignoreCell||null==a.getState())&&mxEvent.isLeftMouseButton(b)||mxEvent.isControlDown(b)&&mxEvent.isShiftDown(b)||this.usePopupTrigger&&mxEvent.isPopupTrigger(b)};
mxPanningHandler.prototype.mouseDown=function(a,b){if(!b.isConsumed()&&this.isEnabled()&&!this.active){this.hideMenu();this.dx0=-this.graph.container.scrollLeft;this.dy0=-this.graph.container.scrollTop;var c=mxUtils.convertPoint(this.graph.container,b.getX(),b.getY());this.triggerX=c.x;this.triggerY=c.y;this.popupTrigger=this.isPopupTrigger(b);this.panningTrigger=this.isPanningEnabled()&&this.isPanningTrigger(b);this.startX=b.getX();this.startY=b.getY();this.panningTrigger&&this.consumePanningTrigger(b)}};
mxPanningHandler.prototype.consumePanningTrigger=function(a){a.consume()};
mxPanningHandler.prototype.mouseMove=function(a,b){var c=b.getX()-this.startX,d=b.getY()-this.startY;if(this.active){var e=b.getEvent().scale;null!=e&&1!=e?this.scaleGraph(e,true):this.previewEnabled&&(this.useGrid&&(c=this.graph.snap(c),d=this.graph.snap(d)),this.graph.panGraph(c+this.dx0,d+this.dy0));this.fireEvent(new mxEventObject(mxEvent.PAN,"event",b));b.consume()}else this.panningTrigger&&(e=this.active,this.active=Math.abs(c)>this.graph.tolerance||Math.abs(d)>this.graph.tolerance,!e&&this.active&&
this.fireEvent(new mxEventObject(mxEvent.PAN_START,"event",b)))};
mxPanningHandler.prototype.mouseUp=function(a,b){var c=Math.abs(b.getX()-this.startX),d=Math.abs(b.getY()-this.startY);if(this.active){if(!this.graph.useScrollbarsForPanning||!mxUtils.hasScrollbars(this.graph.container)){c=b.getX()-this.startX;d=b.getY()-this.startY;this.useGrid&&(c=this.graph.snap(c),d=this.graph.snap(d));var e=this.graph.getView().scale,f=this.graph.getView().translate;this.graph.panGraph(0,0);var g=b.getEvent().scale;null!=g&&1!=g?this.scaleGraph(g,false):this.panGraph(f.x+c/e,
f.y+d/e)}this.active=false;this.fireEvent(new mxEventObject(mxEvent.PAN_END,"event",b));b.consume()}else this.popupTrigger&&c<this.graph.tolerance&&d<this.graph.tolerance&&(c=this.getCellForPopupEvent(b),this.graph.isEnabled()&&this.selectOnPopup&&null!=c&&!this.graph.isCellSelected(c)?this.graph.setSelectionCell(c):this.clearSelectionOnBackground&&null==c&&this.graph.clearSelection(),this.graph.tooltipHandler.hide(),d=mxUtils.getScrollOrigin(),d=new mxPoint(b.getX()+d.x,b.getY()+d.y),this.popup(d.x+
1,d.y+1,c,b.getEvent()),b.consume());this.popupTrigger=this.panningTrigger=false};mxPanningHandler.prototype.scaleGraph=function(a,b){b?this.graph.view.getCanvas().setAttribute("transform","scale("+a+")"):(this.graph.view.getCanvas().removeAttribute("transform"),this.graph.view.setScale(this.graph.view.scale*a))};mxPanningHandler.prototype.getCellForPopupEvent=function(a){return a.getCell()};mxPanningHandler.prototype.panGraph=function(a,b){this.graph.getView().setTranslate(a,b)};
mxPanningHandler.prototype.destroy=function(){this.graph.removeMouseListener(this);mxPopupMenu.prototype.destroy.apply(this)};function mxCellMarker(a,b,c,d){mxEventSource.call(this);null!=a&&(this.graph=a,this.validColor=null!=b?b:mxConstants.DEFAULT_VALID_COLOR,this.invalidColor=null!=b?c:mxConstants.DEFAULT_INVALID_COLOR,this.hotspot=null!=d?d:mxConstants.DEFAULT_HOTSPOT,this.highlight=new mxCellHighlight(a))}mxUtils.extend(mxCellMarker,mxEventSource);mxCellMarker.prototype.graph=null;
mxCellMarker.prototype.enabled=true;mxCellMarker.prototype.hotspot=mxConstants.DEFAULT_HOTSPOT;mxCellMarker.prototype.hotspotEnabled=false;mxCellMarker.prototype.validColor=null;mxCellMarker.prototype.invalidColor=null;mxCellMarker.prototype.currentColor=null;mxCellMarker.prototype.validState=null;mxCellMarker.prototype.markedState=null;mxCellMarker.prototype.setEnabled=function(a){this.enabled=a};mxCellMarker.prototype.isEnabled=function(){return this.enabled};
mxCellMarker.prototype.setHotspot=function(a){this.hotspot=a};mxCellMarker.prototype.getHotspot=function(){return this.hotspot};mxCellMarker.prototype.setHotspotEnabled=function(a){this.hotspotEnabled=a};mxCellMarker.prototype.isHotspotEnabled=function(){return this.hotspotEnabled};mxCellMarker.prototype.hasValidState=function(){return null!=this.validState};mxCellMarker.prototype.getValidState=function(){return this.validState};mxCellMarker.prototype.getMarkedState=function(){return this.markedState};
mxCellMarker.prototype.reset=function(){this.validState=null;null!=this.markedState&&(this.markedState=null,this.unmark())};
mxCellMarker.prototype.process=function(a){var b=null;if(this.isEnabled()){b=this.getState(a);var c=null!=b?this.isValidState(b):false;a=this.getMarkerColor(a.getEvent(),b,c);this.validState=c?b:null;if(b!=this.markedState||a!=this.currentColor){this.currentColor=a;null!=b&&null!=this.currentColor?(this.markedState=b,this.mark()):null!=this.markedState&&(this.markedState=null,this.unmark())}}return b};
mxCellMarker.prototype.markCell=function(a,b){var c=this.graph.getView().getState(a);null!=c&&(this.currentColor=null!=b?b:this.validColor,this.markedState=c,this.mark())};mxCellMarker.prototype.mark=function(){this.highlight.setHighlightColor(this.currentColor);this.highlight.highlight(this.markedState);this.fireEvent(new mxEventObject(mxEvent.MARK,"state",this.markedState))};mxCellMarker.prototype.unmark=function(){this.mark()};mxCellMarker.prototype.isValidState=function(){return true};
mxCellMarker.prototype.getMarkerColor=function(a,b,c){return c?this.validColor:this.invalidColor};mxCellMarker.prototype.getState=function(a){var b=this.graph.getView();cell=this.getCell(a);b=this.getStateToMark(b.getState(cell));return null!=b&&this.intersects(b,a)?b:null};mxCellMarker.prototype.getCell=function(a){return a.getCell()};mxCellMarker.prototype.getStateToMark=function(a){return a};
mxCellMarker.prototype.intersects=function(a,b){return this.hotspotEnabled?mxUtils.intersectsHotspot(a,b.getGraphX(),b.getGraphY(),this.hotspot,mxConstants.MIN_HOTSPOT_SIZE,mxConstants.MAX_HOTSPOT_SIZE):true};mxCellMarker.prototype.destroy=function(){this.graph.getView().removeListener(this.resetHandler);this.graph.getModel().removeListener(this.resetHandler);this.highlight.destroy()};
function mxSelectionCellsHandler(a){mxEventSource.call(this);this.graph=a;this.handlers=new mxDictionary;this.graph.addMouseListener(this);this.refreshHandler=mxUtils.bind(this,function(){this.isEnabled()&&this.refresh()});this.graph.getSelectionModel().addListener(mxEvent.CHANGE,this.refreshHandler);this.graph.getModel().addListener(mxEvent.CHANGE,this.refreshHandler);this.graph.getView().addListener(mxEvent.SCALE,this.refreshHandler);this.graph.getView().addListener(mxEvent.TRANSLATE,this.refreshHandler);
this.graph.getView().addListener(mxEvent.SCALE_AND_TRANSLATE,this.refreshHandler);this.graph.getView().addListener(mxEvent.DOWN,this.refreshHandler);this.graph.getView().addListener(mxEvent.UP,this.refreshHandler)}mxUtils.extend(mxSelectionCellsHandler,mxEventSource);mxSelectionCellsHandler.prototype.graph=null;mxSelectionCellsHandler.prototype.enabled=true;mxSelectionCellsHandler.prototype.refreshHandler=null;mxSelectionCellsHandler.prototype.maxHandlers=100;
mxSelectionCellsHandler.prototype.handlers=null;mxSelectionCellsHandler.prototype.isEnabled=function(){return this.enabled};mxSelectionCellsHandler.prototype.setEnabled=function(a){this.enabled=a};mxSelectionCellsHandler.prototype.getHandler=function(a){return this.handlers.get(a)};mxSelectionCellsHandler.prototype.reset=function(){this.handlers.visit(function(a,b){b.reset.apply(b)})};
mxSelectionCellsHandler.prototype.refresh=function(){var a=this.handlers;this.handlers=new mxDictionary;for(var b=this.graph.getSelectionCells(),c=0;c<b.length;c++){var d=this.graph.view.getState(b[c]);if(null!=d){var e=a.remove(b[c]);null!=e&&(e.state!=d?(e.destroy(),e=null):e.redraw());null==e&&(e=this.graph.createHandler(d),this.fireEvent(new mxEventObject(mxEvent.ADD,"state",d)));null!=e&&this.handlers.put(b[c],e)}}a.visit(mxUtils.bind(this,function(f,g){this.fireEvent(new mxEventObject(mxEvent.REMOVE,
"state",g.state));g.destroy()}))};mxSelectionCellsHandler.prototype.mouseDown=function(a,b){if(this.graph.isEnabled()&&this.isEnabled()){var c=[a,b];this.handlers.visit(function(d,e){e.mouseDown.apply(e,c)})}};mxSelectionCellsHandler.prototype.mouseMove=function(a,b){if(this.graph.isEnabled()&&this.isEnabled()){var c=[a,b];this.handlers.visit(function(d,e){e.mouseMove.apply(e,c)})}};
mxSelectionCellsHandler.prototype.mouseUp=function(a,b){if(this.graph.isEnabled()&&this.isEnabled()){var c=[a,b];this.handlers.visit(function(d,e){e.mouseUp.apply(e,c)})}};mxSelectionCellsHandler.prototype.destroy=function(){this.graph.removeMouseListener(this);null!=this.refreshHandler&&(this.graph.getSelectionModel().removeListener(this.refreshHandler),this.graph.getModel().removeListener(this.refreshHandler),this.graph.getView().removeListener(this.refreshHandler),this.refreshHandler=null)};
function mxConnectionHandler(a,b){mxEventSource.call(this);null!=a&&(this.graph=a,this.factoryMethod=b,this.init())}mxUtils.extend(mxConnectionHandler,mxEventSource);mxConnectionHandler.prototype.graph=null;mxConnectionHandler.prototype.factoryMethod=true;mxConnectionHandler.prototype.moveIconFront=false;mxConnectionHandler.prototype.moveIconBack=false;mxConnectionHandler.prototype.connectImage=null;mxConnectionHandler.prototype.targetConnectImage=false;mxConnectionHandler.prototype.enabled=true;
mxConnectionHandler.prototype.select=true;mxConnectionHandler.prototype.createTarget=false;mxConnectionHandler.prototype.marker=null;mxConnectionHandler.prototype.constraintHandler=null;mxConnectionHandler.prototype.error=null;mxConnectionHandler.prototype.waypointsEnabled=false;mxConnectionHandler.prototype.tapAndHoldEnabled=true;mxConnectionHandler.prototype.tapAndHoldDelay=500;mxConnectionHandler.prototype.tapAndHoldInProgress=false;mxConnectionHandler.prototype.tapAndHoldValid=false;
mxConnectionHandler.prototype.tapAndHoldTolerance=4;mxConnectionHandler.prototype.initialTouchX=0;mxConnectionHandler.prototype.initialTouchY=0;mxConnectionHandler.prototype.ignoreMouseDown=false;mxConnectionHandler.prototype.first=null;mxConnectionHandler.prototype.connectIconOffset=new mxPoint(0,mxConstants.TOOLTIP_VERTICAL_OFFSET);mxConnectionHandler.prototype.edgeState=null;mxConnectionHandler.prototype.changeHandler=null;mxConnectionHandler.prototype.drillHandler=null;
mxConnectionHandler.prototype.mouseDownCounter=0;mxConnectionHandler.prototype.movePreviewAway=mxClient.IS_VML;mxConnectionHandler.prototype.isEnabled=function(){return this.enabled};mxConnectionHandler.prototype.setEnabled=function(a){this.enabled=a};mxConnectionHandler.prototype.isCreateTarget=function(){return this.createTarget};mxConnectionHandler.prototype.setCreateTarget=function(a){this.createTarget=a};
mxConnectionHandler.prototype.createShape=function(){var a=new mxPolyline([],mxConstants.INVALID_COLOR);a.dialect=this.graph.dialect!=mxConstants.DIALECT_SVG?mxConstants.DIALECT_VML:mxConstants.DIALECT_SVG;a.init(this.graph.getView().getOverlayPane());a.svgStrokeTolerance=0;a.pointerEvents=false;a.isDashed=true;if(this.graph.dialect==mxConstants.DIALECT_SVG)a.node.setAttribute("pointer-events","none");else{var b=mxUtils.bind(this,function(c){c=mxUtils.convertPoint(this.graph.container,mxEvent.getClientX(c),
mxEvent.getClientY(c));return this.graph.view.getState(this.graph.getCellAt(c.x,c.y))});mxEvent.redirectMouseEvents(a.node,this.graph,b)}return a};
mxConnectionHandler.prototype.init=function(){this.graph.addMouseListener(this);this.marker=this.createMarker();this.constraintHandler=new mxConstraintHandler(this.graph);this.changeHandler=mxUtils.bind(this,function(){null!=this.iconState&&(this.iconState=this.graph.getView().getState(this.iconState.cell));null!=this.iconState?(this.redrawIcons(this.icons,this.iconState),this.constraintHandler.reset()):this.reset()});this.graph.getModel().addListener(mxEvent.CHANGE,this.changeHandler);this.graph.getView().addListener(mxEvent.SCALE,
this.changeHandler);this.graph.getView().addListener(mxEvent.TRANSLATE,this.changeHandler);this.graph.getView().addListener(mxEvent.SCALE_AND_TRANSLATE,this.changeHandler);this.drillHandler=mxUtils.bind(this,function(){this.reset()});this.graph.addListener(mxEvent.START_EDITING,this.drillHandler);this.graph.getView().addListener(mxEvent.DOWN,this.drillHandler);this.graph.getView().addListener(mxEvent.UP,this.drillHandler)};mxConnectionHandler.prototype.isConnectableCell=function(){return true};
mxConnectionHandler.prototype.createMarker=function(){var a=new mxCellMarker(this.graph);a.hotspotEnabled=true;a.getCell=mxUtils.bind(this,function(b,c){c=mxCellMarker.prototype.getCell.apply(a,arguments);this.error=null;if(!this.isConnectableCell(c))return null;null!=c?this.isConnecting()?null!=this.previous&&(this.error=this.validateConnection(this.previous.cell,c),null!=this.error&&0==this.error.length&&(c=null,this.isCreateTarget()&&(this.error=null))):this.isValidSource(c)||(c=null):this.isConnecting()&&
!this.isCreateTarget()&&!this.graph.allowDanglingEdges&&(this.error="");return c});a.isValidState=mxUtils.bind(this,function(){return this.isConnecting()?null==this.error:mxCellMarker.prototype.isValidState.apply(a,arguments)});a.getMarkerColor=mxUtils.bind(this,function(){return null==this.connectImage||this.isConnecting()?mxCellMarker.prototype.getMarkerColor.apply(a,arguments):null});a.intersects=mxUtils.bind(this,function(){return null!=this.connectImage||this.isConnecting()?true:mxCellMarker.prototype.intersects.apply(a,
arguments)});return a};mxConnectionHandler.prototype.start=function(a,b,c,d){this.previous=a;this.first=new mxPoint(b,c);this.edgeState=null!=d?d:this.createEdgeState(null);this.marker.currentColor=this.marker.validColor;this.marker.markedState=a;this.marker.mark();this.fireEvent(new mxEventObject(mxEvent.START,"state",this.previous))};mxConnectionHandler.prototype.isConnecting=function(){return null!=this.first&&null!=this.shape};mxConnectionHandler.prototype.isValidSource=function(a){return this.graph.isValidSource(a)};
mxConnectionHandler.prototype.isValidTarget=function(){return true};mxConnectionHandler.prototype.validateConnection=function(a,b){return!this.isValidTarget(b)?"":this.graph.getEdgeValidationError(null,a,b)};mxConnectionHandler.prototype.getConnectImage=function(){return this.connectImage};mxConnectionHandler.prototype.isMoveIconToFrontForState=function(a){return null!=a.text&&a.text.node.parentNode==this.graph.container?true:this.moveIconFront};
mxConnectionHandler.prototype.createIcons=function(a){var b=this.getConnectImage(a);if(null!=b&&null!=a){this.iconState=a;var c=[],d=new mxRectangle(0,0,b.width,b.height),e=new mxImageShape(d,b.src,null,null,0);e.preserveImageAspect=false;this.isMoveIconToFrontForState(a)?(e.dialect=mxConstants.DIALECT_STRICTHTML,e.init(this.graph.container)):(e.dialect=this.graph.dialect==mxConstants.DIALECT_SVG?mxConstants.DIALECT_SVG:mxConstants.DIALECT_VML,e.init(this.graph.getView().getOverlayPane()),this.moveIconBack&&
null!=e.node.previousSibling&&e.node.parentNode.insertBefore(e.node,e.node.parentNode.firstChild));e.node.style.cursor=mxConstants.CURSOR_CONNECT;var f=mxUtils.bind(this,function(){return null!=this.currentState?this.currentState:a});b=mxUtils.bind(this,function(g){mxEvent.isConsumed(g)||(this.icon=e,this.graph.fireMouseEvent(mxEvent.MOUSE_DOWN,new mxMouseEvent(g,f())))});mxEvent.redirectMouseEvents(e.node,this.graph,f,b);c.push(e);this.redrawIcons(c,this.iconState);return c}return null};
mxConnectionHandler.prototype.redrawIcons=function(a,b){if(null!=a&&null!=a[0]&&null!=b){var c=this.getIconPosition(a[0],b);a[0].bounds.x=c.x;a[0].bounds.y=c.y;a[0].redraw()}};
mxConnectionHandler.prototype.getIconPosition=function(a,b){var c=this.graph.getView().scale,d=b.getCenterX(),e=b.getCenterY();if(this.graph.isSwimlane(b.cell)){var f=this.graph.getStartSize(b.cell);d=0!=f.width?b.x+f.width*c/2:d;e=0!=f.height?b.y+f.height*c/2:e;f=mxUtils.toRadians(mxUtils.getValue(b.style,mxConstants.STYLE_ROTATION)||0);if(0!=f){c=Math.cos(f);f=Math.sin(f);var g=new mxPoint(b.getCenterX(),b.getCenterY());e=mxUtils.getRotatedPoint(new mxPoint(d,e),c,f,g);d=e.x;e=e.y}}return new mxPoint(d-
a.bounds.width/2,e-a.bounds.height/2)};mxConnectionHandler.prototype.destroyIcons=function(){if(null!=this.icons){for(var a=0;a<this.icons.length;a++)this.icons[a].destroy();this.iconState=this.selectedIcon=this.icon=this.icons=null}};
mxConnectionHandler.prototype.isStartEvent=function(a){return!this.graph.isForceMarqueeEvent(a.getEvent())&&(null!=this.constraintHandler.currentFocus&&null!=this.constraintHandler.currentConstraint||null!=this.previous&&null==this.error&&(null==this.icons||null!=this.icons&&null!=this.icon))};
mxConnectionHandler.prototype.mouseDown=function(a,b){this.mouseDownCounter++;if(this.isEnabled()&&this.graph.isEnabled()&&!b.isConsumed()&&!this.isConnecting()&&this.isStartEvent(b)){null!=this.constraintHandler.currentConstraint&&null!=this.constraintHandler.currentFocus&&null!=this.constraintHandler.currentPoint?(this.sourceConstraint=this.constraintHandler.currentConstraint,this.previous=this.constraintHandler.currentFocus,this.first=this.constraintHandler.currentPoint.clone()):this.first=new mxPoint(b.getGraphX(),
b.getGraphY());this.edgeState=this.createEdgeState(b);this.mouseDownCounter=1;this.waypointsEnabled&&null==this.shape&&(this.waypoints=null,this.shape=this.createShape());null==this.previous&&null!=this.edgeState&&this.edgeState.cell.geometry.setTerminalPoint(this.graph.getPointForEvent(b.getEvent()),true);this.fireEvent(new mxEventObject(mxEvent.START,"state",this.previous));b.consume()}else if(mxClient.IS_TOUCH&&this.tapAndHoldEnabled&&!this.tapAndHoldInProgress&&this.isEnabled()&&this.graph.isEnabled()&&
!this.isConnecting()){this.tapAndHoldInProgress=true;this.initialTouchX=b.getX();this.initialTouchY=b.getY();var c=this.graph.view.getState(this.marker.getCell(b));this.tapAndHoldThread&&window.clearTimeout(this.tapAndHoldThread);this.tapAndHoldThread=window.setTimeout(mxUtils.bind(this,function(){this.tapAndHoldValid&&this.tapAndHold(b,c);this.tapAndHoldValid=this.tapAndHoldInProgress=false}),this.tapAndHoldDelay);this.tapAndHoldValid=true}this.selectedIcon=this.icon;this.icon=null};
mxConnectionHandler.prototype.tapAndHold=function(a,b){null!=b&&(this.marker.currentColor=this.marker.validColor,this.marker.markedState=b,this.marker.mark(),this.first=new mxPoint(a.getGraphX(),a.getGraphY()),this.edgeState=this.createEdgeState(a),this.previous=b,this.fireEvent(new mxEventObject(mxEvent.START,"state",this.previous)))};mxConnectionHandler.prototype.isImmediateConnectSource=function(a){return!this.graph.isCellMovable(a.cell)};mxConnectionHandler.prototype.createEdgeState=function(){return null};
mxConnectionHandler.prototype.updateCurrentState=function(a){var b=this.marker.process(a);this.constraintHandler.update(a,null==this.first);this.currentState=b};mxConnectionHandler.prototype.convertWaypoint=function(a){var b=this.graph.getView().getScale(),c=this.graph.getView().getTranslate();a.x=a.x/b-c.x;a.y=a.y/b-c.y};
mxConnectionHandler.prototype.mouseMove=function(a,b){this.tapAndHoldValid&&(this.tapAndHoldValid=Math.abs(this.initialTouchX-b.getX())<this.tapAndHoldTolerance&&Math.abs(this.initialTouchY-b.getY())<this.tapAndHoldTolerance);if(!b.isConsumed()&&(this.ignoreMouseDown||null!=this.first||!this.graph.isMouseDown)){!this.isEnabled()&&null!=this.currentState&&(this.destroyIcons(),this.currentState=null);(null!=this.first||this.isEnabled()&&this.graph.isEnabled())&&this.updateCurrentState(b);if(null!=this.first){var c=
this.graph.getView().scale;c=new mxPoint(this.graph.snap(b.getGraphX()/c)*c,this.graph.snap(b.getGraphY()/c)*c);var d=null,e=c;null!=this.constraintHandler.currentConstraint&&null!=this.constraintHandler.currentFocus&&null!=this.constraintHandler.currentPoint&&(d=this.constraintHandler.currentConstraint,e=this.constraintHandler.currentPoint.clone());var f=this.first;if(null!=this.selectedIcon){var g=this.selectedIcon.bounds.width,h=this.selectedIcon.bounds.height;null!=this.currentState&&this.targetConnectImage?
(g=this.getIconPosition(this.selectedIcon,this.currentState),this.selectedIcon.bounds.x=g.x,this.selectedIcon.bounds.y=g.y):(g=new mxRectangle(b.getGraphX()+this.connectIconOffset.x,b.getGraphY()+this.connectIconOffset.y,g,h),this.selectedIcon.bounds=g);this.selectedIcon.redraw()}if(null!=this.edgeState){this.edgeState.absolutePoints=[null,null!=this.currentState?null:e];this.graph.view.updateFixedTerminalPoint(this.edgeState,this.previous,true,this.sourceConstraint);null!=this.currentState&&(null==
d&&(d=this.graph.getConnectionConstraint(this.edgeState,this.previous,false)),this.edgeState.setAbsoluteTerminalPoint(null,false),this.graph.view.updateFixedTerminalPoint(this.edgeState,this.currentState,false,d));f=null;if(null!=this.waypoints){f=[];for(e=0;e<this.waypoints.length;e++){d=this.waypoints[e].clone();this.convertWaypoint(d);f[e]=d}}this.graph.view.updatePoints(this.edgeState,f,this.previous,this.currentState);this.graph.view.updateFloatingTerminalPoints(this.edgeState,this.previous,
this.currentState);e=this.edgeState.absolutePoints[this.edgeState.absolutePoints.length-1];f=this.edgeState.absolutePoints[0]}else{null!=this.currentState&&null==this.constraintHandler.currentConstraint&&(g=this.getTargetPerimeterPoint(this.currentState,b),null!=g&&(e=g));null==this.sourceConstraint&&null!=this.previous&&(g=this.getSourcePerimeterPoint(this.previous,null!=this.waypoints&&0<this.waypoints.length?this.waypoints[0]:e,b),null!=g&&(f=g))}if(null==this.currentState&&this.movePreviewAway){g=
f;null!=this.edgeState&&2<this.edgeState.absolutePoints.length&&(d=this.edgeState.absolutePoints[this.edgeState.absolutePoints.length-2],null!=d&&(g=d));d=e.x-g.x;g=e.y-g.y;h=Math.sqrt(d*d+g*g);if(0==h)return;e.x-=4*d/h;e.y-=4*g/h}if(null==this.shape&&(d=Math.abs(c.x-this.first.x),g=Math.abs(c.y-this.first.y),d>this.graph.tolerance||g>this.graph.tolerance)){this.shape=this.createShape();this.updateCurrentState(b)}null!=this.shape&&(null!=this.edgeState?this.shape.points=this.edgeState.absolutePoints:
(c=[f],null!=this.waypoints&&(c=c.concat(this.waypoints)),c.push(e),this.shape.points=c),this.drawPreview());mxEvent.consume(b.getEvent());b.consume()}else!this.isEnabled()||!this.graph.isEnabled()?this.constraintHandler.reset():this.previous!=this.currentState&&null==this.edgeState?(this.destroyIcons(),null!=this.currentState&&null==this.error&&(this.icons=this.createIcons(this.currentState),null==this.icons&&(this.currentState.setCursor(mxConstants.CURSOR_CONNECT),b.consume())),this.previous=this.currentState):
this.previous==this.currentState&&null!=this.currentState&&null==this.icons&&!this.graph.isMouseDown&&b.consume();null!=this.constraintHandler.currentConstraint&&this.marker.reset();if(!this.graph.isMouseDown&&null!=this.currentState&&null!=this.icons){c=false;f=b.getSource();for(e=0;e<this.icons.length&&!c;e++)c=f==this.icons[e].node||f.parentNode==this.icons[e].node;c||this.updateIcons(this.currentState,this.icons,b)}}else this.constraintHandler.reset()};
mxConnectionHandler.prototype.getTargetPerimeterPoint=function(a){var b=null,c=a.view,d=c.getPerimeterFunction(a);if(null!=d){var e=null!=this.waypoints&&0<this.waypoints.length?this.waypoints[this.waypoints.length-1]:new mxPoint(this.previous.getCenterX(),this.previous.getCenterY());c=d(c.getPerimeterBounds(a),this.edgeState,e,false);null!=c&&(b=c)}else b=new mxPoint(a.getCenterX(),a.getCenterY());return b};
mxConnectionHandler.prototype.getSourcePerimeterPoint=function(a,b,c){c=null;var d=a.view,e=d.getPerimeterFunction(a),f=new mxPoint(a.getCenterX(),a.getCenterY());if(null!=e){var g=mxUtils.getValue(a.style,mxConstants.STYLE_ROTATION,0),h=-g*(Math.PI/180);0!=g&&(b=mxUtils.getRotatedPoint(new mxPoint(b.x,b.y),Math.cos(h),Math.sin(h),f));a=e(d.getPerimeterBounds(a),a,b,false);null!=a&&(0!=g&&(a=mxUtils.getRotatedPoint(new mxPoint(a.x,a.y),Math.cos(-h),Math.sin(-h),f)),c=a)}else c=f;return c};
mxConnectionHandler.prototype.updateIcons=function(){};mxConnectionHandler.prototype.isStopEvent=function(a){return null!=a.getState()};
mxConnectionHandler.prototype.addWaypointForEvent=function(a){var b=mxUtils.convertPoint(this.graph.container,a.getX(),a.getY()),c=Math.abs(b.x-this.first.x);b=Math.abs(b.y-this.first.y);if(null!=this.waypoints||1<this.mouseDownCounter&&(c>this.graph.tolerance||b>this.graph.tolerance)){null==this.waypoints&&(this.waypoints=[]);c=this.graph.view.scale;b=new mxPoint(this.graph.snap(a.getGraphX()/c)*c,this.graph.snap(a.getGraphY()/c)*c);this.waypoints.push(b)}};
mxConnectionHandler.prototype.mouseUp=function(a,b){if(!b.isConsumed()&&this.isConnecting()){if(this.waypointsEnabled&&!this.isStopEvent(b)){this.addWaypointForEvent(b);b.consume();return}if(null==this.error){var c=null!=this.previous?this.previous.cell:null,d=null;null!=this.constraintHandler.currentConstraint&&null!=this.constraintHandler.currentFocus&&(d=this.constraintHandler.currentFocus.cell);null==d&&this.marker.hasValidState()&&(d=this.marker.validState.cell);this.connect(c,d,b.getEvent(),
b.getCell())}else{null!=this.previous&&null!=this.marker.validState&&this.previous.cell==this.marker.validState.cell&&this.graph.selectCellForEvent(this.marker.source,evt);0<this.error.length&&this.graph.validationAlert(this.error)}this.destroyIcons();b.consume()}null!=this.first&&this.reset();this.tapAndHoldValid=this.tapAndHoldInProgress=false};
mxConnectionHandler.prototype.reset=function(){null!=this.shape&&(this.shape.destroy(),this.shape=null);this.destroyIcons();this.marker.reset();this.constraintHandler.reset();this.sourceConstraint=this.error=this.previous=this.edgeState=null;this.mouseDownCounter=0;this.first=null;this.fireEvent(new mxEventObject(mxEvent.RESET))};mxConnectionHandler.prototype.drawPreview=function(){var a=null==this.error;this.shape.strokewidth=this.getEdgeWidth(a);a=this.getEdgeColor(a);this.shape.stroke=a;this.shape.redraw()};
mxConnectionHandler.prototype.getEdgeColor=function(a){return a?mxConstants.VALID_COLOR:mxConstants.INVALID_COLOR};mxConnectionHandler.prototype.getEdgeWidth=function(a){return a?3:1};
mxConnectionHandler.prototype.connect=function(a,b,c,d){if(null!=b||this.isCreateTarget()||this.graph.allowDanglingEdges){var e=this.graph.getModel(),f=null;e.beginUpdate();try{if(null!=a&&null==b&&this.isCreateTarget()&&(b=this.createTargetVertex(c,a),null!=b)){d=this.graph.getDropTarget([b],c,d);if(null==d||!this.graph.getModel().isEdge(d)){var g=this.graph.getView().getState(d);if(null!=g){var h=e.getGeometry(b);h.x-=g.origin.x;h.y-=g.origin.y}}else d=this.graph.getDefaultParent();this.graph.addCell(b,
d)}var k=this.graph.getDefaultParent();null!=a&&null!=b&&e.getParent(a)==e.getParent(b)&&e.getParent(e.getParent(a))!=e.getRoot()&&(k=e.getParent(a),null!=a.geometry&&a.geometry.relative&&null!=b.geometry&&b.geometry.relative&&(k=e.getParent(k)));h=g=null;null!=this.edgeState&&(g=this.edgeState.cell.value,h=this.edgeState.cell.style);f=this.insertEdge(k,null,g,a,b,h);if(null!=f){this.graph.setConnectionConstraint(f,a,true,this.sourceConstraint);this.graph.setConnectionConstraint(f,b,false,this.constraintHandler.currentConstraint);
null!=this.edgeState&&e.setGeometry(f,this.edgeState.cell.geometry);var l=e.getGeometry(f);null==l&&(l=new mxGeometry,l.relative=true,e.setGeometry(f,l));if(null!=this.waypoints&&0<this.waypoints.length){var m=this.graph.view.scale,p=this.graph.view.translate;l.points=[];for(a=0;a<this.waypoints.length;a++){var o=this.waypoints[a];l.points.push(new mxPoint(o.x/m-p.x,o.y/m-p.y))}}null==b&&(o=this.graph.getPointForEvent(c,false),o.x-=this.graph.panDx/this.graph.view.scale,o.y-=this.graph.panDy/this.graph.view.scale,
l.setTerminalPoint(o,false));this.fireEvent(new mxEventObject(mxEvent.CONNECT,"cell",f,"event",c,"target",d))}}catch(n){mxLog.show();mxLog.debug(n.message)}finally{e.endUpdate()}this.select&&this.selectCells(f,b)}};mxConnectionHandler.prototype.selectCells=function(a){this.graph.setSelectionCell(a)};mxConnectionHandler.prototype.insertEdge=function(a,b,c,d,e,f){if(null==this.factoryMethod)return this.graph.insertEdge(a,b,c,d,e,f);b=this.createEdge(c,d,e,f);return this.graph.addEdge(b,a,d,e)};
mxConnectionHandler.prototype.createTargetVertex=function(a,b){for(var c=this.graph.getCellGeometry(b);null!=c&&c.relative;){b=this.graph.getModel().getParent(b);c=this.graph.getCellGeometry(b)}var d=this.graph.cloneCells([b])[0];c=this.graph.getModel().getGeometry(d);if(null!=c){var e=this.graph.getPointForEvent(a);c.x=this.graph.snap(e.x-c.width/2)-this.graph.panDx/this.graph.view.scale;c.y=this.graph.snap(e.y-c.height/2)-this.graph.panDy/this.graph.view.scale;if(null!=this.first){var f=this.graph.view.getState(b);
if(null!=f){var g=this.getAlignmentTolerance();Math.abs(this.graph.snap(this.first.x)-this.graph.snap(e.x))<=g?c.x=f.x:Math.abs(this.graph.snap(this.first.y)-this.graph.snap(e.y))<=g&&(c.y=f.y)}}}return d};mxConnectionHandler.prototype.getAlignmentTolerance=function(){return this.graph.isGridEnabled()?this.graph.gridSize:this.graph.tolerance};
mxConnectionHandler.prototype.createEdge=function(a,b,c,d){var e=null;null!=this.factoryMethod&&(e=this.factoryMethod(b,c,d));null==e&&(e=new mxCell(a||""),e.setEdge(true),e.setStyle(d),a=new mxGeometry,a.relative=true,e.setGeometry(a));return e};
mxConnectionHandler.prototype.destroy=function(){this.graph.removeMouseListener(this);null!=this.shape&&(this.shape.destroy(),this.shape=null);null!=this.marker&&(this.marker.destroy(),this.marker=null);null!=this.constraintHandler&&(this.constraintHandler.destroy(),this.constraintHandler=null);null!=this.changeHandler&&(this.graph.getModel().removeListener(this.changeHandler),this.graph.getView().removeListener(this.changeHandler),this.changeHandler=null);null!=this.drillHandler&&(this.graph.removeListener(this.drillHandler),
this.graph.getView().removeListener(this.drillHandler),this.drillHandler=null)};function mxConstraintHandler(a){this.graph=a}mxConstraintHandler.prototype.pointImage=new mxImage(mxClient.imageBasePath+"/point.gif",5,5);mxConstraintHandler.prototype.graph=null;mxConstraintHandler.prototype.enabled=true;mxConstraintHandler.prototype.highlightColor=mxConstants.DEFAULT_VALID_COLOR;mxConstraintHandler.prototype.isEnabled=function(){return this.enabled};
mxConstraintHandler.prototype.setEnabled=function(a){this.enabled=a};mxConstraintHandler.prototype.reset=function(){if(null!=this.focusIcons){for(var a=0;a<this.focusIcons.length;a++)this.focusIcons[a].destroy();this.focusIcons=null}null!=this.focusHighlight&&(this.focusHighlight.destroy(),this.focusHighlight=null);this.focusPoints=this.currentFocus=this.currentPoint=this.currentFocusArea=this.currentConstraint=null};mxConstraintHandler.prototype.getTolerance=function(){return this.graph.getTolerance()};
mxConstraintHandler.prototype.getImageForConstraint=function(){return this.pointImage};mxConstraintHandler.prototype.isEventIgnored=function(){return false};mxConstraintHandler.prototype.isStateIgnored=function(){return false};mxConstraintHandler.prototype.destroyIcons=function(){if(null!=this.focusIcons){for(var a=0;a<this.focusIcons.length;a++)this.focusIcons[a].destroy();this.focusPoints=this.focusIcons=null}};
mxConstraintHandler.prototype.destroyFocusHighlight=function(){null!=this.focusHighlight&&(this.focusHighlight.destroy(),this.focusHighlight=null)};
mxConstraintHandler.prototype.update=function(a,b){if(this.isEnabled()&&!this.isEventIgnored(a)){var c=this.getTolerance(),d=new mxRectangle(a.getGraphX()-c,a.getGraphY()-c,2*c,2*c),e=null!=a.getCell()?this.graph.isCellConnectable(a.getCell()):false;if(null==this.currentFocusArea||!mxUtils.intersects(this.currentFocusArea,d)||null!=a.getState()&&null!=this.currentFocus&&e)if(this.currentFocusArea=null,a.getState()!=this.currentFocus)if(this.currentFocus=null,this.constraints=null!=a.getState()&&e&&
!this.isStateIgnored(a.getState(),b)?this.graph.getAllConnectionConstraints(a.getState(),b):null,null!=this.constraints){this.currentFocus=a.getState();this.currentFocusArea=new mxRectangle(a.getState().x,a.getState().y,a.getState().width,a.getState().height);if(null!=this.focusIcons){for(e=0;e<this.focusIcons.length;e++)this.focusIcons[e].destroy();this.focusPoints=this.focusIcons=null}this.focusIcons=[];this.focusPoints=[];for(e=0;e<this.constraints.length;e++){var f=this.graph.getConnectionPoint(a.getState(),
this.constraints[e]),g=this.getImageForConstraint(a.getState(),this.constraints[e],f),h=g.src;g=new mxRectangle(f.x-g.width/2,f.y-g.height/2,g.width,g.height);g=new mxImageShape(g,h);g.dialect=this.graph.dialect!=mxConstants.DIALECT_SVG?mxConstants.DIALECT_MIXEDHTML:mxConstants.DIALECT_SVG;g.preserveImageAspect=false;g.init(this.graph.getView().getOverlayPane());null!=g.node.previousSibling&&g.node.parentNode.insertBefore(g.node,g.node.parentNode.firstChild);h=mxUtils.bind(this,function(){return null!=
this.currentFocus?this.currentFocus:a.getState()});g.redraw();mxEvent.redirectMouseEvents(g.node,this.graph,h);this.currentFocusArea.add(g.bounds);this.focusIcons.push(g);this.focusPoints.push(f)}this.currentFocusArea.grow(c)}else{this.destroyIcons();this.destroyFocusHighlight()}this.currentPoint=this.currentConstraint=null;if(null!=this.focusIcons&&null!=this.constraints&&(null==a.getState()||this.currentFocus==a.getState()))for(e=0;e<this.focusIcons.length;e++)if(mxUtils.intersects(this.focusIcons[e].bounds,
d)){this.currentConstraint=this.constraints[e];this.currentPoint=this.focusPoints[e];c=this.focusIcons[e].bounds.clone();c.grow(mxClient.IS_IE?3:2);mxClient.IS_IE&&(c.width-=1,c.height-=1);null==this.focusHighlight?(c=new mxRectangleShape(c,null,this.highlightColor,3),c.dialect=this.graph.dialect==mxConstants.DIALECT_SVG?mxConstants.DIALECT_SVG:mxConstants.DIALECT_VML,c.init(this.graph.getView().getOverlayPane()),this.focusHighlight=c,h=mxUtils.bind(this,function(){return null!=this.currentFocus?
this.currentFocus:a.getState()}),mxEvent.redirectMouseEvents(c.node,this.graph,h)):(this.focusHighlight.bounds=c,this.focusHighlight.redraw());break}null==this.currentConstraint&&this.destroyFocusHighlight()}};mxConstraintHandler.prototype.destroy=function(){this.reset()};
function mxRubberband(a){null!=a&&(this.graph=a,this.graph.addMouseListener(this),this.panHandler=mxUtils.bind(this,function(){this.repaint()}),this.graph.addListener(mxEvent.PAN,this.panHandler),mxClient.IS_IE&&mxEvent.addListener(window,"unload",mxUtils.bind(this,function(){this.destroy()})))}mxRubberband.prototype.defaultOpacity=20;mxRubberband.prototype.enabled=true;mxRubberband.prototype.div=null;mxRubberband.prototype.sharedDiv=null;mxRubberband.prototype.currentX=0;
mxRubberband.prototype.currentY=0;mxRubberband.prototype.isEnabled=function(){return this.enabled};mxRubberband.prototype.setEnabled=function(a){this.enabled=a};
mxRubberband.prototype.mouseDown=function(a,b){if(!b.isConsumed()&&this.isEnabled()&&this.graph.isEnabled()&&(this.graph.isForceMarqueeEvent(b.getEvent())||null==b.getState())){var c=mxUtils.getOffset(this.graph.container),d=mxUtils.getScrollOrigin(this.graph.container);d.x-=c.x;d.y-=c.y;this.start(b.getX()+d.x,b.getY()+d.y);if(mxClient.IS_NS&&!mxClient.IS_SF&&!mxClient.IS_GC){var e=this.graph.container,f=function(g){g=new mxMouseEvent(g);var h=mxUtils.convertPoint(e,g.getX(),g.getY());g.graphX=h.x;
g.graphY=h.y;return g};this.dragHandler=mxUtils.bind(this,function(g){this.mouseMove(this.graph,f(g))});this.dropHandler=mxUtils.bind(this,function(g){this.mouseUp(this.graph,f(g))});mxEvent.addListener(document,"mousemove",this.dragHandler);mxEvent.addListener(document,"mouseup",this.dropHandler)}b.consume(false)}};mxRubberband.prototype.start=function(a,b){this.first=new mxPoint(a,b)};
mxRubberband.prototype.mouseMove=function(a,b){if(!b.isConsumed()&&null!=this.first){var c=mxUtils.getScrollOrigin(this.graph.container),d=mxUtils.getOffset(this.graph.container);c.x-=d.x;c.y-=d.y;d=b.getX()+c.x;c=b.getY()+c.y;var e=this.first.x-d,f=this.first.y-c,g=this.graph.tolerance;if(null!=this.div||Math.abs(e)>g||Math.abs(f)>g){null==this.div&&(this.div=this.createShape());mxUtils.clearSelection();this.update(d,c);b.consume()}}};
mxRubberband.prototype.createShape=function(){null==this.sharedDiv&&(this.sharedDiv=document.createElement("div"),this.sharedDiv.className="mxRubberband",mxUtils.setOpacity(this.sharedDiv,this.defaultOpacity));this.graph.container.appendChild(this.sharedDiv);return this.sharedDiv};mxRubberband.prototype.mouseUp=function(a,b){var c=null!=this.div;this.reset();c&&(c=new mxRectangle(this.x,this.y,this.width,this.height),this.graph.selectRegion(c,b.getEvent()),b.consume())};
mxRubberband.prototype.reset=function(){null!=this.div&&this.div.parentNode.removeChild(this.div);null!=this.dragHandler&&(mxEvent.removeListener(document,"mousemove",this.dragHandler),this.dragHandler=null);null!=this.dropHandler&&(mxEvent.removeListener(document,"mouseup",this.dropHandler),this.dropHandler=null);this.currentY=this.currentX=0;this.div=this.first=null};mxRubberband.prototype.update=function(a,b){this.currentX=a;this.currentY=b;this.repaint()};
mxRubberband.prototype.repaint=function(){if(null!=this.div){var a=this.currentX-this.graph.panDx,b=this.currentY-this.graph.panDy;this.x=Math.min(this.first.x,a);this.y=Math.min(this.first.y,b);this.width=Math.max(this.first.x,a)-this.x;this.height=Math.max(this.first.y,b)-this.y;a=mxClient.IS_VML?this.graph.panDy:0;this.div.style.left=this.x+(mxClient.IS_VML?this.graph.panDx:0)+"px";this.div.style.top=this.y+a+"px";this.div.style.width=Math.max(1,this.width)+"px";this.div.style.height=Math.max(1,
this.height)+"px"}};mxRubberband.prototype.destroy=function(){this.destroyed||(this.destroyed=true,this.graph.removeMouseListener(this),this.graph.removeListener(this.panHandler),this.reset(),null!=this.sharedDiv&&(this.sharedDiv=null))};function mxVertexHandler(a){null!=a&&(this.state=a,this.init())}mxVertexHandler.prototype.graph=null;mxVertexHandler.prototype.state=null;mxVertexHandler.prototype.singleSizer=false;mxVertexHandler.prototype.index=null;
mxVertexHandler.prototype.allowHandleBoundsCheck=true;mxVertexHandler.prototype.handleImage=null;mxVertexHandler.prototype.tolerance=0;mxVertexHandler.prototype.rotationEnabled=false;mxVertexHandler.prototype.rotationRaster=true;mxVertexHandler.prototype.livePreview=false;
mxVertexHandler.prototype.init=function(){this.graph=this.state.view.graph;this.selectionBounds=this.getSelectionBounds(this.state);this.bounds=new mxRectangle(this.selectionBounds.x,this.selectionBounds.y,this.selectionBounds.width,this.selectionBounds.height);this.selectionBorder=this.createSelectionShape(this.bounds);this.selectionBorder.dialect=this.graph.dialect!=mxConstants.DIALECT_SVG?mxConstants.DIALECT_VML:mxConstants.DIALECT_SVG;this.selectionBorder.pointerEvents=false;this.selectionBorder.init(this.graph.getView().getOverlayPane());
this.graph.isCellMovable(this.state.cell)&&(this.selectionBorder.node.style.cursor=mxConstants.CURSOR_MOVABLE_VERTEX);mxEvent.redirectMouseEvents(this.selectionBorder.node,this.graph,this.state);if(0>=mxGraphHandler.prototype.maxCells||this.graph.getSelectionCount()<mxGraphHandler.prototype.maxCells){var a=this.graph.isCellResizable(this.state.cell);this.sizers=[];if(a||this.graph.isLabelMovable(this.state.cell)&&2<=this.state.width&&2<=this.state.height){var b=0;a&&(this.singleSizer||(this.sizers.push(this.createSizer("nw-resize",
b++)),this.sizers.push(this.createSizer("n-resize",b++)),this.sizers.push(this.createSizer("ne-resize",b++)),this.sizers.push(this.createSizer("w-resize",b++)),this.sizers.push(this.createSizer("e-resize",b++)),this.sizers.push(this.createSizer("sw-resize",b++)),this.sizers.push(this.createSizer("s-resize",b++))),this.sizers.push(this.createSizer("se-resize",b++)));a=this.graph.model.getGeometry(this.state.cell);null!=a&&!a.relative&&!this.graph.isSwimlane(this.state.cell)&&this.graph.isLabelMovable(this.state.cell)&&
(this.labelShape=this.createSizer(mxConstants.CURSOR_LABEL_HANDLE,mxEvent.LABEL_HANDLE,mxConstants.LABEL_HANDLE_SIZE,mxConstants.LABEL_HANDLE_FILLCOLOR),this.sizers.push(this.labelShape))}else this.graph.isCellMovable(this.state.cell)&&!this.graph.isCellResizable(this.state.cell)&&2>this.state.width&&2>this.state.height&&(this.labelShape=this.createSizer(mxConstants.CURSOR_MOVABLE_VERTEX,null,null,mxConstants.LABEL_HANDLE_FILLCOLOR),this.sizers.push(this.labelShape))}if(this.rotationEnabled&&this.graph.isCellRotatable(this.state.cell)&&
(0>=mxGraphHandler.prototype.maxCells||this.graph.getSelectionCount()<mxGraphHandler.prototype.maxCells)){this.rotationShape=this.createSizer("pointer",mxEvent.ROTATION_HANDLE,mxConstants.HANDLE_SIZE+3,mxConstants.HANDLE_FILLCOLOR);this.sizers.push(this.rotationShape)}this.redraw()};mxVertexHandler.prototype.getSelectionBounds=function(a){return new mxRectangle(Math.round(a.x),Math.round(a.y),Math.round(a.width),Math.round(a.height))};
mxVertexHandler.prototype.createSelectionShape=function(a){a=new mxRectangleShape(a,null,this.getSelectionColor());a.strokewidth=this.getSelectionStrokeWidth();a.isDashed=this.isSelectionDashed();return a};mxVertexHandler.prototype.getSelectionColor=function(){return mxConstants.VERTEX_SELECTION_COLOR};mxVertexHandler.prototype.getSelectionStrokeWidth=function(){return mxConstants.VERTEX_SELECTION_STROKEWIDTH};mxVertexHandler.prototype.isSelectionDashed=function(){return mxConstants.VERTEX_SELECTION_DASHED};
mxVertexHandler.prototype.createSizer=function(a,b,c,d){c=c||mxConstants.HANDLE_SIZE;c=new mxRectangle(0,0,c,c);d=this.createSizerShape(c,b,d);d.isHtmlAllowed()&&null!=this.state.text&&this.state.text.node.parentNode==this.graph.container?(d.bounds.height-=1,d.bounds.width-=1,d.dialect=mxConstants.DIALECT_STRICTHTML,d.init(this.graph.container)):(d.dialect=this.graph.dialect!=mxConstants.DIALECT_SVG?mxConstants.DIALECT_MIXEDHTML:mxConstants.DIALECT_SVG,d.init(this.graph.getView().getOverlayPane()));
mxEvent.redirectMouseEvents(d.node,this.graph,this.state);this.graph.isEnabled()&&(d.node.style.cursor=a);this.isSizerVisible(b)||(d.node.style.visibility="hidden");return d};mxVertexHandler.prototype.isSizerVisible=function(){return true};
mxVertexHandler.prototype.createSizerShape=function(a,b,c){return null!=this.handleImage?(a.width=this.handleImage.width,a.height=this.handleImage.height,new mxImageShape(a,this.handleImage.src)):b==mxEvent.ROTATION_HANDLE?new mxEllipse(a,c||mxConstants.HANDLE_FILLCOLOR,mxConstants.HANDLE_STROKECOLOR):new mxRectangleShape(a,c||mxConstants.HANDLE_FILLCOLOR,mxConstants.HANDLE_STROKECOLOR)};
mxVertexHandler.prototype.moveSizerTo=function(a,b,c){null!=a&&(a.bounds.x=Math.round(b-a.bounds.width/2),a.bounds.y=Math.round(c-a.bounds.height/2),a.redraw())};
mxVertexHandler.prototype.getHandleForEvent=function(a){if(a.isSource(this.rotationShape))return mxEvent.ROTATION_HANDLE;if(a.isSource(this.labelShape))return mxEvent.LABEL_HANDLE;if(null!=this.sizers){var b=this.tolerance;b=this.allowHandleBoundsCheck&&(mxClient.IS_IE||0<b)?new mxRectangle(a.getGraphX()-b,a.getGraphY()-b,2*b,2*b):null;for(var c=0;c<this.sizers.length;c++)if(a.isSource(this.sizers[c])||null!=b&&mxUtils.intersects(this.sizers[c].bounds,b))return c}return null};
mxVertexHandler.prototype.mouseDown=function(a,b){if(!b.isConsumed()&&this.graph.isEnabled()&&!this.graph.isForceMarqueeEvent(b.getEvent())&&(0<this.tolerance||b.getState()==this.state)){var c=this.getHandleForEvent(b);null!=c&&(this.start(b.getX(),b.getY(),c),b.consume())}};
mxVertexHandler.prototype.start=function(a,b,c){a=mxUtils.convertPoint(this.graph.container,a,b);this.startX=a.x;this.startY=a.y;this.index=c;this.selectionBorder.node.style.display=c==mxEvent.ROTATION_HANDLE?"inline":"none";this.livePreview||(this.preview=this.createSelectionShape(this.bounds),!(mxClient.IS_SVG&&0!=Number(this.state.style[mxConstants.STYLE_ROTATION]||"0"))&&null!=this.state.text&&this.state.text.node.parentNode==this.graph.container?(this.preview.dialect=mxConstants.DIALECT_STRICTHTML,
this.preview.init(this.graph.container)):(this.preview.dialect=this.graph.dialect!=mxConstants.DIALECT_SVG?mxConstants.DIALECT_VML:mxConstants.DIALECT_SVG,this.preview.init(this.graph.view.getOverlayPane())))};
mxVertexHandler.prototype.mouseMove=function(a,b){if(!b.isConsumed()&&null!=this.index){var c=new mxPoint(b.getGraphX(),b.getGraphY()),d=this.graph.isGridEnabledEvent(b.getEvent()),e=this.graph.getView().scale;if(this.index==mxEvent.LABEL_HANDLE){d&&(c.x=this.graph.snap(c.x/e)*e,c.y=this.graph.snap(c.y/e)*e);this.moveSizerTo(this.sizers[this.sizers.length-1],c.x,c.y)}else if(this.index==mxEvent.ROTATION_HANDLE){var f=this.state.x+this.state.width/2-c.x,g=this.state.y+this.state.height/2-c.y;this.currentAlpha=
0!=f?180*Math.atan(g/f)/Math.PI+90:0>g?180:0;0<f&&(this.currentAlpha-=180);this.rotationRaster&&this.graph.isGridEnabledEvent(b.getEvent())&&(f=c.x-this.state.getCenterX(),g=c.y-this.state.getCenterY(),e=Math.abs(Math.sqrt(f*f+g*g)-this.state.height/2-20),e=Math.max(1,5*Math.min(3,Math.max(0,Math.round(80/Math.abs(e))))),this.currentAlpha=Math.round(this.currentAlpha/e)*e);this.selectionBorder.rotation=this.currentAlpha;this.selectionBorder.redraw()}else{var h=mxUtils.toRadians(this.state.style[mxConstants.STYLE_ROTATION]||
"0"),k=Math.cos(-h),l=Math.sin(-h),m=new mxPoint(this.state.getCenterX(),this.state.getCenterY());f=c.x-this.startX;g=c.y-this.startY;c=this.graph.view.translate;var p=l*f+k*g;this.bounds=this.union(this.selectionBounds,k*f-l*g,p,this.index,d,e,c);k=Math.cos(h);l=Math.sin(h);g=new mxPoint(this.bounds.getCenterX(),this.bounds.getCenterY());f=g.x-m.x;g=g.y-m.y;this.bounds.x+=k*f-l*g-f;this.bounds.y+=l*f+k*g-g;this.livePreview?(f=new mxRectangle(this.state.x,this.state.y,this.state.width,this.state.height),
k=this.state.origin,this.state.x=this.bounds.x,this.state.y=this.bounds.y,this.state.origin=new mxPoint(this.state.x/e-c.x,this.state.y/e-c.y),this.state.width=this.bounds.width,this.state.height=this.bounds.height,this.state.view.graph.cellRenderer.redraw(this.state,true),this.redrawHandles(),this.state.view.invalidate(this.state.cell),this.state.invalid=false,this.state.view.validate(),this.state.x=f.x,this.state.y=f.y,this.state.width=f.width,this.state.height=f.height,this.state.origin=k):this.drawPreview()}b.consume()}else null!=
this.getHandleForEvent(b)&&b.consume(false)};
mxVertexHandler.prototype.mouseUp=function(a,b){if(!b.isConsumed()&&null!=this.index&&null!=this.state){var c=new mxPoint(b.getGraphX(),b.getGraphY());this.graph.getModel().beginUpdate();try{if(this.index==mxEvent.ROTATION_HANDLE){if(null!=this.currentAlpha){var d=this.currentAlpha-(this.state.style[mxConstants.STYLE_ROTATION]||0);0!=d&&this.rotateCell(this.state.cell,d)}}else{var e=this.graph.isGridEnabledEvent(b.getEvent()),f=mxUtils.toRadians(this.state.style[mxConstants.STYLE_ROTATION]||"0"),
g=Math.cos(-f),h=Math.sin(-f),k=c.x-this.startX,l=c.y-this.startY;c=h*k+g*l;k=g*k-h*l;l=c;var m=this.graph.view.scale;this.resizeCell(this.state.cell,k/m,l/m,this.index,e)}}finally{this.graph.getModel().endUpdate()}this.reset();b.consume()}};
mxVertexHandler.prototype.rotateCell=function(a,b){var c=this.graph.getModel();if(c.isVertex(a)){var d=a==this.state?this.state:this.graph.view.getState(a);null!=d&&this.graph.setCellStyles(mxConstants.STYLE_ROTATION,(d.style[mxConstants.STYLE_ROTATION]||0)+b,[a]);if(this.state.cell!=a&&(d=this.graph.getCellGeometry(a),null!=d&&!d.relative&&0!=b)){var e=this.graph.getModel().getParent(a),f=this.graph.getCellGeometry(e);if(!d.relative&&null!=f){var g=mxUtils.toRadians(b);e=Math.cos(g);g=Math.sin(g);
var h=new mxPoint(d.getCenterX(),d.getCenterY());f=new mxPoint(f.width/2,f.height/2);e=mxUtils.getRotatedPoint(h,e,g,f);d=d.clone();d.x=e.x-d.width/2;d.y=e.y-d.height/2;c.setGeometry(a,d)}}d=c.getChildCount(a);for(e=0;e<d;e++)this.rotateCell(c.getChildAt(a,e),b)}};
mxVertexHandler.prototype.reset=function(){null!=this.sizers&&null!=this.index&&null!=this.sizers[this.index]&&"none"==this.sizers[this.index].node.style.display&&(this.sizers[this.index].node.style.display="");this.index=this.currentAlpha=null;null!=this.preview&&(this.preview.destroy(),this.preview=null);null!=this.selectionBorder&&(this.selectionBorder.node.style.display="inline",this.selectionBounds=this.getSelectionBounds(this.state),this.bounds=new mxRectangle(this.selectionBounds.x,this.selectionBounds.y,
this.selectionBounds.width,this.selectionBounds.height),this.drawPreview())};
mxVertexHandler.prototype.resizeCell=function(a,b,c,d,e){var f=this.graph.model.getGeometry(a);if(null!=f)if(d==mxEvent.LABEL_HANDLE){d=this.graph.view.scale;b=(this.labelShape.bounds.getCenterX()-this.startX)/d;c=(this.labelShape.bounds.getCenterY()-this.startY)/d;f=f.clone();null==f.offset?f.offset=new mxPoint(b,c):(f.offset.x+=b,f.offset.y+=c);this.graph.model.setGeometry(a,f)}else{d=this.union(f,b,c,d,e,1,new mxPoint(0,0));var g=mxUtils.toRadians(this.state.style[mxConstants.STYLE_ROTATION]||
"0");if(0!=g){b=d.getCenterX()-f.getCenterX();c=d.getCenterY()-f.getCenterY();e=Math.cos(g);var h=Math.sin(g);g=e*b-h*c-b;b=h*b+e*c-c;c=d.x-f.x;var k=d.y-f.y,l=e*c-h*k;e=h*c+e*k;d.x+=g;d.y+=b;if(!this.graph.isCellCollapsed(a)&&(0!=g||0!=b)){c=f.x-d.x+l;k=f.y-d.y+e;this.moveChildren(a,c,k)}}this.graph.resizeCell(a,d)}};
mxVertexHandler.prototype.moveChildren=function(a,b,c){for(var d=this.graph.getModel(),e=d.getChildCount(a),f=0;f<e;f++){var g=d.getChildAt(a,f);if(d.isVertex(g)){var h=this.graph.getCellGeometry(g);null!=h&&!h.relative&&(h=h.clone(),h.x+=b,h.y+=c,d.setGeometry(g,h))}}};
mxVertexHandler.prototype.union=function(a,b,c,d,e,f,g){if(this.singleSizer){g=a.x+a.width+b;var h=a.y+a.height+c;e&&(g=this.graph.snap(g/f)*f,h=this.graph.snap(h/f)*f);f=new mxRectangle(a.x,a.y,0,0);f.add(new mxRectangle(g,h,0,0));return f}h=a.x-g.x*f;var k=h+a.width,l=a.y-g.y*f;a=l+a.height;4<d?(a+=c,e&&(a=this.graph.snap(a/f)*f)):3>d&&(l+=c,e&&(l=this.graph.snap(l/f)*f));if(0==d||3==d||5==d){h+=b;e&&(h=this.graph.snap(h/f)*f)}else if(2==d||4==d||7==d){k+=b;e&&(k=this.graph.snap(k/f)*f)}e=k-h;a-=
l;0>e&&(h+=e,e=Math.abs(e));0>a&&(l+=a,a=Math.abs(a));return new mxRectangle(h+g.x*f,l+g.y*f,e,a)};mxVertexHandler.prototype.redraw=function(){this.selectionBounds=this.getSelectionBounds(this.state);this.bounds=new mxRectangle(this.state.x,this.state.y,this.state.width,this.state.height);this.redrawHandles();this.drawPreview()};
mxVertexHandler.prototype.redrawHandles=function(){var a=this.state;if(null!=this.sizers){var b=a.x+a.width,c=a.y+a.height;if(this.singleSizer)this.moveSizerTo(this.sizers[0],b,c);else{var d=a.x+a.width/2,e=a.y+a.height/2;if(1<this.sizers.length){var f=mxUtils.toRadians(a.style[mxConstants.STYLE_ROTATION]||"0"),g=Math.cos(f);f=Math.sin(f);var h=new mxPoint(a.getCenterX(),a.getCenterY()),k=mxUtils.getRotatedPoint(new mxPoint(a.x,a.y),g,f,h);this.moveSizerTo(this.sizers[0],k.x,k.y);k.x=d;k.y=a.y;k=
mxUtils.getRotatedPoint(k,g,f,h);this.moveSizerTo(this.sizers[1],k.x,k.y);k.x=b;k.y=a.y;k=mxUtils.getRotatedPoint(k,g,f,h);this.moveSizerTo(this.sizers[2],k.x,k.y);k.x=a.x;k.y=e;k=mxUtils.getRotatedPoint(k,g,f,h);this.moveSizerTo(this.sizers[3],k.x,k.y);k.x=b;k.y=e;k=mxUtils.getRotatedPoint(k,g,f,h);this.moveSizerTo(this.sizers[4],k.x,k.y);k.x=a.x;k.y=c;k=mxUtils.getRotatedPoint(k,g,f,h);this.moveSizerTo(this.sizers[5],k.x,k.y);k.x=d;k.y=c;k=mxUtils.getRotatedPoint(k,g,f,h);this.moveSizerTo(this.sizers[6],
k.x,k.y);k.x=b;k.y=c;k=mxUtils.getRotatedPoint(k,g,f,h);this.moveSizerTo(this.sizers[7],k.x,k.y);this.moveSizerTo(this.sizers[8],d+a.absoluteOffset.x,e+a.absoluteOffset.y)}else 2<=this.state.width&&2<=this.state.height?this.moveSizerTo(this.sizers[0],d+a.absoluteOffset.x,e+a.absoluteOffset.y):this.moveSizerTo(this.sizers[0],a.x,a.y)}}null!=this.rotationShape&&(f=mxUtils.toRadians(this.state.style[mxConstants.STYLE_ROTATION]||"0"),g=Math.cos(f),f=Math.sin(f),h=new mxPoint(this.state.getCenterX(),this.state.getCenterY()),
k=mxUtils.getRotatedPoint(new mxPoint(a.x+a.width/2,a.y-16),g,f,h),this.moveSizerTo(this.rotationShape,k.x,k.y));this.selectionBorder.rotation=Number(this.state.style[mxConstants.STYLE_ROTATION]||"0")};
mxVertexHandler.prototype.drawPreview=function(){null!=this.preview&&(this.preview.bounds=this.bounds,this.preview.node.parentNode==this.graph.container&&(this.preview.bounds.width=Math.max(0,this.preview.bounds.width-1),this.preview.bounds.height=Math.max(0,this.preview.bounds.height-1)),this.preview.rotation=Number(this.state.style[mxConstants.STYLE_ROTATION]||"0"),this.preview.redraw());this.selectionBorder.bounds=this.bounds;this.selectionBorder.redraw()};
mxVertexHandler.prototype.destroy=function(){null!=this.preview&&(this.preview.destroy(),this.preview=null);this.selectionBorder.destroy();this.labelShape=this.selectionBorder=null;if(null!=this.sizers)for(var a=0;a<this.sizers.length;a++){this.sizers[a].destroy();this.sizers[a]=null}};function mxEdgeHandler(a){null!=a&&(this.state=a,this.init())}mxEdgeHandler.prototype.graph=null;mxEdgeHandler.prototype.state=null;mxEdgeHandler.prototype.marker=null;mxEdgeHandler.prototype.constraintHandler=null;
mxEdgeHandler.prototype.error=null;mxEdgeHandler.prototype.shape=null;mxEdgeHandler.prototype.bends=null;mxEdgeHandler.prototype.labelShape=null;mxEdgeHandler.prototype.cloneEnabled=true;mxEdgeHandler.prototype.addEnabled=false;mxEdgeHandler.prototype.removeEnabled=false;mxEdgeHandler.prototype.preferHtml=false;mxEdgeHandler.prototype.allowHandleBoundsCheck=true;mxEdgeHandler.prototype.snapToTerminals=false;mxEdgeHandler.prototype.handleImage=null;mxEdgeHandler.prototype.tolerance=0;
mxEdgeHandler.prototype.livePreview=false;
mxEdgeHandler.prototype.init=function(){this.graph=this.state.view.graph;this.marker=this.createMarker();this.constraintHandler=new mxConstraintHandler(this.graph);this.points=[];this.abspoints=this.getSelectionPoints(this.state);this.shape=this.createSelectionShape(this.abspoints);this.shape.dialect=this.graph.dialect!=mxConstants.DIALECT_SVG?mxConstants.DIALECT_MIXEDHTML:mxConstants.DIALECT_SVG;this.shape.init(this.graph.getView().getOverlayPane());this.shape.svgStrokeTolerance=0;this.shape.node.style.cursor=
mxConstants.CURSOR_MOVABLE_EDGE;mxEvent.addListener(this.shape.node,"dblclick",mxUtils.bind(this,function(b){this.graph.dblClick(b,this.state.cell)}));mxEvent.addGestureListeners(this.shape.node,mxUtils.bind(this,function(b){this.addEnabled&&this.isAddPointEvent(b)?this.addPoint(this.state,b):this.graph.fireMouseEvent(mxEvent.MOUSE_DOWN,new mxMouseEvent(b,this.state))}),mxUtils.bind(this,function(b){var c=this.state.cell;if(null!=this.index){var d=mxUtils.convertPoint(this.graph.container,mxEvent.getClientX(b),
mxEvent.getClientY(b));c=this.graph.getCellAt(d.x,d.y);this.graph.isSwimlane(c)&&this.graph.hitsSwimlaneContent(c,d.x,d.y)&&(c=null)}this.graph.fireMouseEvent(mxEvent.MOUSE_MOVE,new mxMouseEvent(b,this.graph.getView().getState(c)))}),mxUtils.bind(this,function(b){this.graph.fireMouseEvent(mxEvent.MOUSE_UP,new mxMouseEvent(b,this.state))}));this.preferHtml=null!=this.state.text&&this.state.text.node.parentNode==this.graph.container;if(!this.preferHtml){var a=this.state.getVisibleTerminalState(true);
null!=a&&(this.preferHtml=null!=a.text&&a.text.node.parentNode==this.graph.container);this.preferHtml||(a=this.state.getVisibleTerminalState(false),null!=a&&(this.preferHtml=null!=a.text&&a.text.node.parentNode==this.graph.container))}if(this.graph.getSelectionCount()<mxGraphHandler.prototype.maxCells||0>=mxGraphHandler.prototype.maxCells)this.bends=this.createBends();this.label=new mxPoint(this.state.absoluteOffset.x,this.state.absoluteOffset.y);this.labelShape=new mxRectangleShape(new mxRectangle,
mxConstants.LABEL_HANDLE_FILLCOLOR,mxConstants.HANDLE_STROKECOLOR);this.labelShape.pointerEvents=false;this.initBend(this.labelShape);this.labelShape.node.style.cursor=mxConstants.CURSOR_LABEL_HANDLE;mxEvent.redirectMouseEvents(this.labelShape.node,this.graph,this.state);this.redraw()};mxEdgeHandler.prototype.isAddPointEvent=function(a){return mxEvent.isShiftDown(a)};mxEdgeHandler.prototype.isRemovePointEvent=function(a){return mxEvent.isShiftDown(a)};mxEdgeHandler.prototype.getSelectionPoints=function(a){return a.absolutePoints};
mxEdgeHandler.prototype.createSelectionShape=function(a){a=new mxPolyline(a,this.getSelectionColor());a.strokewidth=this.getSelectionStrokeWidth();a.isDashed=this.isSelectionDashed();return a};mxEdgeHandler.prototype.getSelectionColor=function(){return mxConstants.EDGE_SELECTION_COLOR};mxEdgeHandler.prototype.getSelectionStrokeWidth=function(){return mxConstants.EDGE_SELECTION_STROKEWIDTH};mxEdgeHandler.prototype.isSelectionDashed=function(){return mxConstants.EDGE_SELECTION_DASHED};
mxEdgeHandler.prototype.isConnectableCell=function(){return true};
mxEdgeHandler.prototype.createMarker=function(){var a=new mxCellMarker(this.graph),b=this;a.getCell=function(){var c=mxCellMarker.prototype.getCell.apply(this,arguments);if(!b.isConnectableCell(c))return null;var d=b.graph.getModel();if(c==b.state.cell||null!=c&&!b.graph.connectableEdges&&d.isEdge(c))c=null;return c};a.isValidState=function(c){var d=b.graph.getModel();d=b.graph.view.getTerminalPort(c,b.graph.view.getState(d.getTerminal(b.state.cell,!b.isSource)),!b.isSource);d=null!=d?d.cell:null;
b.error=b.validateConnection(b.isSource?c.cell:d,b.isSource?d:c.cell);return null==b.error};return a};mxEdgeHandler.prototype.validateConnection=function(a,b){return this.graph.getEdgeValidationError(this.state.cell,a,b)};
mxEdgeHandler.prototype.createBends=function(){for(var a=this.state.cell,b=[],c=0;c<this.abspoints.length;c++)if(this.isHandleVisible(c)){var d=c==this.abspoints.length-1;if((d=0==c||d)||this.graph.isCellBendable(a)){var e=this.createHandleShape(c);this.initBend(e);if(this.isHandleEnabled(c))if(mxClient.IS_TOUCH){var f=mxUtils.bind(this,function(g){g=mxUtils.convertPoint(this.graph.container,mxEvent.getClientX(g),mxEvent.getClientY(g));return this.graph.view.getState(this.graph.getCellAt(g.x,g.y))});
mxEvent.redirectMouseEvents(e.node,this.graph,f)}else{e.node.style.cursor=mxConstants.CURSOR_BEND_HANDLE;mxEvent.redirectMouseEvents(e.node,this.graph,this.state)}b.push(e);d||(this.points.push(new mxPoint(0,0)),e.node.style.visibility="hidden")}}return b};mxEdgeHandler.prototype.isHandleEnabled=function(){return true};mxEdgeHandler.prototype.isHandleVisible=function(){return true};
mxEdgeHandler.prototype.createHandleShape=function(a){if(null!=this.handleImage)return new mxImageShape(new mxRectangle(0,0,this.handleImage.width,this.handleImage.height),this.handleImage.src);a=mxConstants.HANDLE_SIZE;this.preferHtml&&(a-=1);return new mxRectangleShape(new mxRectangle(0,0,a,a),mxConstants.HANDLE_FILLCOLOR,mxConstants.HANDLE_STROKECOLOR)};
mxEdgeHandler.prototype.initBend=function(a){this.preferHtml?(a.dialect=mxConstants.DIALECT_STRICTHTML,a.init(this.graph.container)):(a.dialect=this.graph.dialect!=mxConstants.DIALECT_SVG?mxConstants.DIALECT_MIXEDHTML:mxConstants.DIALECT_SVG,a.init(this.graph.getView().getOverlayPane()))};
mxEdgeHandler.prototype.getHandleForEvent=function(a){if(null!=this.bends){var b=this.tolerance;b=this.allowHandleBoundsCheck&&(mxClient.IS_IE||0<b)?new mxRectangle(a.getGraphX()-b,a.getGraphY()-b,2*b,2*b):null;for(var c=0;c<this.bends.length;c++)if((a.isSource(this.bends[c])||null!=b&&mxUtils.intersects(this.bends[c].bounds,b))&&"hidden"!=this.bends[c].node.style.visibility)return c}if(a.isSource(this.labelShape)&&"hidden"!=this.labelShape.node.style.visibility||a.isSource(this.state.text))if(!mxClient.IS_SF&&
!mxClient.IS_GC||"SELECT"!=a.getSource().nodeName)return mxEvent.LABEL_HANDLE;return null};mxEdgeHandler.prototype.mouseDown=function(a,b){var c=null;c=this.getHandleForEvent(b);null!=c&&!b.isConsumed()&&this.graph.isEnabled()&&!this.graph.isForceMarqueeEvent(b.getEvent())&&(this.removeEnabled&&this.isRemovePointEvent(b.getEvent())?this.removePoint(this.state,c):(c!=mxEvent.LABEL_HANDLE||this.graph.isLabelMovable(b.getCell()))&&this.start(b.getX(),b.getY(),c),b.consume())};
mxEdgeHandler.prototype.start=function(a,b,c){this.startX=a;this.startY=b;this.isSource=null==this.bends?false:0==c;this.isTarget=null==this.bends?false:c==this.bends.length-1;this.isLabel=c==mxEvent.LABEL_HANDLE;if(this.isSource||this.isTarget){if(a=this.state.cell,b=this.graph.model.getTerminal(a,this.isSource),null==b&&this.graph.isTerminalPointMovable(a,this.isSource)||null!=b&&this.graph.isCellDisconnectable(a,b,this.isSource))this.index=c}else this.index=c;if(this.livePreview&&(this.shape.node.style.visibility=
"hidden",(this.isSource||this.isTarget)&&null!=this.bends[c]))this.bends[c].node.style.display="none"};mxEdgeHandler.prototype.clonePreviewState=function(){return this.state.clone()};mxEdgeHandler.prototype.getSnapToTerminalTolerance=function(){return this.graph.gridSize*this.graph.view.scale/2};
mxEdgeHandler.prototype.getPointForEvent=function(a){var b=new mxPoint(a.getGraphX(),a.getGraphY()),c=this.getSnapToTerminalTolerance(),d=this.graph.getView(),e=false,f=false;if(this.snapToTerminals&&0<c){var g=function(k){if(null!=k){var l=k.x;Math.abs(b.x-l)<c&&(b.x=l,e=true);k=k.y;Math.abs(b.y-k)<c&&(b.y=k,f=true)}},h=function(k){null!=k&&g.call(this,new mxPoint(d.getRoutingCenterX(k),d.getRoutingCenterY(k)))};h.call(this,this.state.getVisibleTerminalState(true));h.call(this,this.state.getVisibleTerminalState(false));
if(null!=this.abspoints)for(h=0;h<this.abspoints;h++)h!=this.index&&g.call(this,this.abspoints[h])}this.graph.isGridEnabledEvent(a.getEvent())&&(a=d.scale,h=d.translate,e||(b.x=(this.graph.snap(b.x/a-h.x)+h.x)*a),f||(b.y=(this.graph.snap(b.y/a-h.y)+h.y)*a));return b};
mxEdgeHandler.prototype.getPreviewTerminalState=function(a){this.constraintHandler.update(a,this.isSource);this.marker.process(a);a=this.marker.getValidState();var b=null;null!=this.constraintHandler.currentFocus&&null!=this.constraintHandler.currentConstraint&&this.marker.reset();null!=a?b=a:null!=this.constraintHandler.currentConstraint&&null!=this.constraintHandler.currentFocus&&(b=this.constraintHandler.currentFocus);return b};
mxEdgeHandler.prototype.getPreviewPoints=function(a){var b=this.graph.getCellGeometry(this.state.cell);b=null!=b.points?b.points.slice():null;!this.isSource&&!this.isTarget?(this.convertPoint(a,false),null==b?b=[a]:b[this.index-1]=a):this.graph.resetEdgesOnConnect&&(b=null);return b};
mxEdgeHandler.prototype.updatePreviewState=function(a,b,c){var d=this.isSource?c:this.state.getVisibleTerminalState(true),e=this.isTarget?c:this.state.getVisibleTerminalState(false),f=this.graph.getConnectionConstraint(a,d,true),g=this.graph.getConnectionConstraint(a,e,false),h=this.constraintHandler.currentConstraint;null==h&&(h=new mxConnectionConstraint);this.isSource?f=h:this.isTarget&&(g=h);(!this.isSource||null!=d)&&a.view.updateFixedTerminalPoint(a,d,true,f);(!this.isTarget||null!=e)&&a.view.updateFixedTerminalPoint(a,
e,false,g);if((this.isSource||this.isTarget)&&null==c){a.setAbsoluteTerminalPoint(b,this.isSource);null==this.marker.getMarkedState()&&(this.error=this.graph.allowDanglingEdges?null:"")}a.view.updatePoints(a,this.points,d,e);a.view.updateFloatingTerminalPoints(a,d,e)};
mxEdgeHandler.prototype.mouseMove=function(a,b){if(null!=this.index&&null!=this.marker){var c=this.getPointForEvent(b);if(this.isLabel){this.label.x=c.x;this.label.y=c.y}else{this.points=this.getPreviewPoints(c);var d=this.isSource||this.isTarget?this.getPreviewTerminalState(b):null,e=this.clonePreviewState(c,null!=d?d.cell:null);this.updatePreviewState(e,c,d);this.setPreviewColor(null==this.error?this.marker.validColor:this.marker.invalidColor);this.abspoints=e.absolutePoints;this.active=true}this.livePreview?
(d=this.state.absolutePoints,this.isLabel?this.state.absoluteOffset=c:(this.state.absolutePoints=this.abspoints,this.state.view.updateEdgeBounds(this.state),this.state.view.updateEdgeLabelOffset(this.state)),this.state.view.graph.cellRenderer.redraw(this.state,true),this.redrawHandles(),this.state.view.invalidate(this.state.cell),this.state.invalid=false,this.state.view.validate(),this.state.absolutePoints=d,this.state.view.updateEdgeBounds(this.state),this.state.view.updateEdgeLabelOffset(this.state)):
this.drawPreview();mxEvent.consume(b.getEvent());b.consume()}else mxClient.IS_IE&&null!=this.getHandleForEvent(b)&&b.consume(false)};
mxEdgeHandler.prototype.mouseUp=function(a,b){if(null!=this.index&&null!=this.marker){var c=this.state.cell;if(b.getX()!=this.startX||b.getY()!=this.startY)if(null!=this.error)0<this.error.length&&this.graph.validationAlert(this.error);else if(this.isLabel)this.moveLabel(this.state,this.label.x,this.label.y);else if(this.isSource||this.isTarget){var d=null;null!=this.constraintHandler.currentConstraint&&null!=this.constraintHandler.currentFocus&&(d=this.constraintHandler.currentFocus.cell);null==
d&&this.marker.hasValidState()&&(d=this.marker.validState.cell);if(null!=d)c=this.connect(c,d,this.isSource,this.graph.isCloneEvent(b.getEvent())&&this.cloneEnabled&&this.graph.isCellsCloneable(),b);else if(this.graph.isAllowDanglingEdges()){d=this.abspoints[this.isSource?0:this.abspoints.length-1];d.x=d.x/this.graph.view.scale-this.graph.view.translate.x;d.y=d.y/this.graph.view.scale-this.graph.view.translate.y;var e=this.graph.getView().getState(this.graph.getModel().getParent(c));null!=e&&(d.x-=
e.origin.x,d.y-=e.origin.y);d.x-=this.graph.panDx/this.graph.view.scale;d.y-=this.graph.panDy/this.graph.view.scale;this.changeTerminalPoint(c,d,this.isSource)}}else this.active?this.changePoints(c,this.points):(this.graph.getView().invalidate(this.state.cell),this.graph.getView().revalidate(this.state.cell));null!=this.marker&&(this.reset(),c!=this.state.cell&&this.graph.setSelectionCell(c));b.consume()}};
mxEdgeHandler.prototype.reset=function(){null!=this.bends&&null!=this.index&&null!=this.bends[this.index]&&"none"==this.bends[this.index].node.style.display&&(this.bends[this.index].node.style.display="");this.points=this.label=this.index=this.error=null;this.isTarget=this.isSource=this.isLabel=this.active=false;this.marker.reset();this.constraintHandler.reset();this.setPreviewColor(mxConstants.EDGE_SELECTION_COLOR);this.redraw()};
mxEdgeHandler.prototype.setPreviewColor=function(a){null!=this.shape&&(this.shape.stroke=a)};mxEdgeHandler.prototype.convertPoint=function(a,b){var c=this.graph.getView().getScale(),d=this.graph.getView().getTranslate();b&&(a.x=this.graph.snap(a.x),a.y=this.graph.snap(a.y));a.x=Math.round(a.x/c-d.x);a.y=Math.round(a.y/c-d.y);c=this.graph.getView().getState(this.graph.getModel().getParent(this.state.cell));null!=c&&(a.x-=c.origin.x,a.y-=c.origin.y);return a};
mxEdgeHandler.prototype.moveLabel=function(a,b,c){var d=this.graph.getModel(),e=d.getGeometry(a.cell);if(null!=e){e=e.clone();var f=this.graph.getView().getRelativePoint(a,b,c);e.x=f.x;e.y=f.y;var g=this.graph.getView().scale;e.offset=new mxPoint(0,0);f=this.graph.view.getPoint(a,e);e.offset=new mxPoint((b-f.x)/g,(c-f.y)/g);d.setGeometry(a.cell,e)}};
mxEdgeHandler.prototype.connect=function(a,b,c,d,e){e=this.graph.getModel();var f=e.getParent(a);e.beginUpdate();try{if(d){var g=a.clone();e.add(f,g,e.getChildCount(f));var h=e.getTerminal(a,!c);this.graph.connectCell(g,h,!c);a=g}var k=this.constraintHandler.currentConstraint;null==k&&(k=new mxConnectionConstraint);this.graph.connectCell(a,b,c,k)}finally{e.endUpdate()}return a};
mxEdgeHandler.prototype.changeTerminalPoint=function(a,b,c){var d=this.graph.getModel(),e=d.getGeometry(a);if(null!=e){d.beginUpdate();try{e=e.clone();e.setTerminalPoint(b,c);d.setGeometry(a,e);this.graph.connectCell(a,null,c,new mxConnectionConstraint)}finally{d.endUpdate()}}};mxEdgeHandler.prototype.changePoints=function(a,b){var c=this.graph.getModel(),d=c.getGeometry(a);null!=d&&(d=d.clone(),d.points=b,c.setGeometry(a,d))};
mxEdgeHandler.prototype.addPoint=function(a,b){var c=mxUtils.convertPoint(this.graph.container,mxEvent.getClientX(b),mxEvent.getClientY(b)),d=this.graph.isGridEnabledEvent(b);this.convertPoint(c,d);this.addPointAt(a,c.x,c.y);mxEvent.consume(b)};
mxEdgeHandler.prototype.addPointAt=function(a,b,c){var d=this.graph.getCellGeometry(a.cell);b=new mxPoint(b,c);if(null!=d){d=d.clone();c=this.graph.view.translate;var e=this.graph.view.scale;c=mxUtils.findNearestSegment(a,(b.x+c.x)*e,(b.y+c.y)*e);null==d.points?d.points=[b]:d.points.splice(c,0,b);this.graph.getModel().setGeometry(a.cell,d);this.destroy();this.init()}};
mxEdgeHandler.prototype.removePoint=function(a,b){if(0<b&&b<this.abspoints.length-1){var c=this.graph.getCellGeometry(this.state.cell);null!=c&&null!=c.points&&(c=c.clone(),c.points.splice(b-1,1),this.graph.getModel().setGeometry(a.cell,c),this.destroy(),this.init())}};
mxEdgeHandler.prototype.getHandleFillColor=function(a){a=0==a;var b=this.state.cell,c=this.graph.getModel().getTerminal(b,a),d=mxConstants.HANDLE_FILLCOLOR;null!=c&&!this.graph.isCellDisconnectable(b,c,a)||null==c&&!this.graph.isTerminalPointMovable(b,a)?d=mxConstants.LOCKED_HANDLE_FILLCOLOR:null!=c&&this.graph.isCellDisconnectable(b,c,a)&&(d=mxConstants.CONNECT_HANDLE_FILLCOLOR);return d};
mxEdgeHandler.prototype.redraw=function(){this.abspoints=this.state.absolutePoints.slice();this.redrawHandles();var a=this.graph.getModel().getGeometry(this.state.cell).points;if(null!=this.bends&&0<this.bends.length&&null!=a){null==this.points&&(this.points=[]);for(var b=1;b<this.bends.length-1;b++)null!=this.bends[b]&&null!=this.abspoints[b]&&(this.points[b-1]=a[b-1])}this.drawPreview()};
mxEdgeHandler.prototype.redrawHandles=function(){var a=this.state.cell,b=mxConstants.LABEL_HANDLE_SIZE;this.label=new mxPoint(this.state.absoluteOffset.x,this.state.absoluteOffset.y);this.labelShape.bounds=new mxRectangle(Math.round(this.label.x-b/2),Math.round(this.label.y-b/2),b,b);this.labelShape.redraw();b=this.graph.getLabel(a);null!=b&&0<b.length&&this.graph.isLabelMovable(a)?this.labelShape.node.style.visibility="visible":this.labelShape.node.style.visibility="hidden";if(null!=this.bends&&
0<this.bends.length){var c=this.abspoints.length-1;a=this.abspoints[0];var d=this.abspoints[0].y;b=this.bends[0].bounds;this.bends[0].bounds=new mxRectangle(Math.round(this.abspoints[0].x-b.width/2),Math.round(d-b.height/2),b.width,b.height);this.bends[0].fill=this.getHandleFillColor(0);this.bends[0].redraw();d=this.abspoints[c];var e=this.abspoints[c].x;c=this.abspoints[c].y;var f=this.bends.length-1;b=this.bends[f].bounds;this.bends[f].bounds=new mxRectangle(Math.round(e-b.width/2),Math.round(c-
b.height/2),b.width,b.height);this.bends[f].fill=this.getHandleFillColor(f);this.bends[f].redraw();this.redrawInnerBends(a,d)}};
mxEdgeHandler.prototype.redrawInnerBends=function(){for(var a=1;a<this.bends.length-1;a++)if(null!=this.bends[a])if(null!=this.abspoints[a]){var b=this.abspoints[a].x,c=this.abspoints[a].y,d=this.bends[a].bounds;this.bends[a].node.style.visibility="visible";this.bends[a].bounds=new mxRectangle(Math.round(b-d.width/2),Math.round(c-d.height/2),d.width,d.height);this.bends[a].redraw()}else{this.bends[a].destroy();this.bends[a]=null}};
mxEdgeHandler.prototype.drawPreview=function(){if(this.isLabel){var a=mxConstants.LABEL_HANDLE_SIZE;a=new mxRectangle(Math.round(this.label.x-a/2),Math.round(this.label.y-a/2),a,a);this.labelShape.bounds=a;this.labelShape.redraw()}else{this.shape.points=this.abspoints;this.shape.redraw()}};
mxEdgeHandler.prototype.destroy=function(){null!=this.marker&&(this.marker.destroy(),this.marker=null);null!=this.shape&&(this.shape.destroy(),this.shape=null);null!=this.labelShape&&(this.labelShape.destroy(),this.labelShape=null);null!=this.constraintHandler&&(this.constraintHandler.destroy(),this.constraintHandler=null);if(null!=this.bends)for(var a=0;a<this.bends.length;a++)null!=this.bends[a]&&(this.bends[a].destroy(),this.bends[a]=null)};
function mxElbowEdgeHandler(a){mxEdgeHandler.call(this,a)}mxUtils.extend(mxElbowEdgeHandler,mxEdgeHandler);mxElbowEdgeHandler.prototype=new mxEdgeHandler;mxElbowEdgeHandler.prototype.constructor=mxElbowEdgeHandler;mxElbowEdgeHandler.prototype.flipEnabled=true;mxElbowEdgeHandler.prototype.doubleClickOrientationResource="none"!=mxClient.language?"doubleClickOrientation":"";
mxElbowEdgeHandler.prototype.createBends=function(){var a=[],b=this.createHandleShape(0);this.initBend(b);b.node.style.cursor=mxConstants.CURSOR_BEND_HANDLE;mxEvent.redirectMouseEvents(b.node,this.graph,this.state);a.push(b);mxClient.IS_TOUCH&&b.node.setAttribute("pointer-events","none");a.push(this.createVirtualBend());this.points.push(new mxPoint(0,0));b=this.createHandleShape(2);this.initBend(b);b.node.style.cursor=mxConstants.CURSOR_BEND_HANDLE;mxEvent.redirectMouseEvents(b.node,this.graph,this.state);
a.push(b);mxClient.IS_TOUCH&&b.node.setAttribute("pointer-events","none");return a};
mxElbowEdgeHandler.prototype.createVirtualBend=function(){var a=this.createHandleShape();this.initBend(a);var b=this.getCursorForBend();a.node.style.cursor=b;b=mxUtils.bind(this,function(c){!mxEvent.isConsumed(c)&&this.flipEnabled&&(this.graph.flipEdge(this.state.cell,c),mxEvent.consume(c))});mxEvent.redirectMouseEvents(a.node,this.graph,this.state,null,null,null,b);this.graph.isCellBendable(this.state.cell)||(a.node.style.display="none");return a};
mxElbowEdgeHandler.prototype.getCursorForBend=function(){return this.state.style[mxConstants.STYLE_EDGE]==mxEdgeStyle.TopToBottom||this.state.style[mxConstants.STYLE_EDGE]==mxConstants.EDGESTYLE_TOPTOBOTTOM||(this.state.style[mxConstants.STYLE_EDGE]==mxEdgeStyle.ElbowConnector||this.state.style[mxConstants.STYLE_EDGE]==mxConstants.EDGESTYLE_ELBOW)&&this.state.style[mxConstants.STYLE_ELBOW]==mxConstants.ELBOW_VERTICAL?"row-resize":"col-resize"};
mxElbowEdgeHandler.prototype.getTooltipForNode=function(a){var b=null;if(null!=this.bends&&null!=this.bends[1]&&(a==this.bends[1].node||a.parentNode==this.bends[1].node)){b=this.doubleClickOrientationResource;b=mxResources.get(b)||b}return b};
mxElbowEdgeHandler.prototype.convertPoint=function(a,b){var c=this.graph.getView().getScale(),d=this.graph.getView().getTranslate(),e=this.state.origin;b&&(a.x=this.graph.snap(a.x),a.y=this.graph.snap(a.y));a.x=Math.round(a.x/c-d.x-e.x);a.y=Math.round(a.y/c-d.y-e.y)};
mxElbowEdgeHandler.prototype.redrawInnerBends=function(a,b){var c=this.graph.getModel().getGeometry(this.state.cell).points;c=null!=c?c[0]:null;c=null==c?new mxPoint(a.x+(b.x-a.x)/2,a.y+(b.y-a.y)/2):new mxPoint(this.graph.getView().scale*(c.x+this.graph.getView().translate.x+this.state.origin.x),this.graph.getView().scale*(c.y+this.graph.getView().translate.y+this.state.origin.y));var d=this.bends[1].bounds,e=d.width;d=d.height;null==this.handleImage&&(d=e=mxConstants.HANDLE_SIZE);var f=new mxRectangle(Math.round(c.x-
e/2),Math.round(c.y-d/2),e,d);null==this.handleImage&&"hidden"!=this.labelShape.node.style.visibility&&mxUtils.intersects(f,this.labelShape.bounds)&&(e+=3,d+=3,f=new mxRectangle(Math.round(c.x-e/2),Math.round(c.y-d/2),e,d));this.bends[1].bounds=f;this.bends[1].redraw()};function mxEdgeSegmentHandler(a){mxEdgeHandler.call(this,a)}mxUtils.extend(mxEdgeSegmentHandler,mxEdgeHandler);mxEdgeSegmentHandler.prototype=new mxElbowEdgeHandler;mxEdgeSegmentHandler.prototype.constructor=mxEdgeSegmentHandler;
mxEdgeSegmentHandler.prototype.getPreviewPoints=function(a){if(this.isSource||this.isTarget)return mxElbowEdgeHandler.prototype.getPreviewPoints.apply(this,arguments);this.convertPoint(a,false);var b=this.state.absolutePoints,c=b[0].clone();this.convertPoint(c,false);for(var d=[],e=1;e<b.length;e++){var f=b[e].clone();this.convertPoint(f,false);e==this.index&&(c.x==f.x?(c.x=a.x,f.x=a.x):(c.y=a.y,f.y=a.y));e<b.length-1&&d.push(f);c=f}if(1==d.length){if(c=this.state.view,e=this.state.getVisibleTerminalState(true),
f=this.state.getVisibleTerminalState(false),null!=f&null!=e){var g=this.state.origin.x,h=this.state.origin.y;mxUtils.contains(f,d[0].x+g,d[0].y+h)?b[1].y==b[2].y?d[0].y=c.getRoutingCenterY(e)-h:d[0].x=c.getRoutingCenterX(e)-g:mxUtils.contains(e,d[0].x+g,d[0].y+h)&&(b[1].y==b[0].y?d[0].y=c.getRoutingCenterY(f)-h:d[0].x=c.getRoutingCenterX(f)-g)}}else 0==d.length&&(d=[a]);return d};
mxEdgeSegmentHandler.prototype.createBends=function(){var a=[],b=this.createHandleShape(0);this.initBend(b);b.node.style.cursor=mxConstants.CURSOR_BEND_HANDLE;mxEvent.redirectMouseEvents(b.node,this.graph,this.state);a.push(b);mxClient.IS_TOUCH&&b.node.setAttribute("pointer-events","none");var c=this.state.absolutePoints;if(this.graph.isCellBendable(this.state.cell)){null==this.points&&(this.points=[]);for(var d=0;d<c.length-1;d++){b=this.createVirtualBend();a.push(b);b.node.style.cursor=0==c[d].x-
c[d+1].x?"col-resize":"row-resize";this.points.push(new mxPoint(0,0));mxClient.IS_TOUCH&&b.node.setAttribute("pointer-events","none")}}b=this.createHandleShape(c.length);this.initBend(b);b.node.style.cursor=mxConstants.CURSOR_BEND_HANDLE;mxEvent.redirectMouseEvents(b.node,this.graph,this.state);a.push(b);mxClient.IS_TOUCH&&b.node.setAttribute("pointer-events","none");return a};mxEdgeSegmentHandler.prototype.redraw=function(){this.refresh();mxEdgeHandler.prototype.redraw.apply(this,arguments)};
mxEdgeSegmentHandler.prototype.refresh=function(){if(null!=this.bends){for(var a=0;a<this.bends.length;a++)null!=this.bends[a]&&(this.bends[a].destroy(),this.bends[a]=null);this.bends=this.createBends()}};
mxEdgeSegmentHandler.prototype.redrawInnerBends=function(a,b){if(this.graph.isCellBendable(this.state.cell)){var c=mxConstants.HANDLE_SIZE,d=this.state.absolutePoints;if(null!=d&&1<d.length)for(var e=0;e<this.state.absolutePoints.length-1;e++)if(null!=this.bends[e+1]){a=d[e];b=d[e+1];var f=new mxPoint(a.x+(b.x-a.x)/2,a.y+(b.y-a.y)/2);this.bends[e+1].bounds=new mxRectangle(Math.round(f.x-c/2),Math.round(f.y-c/2),c,c);this.bends[e+1].redraw()}}};
mxEdgeSegmentHandler.prototype.changePoints=function(a,b){b=[];var c=this.abspoints;if(1<c.length)for(var d=c[0],e=c[1],f=2;f<c.length;f++){var g=c[f];if((Math.round(d.x)!=Math.round(e.x)||Math.round(e.x)!=Math.round(g.x))&&(Math.round(d.y)!=Math.round(e.y)||Math.round(e.y)!=Math.round(g.y))){d=e;e=e.clone();this.convertPoint(e,false);b.push(e)}e=g}mxElbowEdgeHandler.prototype.changePoints.apply(this,arguments)};
function mxKeyHandler(a,b){null!=a&&(this.graph=a,this.target=b||document.documentElement,this.normalKeys=[],this.shiftKeys=[],this.controlKeys=[],this.controlShiftKeys=[],mxEvent.addListener(this.target,"keydown",mxUtils.bind(this,function(c){this.keyDown(c)})),mxClient.IS_IE&&mxEvent.addListener(window,"unload",mxUtils.bind(this,function(){this.destroy()})))}mxKeyHandler.prototype.graph=null;mxKeyHandler.prototype.target=null;mxKeyHandler.prototype.normalKeys=null;
mxKeyHandler.prototype.shiftKeys=null;mxKeyHandler.prototype.controlKeys=null;mxKeyHandler.prototype.controlShiftKeys=null;mxKeyHandler.prototype.enabled=true;mxKeyHandler.prototype.isEnabled=function(){return this.enabled};mxKeyHandler.prototype.setEnabled=function(a){this.enabled=a};mxKeyHandler.prototype.bindKey=function(a,b){this.normalKeys[a]=b};mxKeyHandler.prototype.bindShiftKey=function(a,b){this.shiftKeys[a]=b};mxKeyHandler.prototype.bindControlKey=function(a,b){this.controlKeys[a]=b};
mxKeyHandler.prototype.bindControlShiftKey=function(a,b){this.controlShiftKeys[a]=b};mxKeyHandler.prototype.isControlDown=function(a){return mxEvent.isControlDown(a)};mxKeyHandler.prototype.getFunction=function(a){return null!=a?this.isControlDown(a)?mxEvent.isShiftDown(a)?this.controlShiftKeys[a.keyCode]:this.controlKeys[a.keyCode]:mxEvent.isShiftDown(a)?this.shiftKeys[a.keyCode]:this.normalKeys[a.keyCode]:null};
mxKeyHandler.prototype.isGraphEvent=function(a){a=mxEvent.getSource(a);if(a==this.target||a.parentNode==this.target||null!=this.graph.cellEditor&&a==this.graph.cellEditor.textarea)return true;for(;null!=a;){if(a==this.graph.container)return true;a=a.parentNode}return false};
mxKeyHandler.prototype.keyDown=function(a){if(this.graph.isEnabled()&&!mxEvent.isConsumed(a)&&this.isGraphEvent(a)&&this.isEnabled())if(27==a.keyCode)this.escape(a);else if(!this.graph.isEditing()){var b=this.getFunction(a);null!=b&&(b(a),mxEvent.consume(a))}};mxKeyHandler.prototype.escape=function(a){this.graph.isEscapeEnabled()&&this.graph.escape(a)};mxKeyHandler.prototype.destroy=function(){this.target=null};
function mxTooltipHandler(a,b){null!=a&&(this.graph=a,this.delay=b||500,this.graph.addMouseListener(this))}mxTooltipHandler.prototype.zIndex=10005;mxTooltipHandler.prototype.graph=null;mxTooltipHandler.prototype.delay=null;mxTooltipHandler.prototype.hideOnHover=false;mxTooltipHandler.prototype.enabled=true;mxTooltipHandler.prototype.isEnabled=function(){return this.enabled};mxTooltipHandler.prototype.setEnabled=function(a){this.enabled=a};mxTooltipHandler.prototype.isHideOnHover=function(){return this.hideOnHover};
mxTooltipHandler.prototype.setHideOnHover=function(a){this.hideOnHover=a};mxTooltipHandler.prototype.init=function(){null!=document.body&&(this.div=document.createElement("div"),this.div.className="mxTooltip",this.div.style.visibility="hidden",document.body.appendChild(this.div),mxEvent.addGestureListeners(this.div,mxUtils.bind(this,function(){this.hideTooltip()})))};mxTooltipHandler.prototype.mouseDown=function(a,b){this.reset(b,false);this.hideTooltip()};
mxTooltipHandler.prototype.mouseMove=function(a,b){if(b.getX()!=this.lastX||b.getY()!=this.lastY){this.reset(b,true);(this.isHideOnHover()||b.getState()!=this.state||b.getSource()!=this.node&&(!this.stateSource||null!=b.getState()&&this.stateSource==(b.isSource(b.getState().shape)||!b.isSource(b.getState().text))))&&this.hideTooltip()}this.lastX=b.getX();this.lastY=b.getY()};mxTooltipHandler.prototype.mouseUp=function(a,b){this.reset(b,true);this.hideTooltip()};
mxTooltipHandler.prototype.resetTimer=function(){null!=this.thread&&(window.clearTimeout(this.thread),this.thread=null)};
mxTooltipHandler.prototype.reset=function(a,b){this.resetTimer();if(b&&this.isEnabled()&&null!=a.getState()&&(null==this.div||"hidden"==this.div.style.visibility)){var c=a.getState(),d=a.getSource(),e=a.getX(),f=a.getY(),g=a.isSource(c.shape)||a.isSource(c.text);this.thread=window.setTimeout(mxUtils.bind(this,function(){if(!this.graph.isEditing()&&!this.graph.panningHandler.isMenuShowing()){this.show(this.graph.getTooltip(c,d,e,f),e,f);this.state=c;this.node=d;this.stateSource=g}}),this.delay)}};
mxTooltipHandler.prototype.hide=function(){this.resetTimer();this.hideTooltip()};mxTooltipHandler.prototype.hideTooltip=function(){null!=this.div&&(this.div.style.visibility="hidden")};
mxTooltipHandler.prototype.show=function(a,b,c){if(null!=a&&0<a.length){null==this.div&&this.init();var d=mxUtils.getScrollOrigin();this.div.style.zIndex=this.zIndex;this.div.style.left=b+d.x+"px";this.div.style.top=c+mxConstants.TOOLTIP_VERTICAL_OFFSET+d.y+"px";mxUtils.isNode(a)?(this.div.innerHTML="",this.div.appendChild(a)):this.div.innerHTML=a.replace(/\n/g,"<br>");this.div.style.visibility="";mxUtils.fit(this.div)}};
mxTooltipHandler.prototype.destroy=function(){this.graph.removeMouseListener(this);mxEvent.release(this.div);null!=this.div&&null!=this.div.parentNode&&this.div.parentNode.removeChild(this.div);this.div=null};function mxCellTracker(a,b,c){mxCellMarker.call(this,a,b);this.graph.addMouseListener(this);null!=c&&(this.getCell=c);mxClient.IS_IE&&mxEvent.addListener(window,"unload",mxUtils.bind(this,function(){this.destroy()}))}mxUtils.extend(mxCellTracker,mxCellMarker);
mxCellTracker.prototype.mouseDown=function(){};mxCellTracker.prototype.mouseMove=function(a,b){this.isEnabled()&&this.process(b)};mxCellTracker.prototype.mouseUp=function(){this.reset()};mxCellTracker.prototype.destroy=function(){this.destroyed||(this.destroyed=true,this.graph.removeMouseListener(this),mxCellMarker.prototype.destroy.apply(this))};
function mxCellHighlight(a,b,c,d){null!=a&&(this.graph=a,this.highlightColor=null!=b?b:mxConstants.DEFAULT_VALID_COLOR,this.strokeWidth=null!=c?c:mxConstants.HIGHLIGHT_STROKEWIDTH,this.dashed=null!=d?d:false,this.repaintHandler=mxUtils.bind(this,function(){null!=this.state&&(this.state=this.graph.view.getState(this.state.cell),null==this.state?this.hide():this.repaint())}),this.graph.getView().addListener(mxEvent.SCALE,this.repaintHandler),this.graph.getView().addListener(mxEvent.TRANSLATE,this.repaintHandler),
this.graph.getView().addListener(mxEvent.SCALE_AND_TRANSLATE,this.repaintHandler),this.graph.getModel().addListener(mxEvent.CHANGE,this.repaintHandler),this.resetHandler=mxUtils.bind(this,function(){this.hide()}),this.graph.getView().addListener(mxEvent.DOWN,this.resetHandler),this.graph.getView().addListener(mxEvent.UP,this.resetHandler))}mxCellHighlight.prototype.keepOnTop=false;mxCellHighlight.prototype.graph=true;mxCellHighlight.prototype.state=null;mxCellHighlight.prototype.spacing=2;
mxCellHighlight.prototype.resetHandler=null;mxCellHighlight.prototype.setHighlightColor=function(a){this.highlightColor=a;null!=this.shape&&(this.shape.stroke=a)};mxCellHighlight.prototype.drawHighlight=function(){this.shape=this.createShape();this.repaint();!this.keepOnTop&&this.shape.node.parentNode.firstChild!=this.shape.node&&this.shape.node.parentNode.insertBefore(this.shape.node,this.shape.node.parentNode.firstChild)};
mxCellHighlight.prototype.createShape=function(){var a=null;a=this.graph.model.isEdge(this.state.cell)?new mxPolyline(this.state.absolutePoints,this.highlightColor,this.strokeWidth):new mxRectangleShape(new mxRectangle,null,this.highlightColor,this.strokeWidth);a.dialect=this.graph.dialect!=mxConstants.DIALECT_SVG?mxConstants.DIALECT_VML:mxConstants.DIALECT_SVG;a.init(this.graph.getView().getOverlayPane());mxEvent.redirectMouseEvents(a.node,this.graph,this.state);a.svgStrokeTolerance=0;a.pointerEvents=
false;a.isDashed=this.dashed;return a};
mxCellHighlight.prototype.repaint=function(){null!=this.state&&null!=this.shape&&(this.graph.model.isEdge(this.state.cell)?this.shape.points=this.state.absolutePoints:(this.shape.bounds=new mxRectangle(this.state.x-this.spacing,this.state.y-this.spacing,this.state.width+2*this.spacing,this.state.height+2*this.spacing),this.shape.rotation=Number(this.state.style[mxConstants.STYLE_ROTATION]||"0")),null!=this.state.shape&&this.shape.setCursor(this.state.shape.getCursor()),this.shape.redraw())};
mxCellHighlight.prototype.hide=function(){this.highlight(null)};mxCellHighlight.prototype.highlight=function(a){this.state!=a&&(null!=this.shape&&(this.shape.destroy(),this.shape=null),this.state=a,null!=this.state&&this.drawHighlight())};
mxCellHighlight.prototype.destroy=function(){this.graph.getView().removeListener(this.repaintHandler);this.graph.getModel().removeListener(this.repaintHandler);this.graph.getView().removeListener(this.resetHandler);this.graph.getModel().removeListener(this.resetHandler);null!=this.shape&&(this.shape.destroy(),this.shape=null)};
function mxDefaultKeyHandler(a){if(null!=a){this.editor=a;this.handler=new mxKeyHandler(a.graph);var b=this.handler.escape;this.handler.escape=function(c){b.apply(this,arguments);a.hideProperties();a.fireEvent(new mxEventObject(mxEvent.ESCAPE,"event",c))}}}mxDefaultKeyHandler.prototype.editor=null;mxDefaultKeyHandler.prototype.handler=null;
mxDefaultKeyHandler.prototype.bindAction=function(a,b,c){var d=mxUtils.bind(this,function(){this.editor.execute(b)});c?this.handler.bindControlKey(a,d):this.handler.bindKey(a,d)};mxDefaultKeyHandler.prototype.destroy=function(){this.handler.destroy();this.handler=null};function mxDefaultPopupMenu(a){this.config=a}mxDefaultPopupMenu.prototype.imageBasePath=null;mxDefaultPopupMenu.prototype.config=null;
mxDefaultPopupMenu.prototype.createMenu=function(a,b,c,d){if(null!=this.config){var e=this.createConditions(a,c,d);this.addItems(a,b,c,d,e,this.config.firstChild,null)}};
mxDefaultPopupMenu.prototype.addItems=function(a,b,c,d,e,f,g){for(var h=false;null!=f;){if("add"==f.nodeName){var k=f.getAttribute("if");if(null==k||e[k]){k=f.getAttribute("as");k=mxResources.get(k)||k;var l=mxUtils.eval(mxUtils.getTextContent(f)),m=f.getAttribute("action"),p=f.getAttribute("icon"),o=f.getAttribute("iconCls");h&&(b.addSeparator(g),h=false);null!=p&&this.imageBasePath&&(p=this.imageBasePath+p);k=this.addAction(b,a,k,p,l,m,c,g,o);this.addItems(a,b,c,d,e,f.firstChild,k)}}else"separator"==
f.nodeName&&(h=true);f=f.nextSibling}};mxDefaultPopupMenu.prototype.addAction=function(a,b,c,d,e,f,g,h,k){return a.addItem(c,d,function(l){"function"==typeof e&&e.call(b,b,g,l);null!=f&&b.execute(f,g,l)},h,k)};
mxDefaultPopupMenu.prototype.createConditions=function(a,b,c){var d=a.graph.getModel(),e=d.getChildCount(b),f=[];f.nocell=null==b;f.ncells=1<a.graph.getSelectionCount();f.notRoot=d.getRoot()!=d.getParent(a.graph.getDefaultParent());f.cell=null!=b;d=null!=b&&1==a.graph.getSelectionCount();f.nonEmpty=d&&0<e;f.expandable=d&&a.graph.isCellFoldable(b,false);f.collapsable=d&&a.graph.isCellFoldable(b,true);f.validRoot=d&&a.graph.isValidRoot(b);f.emptyValidRoot=f.validRoot&&0==e;f.swimlane=d&&a.graph.isSwimlane(b);
e=this.config.getElementsByTagName("condition");for(d=0;d<e.length;d++){var g=mxUtils.eval(mxUtils.getTextContent(e[d])),h=e[d].getAttribute("name");null!=h&&"function"==typeof g&&(f[h]=g(a,b,c))}return f};function mxDefaultToolbar(a,b){this.editor=b;null!=a&&null!=b&&this.init(a)}mxDefaultToolbar.prototype.editor=null;mxDefaultToolbar.prototype.toolbar=null;mxDefaultToolbar.prototype.resetHandler=null;mxDefaultToolbar.prototype.spacing=4;mxDefaultToolbar.prototype.connectOnDrop=false;
mxDefaultToolbar.prototype.init=function(a){null!=a&&(this.toolbar=new mxToolbar(a),this.toolbar.addListener(mxEvent.SELECT,mxUtils.bind(this,function(b,c){var d=c.getProperty("function");this.editor.insertFunction=null!=d?mxUtils.bind(this,function(){d.apply(this,arguments);this.toolbar.resetMode()}):null})),this.resetHandler=mxUtils.bind(this,function(){null!=this.toolbar&&this.toolbar.resetMode(true)}),this.editor.graph.addListener(mxEvent.DOUBLE_CLICK,this.resetHandler),this.editor.addListener(mxEvent.ESCAPE,
this.resetHandler))};mxDefaultToolbar.prototype.addItem=function(a,b,c,d){var e=mxUtils.bind(this,function(){null!=c&&0<c.length&&this.editor.execute(c)});return this.toolbar.addItem(a,b,e,d)};mxDefaultToolbar.prototype.addSeparator=function(a){a=a||mxClient.imageBasePath+"/separator.gif";this.toolbar.addSeparator(a)};mxDefaultToolbar.prototype.addCombo=function(){return this.toolbar.addCombo()};mxDefaultToolbar.prototype.addActionCombo=function(a){return this.toolbar.addActionCombo(a)};
mxDefaultToolbar.prototype.addActionOption=function(a,b,c){var d=mxUtils.bind(this,function(){this.editor.execute(c)});this.addOption(a,b,d)};mxDefaultToolbar.prototype.addOption=function(a,b,c){return this.toolbar.addOption(a,b,c)};mxDefaultToolbar.prototype.addMode=function(a,b,c,d,e){var f=mxUtils.bind(this,function(){this.editor.setMode(c);null!=e&&e(this.editor)});return this.toolbar.addSwitchMode(a,b,f,d)};
mxDefaultToolbar.prototype.addPrototype=function(a,b,c,d,e,f){var g=function(){return"function"==typeof c?c():null!=c?c.clone():null},h=mxUtils.bind(this,function(k,l){"function"==typeof e?e(this.editor,g(),k,l):this.drop(g(),k,l);this.toolbar.resetMode();mxEvent.consume(k)});a=this.toolbar.addMode(a,b,h,d,null,f);this.installDropHandler(a,function(k,l,m){h(l,m)});return a};
mxDefaultToolbar.prototype.drop=function(a,b,c){var d=this.editor.graph,e=d.getModel();if(null==c||e.isEdge(c)||!this.connectOnDrop||!d.isCellConnectable(c)){for(;null!=c&&!d.isValidDropTarget(c,[a],b);)c=e.getParent(c);this.insert(a,b,c)}else this.connect(a,b,c)};
mxDefaultToolbar.prototype.insert=function(a,b,c){var d=this.editor.graph;if(d.canImportCell(a)){var e=mxEvent.getClientX(b),f=mxEvent.getClientY(b);e=mxUtils.convertPoint(d.container,e,f);return d.isSplitEnabled()&&d.isSplitTarget(c,[a],b)?d.splitEdge(c,[a],null,e.x,e.y):this.editor.addVertex(c,a,e.x,e.y)}return null};
mxDefaultToolbar.prototype.connect=function(a,b,c){b=this.editor.graph;var d=b.getModel();if(null!=c&&b.isCellConnectable(a)&&b.isEdgeValid(null,c,a)){var e=null;d.beginUpdate();try{var f=d.getGeometry(c),g=d.getGeometry(a).clone();g.x=f.x+(f.width-g.width)/2;g.y=f.y+(f.height-g.height)/2;var h=this.spacing*b.gridSize,k=20*d.getDirectedEdgeCount(c,true);this.editor.horizontalFlow?g.x+=(g.width+f.width)/2+h+k:g.y+=(g.height+f.height)/2+h+k;a.setGeometry(g);var l=d.getParent(c);b.addCell(a,l);b.constrainChild(a);
e=this.editor.createEdge(c,a);if(null==d.getGeometry(e)){var m=new mxGeometry;m.relative=true;d.setGeometry(e,m)}b.addEdge(e,l,c,a)}finally{d.endUpdate()}b.setSelectionCells([a,e]);b.scrollCellToVisible(a)}};
mxDefaultToolbar.prototype.installDropHandler=function(a,b){var c=document.createElement("img");c.setAttribute("src",a.getAttribute("src"));var d=mxUtils.bind(this,function(){c.style.width=2*a.offsetWidth+"px";c.style.height=2*a.offsetHeight+"px";mxUtils.makeDraggable(a,this.editor.graph,b,c);mxEvent.removeListener(c,"load",d)});mxClient.IS_IE?d():mxEvent.addListener(c,"load",d)};
mxDefaultToolbar.prototype.destroy=function(){null!=this.resetHandler&&(this.editor.graph.removeListener("dblclick",this.resetHandler),this.editor.removeListener("escape",this.resetHandler),this.resetHandler=null);null!=this.toolbar&&(this.toolbar.destroy(),this.toolbar=null)};
function mxEditor(a){this.actions=[];this.addActions();if(null!=document.body){this.cycleAttributeValues=[];this.popupHandler=new mxDefaultPopupMenu;this.undoManager=new mxUndoManager;this.graph=this.createGraph();this.toolbar=this.createToolbar();this.keyHandler=new mxDefaultKeyHandler(this);this.configure(a);this.graph.swimlaneIndicatorColorAttribute=this.cycleAttributeName;!mxClient.IS_LOCAL&&null!=this.urlInit&&(this.session=this.createSession());if(null!=this.onInit)this.onInit();mxClient.IS_IE&&
mxEvent.addListener(window,"unload",mxUtils.bind(this,function(){this.destroy()}))}}mxLoadResources&&mxResources.add(mxClient.basePath+"/resources/editor");mxEditor.prototype=new mxEventSource;mxEditor.prototype.constructor=mxEditor;mxEditor.prototype.askZoomResource="none"!=mxClient.language?"askZoom":"";mxEditor.prototype.lastSavedResource="none"!=mxClient.language?"lastSaved":"";mxEditor.prototype.currentFileResource="none"!=mxClient.language?"currentFile":"";
mxEditor.prototype.propertiesResource="none"!=mxClient.language?"properties":"";mxEditor.prototype.tasksResource="none"!=mxClient.language?"tasks":"";mxEditor.prototype.helpResource="none"!=mxClient.language?"help":"";mxEditor.prototype.outlineResource="none"!=mxClient.language?"outline":"";mxEditor.prototype.outline=null;mxEditor.prototype.graph=null;mxEditor.prototype.graphRenderHint=null;mxEditor.prototype.toolbar=null;mxEditor.prototype.session=null;mxEditor.prototype.status=null;
mxEditor.prototype.popupHandler=null;mxEditor.prototype.undoManager=null;mxEditor.prototype.keyHandler=null;mxEditor.prototype.actions=null;mxEditor.prototype.dblClickAction="edit";mxEditor.prototype.swimlaneRequired=false;mxEditor.prototype.disableContextMenu=true;mxEditor.prototype.insertFunction=null;mxEditor.prototype.forcedInserting=false;mxEditor.prototype.templates=null;mxEditor.prototype.defaultEdge=null;mxEditor.prototype.defaultEdgeStyle=null;mxEditor.prototype.defaultGroup=null;
mxEditor.prototype.groupBorderSize=null;mxEditor.prototype.filename=null;mxEditor.prototype.linefeed="&#xa;";mxEditor.prototype.postParameterName="xml";mxEditor.prototype.escapePostData=true;mxEditor.prototype.urlPost=null;mxEditor.prototype.urlImage=null;mxEditor.prototype.urlInit=null;mxEditor.prototype.urlNotify=null;mxEditor.prototype.urlPoll=null;mxEditor.prototype.horizontalFlow=false;mxEditor.prototype.layoutDiagram=false;mxEditor.prototype.swimlaneSpacing=0;
mxEditor.prototype.maintainSwimlanes=false;mxEditor.prototype.layoutSwimlanes=false;mxEditor.prototype.cycleAttributeValues=null;mxEditor.prototype.cycleAttributeIndex=0;mxEditor.prototype.cycleAttributeName="fillColor";mxEditor.prototype.tasks=null;mxEditor.prototype.tasksWindowImage=null;mxEditor.prototype.tasksTop=20;mxEditor.prototype.help=null;mxEditor.prototype.helpWindowImage=null;mxEditor.prototype.urlHelp=null;mxEditor.prototype.helpWidth=300;mxEditor.prototype.helpHeight=260;
mxEditor.prototype.propertiesWidth=240;mxEditor.prototype.propertiesHeight=null;mxEditor.prototype.movePropertiesDialog=false;mxEditor.prototype.validating=false;mxEditor.prototype.modified=false;mxEditor.prototype.isModified=function(){return this.modified};mxEditor.prototype.setModified=function(a){this.modified=a};
mxEditor.prototype.addActions=function(){this.addAction("save",function(a){a.save()});this.addAction("print",function(a){(new mxPrintPreview(a.graph,1)).open()});this.addAction("show",function(a){mxUtils.show(a.graph,null,10,10)});this.addAction("exportImage",function(a){var b=a.getUrlImage();if(null==b||mxClient.IS_LOCAL)a.execute("show");else{var c=mxUtils.getViewXml(a.graph,1);c=mxUtils.getXml(c,"\n");mxUtils.submit(b,a.postParameterName+"="+encodeURIComponent(c),document,"_blank")}});this.addAction("refresh",
function(a){a.graph.refresh()});this.addAction("cut",function(a){a.graph.isEnabled()&&mxClipboard.cut(a.graph)});this.addAction("copy",function(a){a.graph.isEnabled()&&mxClipboard.copy(a.graph)});this.addAction("paste",function(a){a.graph.isEnabled()&&mxClipboard.paste(a.graph)});this.addAction("delete",function(a){a.graph.isEnabled()&&a.graph.removeCells()});this.addAction("group",function(a){a.graph.isEnabled()&&a.graph.setSelectionCell(a.groupCells())});this.addAction("ungroup",function(a){a.graph.isEnabled()&&
a.graph.setSelectionCells(a.graph.ungroupCells())});this.addAction("removeFromParent",function(a){a.graph.isEnabled()&&a.graph.removeCellsFromParent()});this.addAction("undo",function(a){a.graph.isEnabled()&&a.undo()});this.addAction("redo",function(a){a.graph.isEnabled()&&a.redo()});this.addAction("zoomIn",function(a){a.graph.zoomIn()});this.addAction("zoomOut",function(a){a.graph.zoomOut()});this.addAction("actualSize",function(a){a.graph.zoomActual()});this.addAction("fit",function(a){a.graph.fit()});
this.addAction("showProperties",function(a,b){a.showProperties(b)});this.addAction("selectAll",function(a){a.graph.isEnabled()&&a.graph.selectAll()});this.addAction("selectNone",function(a){a.graph.isEnabled()&&a.graph.clearSelection()});this.addAction("selectVertices",function(a){a.graph.isEnabled()&&a.graph.selectVertices()});this.addAction("selectEdges",function(a){a.graph.isEnabled()&&a.graph.selectEdges()});this.addAction("edit",function(a,b){a.graph.isEnabled()&&a.graph.isCellEditable(b)&&a.graph.startEditingAtCell(b)});
this.addAction("toBack",function(a){a.graph.isEnabled()&&a.graph.orderCells(true)});this.addAction("toFront",function(a){a.graph.isEnabled()&&a.graph.orderCells(false)});this.addAction("enterGroup",function(a,b){a.graph.enterGroup(b)});this.addAction("exitGroup",function(a){a.graph.exitGroup()});this.addAction("home",function(a){a.graph.home()});this.addAction("selectPrevious",function(a){a.graph.isEnabled()&&a.graph.selectPreviousCell()});this.addAction("selectNext",function(a){a.graph.isEnabled()&&
a.graph.selectNextCell()});this.addAction("selectParent",function(a){a.graph.isEnabled()&&a.graph.selectParentCell()});this.addAction("selectChild",function(a){a.graph.isEnabled()&&a.graph.selectChildCell()});this.addAction("collapse",function(a){a.graph.isEnabled()&&a.graph.foldCells(true)});this.addAction("collapseAll",function(a){if(a.graph.isEnabled()){var b=a.graph.getChildVertices();a.graph.foldCells(true,false,b)}});this.addAction("expand",function(a){a.graph.isEnabled()&&a.graph.foldCells(false)});
this.addAction("expandAll",function(a){if(a.graph.isEnabled()){var b=a.graph.getChildVertices();a.graph.foldCells(false,false,b)}});this.addAction("bold",function(a){a.graph.isEnabled()&&a.graph.toggleCellStyleFlags(mxConstants.STYLE_FONTSTYLE,mxConstants.FONT_BOLD)});this.addAction("italic",function(a){a.graph.isEnabled()&&a.graph.toggleCellStyleFlags(mxConstants.STYLE_FONTSTYLE,mxConstants.FONT_ITALIC)});this.addAction("underline",function(a){a.graph.isEnabled()&&a.graph.toggleCellStyleFlags(mxConstants.STYLE_FONTSTYLE,
mxConstants.FONT_UNDERLINE)});this.addAction("shadow",function(a){a.graph.isEnabled()&&a.graph.toggleCellStyleFlags(mxConstants.STYLE_FONTSTYLE,mxConstants.FONT_SHADOW)});this.addAction("alignCellsLeft",function(a){a.graph.isEnabled()&&a.graph.alignCells(mxConstants.ALIGN_LEFT)});this.addAction("alignCellsCenter",function(a){a.graph.isEnabled()&&a.graph.alignCells(mxConstants.ALIGN_CENTER)});this.addAction("alignCellsRight",function(a){a.graph.isEnabled()&&a.graph.alignCells(mxConstants.ALIGN_RIGHT)});
this.addAction("alignCellsTop",function(a){a.graph.isEnabled()&&a.graph.alignCells(mxConstants.ALIGN_TOP)});this.addAction("alignCellsMiddle",function(a){a.graph.isEnabled()&&a.graph.alignCells(mxConstants.ALIGN_MIDDLE)});this.addAction("alignCellsBottom",function(a){a.graph.isEnabled()&&a.graph.alignCells(mxConstants.ALIGN_BOTTOM)});this.addAction("alignFontLeft",function(a){a.graph.setCellStyles(mxConstants.STYLE_ALIGN,mxConstants.ALIGN_LEFT)});this.addAction("alignFontCenter",function(a){a.graph.isEnabled()&&
a.graph.setCellStyles(mxConstants.STYLE_ALIGN,mxConstants.ALIGN_CENTER)});this.addAction("alignFontRight",function(a){a.graph.isEnabled()&&a.graph.setCellStyles(mxConstants.STYLE_ALIGN,mxConstants.ALIGN_RIGHT)});this.addAction("alignFontTop",function(a){a.graph.isEnabled()&&a.graph.setCellStyles(mxConstants.STYLE_VERTICAL_ALIGN,mxConstants.ALIGN_TOP)});this.addAction("alignFontMiddle",function(a){a.graph.isEnabled()&&a.graph.setCellStyles(mxConstants.STYLE_VERTICAL_ALIGN,mxConstants.ALIGN_MIDDLE)});
this.addAction("alignFontBottom",function(a){a.graph.isEnabled()&&a.graph.setCellStyles(mxConstants.STYLE_VERTICAL_ALIGN,mxConstants.ALIGN_BOTTOM)});this.addAction("zoom",function(a){var b=100*a.graph.getView().scale;b=parseFloat(mxUtils.prompt(mxResources.get(a.askZoomResource)||a.askZoomResource,b))/100;isNaN(b)||a.graph.getView().setScale(b)});this.addAction("toggleTasks",function(a){null!=a.tasks?a.tasks.setVisible(!a.tasks.isVisible()):a.showTasks()});this.addAction("toggleHelp",function(a){null!=
a.help?a.help.setVisible(!a.help.isVisible()):a.showHelp()});this.addAction("toggleOutline",function(a){null==a.outline?a.showOutline():a.outline.setVisible(!a.outline.isVisible())});this.addAction("toggleConsole",function(){mxLog.setVisible(!mxLog.isVisible())})};mxEditor.prototype.createSession=function(){return this.connect(this.urlInit,this.urlPoll,this.urlNotify,mxUtils.bind(this,function(a){this.fireEvent(new mxEventObject(mxEvent.SESSION,"session",a))}))};
mxEditor.prototype.configure=function(a){null!=a&&((new mxCodec(a.ownerDocument)).decode(a,this),this.resetHistory())};mxEditor.prototype.resetFirstTime=function(){document.cookie="mxgraph=seen; expires=Fri, 27 Jul 2001 02:47:11 UTC; path=/"};mxEditor.prototype.resetHistory=function(){this.lastSnapshot=(new Date).getTime();this.undoManager.clear();this.ignoredChanges=0;this.setModified(false)};mxEditor.prototype.addAction=function(a,b){this.actions[a]=b};
mxEditor.prototype.execute=function(a){var b=this.actions[a];if(null!=b)try{var c=arguments;c[0]=this;b.apply(this,c)}catch(d){throw mxUtils.error("Cannot execute "+a+": "+d.message,280,true),d;}else mxUtils.error("Cannot find action "+a,280,true)};mxEditor.prototype.addTemplate=function(a,b){this.templates[a]=b};mxEditor.prototype.getTemplate=function(a){return this.templates[a]};
mxEditor.prototype.createGraph=function(){var a=new mxGraph(null,null,this.graphRenderHint);a.setTooltips(true);a.setPanning(true);this.installDblClickHandler(a);this.installUndoHandler(a);this.installDrillHandler(a);this.installChangeHandler(a);this.installInsertHandler(a);a.panningHandler.factoryMethod=mxUtils.bind(this,function(b,c,d){return this.createPopupMenu(b,c,d)});a.connectionHandler.factoryMethod=mxUtils.bind(this,function(b,c){return this.createEdge(b,c)});this.createSwimlaneManager(a);
this.createLayoutManager(a);return a};mxEditor.prototype.createSwimlaneManager=function(a){a=new mxSwimlaneManager(a,false);a.isHorizontal=mxUtils.bind(this,function(){return this.horizontalFlow});a.isEnabled=mxUtils.bind(this,function(){return this.maintainSwimlanes});return a};
mxEditor.prototype.createLayoutManager=function(a){var b=new mxLayoutManager(a),c=this;b.getLayout=function(d){var e=null,f=c.graph.getModel();if(null!=f.getParent(d))if(c.layoutSwimlanes&&a.isSwimlane(d)){null==c.swimlaneLayout&&(c.swimlaneLayout=c.createSwimlaneLayout());e=c.swimlaneLayout}else if(c.layoutDiagram&&(a.isValidRoot(d)||null==f.getParent(f.getParent(d)))){null==c.diagramLayout&&(c.diagramLayout=c.createDiagramLayout());e=c.diagramLayout}return e};return b};
mxEditor.prototype.setGraphContainer=function(a){null==this.graph.container&&(this.graph.init(a),this.rubberband=new mxRubberband(this.graph),this.disableContextMenu&&mxEvent.disableContextMenu(a),mxClient.IS_QUIRKS&&new mxDivResizer(a))};mxEditor.prototype.installDblClickHandler=function(a){a.addListener(mxEvent.DOUBLE_CLICK,mxUtils.bind(this,function(b,c){var d=c.getProperty("cell");null!=d&&a.isEnabled()&&null!=this.dblClickAction&&(this.execute(this.dblClickAction,d),c.consume())}))};
mxEditor.prototype.installUndoHandler=function(a){var b=mxUtils.bind(this,function(c,d){this.undoManager.undoableEditHappened(d.getProperty("edit"))});a.getModel().addListener(mxEvent.UNDO,b);a.getView().addListener(mxEvent.UNDO,b);b=function(c,d){var e=d.getProperty("edit").changes;a.setSelectionCells(a.getSelectionCellsForChanges(e))};this.undoManager.addListener(mxEvent.UNDO,b);this.undoManager.addListener(mxEvent.REDO,b)};
mxEditor.prototype.installDrillHandler=function(a){var b=mxUtils.bind(this,function(){this.fireEvent(new mxEventObject(mxEvent.ROOT))});a.getView().addListener(mxEvent.DOWN,b);a.getView().addListener(mxEvent.UP,b)};
mxEditor.prototype.installChangeHandler=function(a){var b=mxUtils.bind(this,function(c,d){this.setModified(true);true==this.validating&&a.validateGraph();for(var e=d.getProperty("edit").changes,f=0;f<e.length;f++){var g=e[f];if(g instanceof mxRootChange||g instanceof mxValueChange&&g.cell==this.graph.model.root||g instanceof mxCellAttributeChange&&g.cell==this.graph.model.root){this.fireEvent(new mxEventObject(mxEvent.ROOT));break}}});a.getModel().addListener(mxEvent.CHANGE,b)};
mxEditor.prototype.installInsertHandler=function(a){var b=this;a.addMouseListener({mouseDown:function(c,d){if(null!=b.insertFunction&&!d.isPopupTrigger()&&(b.forcedInserting||null==d.getState())){b.graph.clearSelection();b.insertFunction(d.getEvent(),d.getCell());this.isActive=true;d.consume()}},mouseMove:function(c,d){this.isActive&&d.consume()},mouseUp:function(c,d){this.isActive&&(this.isActive=false,d.consume())}})};
mxEditor.prototype.createDiagramLayout=function(){var a=this.graph.gridSize,b=new mxStackLayout(this.graph,!this.horizontalFlow,this.swimlaneSpacing,2*a,2*a);b.isVertexIgnored=function(c){return!b.graph.isSwimlane(c)};return b};mxEditor.prototype.createSwimlaneLayout=function(){return new mxCompactTreeLayout(this.graph,this.horizontalFlow)};mxEditor.prototype.createToolbar=function(){return new mxDefaultToolbar(null,this)};
mxEditor.prototype.setToolbarContainer=function(a){this.toolbar.init(a);mxClient.IS_QUIRKS&&new mxDivResizer(a)};
mxEditor.prototype.setStatusContainer=function(a){null==this.status&&(this.status=a,this.addListener(mxEvent.SAVE,mxUtils.bind(this,function(){var b=(new Date).toLocaleString();this.setStatus((mxResources.get(this.lastSavedResource)||this.lastSavedResource)+": "+b)})),this.addListener(mxEvent.OPEN,mxUtils.bind(this,function(){this.setStatus((mxResources.get(this.currentFileResource)||this.currentFileResource)+": "+this.filename)})),mxClient.IS_QUIRKS&&new mxDivResizer(a))};
mxEditor.prototype.setStatus=function(a){null!=this.status&&null!=a&&(this.status.innerHTML=a)};mxEditor.prototype.setTitleContainer=function(a){this.addListener(mxEvent.ROOT,mxUtils.bind(this,function(){a.innerHTML=this.getTitle()}));mxClient.IS_QUIRKS&&new mxDivResizer(a)};mxEditor.prototype.treeLayout=function(a,b){null!=a&&(new mxCompactTreeLayout(this.graph,b)).execute(a)};
mxEditor.prototype.getTitle=function(){for(var a="",b=this.graph,c=b.getCurrentRoot();null!=c&&null!=b.getModel().getParent(b.getModel().getParent(c));){b.isValidRoot(c)&&(a=" > "+b.convertValueToString(c)+a);c=b.getModel().getParent(c)}return this.getRootTitle()+a};mxEditor.prototype.getRootTitle=function(){return this.graph.convertValueToString(this.graph.getModel().getRoot())};mxEditor.prototype.undo=function(){this.undoManager.undo()};mxEditor.prototype.redo=function(){this.undoManager.redo()};
mxEditor.prototype.groupCells=function(){var a=null!=this.groupBorderSize?this.groupBorderSize:this.graph.gridSize;return this.graph.groupCells(this.createGroup(),a)};mxEditor.prototype.createGroup=function(){return this.graph.getModel().cloneCell(this.defaultGroup)};mxEditor.prototype.open=function(a){if(null!=a){this.readGraphModel(mxUtils.load(a).getXml().documentElement);this.filename=a;this.fireEvent(new mxEventObject(mxEvent.OPEN,"filename",a))}};
mxEditor.prototype.readGraphModel=function(a){(new mxCodec(a.ownerDocument)).decode(a,this.graph.getModel());this.resetHistory()};mxEditor.prototype.save=function(a,b){a=a||this.getUrlPost();if(null!=a&&0<a.length){var c=this.writeGraphModel(b);this.postDiagram(a,c);this.setModified(false)}this.fireEvent(new mxEventObject(mxEvent.SAVE,"url",a))};
mxEditor.prototype.postDiagram=function(a,b){this.escapePostData&&(b=encodeURIComponent(b));mxUtils.post(a,this.postParameterName+"="+b,mxUtils.bind(this,function(c){this.fireEvent(new mxEventObject(mxEvent.POST,"request",c,"url",a,"data",b))}))};mxEditor.prototype.writeGraphModel=function(a){a=null!=a?a:this.linefeed;var b=(new mxCodec).encode(this.graph.getModel());return mxUtils.getXml(b,a)};mxEditor.prototype.getUrlPost=function(){return this.urlPost};mxEditor.prototype.getUrlImage=function(){return this.urlImage};
mxEditor.prototype.connect=function(a,b,c,d){var e=null;mxClient.IS_LOCAL||(e=new mxSession(this.graph.getModel(),a,b,c),e.addListener(mxEvent.RECEIVE,mxUtils.bind(this,function(f,g){null!=g.getProperty("node").getAttribute("namespace")&&this.resetHistory()})),e.addListener(mxEvent.DISCONNECT,d),e.addListener(mxEvent.CONNECT,d),e.addListener(mxEvent.NOTIFY,d),e.addListener(mxEvent.GET,d),e.start());return e};
mxEditor.prototype.swapStyles=function(a,b){var c=this.graph.getStylesheet().styles[b];this.graph.getView().getStylesheet().putCellStyle(b,this.graph.getStylesheet().styles[a]);this.graph.getStylesheet().putCellStyle(a,c);this.graph.refresh()};
mxEditor.prototype.showProperties=function(a){a=a||this.graph.getSelectionCell();null==a&&(a=this.graph.getCurrentRoot(),null==a&&(a=this.graph.getModel().getRoot()));if(null!=a){this.graph.stopEditing(true);var b=mxUtils.getOffset(this.graph.container),c=b.x+10;b=b.y;if(null!=this.properties&&!this.movePropertiesDialog){c=this.properties.getX();b=this.properties.getY()}else{var d=this.graph.getCellBounds(a);null!=d&&(c+=d.x+Math.min(200,d.width),b+=d.y)}this.hideProperties();a=this.createProperties(a);
null!=a&&(this.properties=new mxWindow(mxResources.get(this.propertiesResource)||this.propertiesResource,a,c,b,this.propertiesWidth,this.propertiesHeight,false),this.properties.setVisible(true))}};mxEditor.prototype.isPropertiesVisible=function(){return null!=this.properties};
mxEditor.prototype.createProperties=function(a){var b=this.graph.getModel(),c=b.getValue(a);if(mxUtils.isNode(c)){var d=new mxForm("properties");d.addText("ID",a.getId()).setAttribute("readonly","true");var e=null,f=null,g=null,h=null,k=null;b.isVertex(a)&&(e=b.getGeometry(a),null!=e&&(f=d.addText("top",e.y),g=d.addText("left",e.x),h=d.addText("width",e.width),k=d.addText("height",e.height)));var l=b.getStyle(a),m=d.addText("Style",l||""),p=c.attributes,o=[];for(c=0;c<p.length;c++)o[c]=d.addTextarea(p[c].nodeName,
p[c].nodeValue,"label"==p[c].nodeName?4:2);c=mxUtils.bind(this,function(){this.hideProperties();b.beginUpdate();try{null!=e&&(e=e.clone(),e.x=parseFloat(g.value),e.y=parseFloat(f.value),e.width=parseFloat(h.value),e.height=parseFloat(k.value),b.setGeometry(a,e));0<m.value.length?b.setStyle(a,m.value):b.setStyle(a,null);for(var n=0;n<p.length;n++){var s=new mxCellAttributeChange(a,p[n].nodeName,o[n].value);b.execute(s)}this.graph.isAutoSizeCell(a)&&this.graph.updateCellSize(a)}finally{b.endUpdate()}});
l=mxUtils.bind(this,function(){this.hideProperties()});d.addButtons(c,l);return d.table}return null};mxEditor.prototype.hideProperties=function(){null!=this.properties&&(this.properties.destroy(),this.properties=null)};
mxEditor.prototype.showTasks=function(){if(null==this.tasks){var a=document.createElement("div");a.style.padding="4px";a.style.paddingLeft="20px";var b=document.body.clientWidth;b=new mxWindow(mxResources.get(this.tasksResource)||this.tasksResource,a,b-220,this.tasksTop,200);b.setClosable(true);b.destroyOnClose=false;var c=mxUtils.bind(this,function(){mxEvent.release(a);a.innerHTML="";this.createTasks(a)});this.graph.getModel().addListener(mxEvent.CHANGE,c);this.graph.getSelectionModel().addListener(mxEvent.CHANGE,
c);this.graph.addListener(mxEvent.ROOT,c);null!=this.tasksWindowImage&&b.setImage(this.tasksWindowImage);this.tasks=b;this.createTasks(a)}this.tasks.setVisible(true)};mxEditor.prototype.refreshTasks=function(a){null!=this.tasks&&(a=this.tasks.content,mxEvent.release(a),a.innerHTML="",this.createTasks(a))};mxEditor.prototype.createTasks=function(){};
mxEditor.prototype.showHelp=function(a){if(null==this.help){var b=document.createElement("iframe");b.setAttribute("src",mxResources.get("urlHelp")||this.urlHelp);b.setAttribute("height","100%");b.setAttribute("width","100%");b.setAttribute("frameBorder","0");b.style.backgroundColor="white";a=document.body.clientWidth;var c=document.body.clientHeight||document.documentElement.clientHeight,d=new mxWindow(mxResources.get(this.helpResource)||this.helpResource,b,(a-this.helpWidth)/2,(c-this.helpHeight)/
3,this.helpWidth,this.helpHeight);d.setMaximizable(true);d.setClosable(true);d.destroyOnClose=false;d.setResizable(true);null!=this.helpWindowImage&&d.setImage(this.helpWindowImage);mxClient.IS_NS&&(a=function(){b.setAttribute("height",d.div.offsetHeight-26+"px")},d.addListener(mxEvent.RESIZE_END,a),d.addListener(mxEvent.MAXIMIZE,a),d.addListener(mxEvent.NORMALIZE,a),d.addListener(mxEvent.SHOW,a));this.help=d}this.help.setVisible(true)};
mxEditor.prototype.showOutline=function(){if(null==this.outline){var a=document.createElement("div");a.style.overflow="hidden";a.style.width="100%";a.style.height="100%";a.style.background="white";a.style.cursor="move";var b=new mxWindow(mxResources.get(this.outlineResource)||this.outlineResource,a,600,480,200,200,false),c=new mxOutline(this.graph,a);b.setClosable(true);b.setResizable(true);b.destroyOnClose=false;b.addListener(mxEvent.RESIZE_END,function(){c.update()});this.outline=b;this.outline.outline=
c}this.outline.setVisible(true);this.outline.outline.update(true)};mxEditor.prototype.setMode=function(a){"select"==a?(this.graph.panningHandler.useLeftButtonForPanning=false,this.graph.setConnectable(false)):"connect"==a?(this.graph.panningHandler.useLeftButtonForPanning=false,this.graph.setConnectable(true)):"pan"==a&&(this.graph.panningHandler.useLeftButtonForPanning=true,this.graph.setConnectable(false))};
mxEditor.prototype.createPopupMenu=function(a,b,c){this.popupHandler.createMenu(this,a,b,c)};mxEditor.prototype.createEdge=function(){var a=null;if(null!=this.defaultEdge)a=this.graph.getModel().cloneCell(this.defaultEdge);else{a=new mxCell("");a.setEdge(true);var b=new mxGeometry;b.relative=true;a.setGeometry(b)}b=this.getEdgeStyle();null!=b&&a.setStyle(b);return a};mxEditor.prototype.getEdgeStyle=function(){return this.defaultEdgeStyle};
mxEditor.prototype.consumeCycleAttribute=function(a){return null!=this.cycleAttributeValues&&0<this.cycleAttributeValues.length&&this.graph.isSwimlane(a)?this.cycleAttributeValues[this.cycleAttributeIndex++%this.cycleAttributeValues.length]:null};mxEditor.prototype.cycleAttribute=function(a){if(null!=this.cycleAttributeName){var b=this.consumeCycleAttribute(a);null!=b&&a.setStyle(a.getStyle()+";"+this.cycleAttributeName+"="+b)}};
mxEditor.prototype.addVertex=function(a,b,c,d){for(var e=this.graph.getModel();null!=a&&!this.graph.isValidDropTarget(a);)a=e.getParent(a);a=null!=a?a:this.graph.getSwimlaneAt(c,d);var f=this.graph.getView().scale,g=e.getGeometry(b),h=e.getGeometry(a);if(this.graph.isSwimlane(b)&&!this.graph.swimlaneNesting)a=null;else{if(null==a&&this.swimlaneRequired)return null;if(null!=a&&null!=h){var k=this.graph.getView().getState(a);if(null!=k){if(c-=k.origin.x*f,d-=k.origin.y*f,this.graph.isConstrainedMoving){h=
g.width;var l=g.height,m=k.x+k.width;c+h>m&&(c-=c+h-m);m=k.y+k.height;d+l>m&&(d-=d+l-m)}}else null!=h&&(c-=h.x*f,d-=h.y*f)}}g=g.clone();g.x=this.graph.snap(c/f-this.graph.getView().translate.x-this.graph.gridSize/2);g.y=this.graph.snap(d/f-this.graph.getView().translate.y-this.graph.gridSize/2);b.setGeometry(g);null==a&&(a=this.graph.getDefaultParent());this.cycleAttribute(b);this.fireEvent(new mxEventObject(mxEvent.BEFORE_ADD_VERTEX,"vertex",b,"parent",a));e.beginUpdate();try{b=this.graph.addCell(b,
a);null!=b&&(this.graph.constrainChild(b),this.fireEvent(new mxEventObject(mxEvent.ADD_VERTEX,"vertex",b)))}finally{e.endUpdate()}null!=b&&(this.graph.setSelectionCell(b),this.graph.scrollCellToVisible(b),this.fireEvent(new mxEventObject(mxEvent.AFTER_ADD_VERTEX,"vertex",b)));return b};
mxEditor.prototype.destroy=function(){this.destroyed||(this.destroyed=true,null!=this.tasks&&this.tasks.destroy(),null!=this.outline&&this.outline.destroy(),null!=this.properties&&this.properties.destroy(),null!=this.keyHandler&&this.keyHandler.destroy(),null!=this.rubberband&&this.rubberband.destroy(),null!=this.toolbar&&this.toolbar.destroy(),null!=this.graph&&this.graph.destroy(),this.templates=this.status=null)};
var mxCodecRegistry={codecs:[],aliases:[],register:function(a){if(null!=a){var b=a.getName();mxCodecRegistry.codecs[b]=a;var c=mxUtils.getFunctionName(a.template.constructor);c!=b&&mxCodecRegistry.addAlias(c,b)}return a},addAlias:function(a,b){mxCodecRegistry.aliases[a]=b},getCodec:function(a){var b=null;if(null!=a){b=mxUtils.getFunctionName(a);var c=mxCodecRegistry.aliases[b];null!=c&&(b=c);b=mxCodecRegistry.codecs[b];if(null==b)try{b=new mxObjectCodec(new a);mxCodecRegistry.register(b)}catch(d){}}return b}};
function mxCodec(a){this.document=a||mxUtils.createXmlDocument();this.objects=[]}mxCodec.prototype.document=null;mxCodec.prototype.objects=null;mxCodec.prototype.encodeDefaults=false;mxCodec.prototype.putObject=function(a,b){return this.objects[a]=b};mxCodec.prototype.getObject=function(a){var b=null;null!=a&&(b=this.objects[a],null==b&&(b=this.lookup(a),null==b&&(a=this.getElementById(a),null!=a&&(b=this.decode(a)))));return b};mxCodec.prototype.lookup=function(){return null};
mxCodec.prototype.getElementById=function(a,b){return mxUtils.findNodeByAttribute(this.document.documentElement,null!=b?b:"id",a)};mxCodec.prototype.getId=function(a){var b=null;null!=a&&(b=this.reference(a),null==b&&a instanceof mxCell&&(b=a.getId(),null==b&&(b=mxCellPath.create(a),0==b.length&&(b="root"))));return b};mxCodec.prototype.reference=function(){return null};
mxCodec.prototype.encode=function(a){var b=null;if(null!=a&&null!=a.constructor){var c=mxCodecRegistry.getCodec(a.constructor);null!=c?b=c.encode(this,a):mxUtils.isNode(a)?b=mxClient.IS_IE?a.cloneNode(true):this.document.importNode(a,true):mxLog.warn("mxCodec.encode: No codec for "+mxUtils.getFunctionName(a.constructor))}return b};
mxCodec.prototype.decode=function(a,b){var c=null;if(null!=a&&a.nodeType==mxConstants.NODETYPE_ELEMENT){var d=null;try{d=eval(a.nodeName)}catch(e){}try{var f=mxCodecRegistry.getCodec(d);null!=f?c=f.decode(this,a,b):(c=a.cloneNode(true),c.removeAttribute("as"))}catch(g){mxLog.debug("Cannot decode "+a.nodeName+": "+g.message)}}return c};mxCodec.prototype.encodeCell=function(a,b,c){b.appendChild(this.encode(a));if(null==c||c){c=a.getChildCount();for(var d=0;d<c;d++)this.encodeCell(a.getChildAt(d),b)}};
mxCodec.prototype.isCellCodec=function(a){return null!=a&&"function"==typeof a.isCellCodec?a.isCellCodec():false};mxCodec.prototype.decodeCell=function(a,b){b=null!=b?b:true;var c=null;if(null!=a&&a.nodeType==mxConstants.NODETYPE_ELEMENT){c=mxCodecRegistry.getCodec(a.nodeName);if(!this.isCellCodec(c))for(var d=a.firstChild;null!=d&&!this.isCellCodec(c);){c=mxCodecRegistry.getCodec(d.nodeName);d=d.nextSibling}this.isCellCodec(c)||(c=mxCodecRegistry.getCodec(mxCell));c=c.decode(this,a);b&&this.insertIntoGraph(c)}return c};
mxCodec.prototype.insertIntoGraph=function(a){var b=a.parent,c=a.getTerminal(true),d=a.getTerminal(false);a.setTerminal(null,false);a.setTerminal(null,true);a.parent=null;null!=b&&b.insert(a);null!=c&&c.insertEdge(a,true);null!=d&&d.insertEdge(a,false)};mxCodec.prototype.setAttribute=function(a,b,c){null!=b&&null!=c&&a.setAttribute(b,c)};
function mxObjectCodec(a,b,c,d){this.template=a;this.exclude=null!=b?b:[];this.idrefs=null!=c?c:[];this.mapping=null!=d?d:[];this.reverse={};for(var e in this.mapping)this.reverse[this.mapping[e]]=e}mxObjectCodec.prototype.template=null;mxObjectCodec.prototype.exclude=null;mxObjectCodec.prototype.idrefs=null;mxObjectCodec.prototype.mapping=null;mxObjectCodec.prototype.reverse=null;mxObjectCodec.prototype.getName=function(){return mxUtils.getFunctionName(this.template.constructor)};
mxObjectCodec.prototype.cloneTemplate=function(){return new this.template.constructor};mxObjectCodec.prototype.getFieldName=function(a){if(null!=a){var b=this.reverse[a];null!=b&&(a=b)}return a};mxObjectCodec.prototype.getAttributeName=function(a){if(null!=a){var b=this.mapping[a];null!=b&&(a=b)}return a};mxObjectCodec.prototype.isExcluded=function(a,b){return b==mxObjectIdentity.FIELD_NAME||0<=mxUtils.indexOf(this.exclude,b)};
mxObjectCodec.prototype.isReference=function(a,b){return 0<=mxUtils.indexOf(this.idrefs,b)};mxObjectCodec.prototype.encode=function(a,b){var c=a.document.createElement(this.getName());b=this.beforeEncode(a,b,c);this.encodeObject(a,b,c);return this.afterEncode(a,b,c)};mxObjectCodec.prototype.encodeObject=function(a,b,c){a.setAttribute(c,"id",a.getId(b));for(var d in b){var e=d,f=b[e];null!=f&&!this.isExcluded(b,e,f,true)&&(mxUtils.isNumeric(e)&&(e=null),this.encodeValue(a,b,e,f,c))}};
mxObjectCodec.prototype.encodeValue=function(a,b,c,d,e){if(null!=d){if(this.isReference(b,c,d,true)){var f=a.getId(d);if(null==f){mxLog.warn("mxObjectCodec.encode: No ID for "+this.getName()+"."+c+"="+d);return}d=f}f=this.template[c];if(null==c||a.encodeDefaults||f!=d){c=this.getAttributeName(c);this.writeAttribute(a,b,c,d,e)}}};mxObjectCodec.prototype.writeAttribute=function(a,b,c,d,e){"object"!=typeof d?this.writePrimitiveAttribute(a,b,c,d,e):this.writeComplexAttribute(a,b,c,d,e)};
mxObjectCodec.prototype.writePrimitiveAttribute=function(a,b,c,d,e){d=this.convertValueToXml(d);null==c?(b=a.document.createElement("add"),"function"==typeof d?b.appendChild(a.document.createTextNode(d)):a.setAttribute(b,"value",d),e.appendChild(b)):"function"!=typeof d&&a.setAttribute(e,c,d)};
mxObjectCodec.prototype.writeComplexAttribute=function(a,b,c,d,e){a=a.encode(d);null!=a?(null!=c&&a.setAttribute("as",c),e.appendChild(a)):mxLog.warn("mxObjectCodec.encode: No node for "+this.getName()+"."+c+": "+d)};mxObjectCodec.prototype.convertValueToXml=function(a){if("undefined"==typeof a.length&&(true==a||false==a))a=true==a?"1":"0";return a};mxObjectCodec.prototype.convertValueFromXml=function(a){mxUtils.isNumeric(a)&&(a=parseFloat(a));return a};
mxObjectCodec.prototype.beforeEncode=function(a,b){return b};mxObjectCodec.prototype.afterEncode=function(a,b,c){return c};mxObjectCodec.prototype.decode=function(a,b,c){var d=b.getAttribute("id"),e=a.objects[d];null==e&&(e=c||this.cloneTemplate(),null!=d&&a.putObject(d,e));b=this.beforeDecode(a,b,e);this.decodeNode(a,b,e);return this.afterDecode(a,b,e)};mxObjectCodec.prototype.decodeNode=function(a,b,c){null!=b&&(this.decodeAttributes(a,b,c),this.decodeChildren(a,b,c))};
mxObjectCodec.prototype.decodeAttributes=function(a,b,c){b=b.attributes;if(null!=b)for(var d=0;d<b.length;d++)this.decodeAttribute(a,b[d],c)};mxObjectCodec.prototype.decodeAttribute=function(a,b,c){var d=b.nodeName;if("as"!=d&&"id"!=d){b=this.convertValueFromXml(b.nodeValue);var e=this.getFieldName(d);if(this.isReference(c,e,b,false)){a=a.getObject(b);if(null==a){mxLog.warn("mxObjectCodec.decode: No object for "+this.getName()+"."+d+"="+b);return}b=a}this.isExcluded(c,d,b,false)||(c[d]=b)}};
mxObjectCodec.prototype.decodeChildren=function(a,b,c){for(b=b.firstChild;null!=b;){var d=b.nextSibling;b.nodeType==mxConstants.NODETYPE_ELEMENT&&!this.processInclude(a,b,c)&&this.decodeChild(a,b,c);b=d}};
mxObjectCodec.prototype.decodeChild=function(a,b,c){var d=this.getFieldName(b.getAttribute("as"));if(null==d||!this.isExcluded(c,d,b,false)){var e=this.getFieldTemplate(c,d,b),f=null;"add"==b.nodeName?(f=b.getAttribute("value"),null==f&&(f=mxUtils.eval(mxUtils.getTextContent(b)))):f=a.decode(b,e);this.addObjectValue(c,d,f,e)}};mxObjectCodec.prototype.getFieldTemplate=function(a,b){a=a[b];a instanceof Array&&0<a.length&&(a=null);return a};
mxObjectCodec.prototype.addObjectValue=function(a,b,c,d){null!=c&&c!=d&&(null!=b&&0<b.length?a[b]=c:a.push(c))};mxObjectCodec.prototype.processInclude=function(a,b,c){if("include"==b.nodeName){b=b.getAttribute("name");if(null!=b)try{var d=mxUtils.load(b).getDocumentElement();null!=d&&a.decode(d,c)}catch(e){}return true}return false};mxObjectCodec.prototype.beforeDecode=function(a,b){return b};mxObjectCodec.prototype.afterDecode=function(a,b,c){return c};
mxCodecRegistry.register(function(){var a=new mxObjectCodec(new mxCell,["children","edges","overlays","mxTransient"],["parent","source","target"]);a.isCellCodec=function(){return true};a.isExcluded=function(b,c,d,e){return mxObjectCodec.prototype.isExcluded.apply(this,arguments)||e&&"value"==c&&d.nodeType==mxConstants.NODETYPE_ELEMENT};a.afterEncode=function(b,c,d){if(null!=c.value&&c.value.nodeType==mxConstants.NODETYPE_ELEMENT){var e=d;d=mxClient.IS_IE?c.value.cloneNode(true):b.document.importNode(c.value,
true);d.appendChild(e);b=e.getAttribute("id");d.setAttribute("id",b);e.removeAttribute("id")}return d};a.beforeDecode=function(b,c,d){var e=c,f=this.getName();c.nodeName!=f?(e=c.getElementsByTagName(f)[0],null!=e&&e.parentNode==c?(mxUtils.removeWhitespace(e,true),mxUtils.removeWhitespace(e,false),e.parentNode.removeChild(e)):e=null,d.value=c.cloneNode(true),c=d.value.getAttribute("id"),null!=c&&(d.setId(c),d.value.removeAttribute("id"))):d.setId(c.getAttribute("id"));if(null!=e)for(c=0;c<this.idrefs.length;c++){f=
this.idrefs[c];var g=e.getAttribute(f);if(null!=g){e.removeAttribute(f);var h=b.objects[g]||b.lookup(g);null==h&&(g=b.getElementById(g),null!=g&&(h=(mxCodecRegistry.codecs[g.nodeName]||this).decode(b,g)));d[f]=h}}return e};return a}());
mxCodecRegistry.register(function(){var a=new mxObjectCodec(new mxGraphModel);a.encodeObject=function(b,c,d){var e=b.document.createElement("root");b.encodeCell(c.getRoot(),e);d.appendChild(e)};a.decodeChild=function(b,c,d){"root"==c.nodeName?this.decodeRoot(b,c,d):mxObjectCodec.prototype.decodeChild.apply(this,arguments)};a.decodeRoot=function(b,c,d){var e=null;for(c=c.firstChild;null!=c;){var f=b.decodeCell(c);null!=f&&null==f.getParent()&&(e=f);c=c.nextSibling}null!=e&&d.setRoot(e)};return a}());
mxCodecRegistry.register(function(){var a=new mxObjectCodec(new mxRootChange,["model","previous","root"]);a.afterEncode=function(b,c,d){b.encodeCell(c.root,d);return d};a.beforeDecode=function(b,c,d){if(null!=c.firstChild&&c.firstChild.nodeType==mxConstants.NODETYPE_ELEMENT){c=c.cloneNode(true);var e=c.firstChild;d.root=b.decodeCell(e,false);d=e.nextSibling;e.parentNode.removeChild(e);for(e=d;null!=e;){d=e.nextSibling;b.decodeCell(e);e.parentNode.removeChild(e);e=d}}return c};a.afterDecode=function(b,
c,d){d.previous=d.root;return d};return a}());
mxCodecRegistry.register(function(){var a=new mxObjectCodec(new mxChildChange,["model","child","previousIndex"],["parent","previous"]);a.isReference=function(b,c,d,e){return"child"==c&&(null!=b.previous||!e)?true:0<=mxUtils.indexOf(this.idrefs,c)};a.afterEncode=function(b,c,d){this.isReference(c,"child",c.child,true)?d.setAttribute("child",b.getId(c.child)):b.encodeCell(c.child,d);return d};a.beforeDecode=function(b,c,d){if(null!=c.firstChild&&c.firstChild.nodeType==mxConstants.NODETYPE_ELEMENT){c=
c.cloneNode(true);var e=c.firstChild;d.child=b.decodeCell(e,false);d=e.nextSibling;e.parentNode.removeChild(e);for(e=d;null!=e;){d=e.nextSibling;if(e.nodeType==mxConstants.NODETYPE_ELEMENT){var f=e.getAttribute("id");null==b.lookup(f)&&b.decodeCell(e)}e.parentNode.removeChild(e);e=d}}else{e=c.getAttribute("child");d.child=b.getObject(e)}return c};a.afterDecode=function(b,c,d){d.child.parent=d.previous;d.previous=d.parent;d.previousIndex=d.index;return d};return a}());
mxCodecRegistry.register(function(){var a=new mxObjectCodec(new mxTerminalChange,["model","previous"],["cell","terminal"]);a.afterDecode=function(b,c,d){d.previous=d.terminal;return d};return a}());var mxGenericChangeCodec=function(a,b){var c=new mxObjectCodec(a,["model","previous"],["cell"]);c.afterDecode=function(d,e,f){mxUtils.isNode(f.cell)&&(f.cell=d.decodeCell(f.cell,false));f.previous=f[b];return f};return c};mxCodecRegistry.register(mxGenericChangeCodec(new mxValueChange,"value"));
mxCodecRegistry.register(mxGenericChangeCodec(new mxStyleChange,"style"));mxCodecRegistry.register(mxGenericChangeCodec(new mxGeometryChange,"geometry"));mxCodecRegistry.register(mxGenericChangeCodec(new mxCollapseChange,"collapsed"));mxCodecRegistry.register(mxGenericChangeCodec(new mxVisibleChange,"visible"));mxCodecRegistry.register(mxGenericChangeCodec(new mxCellAttributeChange,"value"));mxCodecRegistry.register(function(){return new mxObjectCodec(new mxGraph,"graphListeners eventListeners view container cellRenderer editor selection".split(" "))}());
mxCodecRegistry.register(function(){var a=new mxObjectCodec(new mxGraphView);a.encode=function(b,c){return this.encodeCell(b,c,c.graph.getModel().getRoot())};a.encodeCell=function(b,c,d){var e=c.graph.getModel(),f=c.getState(d),g=e.getParent(d);if(null==g||null!=f){var h=e.getChildCount(d),k=c.graph.getCellGeometry(d),l=null;g==e.getRoot()?l="layer":null==g?l="graph":e.isEdge(d)?l="edge":0<h&&null!=k?l="group":e.isVertex(d)&&(l="vertex");if(null!=l){var m=b.document.createElement(l);null!=c.graph.getLabel(d)&&
(m.setAttribute("label",c.graph.getLabel(d)),c.graph.isHtmlLabel(d)&&m.setAttribute("html",true));if(null==g){var p=c.getGraphBounds();null!=p&&(m.setAttribute("x",Math.round(p.x)),m.setAttribute("y",Math.round(p.y)),m.setAttribute("width",Math.round(p.width)),m.setAttribute("height",Math.round(p.height)));m.setAttribute("scale",c.scale)}else if(null!=f&&null!=k){for(p in f.style){g=f.style[p];"function"==typeof g&&"object"==typeof g&&(g=mxStyleRegistry.getName(g));null!=g&&"function"!=typeof g&&
"object"!=typeof g&&m.setAttribute(p,g)}g=f.absolutePoints;if(null!=g&&0<g.length){k=Math.round(g[0].x)+","+Math.round(g[0].y);for(p=1;p<g.length;p++)k+=" "+Math.round(g[p].x)+","+Math.round(g[p].y);m.setAttribute("points",k)}else{m.setAttribute("x",Math.round(f.x));m.setAttribute("y",Math.round(f.y));m.setAttribute("width",Math.round(f.width));m.setAttribute("height",Math.round(f.height))}p=f.absoluteOffset;null!=p&&(0!=p.x&&m.setAttribute("dx",Math.round(p.x)),0!=p.y&&m.setAttribute("dy",Math.round(p.y)))}for(p=
0;p<h;p++){f=this.encodeCell(b,c,e.getChildAt(d,p));null!=f&&m.appendChild(f)}}}return m};return a}());
mxCodecRegistry.register(function(){var a=new mxObjectCodec(new mxStylesheet);a.encode=function(b,c){var d=b.document.createElement(this.getName()),e;for(e in c.styles){var f=c.styles[e],g=b.document.createElement("add");if(null!=e){g.setAttribute("as",e);for(var h in f){var k=this.getStringValue(h,f[h]);if(null!=k){var l=b.document.createElement("add");l.setAttribute("value",k);l.setAttribute("as",h);g.appendChild(l)}}0<g.childNodes.length&&d.appendChild(g)}}return d};a.getStringValue=function(b,
c){var d=typeof c;"function"==d?c=mxStyleRegistry.getName(style[j]):"object"==d&&(c=null);return c};a.decode=function(b,c,d){d=d||new this.template.constructor;var e=c.getAttribute("id");null!=e&&(b.objects[e]=d);for(c=c.firstChild;null!=c;){if(!this.processInclude(b,c,d)&&"add"==c.nodeName&&(e=c.getAttribute("as"),null!=e)){var f=c.getAttribute("extend"),g=null!=f?mxUtils.clone(d.styles[f]):null;null==g&&(null!=f&&mxLog.warn("mxStylesheetCodec.decode: stylesheet "+f+" not found to extend"),g={});
for(f=c.firstChild;null!=f;){if(f.nodeType==mxConstants.NODETYPE_ELEMENT){var h=f.getAttribute("as");if("add"==f.nodeName){var k=mxUtils.getTextContent(f),l=null;null!=k&&0<k.length?l=mxUtils.eval(k):(l=f.getAttribute("value"),mxUtils.isNumeric(l)&&(l=parseFloat(l)));null!=l&&(g[h]=l)}else"remove"==f.nodeName&&delete g[h]}f=f.nextSibling}d.putCellStyle(e,g)}c=c.nextSibling}return d};return a}());
mxCodecRegistry.register(function(){var a=new mxObjectCodec(new mxDefaultKeyHandler);a.encode=function(){return null};a.decode=function(b,c,d){if(null!=d)for(c=c.firstChild;null!=c;){if(!this.processInclude(b,c,d)&&"add"==c.nodeName){var e=c.getAttribute("as"),f=c.getAttribute("action"),g=c.getAttribute("control");d.bindAction(e,f,g)}c=c.nextSibling}return d};return a}());
mxCodecRegistry.register(function(){var a=new mxObjectCodec(new mxDefaultToolbar);a.encode=function(){return null};a.decode=function(b,c,d){if(null!=d){var e=d.editor;for(c=c.firstChild;null!=c;){if(c.nodeType==mxConstants.NODETYPE_ELEMENT&&!this.processInclude(b,c,d))if("separator"==c.nodeName)d.addSeparator();else if("br"==c.nodeName)d.toolbar.addBreak();else if("hr"==c.nodeName)d.toolbar.addLine();else if("add"==c.nodeName){var f=c.getAttribute("as");f=mxResources.get(f)||f;var g=c.getAttribute("icon"),
h=c.getAttribute("pressedIcon"),k=c.getAttribute("action"),l=c.getAttribute("mode"),m=c.getAttribute("template"),p="0"!=c.getAttribute("toggle"),o=mxUtils.getTextContent(c),n=null;if(null!=k)n=d.addItem(f,g,k,h);else if(null!=l){var s=mxUtils.eval(o);n=d.addMode(f,g,l,h,s)}else if(null!=m||null!=o&&0<o.length){n=e.templates[m];m=c.getAttribute("style");null!=n&&null!=m&&(n=n.clone(),n.setStyle(m));m=null;null!=o&&0<o.length&&(m=mxUtils.eval(o));n=d.addPrototype(f,g,n,h,m,p)}else if(h=mxUtils.getChildNodes(c),
0<h.length)if(null==g){m=d.addActionCombo(f);for(f=0;f<h.length;f++){p=h[f];"separator"==p.nodeName?d.addOption(m,"---"):"add"==p.nodeName&&(g=p.getAttribute("as"),p=p.getAttribute("action"),d.addActionOption(m,g,p))}}else{var t=null,q=d.addPrototype(f,g,function(){var r=e.templates[t.value];if(null!=r){r=r.clone();var u=t.options[t.selectedIndex].cellStyle;null!=u&&r.setStyle(u);return r}mxLog.warn("Template "+r+" not found");return null},null,null,p);t=d.addCombo();mxEvent.addListener(t,"change",
function(){d.toolbar.selectMode(q,function(r){r=mxUtils.convertPoint(e.graph.container,mxEvent.getClientX(r),mxEvent.getClientY(r));return e.addVertex(null,s(),r.x,r.y)});d.toolbar.noReset=false});for(f=0;f<h.length;f++){p=h[f];"separator"==p.nodeName?d.addOption(t,"---"):"add"==p.nodeName&&(g=p.getAttribute("as"),o=p.getAttribute("template"),d.addOption(t,g,o||m).cellStyle=p.getAttribute("style"))}}null!=n&&(m=c.getAttribute("id"),null!=m&&0<m.length&&n.setAttribute("id",m))}c=c.nextSibling}}return d};
return a}());mxCodecRegistry.register(function(){var a=new mxObjectCodec(new mxDefaultPopupMenu);a.encode=function(){return null};a.decode=function(b,c,d){var e=c.getElementsByTagName("include")[0];null!=e?this.processInclude(b,e,d):null!=d&&(d.config=c);return d};return a}());
mxCodecRegistry.register(function(){var a=new mxObjectCodec(new mxEditor,"modified lastSnapshot ignoredChanges undoManager graphContainer toolbarContainer".split(" "));a.afterDecode=function(b,c,d){b=c.getAttribute("defaultEdge");null!=b&&(c.removeAttribute("defaultEdge"),d.defaultEdge=d.templates[b]);b=c.getAttribute("defaultGroup");null!=b&&(c.removeAttribute("defaultGroup"),d.defaultGroup=d.templates[b]);return d};a.decodeChild=function(b,c,d){if("Array"==c.nodeName){if("templates"==c.getAttribute("as")){this.decodeTemplates(b,
c,d);return}}else if("ui"==c.nodeName){this.decodeUi(b,c,d);return}mxObjectCodec.prototype.decodeChild.apply(this,arguments)};a.decodeUi=function(b,c,d){for(b=c.firstChild;null!=b;){if("add"==b.nodeName){c=b.getAttribute("as");var e=b.getAttribute("element"),f=b.getAttribute("style"),g=null;if(null!=e){g=document.getElementById(e);null!=g&&null!=f&&(g.style.cssText+=";"+f)}else{e=parseInt(b.getAttribute("x"));var h=parseInt(b.getAttribute("y")),k=b.getAttribute("width"),l=b.getAttribute("height");
g=document.createElement("div");g.style.cssText=f;(new mxWindow(mxResources.get(c)||c,g,e,h,k,l,false,true)).setVisible(true)}"graph"==c?d.setGraphContainer(g):"toolbar"==c?d.setToolbarContainer(g):"title"==c?d.setTitleContainer(g):"status"==c?d.setStatusContainer(g):"map"==c&&d.setMapContainer(g)}else"resource"==b.nodeName?mxResources.add(b.getAttribute("basename")):"stylesheet"==b.nodeName&&mxClient.link("stylesheet",b.getAttribute("name"));b=b.nextSibling}};a.decodeTemplates=function(b,c,d){null==
d.templates&&(d.templates=[]);c=mxUtils.getChildNodes(c);for(var e=0;e<c.length;e++){for(var f=c[e].getAttribute("as"),g=c[e].firstChild;null!=g&&1!=g.nodeType;)g=g.nextSibling;null!=g&&(d.templates[f]=b.decodeCell(g))}};return a}());var useLocalStorage=(mxClient.IS_TOUCH||urlParams.storage=="local")&&typeof localStorage!="undefined",fileSupport=window.File!=null&&window.FileReader!=null&&window.FileList!=null,touchStyle=mxClient.IS_TOUCH||urlParams.touch=="1",counter=0;try{for(var op=window;op.opener!=null&&!isNaN(op.opener.counter);)op=op.opener;if(op!=null){op.counter++;counter=op.counter}}catch(e$$631){}
Editor=function(){mxEventSource.call(this);this.init();this.initStencilRegistry();this.graph=new Graph;this.outline=new mxOutline(this.graph);this.outline.updateOnPan=true;this.undoManager=this.createUndoManager();this.status="";this.filename=null;this.getOrCreateFilename=function(){return this.filename||mxResources.get("drawing",[counter])+".xml"};this.getFilename=function(){return this.filename};this.setStatus=function(a){this.status=a;this.fireEvent(new mxEventObject("statusChanged"))};this.getStatus=
function(){return this.status};this.modified=false;this.graphChangeListener=function(){this.modified=true};this.graph.getModel().addListener(mxEvent.CHANGE,mxUtils.bind(this,function(){this.graphChangeListener.apply(this,arguments)}));this.graph.resetViewOnRootChange=false;this.graph.scrollbars=true;this.graph.background=null};mxUtils.extend(Editor,mxEventSource);Editor.prototype.gridImage=IMAGE_PATH+"/grid.gif";Editor.prototype.transparentImage=IMAGE_PATH+"/transparent.gif";
Editor.prototype.setGraphXml=function(a){var b=new mxCodec(a.ownerDocument);if(a.nodeName!="mxGraphModel"){var c=a.getElementsByTagName("mxGraphModel");if(c!=null&&c.length>0)a=c[0]}if(a.nodeName=="mxGraphModel"){this.graph.view.scale=1;this.graph.gridEnabled=a.getAttribute("grid")!="0";this.graph.graphHandler.guidesEnabled=a.getAttribute("guides")!="0";this.graph.setTooltips(a.getAttribute("tooltips")!="0");this.graph.setConnectable(a.getAttribute("connect")!="0");this.graph.foldingEnabled=a.getAttribute("fold")!=
"0";this.graph.scrollbars=a.getAttribute("scrollbars")!="0";if(!this.graph.scrollbars){this.graph.container.scrollLeft=0;this.graph.container.scrollTop=0;this.graph.view.translate.x=Number(a.getAttribute("dx")||0);this.graph.view.translate.y=Number(a.getAttribute("dy")||0)}this.graph.pageVisible=a.getAttribute("page")=="1";this.graph.pageBreaksVisible=this.graph.pageVisible;this.graph.preferPageSize=this.graph.pageBreaksVisible;c=a.getAttribute("pageScale");this.graph.pageScale=c!=null?c:1.5;c=a.getAttribute("pageWidth");
var d=a.getAttribute("pageHeight");if(c!=null&&d!=null){this.graph.pageFormat=new mxRectangle(0,0,parseFloat(c),parseFloat(d));this.outline.outline.pageFormat=this.graph.pageFormat}c=a.getAttribute("background");if(c!=null&&c.length>0)this.graph.background=c;b.decode(a,this.graph.getModel())}else{c=b.document.createElement("mxGraphModel");c.appendChild(a);b.decode(c,this.graph.getModel())}this.updateGraphComponents()};
Editor.prototype.getGraphXml=function(){var a=(new mxCodec(mxUtils.createXmlDocument())).encode(this.graph.getModel());if(this.graph.view.translate.x!=0||this.graph.view.translate.y!=0){a.setAttribute("dx",Math.round(this.graph.view.translate.x*100)/100);a.setAttribute("dy",Math.round(this.graph.view.translate.y*100)/100)}a.setAttribute("grid",this.graph.isGridEnabled()?"1":"0");a.setAttribute("guides",this.graph.graphHandler.guidesEnabled?"1":"0");a.setAttribute("guides",this.graph.graphHandler.guidesEnabled?
"1":"0");a.setAttribute("tooltips",this.graph.tooltipHandler.isEnabled()?"1":"0");a.setAttribute("connect",this.graph.connectionHandler.isEnabled()?"1":"0");a.setAttribute("fold",this.graph.foldingEnabled?"1":"0");a.setAttribute("page",this.graph.pageVisible?"1":"0");a.setAttribute("pageScale",this.graph.pageScale);a.setAttribute("pageWidth",this.graph.pageFormat.width);a.setAttribute("pageHeight",this.graph.pageFormat.height);this.graph.scrollbars||a.setAttribute("scrollbars","0");this.graph.background!=
null&&a.setAttribute("background",this.graph.background);return a};
Editor.prototype.updateGraphComponents=function(){var a=this.graph,b=this.outline;if(a.container!=null&&b.outline.container!=null){if(a.background!=null)if(a.background=="none")a.container.style.backgroundColor="transparent";else{if(a.view.backgroundPageShape!=null){a.view.backgroundPageShape.fill=a.background;a.view.backgroundPageShape.reconfigure()}a.container.style.backgroundColor=a.background}else a.container.style.backgroundColor="";if(a.pageVisible){a.container.style.backgroundColor="#ebebeb";
a.container.style.borderStyle="solid";a.container.style.borderColor="#e5e5e5";a.container.style.borderTopWidth="1px";a.container.style.borderLeftWidth="1px";a.container.style.borderRightWidth="0px";a.container.style.borderBottomWidth="0px"}else a.container.style.border="";b.outline.container.style.backgroundColor=a.container.style.backgroundColor;if(b.outline.pageVisible!=a.pageVisible||b.outline.pageScale!=a.pageScale){b.outline.pageScale=a.pageScale;b.outline.pageVisible=a.pageVisible;b.outline.view.validate()}if(a.scrollbars&&
a.container.style.overflow=="hidden"&&!touchStyle)a.container.style.overflow="auto";else if(!a.scrollbars||touchStyle)a.container.style.overflow="hidden";b=mxClient.IS_IE&&document.documentMode>=9?"url("+this.transparentImage+")":"none";a.container.style.backgroundImage=!a.pageVisible&&a.isGridEnabled()?"url("+this.gridImage+")":b;if(a.view.backgroundPageShape!=null)a.view.backgroundPageShape.node.style.backgroundImage=this.graph.isGridEnabled()?"url("+this.gridImage+")":"none"}};
Editor.prototype.init=function(){mxClient.IS_IE6&&mxClient.link("stylesheet",CSS_PATH+"/grapheditor-ie6.css");mxResources.loadDefaultBundle=false;mxResources.add(RESOURCE_BASE);mxConstants.DEFAULT_HOTSPOT=0.3;var a=mxConnectionHandler.prototype.createMarker;mxConnectionHandler.prototype.createMarker=function(){var g=a.apply(this,arguments);g.intersects=mxUtils.bind(this,function(){if(this.isConnecting())return true;return mxCellMarker.prototype.intersects.apply(g,arguments)});return g};mxConstants.SHADOWCOLOR=
"#d0d0d0";mxConstants.HANDLE_FILLCOLOR="#99ccff";mxConstants.HANDLE_STROKECOLOR="#0088cf";mxConstants.VERTEX_SELECTION_COLOR="#00a8ff";mxConstants.OUTLINE_COLOR="#00a8ff";mxConstants.OUTLINE_HANDLE_FILLCOLOR="#99ccff";mxConstants.OUTLINE_HANDLE_STROKECOLOR="#00a8ff";mxConstants.CONNECT_HANDLE_FILLCOLOR="#cee7ff";mxConstants.EDGE_SELECTION_COLOR="#00a8ff";mxConstants.DEFAULT_VALID_COLOR="#00a8ff";mxConstants.LABEL_HANDLE_FILLCOLOR="#cee7ff";mxConstants.GUIDE_COLOR="#0088cf";mxGraph.prototype.pageBreakColor=
"#c0c0c0";mxGraph.prototype.pageScale=1;mxRubberband.prototype.defaultOpacity=30;mxGraphView.prototype.createBackgroundPageShape=function(g){return new mxRectangleShape(g,this.graph.background||"white","#cacaca")};mxGraphView.prototype.getBackgroundPageBounds=function(){var g=this.getGraphBounds(),h=g.width>0?g.x/this.scale-this.translate.x:0,k=g.height>0?g.y/this.scale-this.translate.y:0,l=this.graph.pageFormat,m=this.graph.pageScale,p=l.width*m;l=l.height*m;m=Math.floor(Math.min(0,h)/p);var o=Math.floor(Math.min(0,
k)/l);return new mxRectangle(this.scale*(this.translate.x+m*p),this.scale*(this.translate.y+o*l),this.scale*(Math.ceil(Math.max(1,h+g.width/this.scale)/p)-m)*p,this.scale*(Math.ceil(Math.max(1,k+g.height/this.scale)/l)-o)*l)};var b=mxGraph.prototype.panGraph;mxGraph.prototype.panGraph=function(g,h){b.apply(this,arguments);if(this.dialect!=mxConstants.DIALECT_SVG&&this.view.backgroundPageShape!=null&&(!this.useScrollbarsForPanning||!mxUtils.hasScrollbars(this.container))){this.view.backgroundPageShape.node.style.marginLeft=
g+"px";this.view.backgroundPageShape.node.style.marginTop=h+"px"}};var c=this;mxGraphView.prototype.validateBackground=function(){var g=this.graph.getBackgroundImage();if(g!=null){if(this.backgroundImage==null||this.backgroundImage.image!=g.src){this.backgroundImage!=null&&this.backgroundImage.destroy();var h=new mxRectangle(0,0,1,1);this.backgroundImage=new mxImageShape(h,g.src);this.backgroundImage.dialect=this.graph.dialect;this.backgroundImage.init(this.backgroundPane);this.backgroundImage.redraw()}this.redrawBackgroundImage(this.backgroundImage,
g)}else if(this.backgroundImage!=null){this.backgroundImage.destroy();this.backgroundImage=null}if(this.graph.pageVisible){h=this.getBackgroundPageBounds();if(this.backgroundPageShape==null){this.backgroundPageShape=this.createBackgroundPageShape(h);this.backgroundPageShape.scale=1;this.backgroundPageShape.isShadow=true;this.backgroundPageShape.dialect=mxConstants.DIALECT_STRICTHTML;this.backgroundPageShape.init(this.graph.container);this.graph.container.firstChild.style.position="absolute";this.graph.container.insertBefore(this.backgroundPageShape.node,
this.graph.container.firstChild);this.backgroundPageShape.redraw();this.backgroundPageShape.node.className="geBackgroundPage";this.backgroundPageShape.node.style.backgroundPosition="-1px -1px";mxEvent.addListener(this.backgroundPageShape.node,"dblclick",mxUtils.bind(this,function(k){this.graph.dblClick(k)}));mxEvent.addGestureListeners(this.backgroundPageShape.node,mxUtils.bind(this,function(k){this.graph.fireMouseEvent(mxEvent.MOUSE_DOWN,new mxMouseEvent(k))}),mxUtils.bind(this,function(k){this.graph.tooltipHandler!=
null&&this.graph.tooltipHandler.isHideOnHover()&&this.graph.tooltipHandler.hide();this.graph.isMouseDown&&!mxEvent.isConsumed(k)&&this.graph.fireMouseEvent(mxEvent.MOUSE_MOVE,new mxMouseEvent(k))}),mxUtils.bind(this,function(k){this.graph.fireMouseEvent(mxEvent.MOUSE_UP,new mxMouseEvent(k))}))}else{this.backgroundPageShape.scale=1;this.backgroundPageShape.bounds=h;this.backgroundPageShape.redraw()}this.backgroundPageShape.node.style.backgroundImage=this.graph.isGridEnabled()?"url("+c.gridImage+")":
"none"}else if(this.backgroundPageShape!=null){this.backgroundPageShape.destroy();this.backgroundPageShape=null}};mxGraph.prototype.updatePageBreaks=function(g,h,k){var l=this.view.scale,m=this.view.translate,p=this.pageFormat,o=l*this.pageScale,n=this.view.getBackgroundPageBounds();h=n.width;k=n.height;m=new mxRectangle(l*m.x,l*m.y,p.width*o,p.height*o);p=(g=g&&Math.min(m.width,m.height)>this.minPageBreakDist)?Math.ceil(h/m.width)-1:0;g=g?Math.ceil(k/m.height)-1:0;h=n.x+h;k=n.y+k;if(this.horizontalPageBreaks==
null&&p>0)this.horizontalPageBreaks=[];if(this.horizontalPageBreaks!=null){for(o=0;o<=p;o++){var s=[new mxPoint(n.x+(o+1)*m.width,n.y),new mxPoint(n.x+(o+1)*m.width,k)];if(this.horizontalPageBreaks[o]!=null){this.horizontalPageBreaks[o].scale=1;this.horizontalPageBreaks[o].points=s;this.horizontalPageBreaks[o].redraw()}else{s=new mxPolyline(s,this.pageBreakColor,this.scale);s.dialect=this.dialect;s.isDashed=this.pageBreakDashed;s.addPipe=false;s.scale=l;s.init(this.view.backgroundPane);s.redraw();
this.horizontalPageBreaks[o]=s}}for(o=p;o<this.horizontalPageBreaks.length;o++)this.horizontalPageBreaks[o].destroy();this.horizontalPageBreaks.splice(p,this.horizontalPageBreaks.length-p)}if(this.verticalPageBreaks==null&&g>0)this.verticalPageBreaks=[];if(this.verticalPageBreaks!=null){for(o=0;o<=g;o++){s=[new mxPoint(n.x,n.y+(o+1)*m.height),new mxPoint(h,n.y+(o+1)*m.height)];if(this.verticalPageBreaks[o]!=null){this.verticalPageBreaks[o].scale=1;this.verticalPageBreaks[o].points=s;this.verticalPageBreaks[o].redraw()}else{s=
new mxPolyline(s,this.pageBreakColor,l);s.dialect=this.dialect;s.isDashed=this.pageBreakDashed;s.addPipe=false;s.scale=l;s.init(this.view.backgroundPane);s.redraw();this.verticalPageBreaks[o]=s}}for(o=g;o<this.verticalPageBreaks.length;o++)this.verticalPageBreaks[o].destroy();this.verticalPageBreaks.splice(g,this.verticalPageBreaks.length-g)}};mxEdgeHandler.prototype.snapToTerminals=true;mxGraphHandler.prototype.guidesEnabled=true;var d=mxGraphHandler.prototype.shouldRemoveCellsFromParent;mxGraphHandler.prototype.shouldRemoveCellsFromParent=
function(g,h){for(var k=0;k<h.length;k++)if(this.graph.getModel().isVertex(h[k])){var l=this.graph.getCellGeometry(h[k]);if(l!=null&&l.relative)return false}return d.apply(this,arguments)};mxGuide.prototype.isEnabledForEvent=function(g){return!mxEvent.isAltDown(g)};mxPopupMenuAddItem=mxPopupMenu.prototype.addItem;mxPopupMenu.prototype.addItem=function(g,h,k,l,m,p){var o=mxPopupMenuAddItem.apply(this,arguments);p!=null&&!p&&mxEvent.addListener(o,"mousedown",function(n){mxEvent.consume(n)});return o};
var e=mxGraphHandler.prototype.getInitialCellForEvent;mxGraphHandler.prototype.getInitialCellForEvent=function(){var g=this.graph.getModel(),h=g.getParent(this.graph.getSelectionCell()),k=e.apply(this,arguments),l=g.getParent(k);if(h==null||h!=k&&h!=l)for(;!this.graph.isCellSelected(k)&&!this.graph.isCellSelected(l)&&g.isVertex(l)&&!this.graph.isValidRoot(l);){k=l;l=this.graph.getModel().getParent(k)}return k};var f=mxGraphHandler.prototype.isDelayedSelection;mxGraphHandler.prototype.isDelayedSelection=
function(g){var h=f.apply(this,arguments),k=this.graph.getModel(),l=k.getParent(this.graph.getSelectionCell()),m=k.getParent(g);if(l==null||l!=g&&l!=m)if(!this.graph.isCellSelected(g)&&k.isVertex(m)&&!this.graph.isValidRoot(m))h=true;return h};mxGraphHandler.prototype.selectDelayed=function(g){var h=g.getCell();if(h==null)h=this.cell;for(var k=this.graph.getModel(),l=k.getParent(h);this.graph.isCellSelected(h)&&k.isVertex(l)&&!this.graph.isValidRoot(l);){h=l;l=k.getParent(h)}this.graph.selectCellForEvent(h,
g.getEvent())};mxPanningHandler.prototype.getCellForPopupEvent=function(g){g=g.getCell();for(var h=this.graph.getModel(),k=h.getParent(g);h.isVertex(k)&&!this.graph.isValidRoot(k);){if(this.graph.isCellSelected(k))g=k;k=h.getParent(k)}return g}};
Editor.prototype.createUndoManager=function(){var a=this.graph,b=new mxUndoManager,c=function(d,e){b.undoableEditHappened(e.getProperty("edit"))};a.getModel().addListener(mxEvent.UNDO,c);a.getView().addListener(mxEvent.UNDO,c);c=function(d,e){for(var f=a.getSelectionCellsForChanges(e.getProperty("edit").changes),g=[],h=0;h<f.length;h++)a.view.getState(f[h])!=null&&g.push(f[h]);a.setSelectionCells(g)};b.addListener(mxEvent.UNDO,c);b.addListener(mxEvent.REDO,c);return b};
Editor.prototype.initStencilRegistry=function(){mxStencilRegistry.loadStencilSet(STENCIL_PATH+"/general.xml")};
(function(){mxStencilRegistry.libraries={};mxStencilRegistry.packages=[];mxStencilRegistry.getStencil=function(a){var b=mxStencilRegistry.stencils[a];if(b==null){var c=mxStencilRegistry.getBasenameForStencil(a);if(c!=null){b=mxStencilRegistry.libraries[c];if(b!=null){if(mxStencilRegistry.packages[c]==null){mxStencilRegistry.packages[c]=1;for(c=0;c<b.length;c++){var d=b[c];if(d.toLowerCase().substring(d.length-4,d.length)==".xml")mxStencilRegistry.loadStencilSet(d,null);else if(d.toLowerCase().substring(d.length-
3,d.length)==".js"){d=mxUtils.load(d);d!=null&&eval.call(window,d.getText())}}}}else mxStencilRegistry.loadStencilSet(STENCIL_PATH+"/"+c+".xml",null);b=mxStencilRegistry.stencils[a]}}return b};mxStencilRegistry.getBasenameForStencil=function(a){a=a.split(".");var b=null;if(a.length>0&&a[0]=="mxgraph"){b=a[1];for(var c=2;c<a.length-1;c++)b+="/"+a[c]}return b};mxStencilRegistry.loadStencilSet=function(a,b,c){var d=mxStencilRegistry.packages[a];if(c!=null&&c||d==null){c=false;if(d==null){d=mxUtils.load(a).getXml();
mxStencilRegistry.packages[a]=d;c=true}mxStencilRegistry.parseStencilSet(d,b,c)}};mxStencilRegistry.parseStencilSet=function(a,b,c){c=c!=null?c:true;var d=a.documentElement;a=d.firstChild;var e="";d=d.getAttribute("name");if(d!=null)e=d+".";for(;a!=null;){if(a.nodeType==mxConstants.NODETYPE_ELEMENT){d=a.getAttribute("name");if(d!=null){e=e.toLowerCase();var f=d.replace(/ /g,"_");c&&mxStencilRegistry.addStencil(e+f.toLowerCase(),new mxStencil(a));if(b!=null){var g=a.getAttribute("w"),h=a.getAttribute("h");
g=g==null?80:parseInt(g,10);h=h==null?80:parseInt(h,10);b(e,f,d,g,h)}}}a=a.nextSibling}}})();OpenFile=function(a){this.consumer=this.producer=null;this.done=a};OpenFile.prototype.setConsumer=function(a){this.consumer=a;this.execute()};OpenFile.prototype.setData=function(a,b){this.data=a;this.filename=b;this.execute()};OpenFile.prototype.error=function(a){this.cancel();mxUtils.alert(a)};
OpenFile.prototype.execute=function(){if(this.consumer!=null&&this.data!=null){this.consumer(this.data,this.filename);this.cancel()}};OpenFile.prototype.cancel=function(){this.done!=null&&this.done()};EditorUi=function(a,b,c){this.editor=a||new Editor;this.choices=b||["all"];this.container=c||document.body;var d=a.graph;this.container.style.overflow="hidden";(new Image).src=mxPopupMenu.prototype.submenuImage;if(mxConnectionHandler.prototype.connectImage!=null)(new Image).src=mxConnectionHandler.prototype.connectImage.src;this.actions=new Actions(this);this.menus=new Menus(this);this.createDivs();this.refresh();this.createUi();b=mxUtils.bind(this,function(g){if(g==null)g=window.event;if(this.isSelectionAllowed(g))return true;
return d.isEditing()});if(this.container==document.body){this.menubarContainer.onselectstart=b;this.menubarContainer.onmousedown=b;this.toolbarContainer.onselectstart=b;this.toolbarContainer.onmousedown=b;this.diagramContainer.onselectstart=b;this.diagramContainer.onmousedown=b;this.sidebarContainer.onselectstart=b;this.sidebarContainer.onmousedown=b;this.footerContainer.onselectstart=b;this.footerContainer.onmousedown=b}if(mxClient.IS_IE&&(typeof document.documentMode==="undefined"||document.documentMode<
9))mxEvent.addListener(this.diagramContainer,"contextmenu",b);else this.diagramContainer.oncontextmenu=b;d.init(this.diagramContainer);d.refresh();d.container.setAttribute("tabindex","0");d.container.style.overflow=touchStyle?"hidden":"auto";d.container.style.cursor="default";d.container.style.backgroundImage="url("+a.gridImage+")";d.container.style.backgroundPosition="-1px -1px";d.container.focus();var e=d.fireMouseEvent;d.fireMouseEvent=function(g){g==mxEvent.MOUSE_DOWN&&this.container.focus();
e.apply(this,arguments)};d.panningHandler.autoExpand=true;d.panningHandler.factoryMethod=mxUtils.bind(this,function(g,h,k){this.menus.createPopupMenu(g,h,k)});a.outline.init(this.outlineContainer);mxEvent.addGestureListeners(document,mxUtils.bind(this,function(){d.panningHandler.hideMenu()}));if(mxClient.IS_TOUCH){mxEvent.addListener(d.container,"gesturechange",mxUtils.bind(this,function(g){d.view.getDrawPane().setAttribute("transform","scale("+g.scale+")");d.view.getOverlayPane().style.visibility=
"hidden";mxEvent.consume(g)}));mxEvent.addListener(d.container,"gestureend",mxUtils.bind(this,function(g){d.view.getDrawPane().removeAttribute("transform");d.view.setScale(d.view.scale*g.scale);d.view.getOverlayPane().style.visibility="visible";mxEvent.consume(g)}));d.handleGesture=function(){}}var f=this.createKeyHandler(a);this.getKeyHandler=function(){return f};mxEvent.addListener(window,"resize",mxUtils.bind(this,function(){this.refresh();d.sizeDidChange();this.editor.outline.update(false);this.editor.outline.outline.sizeDidChange()}));
this.init();this.open()};EditorUi.prototype.splitSize=mxClient.IS_TOUCH?16:8;EditorUi.prototype.menubarHeight=0;EditorUi.prototype.toolbarHeight=36;EditorUi.prototype.footerHeight=0;EditorUi.prototype.sidebarFooterHeight=34;EditorUi.prototype.hsplitPosition=204;EditorUi.prototype.vsplitPosition=0;
EditorUi.prototype.init=function(){this.addUndoListener();this.addSelectionListener();var a=this.actions.get("paste"),b=mxClipboard.cut;mxClipboard.cut=function(){b.apply(this,arguments);a.setEnabled(!mxClipboard.isEmpty())};var c=mxClipboard.copy;mxClipboard.copy=function(){c.apply(this,arguments);a.setEnabled(!mxClipboard.isEmpty())}};EditorUi.prototype.isSelectionAllowed=function(){return false};
EditorUi.prototype.open=function(){try{window.opener!=null&&window.opener.openFile!=null&&window.opener.openFile.setConsumer(mxUtils.bind(this,function(b,c){try{this.editor.setGraphXml(mxUtils.parseXml(b).documentElement);this.editor.modified=false;this.editor.undoManager.clear();if(c!=null)this.editor.filename=c}catch(d){mxUtils.alert(mxResources.get("invalidOrMissingFile")+": "+d.message)}}))}catch(a){}};
EditorUi.prototype.save=function(a){if(a!=null){var b=mxUtils.getXml(this.editor.getGraphXml());try{if(useLocalStorage){if(localStorage.getItem(a)!=null&&!mxUtils.confirm(mxResources.get("replace",[a])))return;localStorage.setItem(a,b);this.editor.setStatus(mxResources.get("saved")+" "+new Date)}else if(b.length<MAX_REQUEST_SIZE){b=encodeURIComponent(b);(new mxXmlRequest(SAVE_URL,"filename="+a+"&xml="+b)).simulate(document,"_blank")}else{mxUtils.alert(mxResources.get("drawingTooLarge"));mxUtils.popup(b);
return}this.editor.filename=a;this.editor.modified=false}catch(c){this.editor.setStatus("Error saving file")}}};EditorUi.prototype.getUrl=function(a){a=a!=null?a:window.location.pathname;var b=a.indexOf("?")>0?1:0,c;for(c in urlParams){a+=b==0?"?":"&";a+=c+"="+urlParams[c];b++}return a};
EditorUi.prototype.addUndoListener=function(){var a=this.actions.get("undo"),b=this.actions.get("redo"),c=this.editor.undoManager,d=function(){a.setEnabled(c.canUndo());b.setEnabled(c.canRedo())};c.addListener(mxEvent.ADD,d);c.addListener(mxEvent.UNDO,d);c.addListener(mxEvent.REDO,d);c.addListener(mxEvent.CLEAR,d);d()};
EditorUi.prototype.addSelectionListener=function(){var a=mxUtils.bind(this,function(){var b=this.editor.graph,c=!b.isSelectionEmpty(),d=false,e=false,f=b.getSelectionCells();if(f!=null)for(var g=0;g<f.length;g++){var h=f[g];if(b.getModel().isEdge(h))e=true;if(b.getModel().isVertex(h))d=true;if(e&&d)break}f=["cut","copy","delete","duplicate","bold","italic","style","fillColor","gradientColor","underline","fontColor","strokeColor","backgroundColor","borderColor","toFront","toBack","dashed","rounded",
"shadow","tilt","autosize","lockUnlock"];for(g=0;g<f.length;g++)this.actions.get(f[g]).setEnabled(c);this.actions.get("curved").setEnabled(e);this.actions.get("rotation").setEnabled(d);this.actions.get("wordWrap").setEnabled(d);this.actions.get("group").setEnabled(b.getSelectionCount()>1);this.actions.get("ungroup").setEnabled(b.getSelectionCount()==1&&b.getModel().getChildCount(b.getSelectionCell())>0);g=d&&b.getSelectionCount()==1;this.actions.get("removeFromGroup").setEnabled(g&&b.getModel().isVertex(b.getModel().getParent(b.getSelectionCell())));
f=["fontFamily","fontSize","alignment","position","text","format","arrange","linewidth","spacing","gradient"];for(g=0;g<f.length;g++)this.menus.get(f[g]).setEnabled(c);f=["line","lineend","linestart"];for(g=0;g<f.length;g++)this.menus.get(f[g]).setEnabled(e);this.actions.get("setAsDefaultEdge").setEnabled(e);this.menus.get("align").setEnabled(b.getSelectionCount()>1);this.menus.get("direction").setEnabled(d||e&&b.isLoop(b.view.getState(b.getSelectionCell())));this.menus.get("navigation").setEnabled(b.foldingEnabled&&
(b.view.currentRoot!=null||b.getSelectionCount()==1&&b.isValidRoot(b.getSelectionCell())));this.menus.get("layers").setEnabled(b.view.currentRoot==null);this.actions.get("home").setEnabled(b.view.currentRoot!=null);this.actions.get("exitGroup").setEnabled(b.view.currentRoot!=null);c=b.getSelectionCount()==1&&b.isValidRoot(b.getSelectionCell());this.actions.get("enterGroup").setEnabled(c);this.actions.get("expand").setEnabled(c);this.actions.get("collapse").setEnabled(c);this.actions.get("editLink").setEnabled(b.getSelectionCount()==
1);this.actions.get("openLink").setEnabled(b.getSelectionCount()==1&&b.getLinkForCell(b.getSelectionCell())!=null)});this.editor.graph.getSelectionModel().addListener(mxEvent.CHANGE,a);a()};
EditorUi.prototype.refresh=function(){var a=mxClient.IS_IE&&(document.documentMode==null||document.documentMode==5),b=this.container.clientWidth,c=this.container.clientHeight;if(this.container==document.body){b=document.body.clientWidth||document.documentElement.clientWidth;c=a?document.body.clientHeight||document.documentElement.clientHeight:document.documentElement.clientHeight}var d=Math.max(0,Math.min(this.hsplitPosition,b-this.splitSize-20)),e=Math.max(0,Math.min(this.vsplitPosition,c-this.menubarHeight-
this.toolbarHeight-this.footerHeight-this.splitSize-1));this.menubarContainer.style.height=this.menubarHeight+"px";this.toolbarContainer.style.top=this.menubarHeight+"px";this.toolbarContainer.style.height=this.toolbarHeight+"px";var f=this.menubarHeight+this.toolbarHeight;mxClient.IS_QUIRKS||(f+=1);var g=0;if(this.sidebarFooterContainer!=null){var h=e+this.splitSize+this.footerHeight;g=Math.max(0,Math.min(c-f-h,this.sidebarFooterHeight));this.sidebarFooterContainer.style.width=d+"px";this.sidebarFooterContainer.style.height=
g+"px";this.sidebarFooterContainer.style.bottom=h+"px"}this.sidebarContainer.style.top=f+"px";this.sidebarContainer.style.width=d+"px";this.outlineContainer.style.width=d+"px";this.outlineContainer.style.height=e+"px";this.outlineContainer.style.bottom=this.footerHeight+"px";this.diagramContainer.style.left=d+this.splitSize+"px";this.diagramContainer.style.top=this.sidebarContainer.style.top;this.footerContainer.style.height=this.footerHeight+"px";this.hsplit.style.top=this.sidebarContainer.style.top;
this.hsplit.style.bottom=this.outlineContainer.style.bottom;this.hsplit.style.left=d+"px";this.vsplit.style.width=this.sidebarContainer.style.width;this.vsplit.style.bottom=e+this.footerHeight+"px";if(a){this.menubarContainer.style.width=b+"px";this.toolbarContainer.style.width=this.menubarContainer.style.width;this.sidebarContainer.style.height=Math.max(0,c-e-this.splitSize-this.footerHeight-this.menubarHeight-this.toolbarHeight)-g+"px";this.diagramContainer.style.width=Math.max(0,b-d-this.splitSize)+
"px";a=Math.max(0,c-this.footerHeight-this.menubarHeight-this.toolbarHeight);this.diagramContainer.style.height=a+"px";this.footerContainer.style.width=this.menubarContainer.style.width;this.hsplit.style.height=a+"px"}else{this.sidebarContainer.style.bottom=e+this.splitSize+this.footerHeight+g+"px";this.diagramContainer.style.bottom=this.outlineContainer.style.bottom}};
EditorUi.prototype.createDivs=function(){this.menubarContainer=this.createDiv("geMenubarContainer");this.toolbarContainer=this.createDiv("geToolbarContainer");this.sidebarContainer=this.createDiv("geSidebarContainer");this.outlineContainer=this.createDiv("geOutlineContainer");this.diagramContainer=this.createDiv("geDiagramContainer");this.footerContainer=this.createDiv("geFooterContainer");this.hsplit=this.createDiv("geHsplit");this.vsplit=this.createDiv("geVsplit");this.menubarContainer.style.top=
"0px";this.menubarContainer.style.left="0px";this.menubarContainer.style.right="0px";this.toolbarContainer.style.left="0px";this.toolbarContainer.style.right="0px";this.sidebarContainer.style.left="0px";this.outlineContainer.style.left="0px";this.diagramContainer.style.right="0px";this.footerContainer.style.left="0px";this.footerContainer.style.right="0px";this.footerContainer.style.bottom="0px";this.vsplit.style.left="0px";this.vsplit.style.height=this.splitSize+"px";this.hsplit.style.width=this.splitSize+
"px";if(this.sidebarFooterContainer=this.createSidebarFooterContainer())this.sidebarFooterContainer.style.left="0px"};EditorUi.prototype.createSidebarFooterContainer=function(){return null};
EditorUi.prototype.createUi=function(){this.menubar=this.menus.createMenubar(this.createDiv("geMenubar"));this.menubarContainer.appendChild(this.menubar.container);this.toolbar=this.createToolbar(this.createDiv("geToolbar"));this.toolbarContainer.appendChild(this.toolbar.container);this.sidebar=this.createSidebar(this.sidebarContainer);this.footerContainer.appendChild(this.createFooter());this.statusContainer=this.createStatusContainer();this.editor.addListener("statusChanged",mxUtils.bind(this,function(){this.setStatusText(this.editor.getStatus())}));
this.setStatusText(this.editor.getStatus());this.menubar.container.appendChild(this.statusContainer);this.container.appendChild(this.menubarContainer);this.container.appendChild(this.toolbarContainer);this.container.appendChild(this.sidebarContainer);this.container.appendChild(this.outlineContainer);this.container.appendChild(this.diagramContainer);this.container.appendChild(this.footerContainer);this.container.appendChild(this.hsplit);this.container.appendChild(this.vsplit);this.sidebarFooterContainer&&
this.container.appendChild(this.sidebarFooterContainer);this.addSplitHandler(this.hsplit,true,0,mxUtils.bind(this,function(a){this.hsplitPosition=a;this.refresh();this.editor.graph.sizeDidChange();this.editor.outline.update(false);this.editor.outline.outline.sizeDidChange()}));this.addSplitHandler(this.vsplit,false,this.footerHeight,mxUtils.bind(this,function(a){this.vsplitPosition=a;this.refresh();this.editor.outline.update(false);this.editor.outline.outline.sizeDidChange()}))};
EditorUi.prototype.createStatusContainer=function(){var a=document.createElement("a");a.className="geItem geStatus";return a};EditorUi.prototype.setStatusText=function(a){this.statusContainer.innerHTML=a};EditorUi.prototype.createToolbar=function(a){return new Toolbar(this,a)};EditorUi.prototype.createSidebar=function(a){return new Sidebar(this,a,this.choices)};EditorUi.prototype.createFooter=function(){return this.createDiv("geFooter")};
EditorUi.prototype.createDiv=function(a){var b=document.createElement("div");b.className=a;return b};
EditorUi.prototype.addSplitHandler=function(a,b,c,d){function e(k){if(g!=null){var l=new mxPoint(mxEvent.getClientX(k),mxEvent.getClientY(k));d(Math.max(0,h+(b?l.x-g.x:g.y-l.y)-c));mxEvent.consume(k)}}function f(k){e(k);h=g=null}var g=null,h=null;mxEvent.addGestureListeners(a,function(k){g=new mxPoint(mxEvent.getClientX(k),mxEvent.getClientY(k));h=parseInt(b?a.style.left:a.style.bottom);mxEvent.consume(k)});mxEvent.addListener(document,"mousemove",e);mxEvent.addListener(document,"touchmove",e);mxEvent.addListener(document,
"mouseup",f);mxEvent.addListener(document,"touchend",f)};EditorUi.prototype.showDialog=function(a,b,c,d,e,f){this.hideDialog();this.dialog=new Dialog(this,a,b,mxClient.IS_VML?c-12:c,d,e,f)};EditorUi.prototype.hideDialog=function(){if(this.dialog!=null){this.dialog.close();this.dialog=null;this.editor.graph.container.focus()}};
EditorUi.prototype.executeLayout=function(a,b,c,d,e){var f=this.editor.graph;c=f.getSelectionCell();b=this.animate!=null?this.animate:b;f.getModel().beginUpdate();try{d!=null?d():a.execute(f.getDefaultParent(),c)}catch(g){throw g;}finally{if(b&&navigator.userAgent.indexOf("Camino")<0){a=new mxMorphing(f);a.addListener(mxEvent.DONE,mxUtils.bind(this,function(){f.getModel().endUpdate();e!=null&&e()}));a.startAnimation()}else f.getModel().endUpdate()}};
EditorUi.prototype.createKeyHandler=function(){function a(g){if(!b.isSelectionEmpty()){var h=0,k=0;if(g==37)h=-1;else if(g==38)k=-1;else if(g==39)h=1;else if(g==40)k=1;b.moveCells(b.getSelectionCells(),h,k);b.scrollCellToVisible(b.getSelectionCell())}}var b=this.editor.graph,c=new mxKeyHandler(b);c.isControlDown=function(g){return mxEvent.isControlDown(g)||mxClient.IS_MAC&&g.metaKey};var d=mxUtils.bind(this,function(g,h,k,l){var m=this.actions.get(k);if(m!=null){k=function(){m.enabled&&m.funct()};
if(h)l?c.bindControlShiftKey(g,k):c.bindControlKey(g,k);else l?c.bindShiftKey(g,k):c.bindKey(g,k)}}),e=this,f=c.escape;c.escape=function(){e.hideDialog();f.apply(this,arguments)};c.enter=function(){};c.bindShiftKey(13,function(){b.foldCells(true)});c.bindKey(13,function(){b.foldCells(false)});c.bindKey(33,function(){b.exitGroup()});c.bindKey(34,function(){b.enterGroup()});c.bindKey(36,function(){b.home()});c.bindKey(35,function(){b.refresh()});c.bindKey(37,function(){a(37)});c.bindKey(38,function(){a(38)});
c.bindKey(39,function(){a(39)});c.bindKey(40,function(){a(40)});c.bindKey(113,function(){b.startEditingAtCell()});c.bindKey(8,function(){b.foldCells(true)});d(8,false,"delete");d(46,false,"delete");d(46,false,"delete");d(82,true,"tilt");d(107,false,"zoomIn");d(109,false,"zoomOut");d(65,true,"selectAll");d(86,true,"selectVertices",true);d(69,true,"selectEdges",true);d(66,true,"toBack");d(70,true,"toFront");d(68,true,"duplicate");d(90,true,"undo");d(89,true,"redo");d(88,true,"cut");d(67,true,"copy");
d(81,true,"connect");d(86,true,"paste");d(71,true,"group");d(71,true,"grid",true);d(76,true,"lockUnlock");d(85,true,"ungroup");return c};function Actions(a){this.editorUi=a;this.actions={};this.init()}
Actions.prototype.init=function(){var a=this.editorUi,b=a.editor,c=b.graph;this.addAction("new",function(){window.open(a.getUrl())});this.addAction("open",function(){window.openNew=true;window.openKey="open";a.openFile()});this.addAction("import",function(){window.openNew=false;window.openKey="import";window.openFile=new OpenFile(mxUtils.bind(this,function(){a.hideDialog()}));window.openFile.setConsumer(mxUtils.bind(this,function(e){try{var f=mxUtils.parseXml(e),g=new mxGraphModel;(new mxCodec(f)).decode(f.documentElement,
g);var h=g.getChildren(g.getChildAt(g.getRoot(),0));b.graph.setSelectionCells(b.graph.importCells(h))}catch(k){mxUtils.alert(mxResources.get("invalidOrMissingFile")+": "+k.message)}}));a.showDialog((new OpenDialog(this)).container,300,180,true,true,function(){window.openFile=null})});this.addAction("save",function(){a.saveFile(false)},null,null,"Ctrl+S");this.addAction("saveAs",function(){a.saveFile(true)},null,null,"Ctrl+Shift-S");this.addAction("export",function(){a.showDialog((new ExportDialog(a)).container,
300,200,true,true)},null,null,"Ctrl+E");this.put("editFile",new Action(mxResources.get("edit"),mxUtils.bind(this,function(){this.editorUi.showDialog((new EditFileDialog(a)).container,620,420,true,true)})));this.addAction("pageSetup",function(){a.showDialog((new PageSetupDialog(a)).container,300,200,true,true)});this.addAction("print",function(){a.showDialog((new PrintDialog(a)).container,300,200,true,true)},null,"sprite-print","Ctrl+P");this.addAction("preview",function(){mxUtils.show(c,null,10,10)});
this.addAction("undo",function(){b.undoManager.undo()},null,"sprite-undo","Ctrl+Z");this.addAction("redo",function(){b.undoManager.redo()},null,"sprite-redo","Ctrl+Y");this.addAction("cut",function(){mxClipboard.cut(c)},null,"sprite-cut","Ctrl+X");this.addAction("copy",function(){mxClipboard.copy(c)},null,"sprite-copy","Ctrl+C");this.addAction("paste",function(){mxClipboard.paste(c)},false,"sprite-paste","Ctrl+V");this.addAction("delete",function(){c.connectionHandler.isConnecting()?c.connectionHandler.reset():
c.removeCells()},null,null,"Delete");this.addAction("duplicate",function(){var e=c.gridSize;c.setSelectionCells(c.moveCells(c.getSelectionCells(),e,e,true))},null,null,"Ctrl+D");this.addAction("selectVertices",function(){c.selectVertices()},null,null,"Ctrl+Shift+V");this.addAction("selectEdges",function(){c.selectEdges()},null,null,"Ctrl+Shift+E");this.addAction("selectAll",function(){c.selectAll()},null,null,"Ctrl+A");this.addAction("lockUnlock",function(){c.getModel().beginUpdate();try{c.toggleCellStyles(mxConstants.STYLE_RESIZABLE,
1);c.toggleCellStyles(mxConstants.STYLE_MOVABLE,1);c.toggleCellStyles(mxConstants.STYLE_ROTATABLE,1)}finally{c.getModel().endUpdate()}},null,null,"Ctrl+L");this.addAction("home",function(){c.home()},null,null,"Home");this.addAction("exitGroup",function(){c.exitGroup()},null,null,"Page Up");this.addAction("enterGroup",function(){c.enterGroup()},null,null,"Page Down");this.addAction("expand",function(){c.foldCells(false)},null,null,"Enter");this.addAction("collapse",function(){c.foldCells(true)},null,
null,"Backspace");this.addAction("toFront",function(){c.orderCells(false)},null,null,"Ctrl+F");this.addAction("toBack",function(){c.orderCells(true)},null,null,"Ctrl+B");this.addAction("group",function(){c.setSelectionCell(c.groupCells(null,0))},null,null,"Ctrl+G");this.addAction("ungroup",function(){c.setSelectionCells(c.ungroupCells())},null,null,"Ctrl+U");this.addAction("removeFromGroup",function(){c.removeCellsFromParent()});this.addAction("editLink",function(){var e=c.getSelectionCell(),f=c.getLinkForCell(e);
if(f==null)f="";f=mxUtils.prompt(mxResources.get("enterValue"),f);f!=null&&c.setLinkForCell(e,f)});this.addAction("openLink",function(){var e=c.getSelectionCell();e=c.getLinkForCell(e);e!=null&&window.open(e)});this.addAction("autosize",function(){var e=c.getSelectionCells();if(e!=null){c.getModel().beginUpdate();try{for(var f=0;f<e.length;f++){var g=e[f];c.getModel().getChildCount(g)?c.updateGroupBounds([g],20):c.updateCellSize(g)}}finally{c.getModel().endUpdate()}}});this.addAction("wordWrap",function(){var e=
c.getView().getState(c.getSelectionCell()),f="wrap";if(e!=null&&e.style[mxConstants.STYLE_WHITE_SPACE]=="wrap")f=null;c.setCellStyles(mxConstants.STYLE_WHITE_SPACE,f)});this.addAction("rotation",function(){var e="0",f=c.getView().getState(c.getSelectionCell());if(f!=null)e=f.style[mxConstants.STYLE_ROTATION]||e;e=mxUtils.prompt(mxResources.get("enterValue")+" ("+mxResources.get("rotation")+" 0-360)",e);e!=null&&c.setCellStyles(mxConstants.STYLE_ROTATION,e)});this.addAction("tilt",function(){var e=
c.getSelectionCells();if(e!=null){c.getModel().beginUpdate();try{for(var f=0;f<e.length;f++){var g=e[f];if(c.getModel().isVertex(g)&&c.getModel().getChildCount(g)==0){var h=c.getCellGeometry(g);if(h!=null){h=h.clone();h.x+=h.width/2-h.height/2;h.y+=h.height/2-h.width/2;var k=h.width;h.width=h.height;h.height=k;c.getModel().setGeometry(g,h);var l=c.view.getState(g);if(l!=null){var m=l.style[mxConstants.STYLE_DIRECTION]||"east";if(m=="east")m="south";else if(m=="south")m="west";else if(m=="west")m=
"north";else if(m=="north")m="east";c.setCellStyles(mxConstants.STYLE_DIRECTION,m,[g])}}}}}finally{c.getModel().endUpdate()}}},null,null,"Ctrl+R");this.addAction("actualSize",function(){c.zoomTo(1)});this.addAction("zoomIn",function(){c.zoomIn()},null,null,"Add");this.addAction("zoomOut",function(){c.zoomOut()},null,null,"Subtract");this.addAction("fitWindow",function(){c.fit()});this.addAction("fitPage",mxUtils.bind(this,function(){c.pageVisible||this.get("pageView").funct();var e=c.pageFormat,f=
c.pageScale,g=Math.floor(100*Math.min((c.container.clientWidth-20)/e.width/f,(c.container.clientHeight-20)/e.height/f))/100;c.zoomTo(g);c.container.scrollLeft=Math.round(c.view.translate.x*g-Math.max(10,(c.container.clientWidth-e.width*f*g)/2));c.container.scrollTop=Math.round(c.view.translate.y*g-Math.max(10,(c.container.clientHeight-e.height*f*g)/2))}));this.addAction("fitPageWidth",mxUtils.bind(this,function(){c.pageVisible||this.get("pageView").funct();var e=c.pageFormat,f=c.pageScale,g=Math.floor(100*
(c.container.clientWidth-20)/e.width/f)/100;c.zoomTo(g);c.container.scrollLeft=Math.round(c.view.translate.x*g-Math.max(10,(c.container.clientWidth-e.width*f*g)/2));c.container.scrollTop=Math.round(c.view.translate.y*g-Math.max(10,(c.container.clientHeight-e.height*f*g)/2))}));this.put("customZoom",new Action(mxResources.get("custom"),function(){var e=mxUtils.prompt(mxResources.get("enterValue")+" (%)",parseInt(c.getView().getScale()*100));e!=null&&e.length>0&&!isNaN(parseInt(e))&&c.zoomTo(parseInt(e)/
100)}));var d=null;d=this.addAction("grid",function(){c.setGridEnabled(!c.isGridEnabled());b.updateGraphComponents()},null,null,"Ctrl+Shift+G");d.setToggleAction(true);d.setSelectedCallback(function(){return c.isGridEnabled()});d=this.addAction("guides",function(){c.graphHandler.guidesEnabled=!c.graphHandler.guidesEnabled});d.setToggleAction(true);d.setSelectedCallback(function(){return c.graphHandler.guidesEnabled});d=this.addAction("tooltips",function(){c.tooltipHandler.setEnabled(!c.tooltipHandler.isEnabled())});
d.setToggleAction(true);d.setSelectedCallback(function(){return c.tooltipHandler.isEnabled()});d=this.addAction("navigation",function(){c.foldingEnabled=!c.foldingEnabled;c.view.revalidate()});d.setToggleAction(true);d.setSelectedCallback(function(){return c.foldingEnabled});d=this.addAction("scrollbars",function(){c.scrollbars=!c.scrollbars;b.updateGraphComponents();if(c.scrollbars){var e=c.view.translate.x,f=c.view.translate.y;c.view.translate.x=0;c.view.translate.y=0;c.sizeDidChange();c.container.scrollLeft-=
Math.round(e*c.view.scale);c.container.scrollTop-=Math.round(f*c.view.scale)}else{e=c.view.translate;c.view.setTranslate(e.x-c.container.scrollLeft/c.view.scale,e.y-c.container.scrollTop/c.view.scale);c.container.scrollLeft=0;c.container.scrollTop=0;c.sizeDidChange()}},!mxClient.IS_TOUCH);d.setToggleAction(true);d.setSelectedCallback(function(){return c.container.style.overflow=="auto"});d=this.addAction("pageView",mxUtils.bind(this,function(){c.pageVisible=!c.pageVisible;c.pageBreaksVisible=c.pageVisible;
c.preferPageSize=c.pageBreaksVisible;c.view.validate();c.sizeDidChange();b.updateGraphComponents();b.outline.update();if(mxUtils.hasScrollbars(c.container))if(c.pageVisible){c.container.scrollLeft-=20;c.container.scrollTop-=20}else{c.container.scrollLeft+=20;c.container.scrollTop+=20}}));d.setToggleAction(true);d.setSelectedCallback(function(){return c.pageVisible});this.put("pageBackgroundColor",new Action(mxResources.get("backgroundColor"),function(){var e=new ColorDialog(a,c.background||"none",
function(f){c.background=f;b.updateGraphComponents()});a.showDialog(e.container,220,400,true,false);mxClient.IS_TOUCH||e.colorInput.focus()}));d=this.addAction("connect",function(){c.setConnectable(!c.connectionHandler.isEnabled())},null,null,"Ctrl+Q");d.setToggleAction(true);d.setSelectedCallback(function(){return c.connectionHandler.isEnabled()});d=this.addAction("copyConnect",function(){c.connectionHandler.setCreateTarget(!c.connectionHandler.isCreateTarget())});d.setToggleAction(true);d.setSelectedCallback(function(){return c.connectionHandler.isCreateTarget()});
this.addAction("help",function(){var e="";if(mxResources.isLanguageSupported(mxClient.language))e="_"+mxClient.language;window.open(RESOURCES_PATH+"/help"+e+".html")});this.put("about",new Action(mxResources.get("about")+" Graph Editor",function(){a.showDialog((new AboutDialog(a)).container,320,280,true,true)},null,null,"F1"));d=mxUtils.bind(this,function(e,f){this.addAction(e,function(){c.toggleCellStyleFlags(mxConstants.STYLE_FONTSTYLE,f)})});d("bold",mxConstants.FONT_BOLD);d("italic",mxConstants.FONT_ITALIC);
d("underline",mxConstants.FONT_UNDERLINE);this.addAction("fontColor",function(){a.menus.pickColor(mxConstants.STYLE_FONTCOLOR)});this.addAction("strokeColor",function(){a.menus.pickColor(mxConstants.STYLE_STROKECOLOR)});this.addAction("fillColor",function(){a.menus.pickColor(mxConstants.STYLE_FILLCOLOR)});this.addAction("gradientColor",function(){a.menus.pickColor(mxConstants.STYLE_GRADIENTCOLOR)});this.addAction("backgroundColor",function(){a.menus.pickColor(mxConstants.STYLE_LABEL_BACKGROUNDCOLOR)});
this.addAction("borderColor",function(){a.menus.pickColor(mxConstants.STYLE_LABEL_BORDERCOLOR)});this.addAction("shadow",function(){c.toggleCellStyles(mxConstants.STYLE_SHADOW)});this.addAction("dashed",function(){c.toggleCellStyles(mxConstants.STYLE_DASHED)});this.addAction("rounded",function(){c.toggleCellStyles(mxConstants.STYLE_ROUNDED)});this.addAction("curved",function(){c.toggleCellStyles(mxConstants.STYLE_CURVED)});this.addAction("style",function(){var e=c.getSelectionCells();if(e!=null&&
e.length>0){var f=c.getModel();f=mxUtils.prompt(mxResources.get("enterValue")+" ("+mxResources.get("style")+")",f.getStyle(e[0])||"");f!=null&&c.setCellStyle(f,e)}});this.addAction("setAsDefaultEdge",function(){c.setDefaultEdge(c.getSelectionCell())});this.addAction("addWaypoint",function(){var e=c.getSelectionCell();if(e!=null&&c.getModel().isEdge(e)){var f=b.graph.selectionCellsHandler.getHandler(e);if(f instanceof mxEdgeHandler){var g=c.view.translate,h=c.view.scale,k=g.x;g=g.y;e=c.getModel().getParent(e);
var l=c.getCellGeometry(e);if(c.getModel().isVertex(e)&&l!=null){k+=l.x;g+=l.y}f.addPointAt(f.state,c.panningHandler.triggerX/h-k,c.panningHandler.triggerY/h-g)}}});this.addAction("removeWaypoint",function(){var e=a.actions.get("removeWaypoint");e.handler!=null&&e.handler.removePoint(e.handler.state,e.index)});this.addAction("image",function(){var e="",f=c.getView().getState(c.getSelectionCell());if(f!=null)e=f.style[mxConstants.STYLE_IMAGE]||e;e=mxUtils.prompt(mxResources.get("enterValue")+" ("+
mxResources.get("url")+")",e);if(e!=null)if(e.length>0){var g=new Image;g.onload=function(){var h=e,k=g.width,l=g.height,m=null,p=c.getSelectionCells();c.getModel().beginUpdate();try{if(p.length==0){var o=c.getGridSize();m=p=[c.insertVertex(c.getDefaultParent(),null,"",o,o,k,l)]}c.setCellStyles(mxConstants.STYLE_IMAGE,h,p);c.setCellStyles(mxConstants.STYLE_SHAPE,"image",p);if(c.getSelectionCount()==1)if(k!=null&&l!=null){var n=p[0],s=c.getModel().getGeometry(n);if(s!=null){s=s.clone();s.width=k;s.height=
l;c.getModel().setGeometry(n,s)}}}finally{c.getModel().endUpdate()}if(m!=null){c.setSelectionCells(m);c.scrollCellToVisible(m[0])}};g.onerror=function(){mxUtils.alert(mxResources.get("fileNotFound"))};g.src=e}})};Actions.prototype.addAction=function(a,b,c,d,e){return this.put(a,new Action(mxResources.get(a),b,c,d,e))};Actions.prototype.put=function(a,b){return this.actions[a]=b};Actions.prototype.get=function(a){return this.actions[a]};
function Action(a,b,c,d,e){mxEventSource.call(this);this.label=a;this.funct=b;this.enabled=c!=null?c:true;this.iconCls=d;this.shortcut=e}mxUtils.extend(Action,mxEventSource);Action.prototype.setEnabled=function(a){if(this.enabled!=a){this.enabled=a;this.fireEvent(new mxEventObject("stateChanged"))}};Action.prototype.setToggleAction=function(a){this.toggleAction=a};Action.prototype.setSelectedCallback=function(a){this.selectedCallback=a};Action.prototype.isSelected=function(){return this.selectedCallback()};function Dialog(a,b,c,d,e,f,g){var h=0;if(mxClient.IS_IE&&document.documentMode!=9)h=60;c+=h;d+=h;var k=Math.max(0,Math.round((document.body.scrollWidth-c)/2)),l=Math.max(0,Math.round((Math.max(document.body.scrollHeight,document.documentElement.scrollHeight)-d)/3)),m=a.createDiv("geDialog");m.style.width=c+"px";m.style.height=d+"px";m.style.left=k+"px";m.style.top=l+"px";if(this.bg==null){this.bg=a.createDiv("background");this.bg.style.position="absolute";this.bg.style.background="white";this.bg.style.left=
"0px";this.bg.style.top="0px";this.bg.style.bottom="0px";this.bg.style.right="0px";mxUtils.setOpacity(this.bg,80);mxClient.IS_QUIRKS&&new mxDivResizer(this.bg)}e&&document.body.appendChild(this.bg);m.appendChild(b);document.body.appendChild(m);if(f){b=document.createElement("img");b.setAttribute("src",IMAGE_PATH+"/close.png");b.setAttribute("title",mxResources.get("close"));b.className="geDialogClose";b.style.top=l+14+"px";b.style.left=k+c+38-h+"px";mxEvent.addListener(b,"click",mxUtils.bind(this,
function(){a.hideDialog()}));document.body.appendChild(b);this.dialogImg=b}this.onDialogClose=g;this.container=m}Dialog.prototype.close=function(){if(this.onDialogClose!=null){this.onDialogClose();this.onDialogClose=null}if(this.dialogImg!=null){this.dialogImg.parentNode.removeChild(this.dialogImg);this.dialogImg=null}this.container.parentNode.removeChild(this.container);this.bg.parentNode.removeChild(this.bg)};
function OpenDialog(){var a=document.createElement("iframe");a.style.backgroundColor="transparent";a.allowTransparency="true";a.style.borderStyle="none";a.style.borderWidth="0px";a.style.overflow="hidden";a.frameBorder="0";a.setAttribute("width","320px");a.setAttribute("height","190px");a.setAttribute("src",OPEN_FORM);this.container=a}
function ColorDialog(a,b,c){function d(m,p){p=p!=null?p:12;var o=document.createElement("table");o.style.borderCollapse="collapse";o.setAttribute("cellspacing","0");o.style.marginBottom="20px";o.style.cellSpacing="0px";var n=document.createElement("tbody");o.appendChild(n);for(var s=m.length/p,t=0;t<s;t++){for(var q=document.createElement("tr"),r=0;r<p;r++)(function(u){var x=document.createElement("td");x.style.border="1px solid black";x.style.padding="0px";x.style.width="16px";x.style.height="16px";
if(u=="none")x.style.background="url('"+IMAGE_PATH+"/nocolor.png')";else x.style.backgroundColor="#"+u;q.appendChild(x);mxEvent.addListener(x,"click",function(){if(u=="none"){f.fromString("ffffff");e.value="none"}else f.fromString(u)})})(m[t*p+r]);n.appendChild(q)}h.appendChild(o);return o}this.editorUi=a;var e=document.createElement("input");e.style.marginBottom="10px";e.style.width="216px";if(mxClient.IS_IE){e.style.marginTop="10px";document.body.appendChild(e)}var f=new jscolor.color(e);f.pickerOnfocus=
false;f.showPicker();var g=document.createElement("div");jscolor.picker.box.style.position="relative";jscolor.picker.box.style.width="230px";jscolor.picker.box.style.height="100px";jscolor.picker.box.style.paddingBottom="10px";g.appendChild(jscolor.picker.box);var h=document.createElement("center");g.appendChild(e);mxUtils.br(g);var k=d(["E6D0DE","CDA2BE","B5739D","E1D5E7","C3ABD0","A680B8","D4E1F5","A9C4EB","7EA6E0","D5E8D4","9AC7BF","67AB9F","D5E8D4","B9E0A5","97D077","FFF2CC","FFE599","FFD966",
"FFF4C3","FFCE9F","FFB570","F8CECC","F19C99","EA6B66"],12);k.style.marginBottom="8px";k=d(["none","FFFFFF","E6E6E6","CCCCCC","B3B3B3","999999","808080","666666","4D4D4D","333333","1A1A1A","000000","FFCCCC","FFE6CC","FFFFCC","E6FFCC","CCFFCC","CCFFE6","CCFFFF","CCE5FF","CCCCFF","E5CCFF","FFCCFF","FFCCE6","FF9999","FFCC99","FFFF99","CCFF99","99FF99","99FFCC","99FFFF","99CCFF","9999FF","CC99FF","FF99FF","FF99CC","FF6666","FFB366","FFFF66","B3FF66","66FF66","66FFB3","66FFFF","66B2FF","6666FF","B266FF",
"FF66FF","FF66B3","FF3333","FF9933","FFFF33","99FF33","33FF33","33FF99","33FFFF","3399FF","3333FF","9933FF","FF33FF","FF3399","FF0000","FF8000","FFFF00","80FF00","00FF00","00FF80","00FFFF","007FFF","0000FF","7F00FF","FF00FF","FF0080","CC0000","CC6600","CCCC00","66CC00","00CC00","00CC66","00CCCC","0066CC","0000CC","6600CC","CC00CC","CC0066","990000","994C00","999900","4D9900","009900","00994D","009999","004C99","000099","4C0099","990099","99004D","660000","663300","666600","336600","006600","006633",
"006666","003366","000066","330066","660066","660033","330000","331A00","333300","1A3300","003300","00331A","003333","001933","000033","190033","330033","33001A"]);k.style.marginBottom="16px";g.appendChild(h);k=document.createElement("div");k.style.textAlign="right";k.style.whiteSpace="nowrap";var l=c!=null?c:this.createApplyFunction();k.appendChild(mxUtils.button(mxResources.get("apply"),function(){var m=e.value;if(m!="none")m="#"+m;l(m);a.hideDialog()}));k.appendChild(mxUtils.button(mxResources.get("cancel"),
function(){a.hideDialog()}));if(b!=null)if(b=="none"){f.fromString("ffffff");e.value="none"}else f.fromString(b);g.appendChild(k);this.picker=f;this.colorInput=e;this.container=g}ColorDialog.prototype.createApplyFunction=function(){return mxUtils.bind(this,function(a){this.editorUi.editor.graph.setCellStyles(this.currentColorKey,a=="none"?"none":a)})};
function AboutDialog(a){var b=document.createElement("div");b.setAttribute("align","center");var c=document.createElement("h3");mxUtils.write(c,mxResources.get("about")+" GraphEditor");b.appendChild(c);c=document.createElement("img");c.style.border="0px";c.setAttribute("width","176");c.setAttribute("width","151");c.setAttribute("src",IMAGE_PATH+"/logo.png");b.appendChild(c);mxUtils.br(b);mxUtils.write(b,"Powered by mxGraph "+mxClient.VERSION);mxUtils.br(b);c=document.createElement("a");c.setAttribute("href",
"http://www.jgraph.com/");c.setAttribute("target","_blank");mxUtils.write(c,"www.jgraph.com");b.appendChild(c);mxUtils.br(b);mxUtils.br(b);b.appendChild(mxUtils.button(mxResources.get("close"),function(){a.hideDialog()}));this.container=b}
function PageSetupDialog(a){var b=a.editor.graph,c=mxConstants.PAGE_FORMAT_A4_PORTRAIT;c=b.pageFormat.width==c.width&&b.pageFormat.height==c.height||b.pageFormat.height==c.width&&b.pageFormat.width==c.height?c:mxConstants.PAGE_FORMAT_LETTER_PORTRAIT;var d,e,f=document.createElement("table");f.style.width="100%";f.style.height="100%";var g=document.createElement("tbody");d=document.createElement("tr");e=document.createElement("td");e.style.fontSize="10pt";mxUtils.write(e,mxResources.get("paperSize")+
":");d.appendChild(e);var h=document.createElement("select");e=document.createElement("option");e.setAttribute("value","a4");mxUtils.write(e,"A4");h.appendChild(e);e=document.createElement("option");e.setAttribute("value","letter");mxUtils.write(e,"Letter");h.appendChild(e);c===mxConstants.PAGE_FORMAT_LETTER_PORTRAIT&&e.setAttribute("selected","selected");e=document.createElement("td");e.style.fontSize="10pt";e.appendChild(h);d.appendChild(e);g.appendChild(d);d=document.createElement("tr");e=document.createElement("td");
d.appendChild(e);var k=document.createElement("input");k.setAttribute("type","checkbox");b.pageFormat.width==c.height&&k.setAttribute("checked","checked");e=document.createElement("td");e.style.padding="4 0 16 2px";e.style.fontSize="10pt";e.appendChild(k);mxUtils.write(e," "+mxResources.get("landscape"));d.appendChild(e);g.appendChild(d);d=document.createElement("tr");e=document.createElement("td");e.style.fontSize="10pt";e.style.width="130px";mxUtils.write(e,mxResources.get("pageScale")+":");d.appendChild(e);
var l=document.createElement("input");l.setAttribute("value",a.editor.graph.pageScale*100+"%");l.style.width="60px";e=document.createElement("td");e.appendChild(l);d.appendChild(e);g.appendChild(d);d=document.createElement("tr");e=document.createElement("td");e.colSpan=2;e.style.paddingTop="40px";e.setAttribute("align","right");e.appendChild(mxUtils.button(mxResources.get("ok"),function(){a.hideDialog();var m=k.checked;b.pageFormat=h.value=="letter"?m?mxConstants.PAGE_FORMAT_LETTER_LANDSCAPE:mxConstants.PAGE_FORMAT_LETTER_PORTRAIT:
m?mxConstants.PAGE_FORMAT_A4_LANDSCAPE:mxConstants.PAGE_FORMAT_A4_PORTRAIT;a.editor.outline.outline.pageFormat=b.pageFormat;b.pageScale=parseInt(l.value)/100;if(b.pageVisible){a.editor.updateGraphComponents();b.view.validateBackground();b.sizeDidChange();a.editor.outline.update()}else a.actions.get("pageView").funct()}));e.appendChild(mxUtils.button(mxResources.get("cancel"),function(){a.hideDialog()}));d.appendChild(e);g.appendChild(d);g.appendChild(d);f.appendChild(g);this.container=f}
function PrintDialog(a){function b(){var o=l.checked;o=k.value=="letter"?o?mxConstants.PAGE_FORMAT_LETTER_LANDSCAPE:mxConstants.PAGE_FORMAT_LETTER_PORTRAIT:o?mxConstants.PAGE_FORMAT_A4_LANDSCAPE:mxConstants.PAGE_FORMAT_A4_PORTRAIT;var n=1/c.pageScale;if(m.checked){var s=parseInt(p.value);isNaN(s)||(n=mxUtils.getScaleForPageCount(s,c,o))}var t=c.getGraphBounds();s=m.checked;var q=0,r=0,u=t.width>0?t.x/c.view.scale-c.view.translate.x:0;t=t.height>0?t.y/c.view.scale-c.view.translate.y:0;if(u<0||t<0){s=
true;if(c.pageVisible){r=c.pageScale;q=o.width*r;r*=o.height;q=u>0?u:o.width*-Math.floor(Math.min(0,u)/q)+Math.min(0,u)/c.pageScale;r=t>0?t:o.height*-Math.floor(Math.min(0,t)/r)+Math.min(0,t)/c.pageScale}else r=q=10}o=new mxPrintPreview(c,n,o,0,q,r);o.title=mxResources.get("preview");o.autoOrigin=s;return o.open()}var c=a.editor.graph,d=mxConstants.PAGE_FORMAT_A4_PORTRAIT;d=c.pageFormat.width==d.width&&c.pageFormat.height==d.height||c.pageFormat.height==d.width&&c.pageFormat.width==d.height?d:mxConstants.PAGE_FORMAT_LETTER_PORTRAIT;
var e,f,g=document.createElement("table");g.style.width="100%";g.style.height="100%";var h=document.createElement("tbody");e=document.createElement("tr");f=document.createElement("td");f.style.fontSize="10pt";mxUtils.write(f,mxResources.get("paperSize")+":");e.appendChild(f);var k=document.createElement("select");f=document.createElement("option");f.setAttribute("value","a4");mxUtils.write(f,"A4");k.appendChild(f);f=document.createElement("option");f.setAttribute("value","letter");mxUtils.write(f,
"Letter");k.appendChild(f);d===mxConstants.PAGE_FORMAT_LETTER_PORTRAIT&&f.setAttribute("selected","selected");f=document.createElement("td");f.style.fontSize="10pt";f.appendChild(k);e.appendChild(f);h.appendChild(e);e=document.createElement("tr");f=document.createElement("td");e.appendChild(f);var l=document.createElement("input");l.setAttribute("type","checkbox");c.pageFormat.width==d.height&&l.setAttribute("checked","checked");f=document.createElement("td");f.style.padding="4 0 16 2px";f.style.fontSize=
"10pt";f.appendChild(l);mxUtils.write(f," "+mxResources.get("landscape"));e.appendChild(f);h.appendChild(e);e=document.createElement("tr");var m=document.createElement("input");m.setAttribute("type","checkbox");f=document.createElement("td");f.style.paddingRight="10px";f.style.fontSize="10pt";f.appendChild(m);mxUtils.write(f," "+mxResources.get("posterPrint")+":");e.appendChild(f);var p=document.createElement("input");p.setAttribute("value","1");p.setAttribute("type","number");p.setAttribute("min",
"1");p.setAttribute("size","4");p.setAttribute("disabled","disabled");p.style.width="50px";f=document.createElement("td");f.style.fontSize="10pt";f.appendChild(p);mxUtils.write(f," "+mxResources.get("pages"));e.appendChild(f);h.appendChild(e);mxEvent.addListener(m,"change",function(){m.checked?p.removeAttribute("disabled"):p.setAttribute("disabled","disabled")});e=document.createElement("tr");f=document.createElement("td");f.colSpan=2;f.style.paddingTop="40px";f.setAttribute("align","right");f.appendChild(mxUtils.button(mxResources.get("print"),
function(){a.hideDialog();b().print()}));f.appendChild(mxUtils.button(mxResources.get("preview"),function(){a.hideDialog();b()}));f.appendChild(mxUtils.button(mxResources.get("cancel"),function(){a.hideDialog()}));e.appendChild(f);h.appendChild(e);h.appendChild(e);g.appendChild(h);this.container=g}
function SaveDialog(a){var b,c,d=document.createElement("table"),e=document.createElement("tbody");b=document.createElement("tr");c=document.createElement("td");c.style.fontSize="10pt";c.style.width="100px";mxUtils.write(c,mxResources.get("filename")+":");b.appendChild(c);var f=document.createElement("input");f.setAttribute("value",a.editor.getOrCreateFilename());f.style.width="180px";c=document.createElement("td");c.appendChild(f);b.appendChild(c);e.appendChild(b);b=document.createElement("tr");
c=document.createElement("td");c.colSpan=2;c.style.paddingTop="30px";c.style.whiteSpace="nowrap";c.setAttribute("align","right");var g=mxUtils.button(mxResources.get("save"),function(){a.save(f.value);a.hideDialog()});c.appendChild(g);c.appendChild(mxUtils.button(mxResources.get("cancel"),function(){a.hideDialog()}));b.appendChild(c);e.appendChild(b);e.appendChild(b);d.appendChild(e);this.container=d}
function EditFileDialog(a){var b=document.createElement("div");b.style.textAlign="right";var c=document.createElement("textarea");c.style.width="600px";c.style.height="374px";c.value=mxUtils.getPrettyXml(a.editor.getGraphXml());b.appendChild(c);if(fileSupport){c.addEventListener("dragover",function(f){f.stopPropagation();f.preventDefault()},false);c.addEventListener("drop",function(f){f.stopPropagation();f.preventDefault();if(f.dataTransfer.files.length>0){f=f.dataTransfer.files[0];var g=new FileReader;
g.onload=function(h){c.value=h.target.result};g.readAsText(f)}},false)}var d=document.createElement("select");d.style.width="180px";var e=document.createElement("option");e.setAttribute("value","new");mxUtils.write(e,mxResources.get("openInNewWindow"));d.appendChild(e);e=document.createElement("option");e.setAttribute("value","replace");mxUtils.write(e,mxResources.get("replaceExistingDrawing"));d.appendChild(e);e=document.createElement("option");e.setAttribute("value","import");mxUtils.write(e,mxResources.get("addToExistingDrawing"));
d.appendChild(e);b.appendChild(d);b.appendChild(mxUtils.button(mxResources.get("ok"),function(){if(d.value=="new"){window.openFile=new OpenFile(function(){a.hideDialog();window.openFile=null});window.openFile.setData(c.value,null);window.open(a.getUrl())}else if(d.value=="replace"){var f=mxUtils.parseXml(c.value);a.editor.setGraphXml(f.documentElement);a.hideDialog()}else if(d.value=="import"){f=mxUtils.parseXml(c.value);var g=new mxGraphModel;(new mxCodec(f)).decode(f.documentElement,g);f=g.getChildren(g.getChildAt(g.getRoot(),
0));a.editor.graph.setSelectionCells(a.editor.graph.importCells(f));a.hideDialog()}}));b.appendChild(mxUtils.button(mxResources.get("cancel"),function(){a.hideDialog()}));this.container=b}
function ExportDialog(a){function b(){var q=m.value,r=q.lastIndexOf(".");m.value=r>0?q.substring(0,r+1)+p.value:q+"."+p.value;if(p.value==="xml"){o.setAttribute("disabled","true");n.setAttribute("disabled","true");s.setAttribute("disabled","true")}else{o.removeAttribute("disabled");n.removeAttribute("disabled");s.removeAttribute("disabled")}}function c(){o.style.backgroundColor=o.value*n.value>MAX_AREA||o.value<0?"red":"";n.style.backgroundColor=o.value*n.value>MAX_AREA||n.value<0?"red":""}var d=
a.editor.graph,e=d.getGraphBounds(),f=d.view.scale,g=Math.ceil(e.width/f),h=Math.ceil(e.height/f),k;f=document.createElement("table");var l=document.createElement("tbody");e=document.createElement("tr");k=document.createElement("td");k.style.fontSize="10pt";k.style.width="100px";mxUtils.write(k,mxResources.get("filename")+":");e.appendChild(k);var m=document.createElement("input");m.setAttribute("value",a.editor.getOrCreateFilename());m.style.width="180px";k=document.createElement("td");k.appendChild(m);
e.appendChild(k);l.appendChild(e);e=document.createElement("tr");k=document.createElement("td");k.style.fontSize="10pt";mxUtils.write(k,mxResources.get("format")+":");e.appendChild(k);var p=document.createElement("select");p.style.width="180px";k=document.createElement("option");k.setAttribute("value","png");mxUtils.write(k,"PNG - Portable Network Graphics");p.appendChild(k);k=document.createElement("option");k.setAttribute("value","gif");mxUtils.write(k,"GIF - Graphics Interchange Format");p.appendChild(k);
k=document.createElement("option");k.setAttribute("value","jpg");mxUtils.write(k,"JPG - JPEG File Interchange Format");p.appendChild(k);k=document.createElement("option");k.setAttribute("value","pdf");mxUtils.write(k,"PDF - Portable Document Format");p.appendChild(k);k=document.createElement("option");k.setAttribute("value","svg");mxUtils.write(k,"SVG - Scalable Vector Graphics");p.appendChild(k);k=document.createElement("option");k.setAttribute("value","xml");mxUtils.write(k,"XML - Diagramly XML Document");
p.appendChild(k);k=document.createElement("td");k.appendChild(p);e.appendChild(k);l.appendChild(e);e=document.createElement("tr");k=document.createElement("td");k.style.fontSize="10pt";mxUtils.write(k,mxResources.get("width")+":");e.appendChild(k);var o=document.createElement("input");o.setAttribute("value",g);o.style.width="180px";k=document.createElement("td");k.appendChild(o);e.appendChild(k);l.appendChild(e);e=document.createElement("tr");k=document.createElement("td");k.style.fontSize="10pt";
mxUtils.write(k,mxResources.get("height")+":");e.appendChild(k);var n=document.createElement("input");n.setAttribute("value",h);n.style.width="180px";k=document.createElement("td");k.appendChild(n);e.appendChild(k);l.appendChild(e);e=document.createElement("tr");k=document.createElement("td");k.style.fontSize="10pt";mxUtils.write(k,mxResources.get("borderWidth")+":");e.appendChild(k);var s=document.createElement("input");s.setAttribute("value",g);s.style.width="180px";s.value="0";k=document.createElement("td");
k.appendChild(s);e.appendChild(k);l.appendChild(e);f.appendChild(l);mxEvent.addListener(p,"change",b);b();mxEvent.addListener(o,"change",function(){n.value=g>0?Math.ceil(parseInt(o.value)*h/g):"0";c()});mxEvent.addListener(n,"change",function(){o.value=h>0?Math.ceil(parseInt(n.value)*g/h):"0";c()});var t=new mxImageExport;e=document.createElement("tr");k=document.createElement("td");k.colSpan=2;k.style.paddingTop="40px";k.setAttribute("align","right");k.appendChild(mxUtils.button(mxResources.get("save"),
mxUtils.bind(this,function(){if(parseInt(o.value)<=0&&parseInt(n.value)<=0)mxUtils.alert(mxResources.get("drawingEmpty"));else{var q=p.value,r=m.value;if(q=="xml"){var u=encodeURIComponent(mxUtils.getXml(a.editor.getGraphXml()));(new mxXmlRequest(SAVE_URL,"filename="+r+"&xml="+u)).simulate(document,"_blank")}else if(q=="svg"){var x=Math.max(0,parseInt(s.value))+1,A=parseInt(o.value)/g,H=d.getGraphBounds(),D=d.view.scale,y=mxUtils.createXmlDocument();u=y.createElementNS!=null?y.createElementNS(mxConstants.NS_SVG,
"svg"):y.createElement("svg");if(d.background!=null)if(u.style!=null)u.style.backgroundColor=d.background;else u.setAttribute("style","background-color:"+d.background);y.createElementNS==null&&u.setAttribute("xmlns",mxConstants.NS_SVG);u.setAttribute("width",Math.ceil(H.width*A/D+2*x)+"px");u.setAttribute("height",Math.ceil(H.height*A/D+2*x)+"px");u.setAttribute("xmlns:xlink",mxConstants.NS_XLINK);u.setAttribute("version","1.1");var z=y.createElementNS!=null?y.createElementNS(mxConstants.NS_SVG,"g"):
y.createElement("g");z.setAttribute("transform","translate(0.5,0.5)");u.appendChild(z);y.appendChild(u);y=new mxSvgCanvas2D(z);y.translate(Math.floor((x/A-H.x)/D),Math.floor((x/A-H.y)/D));y.scale(A/D);t.drawState(d.getView().getState(d.model.root),y);u=mxUtils.getXml(u);if(u.length<MAX_REQUEST_SIZE){u=encodeURIComponent(u);(new mxXmlRequest(SAVE_URL,"filename="+r+"&format="+q+"&xml="+u)).simulate(document,"_blank")}else{mxUtils.alert(mxResources.get("drawingTooLarge"));mxUtils.popup(u)}}else{x=Math.max(0,
parseInt(s.value))+1;A=parseInt(o.value)/g;H=d.getGraphBounds();D=d.view.scale;y=mxUtils.createXmlDocument();u=y.createElement("output");y.appendChild(u);y=new mxXmlCanvas2D(u);y.translate(Math.floor((x/A-H.x)/D),Math.floor((x/A-H.y)/D));y.scale(A/D);t.drawState(d.getView().getState(d.model.root),y);y=Math.ceil(H.width*A/D+2*x);x=Math.ceil(H.height*A/D+2*x);u=mxUtils.getXml(u);u.length<=MAX_REQUEST_SIZE&&y>0&&x>0&&y*x<MAX_AREA?(new mxXmlRequest(EXPORT_URL,"filename="+r+"&format="+q+"&bg="+(d.background||
"#ffffff")+"&w="+y+"&h="+x+"&plain="+encodeURIComponent(u))).simulate(document,"_blank"):mxUtils.alert(mxResources.get("drawingTooLarge"))}a.hideDialog()}})));k.appendChild(mxUtils.button(mxResources.get("cancel"),function(){a.hideDialog()}));e.appendChild(k);l.appendChild(e);l.appendChild(e);f.appendChild(l);this.container=f};var mxGraphFiles={save:function(a){var b=a.editor.graph,c=b.getGraphBounds(),d=new mxImageExport;a=mxUtils.getXml(a.editor.getGraphXml());c=b.getGraphBounds();var e=b.view.scale,f=mxUtils.createXmlDocument(),g=f.createElementNS!=null?f.createElementNS(mxConstants.NS_SVG,"svg"):f.createElement("svg");if(b.background!=null)if(g.style!=null)g.style.backgroundColor=b.background;else g.setAttribute("style","background-color:"+b.background);f.createElementNS==null&&g.setAttribute("xmlns",mxConstants.NS_SVG);
g.setAttribute("width",Math.ceil(c.width*1/e+2)+"px");g.setAttribute("height",Math.ceil(c.height*1/e+2)+"px");g.setAttribute("xmlns:xlink",mxConstants.NS_XLINK);g.setAttribute("version","1.1");var h=f.createElementNS!=null?f.createElementNS(mxConstants.NS_SVG,"g"):f.createElement("g");h.setAttribute("transform","translate(0.5,0.5)");g.appendChild(h);f.appendChild(g);f=new mxSvgCanvas2D(h);f.translate(Math.floor((1-c.x)/e),Math.floor((1-c.y)/e));f.scale(1/e);d.drawState(b.getView().getState(b.model.root),
f);b=mxUtils.getXml(g);if(b.length<MAX_REQUEST_SIZE){$("#draw_xml").val(a);$("#draw_svg").val(b);return{xml:a,svg:b}}},load_xml:function(a,b){var c=mxUtils.parseXml(b);a.editor.setGraphXml(c.documentElement)}};Graph=function(a,b,c,d){mxGraph.call(this,a,b,c,d);this.setConnectable(true);this.setDropEnabled(true);this.setPanning(true);this.setTooltips(!mxClient.IS_TOUCH);this.setAllowLoops(true);this.allowAutoPanning=true;this.constrainChildren=this.resetEdgesOnConnect=false;this.connectionHandler.setCreateTarget(true);this.connectionHandler.isValidSource=function(){return mxConnectionHandler.prototype.isValidSource.apply(this,arguments)&&urlParams.connect!="2"&&urlParams.connect!=null};this.alternateEdgeStyle=
"vertical";d==null&&this.loadStylesheet();var e=new mxRubberband(this);this.getRubberband=function(){return e};this.panningHandler.addListener(mxEvent.PAN_START,mxUtils.bind(this,function(){this.container.style.cursor="pointer"}));this.panningHandler.addListener(mxEvent.PAN_END,mxUtils.bind(this,function(){this.container.style.cursor="default"}));this.isHtmlLabel=function(g){var h=this.view.getState(g);g=h!=null?h.style:this.getCellStyle(g);return g.html=="1"||g.whiteSpace=="wrap"};this.cellRenderer.getLabelValue=
function(g){var h=mxCellRenderer.prototype.getLabelValue.apply(this,arguments);if(g.style.whiteSpace=="wrap"&&g.style.html!=1)h=mxUtils.htmlEntities(h,false);return h};this.isCellLocked=function(){return false};this.connectionHandler.tapAndHoldTolerance=16;var f=this.connectionHandler.tapAndHold;this.connectionHandler.tapAndHold=function(g,h){if(h==null){if(!this.graph.panningHandler.active){e.start(g.getGraphX(),g.getGraphY());this.graph.panningHandler.panningTrigger=false}}else if(tapAndHoldStartsConnection)f.apply(this,
arguments);else this.graph.isCellSelected(h.cell)&&this.graph.getSelectionCount()>1&&this.graph.removeSelectionCell(h.cell)};this.connectionHandler.selectCells=function(g,h){this.graph.setSelectionCell(h||g)};this.connectionHandler.constraintHandler.isStateIgnored=function(g,h){return h&&g.view.graph.isCellSelected(g.cell)};this.selectionModel.addListener(mxEvent.CHANGE,mxUtils.bind(this,function(){var g=this.connectionHandler.constraintHandler;if(g.currentFocus!=null&&g.isStateIgnored(g.currentFocus,
true)){g.currentFocus=null;g.constraints=null;g.destroyIcons()}g.destroyFocusHighlight()}));touchStyle&&this.initTouch()};mxUtils.extend(Graph,mxGraph);Graph.prototype.minFitScale=null;Graph.prototype.maxFitScale=null;Graph.prototype.loadStylesheet=function(){var a=mxUtils.load(STYLE_PATH+"/default.xml").getDocumentElement();(new mxCodec(a.ownerDocument)).decode(a,this.getStylesheet())};
Graph.prototype.flipEdge=function(a){if(a!=null){var b=this.view.getState(a);b=b!=null?b.style:this.getCellStyle(a);if(b!=null){b=mxUtils.getValue(b,mxConstants.STYLE_ELBOW,mxConstants.ELBOW_HORIZONTAL)==mxConstants.ELBOW_HORIZONTAL?mxConstants.ELBOW_VERTICAL:mxConstants.ELBOW_HORIZONTAL;this.setCellStyles(mxConstants.STYLE_ELBOW,b,[a])}}};
Graph.prototype.setDefaultEdge=function(a){if(a!=null&&this.getModel().isEdge(a)){var b=this.getModel().cloneCell(a);if(b.geometry!=null)b.geometry.points=null;a=b.getStyle();a=mxUtils.setStyle(a,mxConstants.STYLE_ENTRY_X,null);a=mxUtils.setStyle(a,mxConstants.STYLE_ENTRY_Y,null);a=mxUtils.setStyle(a,mxConstants.STYLE_EXIT_X,null);a=mxUtils.setStyle(a,mxConstants.STYLE_EXIT_Y,null);b.setStyle(a);this.connectionHandler.createEdgeState=function(){return this.graph.view.createState(b)};this.connectionHandler.factoryMethod=
function(){return this.graph.cloneCells([b])[0]}}};Graph.prototype.isCellFoldable=function(a){return this.foldingEnabled&&this.isSwimlane(a)};Graph.prototype.isValidRoot=function(a){return this.isSwimlane(a)};Graph.prototype.createGroupCell=function(){var a=mxGraph.prototype.createGroupCell.apply(this,arguments);a.setStyle("group");return a};
Graph.prototype.getTooltipForCell=function(a){var b="";if(this.getModel().isVertex(a)){var c=this.getCellGeometry(a),d=function(e){return Math.round(parseFloat(e)*100)/100};if(c!=null){if(b==null)b="";else if(b.length>0)b+="\n";b+="X: "+d(c.x)+"\nY: "+d(c.y)+"\nW: "+d(c.width)+"\nH: "+d(c.height)}}else if(this.getModel().isEdge(a))b=mxGraph.prototype.getTooltipForCell.apply(this,arguments);return b};
Graph.prototype.convertValueToString=function(a){if(a.value!=null&&typeof a.value=="object")return a.value.getAttribute("label");return mxGraph.prototype.convertValueToString.apply(this,arguments)};Graph.prototype.cellLabelChanged=function(a,b){if(a.value!=null&&typeof a.value=="object"){var c=a.value.cloneNode(true);c.setAttribute("label",b);b=c}mxGraph.prototype.cellLabelChanged.apply(this,arguments)};
Graph.prototype.setLinkForCell=function(a,b){var c=null;if(a.value!=null&&typeof a.value=="object")c=a.value.cloneNode(true);else{c=mxUtils.createXmlDocument().createElement("UserObject");c.setAttribute("label",a.value)}b!=null&&b.length>0?c.setAttribute("link",b):c.removeAttribute("link");this.model.setValue(a,c)};Graph.prototype.getLinkForCell=function(a){if(a.value!=null&&typeof a.value=="object")return a.value.getAttribute("link");return null};
Graph.prototype.initTouch=function(){this.connectionHandler.marker.isEnabled=function(){return this.graph.connectionHandler.first!=null};this.addListener(mxEvent.START_EDITING,function(){this.panningHandler.hideMenu()});var a=false,b=null;this.updateMouseEvent=function(c){mxGraph.prototype.updateMouseEvent.apply(this,arguments);if(c.getState()==null){var d=this.getCellAt(c.graphX,c.graphY);if(this.getModel().isEdge(d)){c.state=this.view.getState(d);if(c.state!=null&&c.state.shape!=null)this.container.style.cursor=
c.state.shape.node.style.cursor}}if(c.getState()==null)this.container.style.cursor="default"};this.fireMouseEvent=function(c,d){if(c==mxEvent.MOUSE_DOWN)if(this.panningHandler.isMenuShowing()){a=false;b=null}else{b=d.getCell();a=b!=null?this.isCellSelected(b):this.isSelectionEmpty()}else if(c==mxEvent.MOUSE_UP){if(a&&!this.isEditing()){if(!this.panningHandler.isMenuShowing()){var e=mxEvent.getClientX(d.getEvent()),f=mxEvent.getClientY(d.getEvent());this.panningHandler.popup(e+16,f,b,d.getEvent())}a=
false;b=null;d.consume();return}a=false;b=null}mxGraph.prototype.fireMouseEvent.apply(this,arguments);if(c==mxEvent.MOUSE_MOVE&&d.isConsumed()){a=false;b=null}}};
(function(){mxVertexHandler.prototype.rotationEnabled=true;mxVertexHandler.prototype.livePreview=!mxClient.IS_TOUCH;mxEdgeHandler.prototype.livePreview=!mxClient.IS_TOUCH;mxText.prototype.baseSpacingTop=5;mxText.prototype.baseSpacingBottom=1;if(touchStyle){mxConstants.HANDLE_SIZE=16;mxConstants.LABEL_HANDLE_SIZE=7;if(mxClient.IS_TOUCH){mxVertexHandler.prototype.tolerance=4;mxEdgeHandler.prototype.tolerance=6;Graph.prototype.tolerance=14;Graph.prototype.gridSize=20;mxPanningHandler.prototype.selectOnPopup=
false;mxPanningHandler.prototype.useLeftButtonForPanning=true;mxPanningHandler.prototype.isPanningTrigger=function(k){var l=k.getEvent();return this.useLeftButtonForPanning&&(this.ignoreCell||k.getState()==null)||mxEvent.isControlDown(l)&&mxEvent.isShiftDown(l)||this.usePopupTrigger&&mxEvent.isPopupTrigger(l)}}var a=mxGraphHandler.prototype.mouseDown;mxGraphHandler.prototype.mouseDown=function(k,l){a.apply(this,arguments);if(this.graph.isCellSelected(l.getCell())&&this.graph.getSelectionCount()>1)this.delayedSelection=
false};Graph.prototype.createHandlers=function(){this.tooltipHandler=new mxTooltipHandler(this);this.tooltipHandler.setEnabled(false);this.selectionCellsHandler=new mxSelectionCellsHandler(this);this.panningHandler=new mxPanningHandler(this);this.panningHandler.panningEnabled=false;this.connectionHandler=new mxConnectionHandler(this);this.connectionHandler.setEnabled(false);this.graphHandler=new mxGraphHandler(this)};var b=mxGraph.prototype.dblClick;Graph.prototype.dblClick=function(k,l){if(l==null){var m=
mxUtils.convertPoint(this.container,mxEvent.getClientX(k),mxEvent.getClientY(k));l=this.getCellAt(m.x,m.y)}b.call(this,k,l)};var c=new mxImage(IMAGE_PATH+"/touch-handle.png",16,16);mxVertexHandler.prototype.handleImage=c;mxEdgeHandler.prototype.handleImage=c;mxOutline.prototype.sizerImage=c;(new Image).src=c.src;var d=IMAGE_PATH+"/touch-connector.png",e=mxVertexHandler.prototype.init;mxVertexHandler.prototype.init=function(){e.apply(this,arguments);if(showConnectorImg&&this.graph.connectionHandler.isEnabled()&&
this.graph.isCellConnectable(this.state.cell)&&!this.graph.isValidRoot(this.state.cell)&&this.graph.getSelectionCount()==1){this.connectorImg=mxUtils.createImage(d);this.connectorImg.style.cursor="pointer";this.connectorImg.style.width="29px";this.connectorImg.style.height="29px";this.connectorImg.style.position="absolute";if(!mxClient.IS_TOUCH){this.connectorImg.setAttribute("title",mxResources.get("connect"));mxEvent.redirectMouseEvents(this.connectorImg,this.graph,this.state)}this.connectorImg.style.padding=
"2px";mxEvent.addGestureListeners(this.connectorImg,mxUtils.bind(this,function(k){this.graph.panningHandler.hideMenu();var l=mxUtils.convertPoint(this.graph.container,mxEvent.getClientX(k),mxEvent.getClientY(k));this.graph.connectionHandler.start(this.state,l.x,l.y);this.graph.isMouseDown=true;mxEvent.consume(k)}));this.graph.container.appendChild(this.connectorImg)}this.redrawTools()};var f=mxVertexHandler.prototype.redrawHandles;mxVertexHandler.prototype.redrawHandles=function(){f.apply(this);this.redrawTools()};
mxVertexHandler.prototype.redrawTools=function(){if(this.state!=null&&this.connectorImg!=null){var k=new mxPoint,l=this.state;if(mxVertexHandler.prototype.singleSizer){k.x=l.x+l.width-this.connectorImg.offsetWidth/2;k.y=l.y-this.connectorImg.offsetHeight/2}else{k.x=l.x+l.width+mxConstants.HANDLE_SIZE/2+4+this.connectorImg.offsetWidth/2;k.y=l.y+l.height/2}var m=mxUtils.toRadians(mxUtils.getValue(l.style,mxConstants.STYLE_ROTATION,0));if(m!=0){var p=Math.cos(m);m=Math.sin(m);l=new mxPoint(l.getCenterX(),
l.getCenterY());k=mxUtils.getRotatedPoint(k,p,m,l)}this.connectorImg.style.left=k.x-this.connectorImg.offsetWidth/2+"px";this.connectorImg.style.top=k.y-this.connectorImg.offsetHeight/2+"px"}};var g=mxVertexHandler.prototype.destroy;mxVertexHandler.prototype.destroy=function(){g.apply(this,arguments);if(this.connectorImg!=null){this.connectorImg.parentNode.removeChild(this.connectorImg);this.connectorImg=null}};(new Image).src=d}else{var h=new mxImage(IMAGE_PATH+"/connector.png",15,15);mxConnectionHandler.prototype.connectImage=
h;(new Image).src=h.src;if(urlParams.connect==null||urlParams.connect=="2"){h=new mxImage(IMAGE_PATH+"/connector.png",15,15);e=mxVertexHandler.prototype.init;mxVertexHandler.prototype.init=function(){this.singleSizer=this.state.width<30&&this.state.height<30;e.apply(this,arguments);if(showConnectorImg&&this.graph.connectionHandler.isEnabled()&&this.graph.isCellConnectable(this.state.cell)&&!this.graph.isValidRoot(this.state.cell)&&this.graph.getSelectionCount()==1){if(mxClient.IS_IE&&!mxClient.IS_SVG){this.connectorImg=
document.createElement("div");this.connectorImg.style.backgroundImage="url("+h.src+")";this.connectorImg.style.backgroundPosition="center";this.connectorImg.style.backgroundRepeat="no-repeat";this.connectorImg.style.width=h.width+4+"px";this.connectorImg.style.height=h.height+4+"px";this.connectorImg.style.display=mxClient.IS_QUIRKS?"inline":"inline-block"}else{this.connectorImg=mxUtils.createImage(h.src);this.connectorImg.style.width=h.width+"px";this.connectorImg.style.height=h.height+"px"}this.connectorImg.style.cursor=
"pointer";this.connectorImg.style.position="absolute";this.connectorImg.setAttribute("title",mxResources.get("connect"));mxEvent.redirectMouseEvents(this.connectorImg,this.graph,this.state);this.connectorImg.style.padding="2px";mxEvent.addListener(this.connectorImg,"mousedown",mxUtils.bind(this,function(k){this.graph.panningHandler.hideMenu();var l=mxUtils.convertPoint(this.graph.container,mxEvent.getClientX(k),mxEvent.getClientY(k));this.graph.connectionHandler.start(this.state,l.x,l.y);this.graph.isMouseDown=
true;mxEvent.consume(k)}));this.graph.container.appendChild(this.connectorImg)}this.redrawTools()};f=mxVertexHandler.prototype.redrawHandles;mxVertexHandler.prototype.redrawHandles=function(){f.apply(this);this.redrawTools()};mxVertexHandler.prototype.redrawTools=function(){if(this.state!=null&&this.connectorImg!=null){var k=new mxPoint,l=this.state;if(mxVertexHandler.prototype.singleSizer){k.x=l.x+l.width-this.connectorImg.offsetWidth/2;k.y=l.y}else{k.x=l.x+l.width+mxConstants.HANDLE_SIZE/2+2+this.connectorImg.offsetWidth/
2;k.y=l.y+l.height/2}var m=mxUtils.toRadians(mxUtils.getValue(l.style,mxConstants.STYLE_ROTATION,0));if(m!=0){var p=Math.cos(m);m=Math.sin(m);l=new mxPoint(l.getCenterX(),l.getCenterY());k=mxUtils.getRotatedPoint(k,p,m,l)}this.connectorImg.style.left=k.x-this.connectorImg.offsetWidth/2+"px";this.connectorImg.style.top=k.y-this.connectorImg.offsetHeight/2+"px"}};g=mxVertexHandler.prototype.destroy;mxVertexHandler.prototype.destroy=function(){g.apply(this,arguments);if(this.connectorImg!=null){this.connectorImg.parentNode.removeChild(this.connectorImg);
this.connectorImg=null}}}}})();Menus=function(a){this.editorUi=a;this.menus={};this.init();(new Image).src=IMAGE_PATH+"/checkmark.gif"};
Menus.prototype.init=function(){var a=this.editorUi.editor.graph;this.put("fontFamily",new Menu(mxUtils.bind(this,function(b,c){for(var d=["Helvetica","Verdana","Times New Roman","Garamond","Comic Sans MS","Courier New","Georgia","Lucida Console","Tahoma"],e=0;e<d.length;e++)this.styleChange(b,d[e],[mxConstants.STYLE_FONTFAMILY],[d[e]],null,c).firstChild.nextSibling.style.fontFamily=d[e];b.addSeparator(c);this.promptChange(b,mxResources.get("custom"),"",mxConstants.DEFAULT_FONTFAMILY,mxConstants.STYLE_FONTFAMILY,
c)})));this.put("fontSize",new Menu(mxUtils.bind(this,function(b,c){for(var d=[6,8,9,10,11,12,14,18,24,36,48,72],e=0;e<d.length;e++)this.styleChange(b,d[e],[mxConstants.STYLE_FONTSIZE],[d[e]],null,c);b.addSeparator(c);this.promptChange(b,mxResources.get("custom"),"(pt)","12",mxConstants.STYLE_FONTSIZE,c)})));this.put("linewidth",new Menu(mxUtils.bind(this,function(b,c){for(var d=[1,2,3,4,8,12,16,24],e=0;e<d.length;e++)this.styleChange(b,d[e]+"px",[mxConstants.STYLE_STROKEWIDTH],[d[e]],null,c);b.addSeparator(c);
this.promptChange(b,mxResources.get("custom"),"(px)","1",mxConstants.STYLE_STROKEWIDTH,c)})));this.put("line",new Menu(mxUtils.bind(this,function(b,c){this.styleChange(b,mxResources.get("straight"),[mxConstants.STYLE_EDGE],[null],null,c);this.styleChange(b,mxResources.get("entityRelation"),[mxConstants.STYLE_EDGE],["entityRelationEdgeStyle"],null,c);b.addSeparator(c);this.styleChange(b,mxResources.get("horizontal"),[mxConstants.STYLE_EDGE,mxConstants.STYLE_ELBOW],["elbowEdgeStyle","horizontal"],null,
c);this.styleChange(b,mxResources.get("vertical"),[mxConstants.STYLE_EDGE,mxConstants.STYLE_ELBOW],["elbowEdgeStyle","vertical"],null,c);b.addSeparator(c);this.styleChange(b,mxResources.get("manual"),[mxConstants.STYLE_EDGE],["segmentEdgeStyle"],null,c);this.styleChange(b,mxResources.get("automatic"),[mxConstants.STYLE_EDGE],["orthogonalEdgeStyle"],null,c)})));this.put("lineend",new Menu(mxUtils.bind(this,function(b,c){this.styleChange(b,mxResources.get("classic"),[mxConstants.STYLE_ENDARROW],[mxConstants.ARROW_CLASSIC],
null,c);this.styleChange(b,mxResources.get("openArrow"),[mxConstants.STYLE_ENDARROW],[mxConstants.ARROW_OPEN],null,c);this.styleChange(b,mxResources.get("block"),[mxConstants.STYLE_ENDARROW],[mxConstants.ARROW_BLOCK],null,c);b.addSeparator(c);this.styleChange(b,mxResources.get("oval"),[mxConstants.STYLE_ENDARROW],[mxConstants.ARROW_OVAL],null,c);this.styleChange(b,mxResources.get("diamond"),[mxConstants.STYLE_ENDARROW],[mxConstants.ARROW_DIAMOND],null,c);this.styleChange(b,mxResources.get("diamondThin"),
[mxConstants.STYLE_ENDARROW],[mxConstants.ARROW_DIAMOND_THIN],null,c);b.addSeparator(c);this.styleChange(b,mxResources.get("none"),[mxConstants.STYLE_ENDARROW],[mxConstants.NONE],null,c);b.addSeparator(c);b.addItem(mxResources.get("transparent"),null,function(){a.toggleCellStyles("endFill",true)},c,null,true);b.addSeparator(c);this.promptChange(b,mxResources.get("size"),"(px)",mxConstants.DEFAULT_MARKERSIZE,mxConstants.STYLE_ENDSIZE,c)})));this.put("linestart",new Menu(mxUtils.bind(this,function(b,
c){this.styleChange(b,mxResources.get("classic"),[mxConstants.STYLE_STARTARROW],[mxConstants.ARROW_CLASSIC],null,c);this.styleChange(b,mxResources.get("openArrow"),[mxConstants.STYLE_STARTARROW],[mxConstants.ARROW_OPEN],null,c);this.styleChange(b,mxResources.get("block"),[mxConstants.STYLE_STARTARROW],[mxConstants.ARROW_BLOCK],null,c);b.addSeparator(c);this.styleChange(b,mxResources.get("oval"),[mxConstants.STYLE_STARTARROW],[mxConstants.ARROW_OVAL],null,c);this.styleChange(b,mxResources.get("diamond"),
[mxConstants.STYLE_STARTARROW],[mxConstants.ARROW_DIAMOND],null,c);this.styleChange(b,mxResources.get("diamondThin"),[mxConstants.STYLE_STARTARROW],[mxConstants.ARROW_DIAMOND_THIN],null,c);b.addSeparator(c);this.styleChange(b,mxResources.get("none"),[mxConstants.STYLE_STARTARROW],[mxConstants.NONE],null,c);b.addSeparator(c);b.addItem(mxResources.get("transparent"),null,function(){a.toggleCellStyles("startFill",true)},c,null,true);b.addSeparator(c);this.promptChange(b,mxResources.get("size"),"(px)",
mxConstants.DEFAULT_MARKERSIZE,mxConstants.STYLE_STARTSIZE,c)})));this.put("spacing",new Menu(mxUtils.bind(this,function(b,c){var d=this.editorUi.actions.get("shadow").enabled,e=this.get("line").enabled;if(d||b.showDisabled){this.promptChange(b,mxResources.get("top"),"(px)","0",mxConstants.STYLE_SPACING_TOP,c,d);this.promptChange(b,mxResources.get("right"),"(px)","0",mxConstants.STYLE_SPACING_RIGHT,c,d);this.promptChange(b,mxResources.get("bottom"),"(px)","0",mxConstants.STYLE_SPACING_BOTTOM,c,d);
this.promptChange(b,mxResources.get("left"),"(px)","0",mxConstants.STYLE_SPACING_LEFT,c,d);b.addSeparator(c);this.promptChange(b,mxResources.get("global"),"(px)","0",mxConstants.STYLE_SPACING,c,d);this.promptChange(b,mxResources.get("perimeter"),"(px)","0",mxConstants.STYLE_PERIMETER_SPACING,c,d)}if(e||b.showDisabled){b.addSeparator(c);this.promptChange(b,mxResources.get("sourceSpacing"),"(px)","0",mxConstants.STYLE_SOURCE_PERIMETER_SPACING,c,e);this.promptChange(b,mxResources.get("targetSpacing"),
"(px)","0",mxConstants.STYLE_TARGET_PERIMETER_SPACING,c,e)}})));this.put("format",new Menu(mxUtils.bind(this,function(b,c){this.addMenuItems(b,["fillColor"],c);this.addSubmenu("gradient",b,c);this.addMenuItems(b,["-","shadow"],c);this.promptChange(b,mxResources.get("opacity"),"(%)","100",mxConstants.STYLE_OPACITY,c,this.get("format").enabled);this.addMenuItems(b,["-","curved","rounded","dashed","-","strokeColor"],c);this.addSubmenu("linewidth",b,c);this.addMenuItems(b,["-"],c);this.addSubmenu("line",
b,c);this.addMenuItems(b,["-"],c);this.addSubmenu("linestart",b,c);this.addSubmenu("lineend",b,c);b.addSeparator(c);this.addMenuItem(b,"style",c)})));this.put("gradient",new Menu(mxUtils.bind(this,function(b,c){this.addMenuItems(b,["gradientColor","-"],c);this.styleChange(b,mxResources.get("north"),[mxConstants.STYLE_GRADIENT_DIRECTION],[mxConstants.DIRECTION_NORTH],null,c);this.styleChange(b,mxResources.get("east"),[mxConstants.STYLE_GRADIENT_DIRECTION],[mxConstants.DIRECTION_EAST],null,c);this.styleChange(b,
mxResources.get("south"),[mxConstants.STYLE_GRADIENT_DIRECTION],[mxConstants.DIRECTION_SOUTH],null,c);this.styleChange(b,mxResources.get("west"),[mxConstants.STYLE_GRADIENT_DIRECTION],[mxConstants.DIRECTION_WEST],null,c)})));this.put("text",new Menu(mxUtils.bind(this,function(b,c){var d=this.get("text").enabled;b.addSeparator(c);this.addMenuItem(b,"fontColor",c);this.addMenuItems(b,["backgroundColor","borderColor","-"],c);this.addSubmenu("fontFamily",b,c);this.addSubmenu("fontSize",b,c);this.addMenuItems(b,
["-","bold","italic","underline","-"],c);this.addSubmenu("alignment",b,c);this.addMenuItem(b,"wordWrap",c);b.addSeparator(c);this.promptChange(b,mxResources.get("textOpacity"),"(%)","100",mxConstants.STYLE_TEXT_OPACITY,c,d);b.addItem(mxResources.get("hide"),null,function(){a.toggleCellStyles(mxConstants.STYLE_NOLABEL,false)},c,null,d)})));this.put("alignment",new Menu(mxUtils.bind(this,function(b,c){this.styleChange(b,mxResources.get("leftAlign"),[mxConstants.STYLE_ALIGN],[mxConstants.ALIGN_LEFT],
null,c);this.styleChange(b,mxResources.get("center"),[mxConstants.STYLE_ALIGN],[mxConstants.ALIGN_CENTER],null,c);this.styleChange(b,mxResources.get("rightAlign"),[mxConstants.STYLE_ALIGN],[mxConstants.ALIGN_RIGHT],null,c);b.addSeparator(c);this.styleChange(b,mxResources.get("topAlign"),[mxConstants.STYLE_VERTICAL_ALIGN],[mxConstants.ALIGN_TOP],null,c);this.styleChange(b,mxResources.get("middle"),[mxConstants.STYLE_VERTICAL_ALIGN],[mxConstants.ALIGN_MIDDLE],null,c);this.styleChange(b,mxResources.get("bottomAlign"),
[mxConstants.STYLE_VERTICAL_ALIGN],[mxConstants.ALIGN_BOTTOM],null,c);b.addSeparator(c);this.addSubmenu("position",b,c);this.addSubmenu("spacing",b,c);b.addSeparator(c);var d=this.get("text").enabled;b.addItem(mxResources.get("vertical"),null,function(){a.toggleCellStyles(mxConstants.STYLE_HORIZONTAL,true)},c,null,d)})));this.put("position",new Menu(mxUtils.bind(this,function(b,c){this.styleChange(b,mxResources.get("left"),[mxConstants.STYLE_LABEL_POSITION,mxConstants.STYLE_ALIGN],[mxConstants.ALIGN_LEFT,
mxConstants.ALIGN_RIGHT],null,c);this.styleChange(b,mxResources.get("center"),[mxConstants.STYLE_LABEL_POSITION,mxConstants.STYLE_ALIGN],[mxConstants.ALIGN_CENTER,mxConstants.ALIGN_CENTER],null,c);this.styleChange(b,mxResources.get("right"),[mxConstants.STYLE_LABEL_POSITION,mxConstants.STYLE_ALIGN],[mxConstants.ALIGN_RIGHT,mxConstants.ALIGN_LEFT],null,c);b.addSeparator(c);this.styleChange(b,mxResources.get("top"),[mxConstants.STYLE_VERTICAL_LABEL_POSITION,mxConstants.STYLE_VERTICAL_ALIGN],[mxConstants.ALIGN_TOP,
mxConstants.ALIGN_BOTTOM],null,c);this.styleChange(b,mxResources.get("middle"),[mxConstants.STYLE_VERTICAL_LABEL_POSITION,mxConstants.STYLE_VERTICAL_ALIGN],[mxConstants.ALIGN_MIDDLE,mxConstants.ALIGN_MIDDLE],null,c);this.styleChange(b,mxResources.get("bottom"),[mxConstants.STYLE_VERTICAL_LABEL_POSITION,mxConstants.STYLE_VERTICAL_ALIGN],[mxConstants.ALIGN_BOTTOM,mxConstants.ALIGN_TOP],null,c)})));this.put("direction",new Menu(mxUtils.bind(this,function(b,c){b.addItem(mxResources.get("flipH"),null,
function(){a.toggleCellStyles(mxConstants.STYLE_FLIPH,false)},c);b.addItem(mxResources.get("flipV"),null,function(){a.toggleCellStyles(mxConstants.STYLE_FLIPV,false)},c);this.addMenuItems(b,["-","tilt","rotation"],c)})));this.put("align",new Menu(mxUtils.bind(this,function(b,c){b.addItem(mxResources.get("leftAlign"),null,function(){a.alignCells(mxConstants.ALIGN_LEFT)},c);b.addItem(mxResources.get("center"),null,function(){a.alignCells(mxConstants.ALIGN_CENTER)},c);b.addItem(mxResources.get("rightAlign"),
null,function(){a.alignCells(mxConstants.ALIGN_RIGHT)},c);b.addSeparator(c);b.addItem(mxResources.get("topAlign"),null,function(){a.alignCells(mxConstants.ALIGN_TOP)},c);b.addItem(mxResources.get("middle"),null,function(){a.alignCells(mxConstants.ALIGN_MIDDLE)},c);b.addItem(mxResources.get("bottomAlign"),null,function(){a.alignCells(mxConstants.ALIGN_BOTTOM)},c)})));this.put("layers",new Menu(mxUtils.bind(this,function(b,c){var d=a.getDefaultParent(),e=mxResources.get("background"),f=b.addItem(e,
null,mxUtils.bind(this,function(){a.setDefaultParent(null)}),c);d==a.model.getChildAt(a.model.root,0)&&this.addCheckmark(f);f=a.model.getChildCount(a.model.root);for(var g=1;g<f;g++)mxUtils.bind(this,function(h){var k=h.value||mxResources.get("layer")+" "+g;a.model.isVisible(h)||(k+=" ("+mxResources.get("hidden")+")");var l=b.addItem(k,null,function(){if(!a.model.isVisible(h)){a.model.setVisible(h,true);a.view.invalidate()}a.setDefaultParent(h)},c);if(d==h){this.addCheckmark(l);e=k}})(a.model.getChildAt(a.model.root,
g));f=d!=a.model.getChildAt(a.model.root,0);b.addSeparator(c);b.addItem(mxResources.get("removeIt",[e]),null,mxUtils.bind(this,function(){a.removeCells([d]);a.setDefaultParent(null)}),c,null,f);b.addItem(mxResources.get("renameIt",[e]),null,mxUtils.bind(this,function(){var h=mxUtils.prompt(mxResources.get("enterName"),e);h!=null&&h.length>0&&a.getModel().setValue(d,h)}),c,null,f);b.addItem(mxResources.get("hideIt",[e]),null,mxUtils.bind(this,function(){if(a.model.isVisible(d)){a.model.beginUpdate();
try{a.model.setVisible(d,!a.model.isVisible(d));a.view.invalidate()}finally{a.model.endUpdate()}a.setDefaultParent(null)}}),c,null,f);b.addSeparator(c);b.addItem(mxResources.get("moveSelectionTo",[e]),null,mxUtils.bind(this,function(){a.moveCells(a.getSelectionCells(),0,0,false,d)}),c,null,!a.isSelectionEmpty());b.addSeparator(c);b.addItem(mxResources.get("addLayer"),null,mxUtils.bind(this,function(){var h=a.addCell(new mxCell,a.model.root);a.setDefaultParent(h)}),c)})));this.put("layout",new Menu(mxUtils.bind(this,
function(b,c){b.addItem(mxResources.get("horizontalTree"),null,mxUtils.bind(this,function(){if(!a.isSelectionEmpty()){var d=new mxCompactTreeLayout(a,true);d.edgeRouting=false;d.levelDistance=30;this.editorUi.executeLayout(d,true,true)}}),c);b.addItem(mxResources.get("verticalTree"),null,mxUtils.bind(this,function(){if(!a.isSelectionEmpty()){var d=new mxCompactTreeLayout(a,false);d.edgeRouting=false;d.levelDistance=30;this.editorUi.executeLayout(d,true,true)}}),c);b.addSeparator(c);b.addItem(mxResources.get("horizontalFlow"),
null,mxUtils.bind(this,function(){this.editorUi.executeLayout(new mxHierarchicalLayout(a,mxConstants.DIRECTION_WEST),true,true)}),c);b.addItem(mxResources.get("verticalFlow"),null,mxUtils.bind(this,function(){this.editorUi.executeLayout(new mxHierarchicalLayout(a,mxConstants.DIRECTION_NORTH),true,true)}),c);b.addSeparator(c);b.addItem(mxResources.get("organic"),null,mxUtils.bind(this,function(){this.editorUi.executeLayout(new mxFastOrganicLayout(a),true,true)}),c);b.addItem(mxResources.get("circle"),
null,mxUtils.bind(this,function(){this.editorUi.executeLayout(new mxCircleLayout(a),true,true,a.getSelectionCells())}),c)})));this.put("navigation",new Menu(mxUtils.bind(this,function(b,c){this.addMenuItems(b,["home","-","exitGroup","enterGroup","-","expand","collapse"],c)})));this.put("arrange",new Menu(mxUtils.bind(this,function(b,c){this.addMenuItems(b,["toFront","toBack","-"],c);this.addSubmenu("direction",b,c);this.addSubmenu("layout",b,c);this.addSubmenu("align",b,c);b.addSeparator(c);this.addSubmenu("layers",
b,c);this.addSubmenu("navigation",b,c);this.addMenuItems(b,["-","group","ungroup","removeFromGroup","-","lockUnlock","-","autosize"],c)})));this.put("view",new Menu(mxUtils.bind(this,function(b,c){this.addMenuItems(b,["actualSize"],c);b.addSeparator();for(var d=[0.25,0.5,0.75,1,1.5,2,4],e=0;e<d.length;e++)(function(f){b.addItem(f*100+"%",null,function(){a.zoomTo(f)},c)})(d[e]);this.addMenuItems(b,["-","zoomIn","zoomOut","-","fitWindow","customZoom","-","fitPage","fitPageWidth"],c)})));this.put("file",
new Menu(mxUtils.bind(this,function(b,c){this.addMenuItems(b,["new","open","-","save","saveAs","-","import","export","-","editFile","-","pageSetup","print"],c)})));this.put("edit",new Menu(mxUtils.bind(this,function(b){this.addMenuItems(b,["undo","redo","-","cut","copy","paste","delete","-","duplicate","-","editLink","openLink","-","selectVertices","selectEdges","selectAll","-","setAsDefaultEdge"])})));this.put("options",new Menu(mxUtils.bind(this,function(b){this.addMenuItems(b,["grid","guides",
"tooltips","-","connect","copyConnect","navigation","-","scrollbars","pageView","-","pageBackgroundColor"])})));this.put("help",new Menu(mxUtils.bind(this,function(b){this.addMenuItems(b,["help","-","about"])})))};Menus.prototype.put=function(a,b){this.menus[a]=b};Menus.prototype.get=function(a){return this.menus[a]};Menus.prototype.addSubmenu=function(a,b,c){var d=this.get(a).enabled;if(b.showDisabled||d){c=b.addItem(mxResources.get(a),null,null,c,null,d);this.addMenu(a,b,c)}};
Menus.prototype.addMenu=function(a,b,c){var d=this.get(a);if(d!=null&&(b.showDisabled||d.enabled))this.get(a).execute(b,c)};Menus.prototype.styleChange=function(a,b,c,d,e,f){return a.addItem(b,null,mxUtils.bind(this,function(){var g=this.editorUi.editor.graph;g.getModel().beginUpdate();try{for(var h=0;h<c.length;h++)g.setCellStyles(c[h],d[h])}finally{g.getModel().endUpdate()}}),f,e)};
Menus.prototype.promptChange=function(a,b,c,d,e,f,g){return a.addItem(b,null,mxUtils.bind(this,function(){var h=this.editorUi.editor.graph,k=d,l=h.getView().getState(h.getSelectionCell());if(l!=null)k=l.style[e]||k;k=mxUtils.prompt(mxResources.get("enterValue")+(c.length>0?" "+c:""),k);k!=null&&k.length>0&&h.setCellStyles(e,k)}),f,null,g)};
Menus.prototype.pickColor=function(a){if(this.colorDialog==null)this.colorDialog=new ColorDialog(this.editorUi);this.colorDialog.currentColorKey=a;var b=this.editorUi.editor.graph;b=b.getView().getState(b.getSelectionCell());var c="none";if(b!=null)c=b.style[a]||c;if(c=="none"){this.colorDialog.picker.fromString("ffffff");this.colorDialog.colorInput.value="none"}else this.colorDialog.picker.fromString(c);this.editorUi.showDialog(this.colorDialog.container,220,400,true,false);mxClient.IS_TOUCH||this.colorDialog.colorInput.focus()};
Menus.prototype.addMenuItem=function(a,b,c){b=this.editorUi.actions.get(b);if(b!=null&&(a.showDisabled||b.enabled)){a=a.addItem(b.label,null,b.funct,c,null,b.enabled);b.toggleAction&&b.isSelected()&&this.addCheckmark(a);this.addShortcut(a,b);return a}return null};Menus.prototype.addShortcut=function(a,b){if(b.shortcut!=null){var c=a.firstChild.nextSibling.nextSibling,d=document.createElement("span");d.style.color="gray";mxUtils.write(d,b.shortcut);c.appendChild(d)}};
Menus.prototype.addCheckmark=function(a){a=a.firstChild.nextSibling;a.style.backgroundImage="url("+IMAGE_PATH+"/checkmark.gif)";a.style.backgroundRepeat="no-repeat";a.style.backgroundPosition="2px 50%"};Menus.prototype.addMenuItems=function(a,b,c){for(var d=0;d<b.length;d++)b[d]=="-"?a.addSeparator(c):this.addMenuItem(a,b[d],c)};
Menus.prototype.createPopupMenu=function(a,b,c){var d=this.editorUi.editor.graph;a.smartSeparators=true;if(d.isSelectionEmpty())this.addMenuItems(a,["undo","redo","-","paste","-"]);else{this.addMenuItems(a,["delete","-","cut","copy","-","duplicate"]);d.getSelectionCount()==1&&d.getModel().isEdge(d.getSelectionCell())&&this.addMenuItems(a,["setAsDefaultEdge"]);a.addSeparator()}if(d.getSelectionCount()>0){this.addMenuItems(a,["toFront","toBack","-"]);if(d.getModel().isEdge(d.getSelectionCell())){var e=
false;b=d.getSelectionCell();if(b!=null&&d.getModel().isEdge(b)){b=d.selectionCellsHandler.getHandler(b);if(b instanceof mxEdgeHandler&&b.bends!=null&&b.bends.length>2){c=b.getHandleForEvent(new mxMouseEvent(c));e=this.editorUi.actions.get("removeWaypoint");e.handler=b;e.index=c;e=c>0&&c<b.bends.length}}this.addMenuItems(a,["-",e?"removeWaypoint":"addWaypoint"])}else if(d.getSelectionCount()>1){a.addSeparator();this.addMenuItems(a,["group"])}a.addSeparator();d.getSelectionCount()==1&&d.getLinkForCell(d.getSelectionCell())!=
null&&this.addMenuItems(a,["openLink"])}else this.addMenuItems(a,["-","selectVertices","selectEdges","-","selectAll"])};Menus.prototype.createMenubar=function(a){a=new Menubar(this.editorUi,a);for(var b=["file","edit","view","format","text","arrange","options","help"],c=0;c<b.length;c++)a.addMenu(mxResources.get(b[c]),this.get(b[c]).funct);return a};function Menubar(a,b){this.editorUi=a;this.container=b;mxEvent.addGestureListeners(document,mxUtils.bind(this,function(){this.hideMenu()}))}
Menubar.prototype.hideMenu=function(){this.currentMenu!=null&&this.currentMenu.hideMenu()};Menubar.prototype.addMenu=function(a,b){var c=document.createElement("a");c.setAttribute("href","javascript:void(0);");c.className="geItem";mxUtils.write(c,a);this.addMenuHandler(c,b);this.container.appendChild(c);return c};
Menubar.prototype.addMenuHandler=function(a,b){if(b!=null){var c=true,d=mxUtils.bind(this,function(e){if(c&&a.enabled==null||a.enabled){this.editorUi.editor.graph.panningHandler.hideMenu();var f=new mxPopupMenu(b);f.div.className+=" geMenubarMenu";f.smartSeparators=true;f.showDisabled=true;f.autoExpand=true;f.hideMenu=mxUtils.bind(this,function(){mxPopupMenu.prototype.hideMenu.apply(f,arguments);f.destroy();this.currentElt=this.currentMenu=null});f.popup(a.offsetLeft+4,a.offsetTop+a.offsetHeight+
4,null,e);this.currentMenu=f;this.currentElt=a}c=true;mxEvent.consume(e)});mxEvent.addListener(a,"mousemove",mxUtils.bind(this,function(e){if(this.currentMenu!=null&&this.currentElt!=a){this.hideMenu();d(e)}}));mxEvent.addListener(a,"mousedown",mxUtils.bind(this,function(){c=this.currentElt!=a}));mxEvent.addListener(a,"click",d)}};function Menu(a,b){mxEventSource.call(this);this.funct=a;this.enabled=b!=null?b:true}mxUtils.extend(Menu,mxEventSource);
Menu.prototype.setEnabled=function(a){if(this.enabled!=a){this.enabled=a;this.fireEvent(new mxEventObject("stateChanged"))}};Menu.prototype.execute=function(a,b){this.funct(a,b)};(function(){function a(){}function b(){}function c(){}function d(){}function e(){}function f(){}function g(){}function h(){}function k(){mxRectangleShape.call(this)}function l(){}function m(){mxRectangleShape.call(this)}function p(){mxRectangleShape.call(this)}function o(){}function n(){}function s(){}function t(){}function q(){}function r(){}function u(){mxArrow.call(this)}a.prototype=new mxCylinder;a.prototype.constructor=a;a.prototype.size=20;a.prototype.redrawPath=function(v,B,M,J,L,T){B=Math.min(J,
Math.min(L,mxUtils.getValue(this.style,"size",this.size)));if(T){v.moveTo(B,L);v.lineTo(B,B);v.lineTo(0,0);v.moveTo(B,B);v.lineTo(J,B)}else{v.moveTo(0,0);v.lineTo(J-B,0);v.lineTo(J,B);v.lineTo(J,L);v.lineTo(B,L);v.lineTo(0,L-B);v.lineTo(0,0);v.close()}v.end()};mxCellRenderer.prototype.defaultShapes.cube=a;b.prototype=new mxCylinder;b.prototype.constructor=b;b.prototype.size=30;b.prototype.redrawPath=function(v,B,M,J,L,T){B=Math.min(J,Math.min(L,mxUtils.getValue(this.style,"size",this.size)));if(T){v.moveTo(J-
B,0);v.lineTo(J-B,B);v.lineTo(J,B)}else{v.moveTo(0,0);v.lineTo(J-B,0);v.lineTo(J,B);v.lineTo(J,L);v.lineTo(0,L);v.lineTo(0,0);v.close()}v.end()};mxCellRenderer.prototype.defaultShapes.note=b;c.prototype=new mxCylinder;c.prototype.constructor=c;c.prototype.tabWidth=60;c.prototype.tabHeight=20;c.prototype.tabPosition="right";c.prototype.redrawPath=function(v,B,M,J,L,T){var ka=mxUtils.getValue(this.style,"tabWidth",this.tabWidth);M=mxUtils.getValue(this.style,"tabHeight",this.tabHeight);B=mxUtils.getValue(this.style,
"tabPosition",this.tabPosition);ka=Math.min(J,ka);M=Math.min(L,M);if(T)if(B=="left"){v.moveTo(0,M);v.lineTo(ka,M)}else{v.moveTo(J-ka,M);v.lineTo(J,M)}else{if(B=="left"){v.moveTo(0,0);v.lineTo(ka,0);v.lineTo(ka,M);v.lineTo(J,M)}else{v.moveTo(0,M);v.lineTo(J-ka,M);v.lineTo(J-ka,0);v.lineTo(J,0)}v.lineTo(J,L);v.lineTo(0,L);v.lineTo(0,M);v.close()}v.end()};mxCellRenderer.prototype.defaultShapes.folder=c;d.prototype=new mxCylinder;d.prototype.constructor=d;d.prototype.size=30;d.prototype.redrawPath=function(v,
B,M,J,L,T){B=Math.min(J,Math.min(L,mxUtils.getValue(this.style,"size",this.size)));if(!T){v.moveTo(B,0);v.lineTo(J,0);v.lineTo(J,L);v.lineTo(0,L);v.lineTo(0,B);v.lineTo(B,0);v.close();v.end()}};mxCellRenderer.prototype.defaultShapes.card=d;e.prototype=new mxCylinder;e.prototype.constructor=e;e.prototype.size=0.4;e.prototype.redrawPath=function(v,B,M,J,L,T){B=mxUtils.getValue(this.style,"size",this.size);B*=L;if(!T){v.moveTo(0,B/2);v.quadTo(J/4,B*1.4,J/2,B/2);v.quadTo(J*3/4,B*(1-1.4),J,B/2);v.lineTo(J,
L-B/2);v.quadTo(J*3/4,L-B*1.4,J/2,L-B/2);v.quadTo(J/4,L-B*(1-1.4),0,L-B/2);v.lineTo(0,B/2);v.close();v.end()}};mxCellRenderer.prototype.defaultShapes.tape=e;f.prototype=new mxCylinder;f.prototype.constructor=f;f.prototype.size=0.3;f.prototype.redrawPath=function(v,B,M,J,L,T){B=mxUtils.getValue(this.style,"size",this.size);B*=L;if(!T){v.moveTo(0,0);v.lineTo(J,0);v.lineTo(J,L-B/2);v.quadTo(J*3/4,L-B*1.4,J/2,L-B/2);v.quadTo(J/4,L-B*(1-1.4),0,L-B/2);v.lineTo(0,B/2);v.close();v.end()}};mxCellRenderer.prototype.defaultShapes.document=
f;g.prototype=new mxCylinder;g.prototype.constructor=g;g.prototype.size=0.2;g.prototype.redrawPath=function(v,B,M,J,L,T){B=Math.min(J,Math.min(J,mxUtils.getValue(this.style,"size",this.size)*J));if(!T){v.moveTo(0,L);v.lineTo(B,0);v.lineTo(J,0);v.lineTo(J-B,L);v.close();v.end()}};mxCellRenderer.prototype.defaultShapes.parallelogram=g;h.prototype=new mxCylinder;h.prototype.constructor=h;h.prototype.size=0.2;h.prototype.redrawPath=function(v,B,M,J,L,T){B=Math.min(J,Math.min(J,mxUtils.getValue(this.style,
"size",this.size)*J));if(!T){v.moveTo(0,L);v.lineTo(B,0);v.lineTo(J-B,0);v.lineTo(J,L);v.close();v.end()}};mxCellRenderer.prototype.defaultShapes.trapezoid=h;mxUtils.extend(k,mxRectangleShape);k.prototype.size=0.1;k.prototype.isHtmlAllowed=function(){return false};k.prototype.getLabelBounds=function(v){var B=v.width,M=v.height;v=new mxRectangle(v.x,v.y,B,M);var J=Math.min(B,Math.min(B,mxUtils.getValue(this.style,"size",this.size)*B)+this.strokewidth);if(this.isRounded){var L=mxUtils.getValue(this.style,
mxConstants.STYLE_ARCSIZE,mxConstants.RECTANGLE_ROUNDING_FACTOR*100)/100;J=Math.max(J,Math.min(B*L,M*L))}v.x+=J;v.width-=2*J;return v};k.prototype.paintForeground=function(v,B,M,J,L){var T=Math.min(J,Math.min(J,mxUtils.getValue(this.style,"size",this.size)*J)+this.strokewidth);if(this.isRounded){var ka=mxUtils.getValue(this.style,mxConstants.STYLE_ARCSIZE,mxConstants.RECTANGLE_ROUNDING_FACTOR*100)/100;T=Math.max(T,Math.min(J*ka,L*ka))}v.begin();v.moveTo(B+T,M);v.lineTo(B+T,M+L);v.moveTo(B+J-T,M);
v.lineTo(B+J-T,M+L);v.end();v.stroke();mxRectangleShape.prototype.paintForeground.apply(this,arguments)};mxCellRenderer.prototype.defaultShapes.process=k;l.prototype=new mxCylinder;l.prototype.constructor=l;l.prototype.size=0.2;l.prototype.redrawPath=function(v,B,M,J,L,T){B=J*mxUtils.getValue(this.style,"size",this.size);if(!T){v.moveTo(0,0);v.lineTo(J-B,0);v.lineTo(J,L/2);v.lineTo(J-B,L);v.lineTo(0,L);v.lineTo(B,L/2);v.close();v.end()}};mxCellRenderer.prototype.defaultShapes.step=l;mxUtils.extend(m,
mxRectangleShape);m.prototype.isHtmlAllowed=function(){return false};m.prototype.paintForeground=function(v,B,M,J,L){var T=Math.min(J/5,L/5)+1;v.begin();v.moveTo(B+J/2,M+T);v.lineTo(B+J/2,M+L-T);v.moveTo(B+T,M+L/2);v.lineTo(B+J-T,M+L/2);v.end();v.stroke();mxRectangleShape.prototype.paintForeground.apply(this,arguments)};mxCellRenderer.prototype.defaultShapes.plus=m;mxUtils.extend(p,mxRectangleShape);p.prototype.isHtmlAllowed=function(){return false};p.prototype.paintForeground=function(v,B,M,J,L){if(this.style!=
null){if(this.style["double"]==1){var T=Math.max(2,this.strokewidth+1);mxRectangleShape.prototype.paintBackground.call(this,v,B+T,M+T,J-2*T,L-2*T);mxRectangleShape.prototype.paintForeground.apply(this,arguments);B+=T;M+=T;J-=2*T;L-=2*T}v.setDashed(false);T=0;var ka=null;do{ka=mxCellRenderer.prototype.defaultShapes[this.style["symbol"+T]];if(ka!=null){var F=this.style["symbol"+T+"Align"],G=this.style["symbol"+T+"VerticalAlign"],N=this.style["symbol"+T+"Width"],P=this.style["symbol"+T+"Height"],ea=
this.style["symbol"+T+"Spacing"]||0,Q=this.style["symbol"+T+"ArcSpacing"];if(Q!=null)ea+=this.getArcSize(J+this.strokewidth,L+this.strokewidth)*Q;Q=B;var aa=M;Q+=F==mxConstants.ALIGN_CENTER?(J-N)/2:F==mxConstants.ALIGN_RIGHT?J-N-ea:ea;aa+=G==mxConstants.ALIGN_MIDDLE?(L-P)/2:G==mxConstants.ALIGN_BOTTOM?L-P-ea:ea;v.save();F=new ka;F.style=this.style;ka.prototype.paintVertexShape.call(F,v,Q,aa,N,P);v.restore()}T++}while(ka!=null)}};mxCellRenderer.prototype.defaultShapes.ext=p;o.prototype=new mxCylinder;
o.prototype.constructor=o;o.prototype.redrawPath=function(v,B,M,J,L,T){if(T){v.moveTo(0,0);v.lineTo(J/2,L/2);v.lineTo(J,0);v.end()}else{v.moveTo(0,0);v.lineTo(J,0);v.lineTo(J,L);v.lineTo(0,L);v.close()}};mxCellRenderer.prototype.defaultShapes.message=o;n.prototype=new mxCylinder;n.prototype.constructor=n;n.prototype.addPipe=true;n.prototype.redrawPath=function(v,B,M,J,L,T){B=J/3;M=L/4;if(!T){v.moveTo(J/2,M);v.curveTo(J/2-B,M,J/2-B,0,J/2,0);v.curveTo(J/2+B,0,J/2+B,M,J/2,M);v.close();v.moveTo(J/2,M);
v.lineTo(J/2,2*L/3);v.moveTo(J/2,L/3);v.lineTo(0,L/3);v.moveTo(J/2,L/3);v.lineTo(J,L/3);v.moveTo(J/2,2*L/3);v.lineTo(0,L);v.moveTo(J/2,2*L/3);v.lineTo(J,L);v.end()}};mxCellRenderer.prototype.defaultShapes.umlActor=n;s.prototype=new mxCylinder;s.prototype.constructor=s;s.prototype.size=10;s.prototype.addPipe=true;s.prototype.redrawPath=function(v,B,M,J,L,T){B=mxUtils.getValue(this.style,"size",this.size);M=B*2/3;if(!T){v.moveTo(J/2,B);v.curveTo(J/2-M,B,J/2-M,0,J/2,0);v.curveTo(J/2+M,0,J/2+M,B,J/2,
B);v.close();v.moveTo(J/2,B);v.lineTo(J/2,L);v.end()}};mxCellRenderer.prototype.defaultShapes.lollipop=s;t.prototype=new mxCylinder;t.prototype.constructor=t;t.prototype.jettyWidth=32;t.prototype.jettyHeight=12;t.prototype.redrawPath=function(v,B,M,J,L,T){var ka=mxUtils.getValue(this.style,"jettyWidth",this.jettyWidth);B=mxUtils.getValue(this.style,"jettyHeight",this.jettyHeight);M=ka/2;ka=M+ka/2;var F=0.3*L-B/2,G=0.7*L-B/2;if(T){v.moveTo(M,F);v.lineTo(ka,F);v.lineTo(ka,F+B);v.lineTo(M,F+B);v.moveTo(M,
G);v.lineTo(ka,G);v.lineTo(ka,G+B);v.lineTo(M,G+B)}else{v.moveTo(M,0);v.lineTo(J,0);v.lineTo(J,L);v.lineTo(M,L);v.lineTo(M,G+B);v.lineTo(0,G+B);v.lineTo(0,G);v.lineTo(M,G);v.lineTo(M,F+B);v.lineTo(0,F+B);v.lineTo(0,F);v.lineTo(M,F);v.close()}v.end()};mxCellRenderer.prototype.defaultShapes.component=t;q.prototype=new mxDoubleEllipse;q.prototype.constructor=q;q.prototype.outerStroke=true;q.prototype.paintVertexShape=function(v,B,M,J,L){var T=Math.min(4,Math.min(J/5,L/5));if(J>0&&L>0){v.ellipse(B+T,
M+T,J-2*T,L-2*T);v.fillAndStroke()}v.setShadow(false);if(this.outerStroke){v.ellipse(B,M,J,L);v.stroke()}};mxCellRenderer.prototype.defaultShapes.endState=q;r.prototype=new q;r.prototype.constructor=r;r.prototype.outerStroke=false;mxCellRenderer.prototype.defaultShapes.startState=r;var x=mxImageExport.prototype.initShapes;mxImageExport.prototype.initShapes=function(){function v(B){return{drawShape:function(M,J,L,T){J=L.x;var ka=L.y,F=L.width;L=L.height;if(T){T=Math.min(4,Math.min(F/5,L/5));J+=T;ka+=
T;F-=2*T;L-=2*T;F>0&&L>0&&M.ellipse(J,ka,F,L);return true}else{M.fillAndStroke();if(B){M.ellipse(J,ka,F,L);M.stroke()}}}}}x.apply(this,arguments);this.shapes.endState=v(true);this.shapes.startState=v(false)};mxUtils.extend(u,mxArrow);u.prototype.paintEdgeShape=function(v,B){var M=B[0],J=B[B.length-1],L=J.x-M.x;J=J.y-M.y;var T=Math.sqrt(L*L+J*J),ka=L/T,F=J/T;L=10*F/3;J=-10*ka/3;var G=M.x-L/2;M=M.y-J/2;var N=G+L,P=M+J;ka=N+T*ka;T=P+T*F;F=ka+L-3*L;var ea=T+J-3*J;v.begin();v.moveTo(N,P);v.lineTo(ka,T);
v.moveTo(F+L,ea+J);v.lineTo(G,M);v.stroke()};mxCellRenderer.prototype.defaultShapes.link=u;mxMarker.addMarker("dash",function(v,B,M,J,L,T,ka,F,G){var N=L*(ka+G+1),P=T*(ka+G+1);return function(){v.begin();v.moveTo(J.x-N/2-P/2,J.y-P/2+N/2);v.lineTo(J.x+P/2-3*N/2,J.y-3*P/2-N/2);v.stroke()}});if(typeof mxVertexHandler!="undefined"){var A=function(v){mxVertexHandler.call(this,v)};mxUtils.extend(A,mxVertexHandler);A.prototype.useGridForSpecialHandle=false;A.prototype.init=function(){this.horizontal=mxUtils.getValue(this.state.style,
mxConstants.STYLE_HORIZONTAL,true);var v=this.state.view.graph;if(this.handleImage!=null){var B=new mxRectangle(0,0,this.handleImage.width,this.handleImage.height);this.specialHandle=new mxImageShape(B,this.handleImage.src)}else{B=new mxRectangle(0,0,10,10);this.specialHandle=new mxRhombus(B,mxConstants.HANDLE_FILLCOLOR,mxConstants.HANDLE_STROKECOLOR)}this.specialHandle.dialect=v.dialect!=mxConstants.DIALECT_SVG?mxConstants.DIALECT_VML:mxConstants.DIALECT_SVG;this.specialHandle.init(v.getView().getOverlayPane());
this.specialHandle.node.style.cursor=this.getSpecialHandleCursor();if(!v.isCellRotatable(this.state.cell))this.specialHandle.node.style.display="none";mxEvent.redirectMouseEvents(this.specialHandle.node,v,this.state);mxVertexHandler.prototype.init.apply(this,arguments)};A.prototype.getSpecialHandleCursor=function(){return"default"};A.prototype.redrawHandles=function(){mxVertexHandler.prototype.redrawHandles.apply(this,arguments);this.specialHandle.bounds=this.getSpecialHandleBounds(this.specialHandle.bounds.width);
this.specialHandle.redraw()};A.prototype.destroy=function(){mxVertexHandler.prototype.destroy.apply(this,arguments);if(this.specialHandle!=null){this.specialHandle.destroy();this.specialHandle=null}};A.prototype.getHandleForEvent=function(v){if(v.isSource(this.specialHandle))return-99;return mxVertexHandler.prototype.getHandleForEvent.apply(this,arguments)};A.prototype.mouseMove=function(v,B){if(!B.isConsumed()&&this.index==-99){var M=new mxPoint(B.getGraphX(),B.getGraphY());this.constrainPoint(M);
var J=this.graph.isGridEnabledEvent(B.getEvent()),L=this.graph.getView().scale;if(J&&this.useGridForSpecialHandle){M.x=this.graph.snap(M.x/L)*L;M.y=this.graph.snap(M.y/L)*L}this.updateStyle(M);this.state.view.graph.cellRenderer.redraw(this.state,true);mxClient.IS_TOUCH||this.moveSizerTo(this.specialHandle,M.x,M.y);B.consume()}else mxVertexHandler.prototype.mouseMove.apply(this,arguments)};A.prototype.mouseUp=function(v,B){if(!B.isConsumed()&&this.index==-99){this.applyStyle();this.reset();B.consume()}else mxVertexHandler.prototype.mouseUp.apply(this,
arguments)};A.prototype.getSpecialHandleBounds=function(v){var B=this.state.shape.getShapeRotation(),M=mxUtils.toRadians(B);B=Math.cos(M);M=Math.sin(M);var J=new mxRectangle(this.state.x,this.state.y,this.state.width,this.state.height);if(this.state.shape.isPaintBoundsInverted()){var L=(J.width-J.height)/2;J.x+=L;J.y-=L;L=J.width;J.width=J.height;J.height=L}L=this.getSpecialHandlePoint(J);if(this.state.shape.flipH)L.x=2*J.x+J.width-L.x;if(this.state.shape.flipV)L.y=2*J.y+J.height-L.y;L=mxUtils.getRotatedPoint(L,
B,M,new mxPoint(this.state.getCenterX(),this.state.getCenterY()));return new mxRectangle(L.x-v/2,L.y-v/2,v,v)};A.prototype.getSpecialHandlePoint=function(){return null};A.prototype.updateStyle=function(){};A.prototype.constrainPoint=function(v){v.x=Math.max(this.state.x,Math.min(this.state.x+this.state.width,v.x));v.y=Math.max(this.state.y,Math.min(this.state.y+this.state.height,v.y))};A.prototype.applyStyle=function(){};var H=function(v){mxVertexHandler.call(this,v)};mxUtils.extend(H,A);H.prototype.getSpecialHandlePoint=
function(v){var B=this.graph.getView().scale,M=Math.min(v.width,mxUtils.getValue(this.state.style,"tabWidth",60)*B);B=Math.min(v.height,mxUtils.getValue(this.state.style,"tabHeight",20)*B);M=mxUtils.getValue(this.state.style,"tabPosition","right")=="left"?v.x+M:v.x+v.width-M;return new mxPoint(M,v.y+B)};H.prototype.updateStyle=function(v){var B=this.state.shape.getShapeRotation();B=mxUtils.toRadians(B);var M=Math.cos(-B),J=Math.sin(-B),L=new mxRectangle(this.state.x,this.state.y,this.state.width,
this.state.height);if(this.state.shape.isPaintBoundsInverted()){var T=(L.width-L.height)/2;L.x+=T;L.y-=T;T=L.width;L.width=L.height;L.height=T}T=new mxPoint(v.x,v.y);T=mxUtils.getRotatedPoint(T,M,J,new mxPoint(this.state.getCenterX(),this.state.getCenterY()));if(this.state.shape.flipH)T.x=2*L.x+L.width-T.x;if(this.state.shape.flipV)T.y=2*L.y+L.height-T.y;T=this.updateStyleUnrotated(T,L);if(T!=null){if(this.state.shape.flipH)T.x=2*L.x+L.width-T.x;if(this.state.shape.flipV)T.y=2*L.y+L.height-T.y;M=
Math.cos(B);J=Math.sin(B);T=mxUtils.getRotatedPoint(T,M,J,new mxPoint(this.state.getCenterX(),this.state.getCenterY()));v.x=T.x;v.y=T.y}};H.prototype.updateStyleUnrotated=function(v,B){var M=mxUtils.getValue(this.state.style,"tabPosition","right")=="left"?v.x-B.x:B.x+B.width-v.x,J=v.y-B.y,L=this.graph.getView().scale;this.state.style.tabWidth=Math.round(Math.max(1,M)/L);this.state.style.tabHeight=Math.round(Math.max(1,J)/L)};H.prototype.applyStyle=function(){var v=this.graph.getModel();v.beginUpdate();
try{this.state.view.graph.setCellStyles("tabWidth",this.state.style.tabWidth,[this.state.cell]);this.state.view.graph.setCellStyles("tabHeight",this.state.style.tabHeight,[this.state.cell])}finally{v.endUpdate()}};A=function(v){mxVertexHandler.call(this,v)};mxUtils.extend(A,H);A.prototype.getSpecialHandlePoint=function(v){var B=this.graph.getView().scale,M=mxUtils.getValue(this.state.style,mxConstants.STYLE_STARTSIZE,mxConstants.DEFAULT_STARTSIZE);return new mxPoint(v.x+v.width/2,v.y+Math.min(v.height,
M*B))};A.prototype.updateStyleUnrotated=function(v,B){v.x=B.x+B.width/2;startSize=v.y-B.y;var M=this.graph.getView().scale;this.state.style.startSize=Math.round(Math.max(1,startSize)/M);return v};A.prototype.applyStyle=function(){this.state.view.graph.setCellStyles("startSize",this.state.style.startSize,[this.state.cell])};var D=function(v){mxVertexHandler.call(this,v)};mxUtils.extend(D,H);D.prototype.defaultValue=20;D.prototype.scaleFactor=1;D.prototype.getSpecialHandlePoint=function(v){var B=this.graph.getView().scale;
B=Math.min(v.width,Math.min(v.height,mxUtils.getValue(this.state.style,"size",this.defaultValue)*B/this.scaleFactor));return new mxPoint(v.x+B,v.y+B)};D.prototype.updateStyleUnrotated=function(v,B){var M=Math.max(0,Math.min(Math.min(B.width/this.scaleFactor,v.x-B.x),Math.min(B.height/this.scaleFactor,v.y-B.y))),J=this.graph.getView().scale;this.state.style.size=Math.round(Math.max(1,M)/J)*this.scaleFactor;return new mxPoint(B.x+M,B.y+M)};D.prototype.applyStyle=function(){this.state.view.graph.setCellStyles("size",
this.state.style.size,[this.state.cell])};var y=function(v){mxVertexHandler.call(this,v)};mxUtils.extend(y,D);y.prototype.defaultValue=30;y.prototype.scaleFactor=2;var z=function(v){mxVertexHandler.call(this,v)};mxUtils.extend(z,D);z.prototype.defaultValue=30;z.prototype.scaleFactor=1;z.prototype.getSpecialHandlePoint=function(v){var B=this.graph.getView().scale;B=Math.min(v.width,Math.min(v.height,mxUtils.getValue(this.state.style,"size",this.defaultValue)*B/this.scaleFactor));return new mxPoint(v.x+
v.width-B,v.y+B)};z.prototype.updateStyleUnrotated=function(v,B){var M=Math.max(0,Math.min(Math.min(B.width/this.scaleFactor,v.x-B.x+B.width),Math.min(B.height/this.scaleFactor,v.y-B.y))),J=this.graph.getView().scale;this.state.style.size=Math.round(Math.max(1,M)/J)*this.scaleFactor;return new mxPoint(B.x+B.width-M,B.y+M)};var I=function(v){mxVertexHandler.call(this,v)};mxUtils.extend(I,D);I.prototype.defaultValue=0.2;I.prototype.scaleFactor=1;I.prototype.getSpecialHandlePoint=function(v){var B=mxUtils.getValue(this.state.style,
"size",this.defaultValue);return new mxPoint(v.x+v.width*B,v.y+v.height/2)};I.prototype.updateStyleUnrotated=function(v,B){var M=Math.min(1,(v.x-B.x)/B.width);this.state.style.size=M;return new mxPoint(B.x+M*B.width,B.y+B.height/2)};var ga=function(v){mxVertexHandler.call(this,v)};mxUtils.extend(ga,D);ga.prototype.defaultValue=0.4;ga.prototype.scaleFactor=1;ga.prototype.getSpecialHandlePoint=function(v){var B=mxUtils.getValue(this.state.style,"size",this.defaultValue);return new mxPoint(v.x+v.width/
2,v.y+B*v.height/2)};ga.prototype.updateStyleUnrotated=function(v,B){var M=Math.max(0,Math.min(1,(v.y-B.y)/B.height*2));this.state.style.size=M;return new mxPoint(B.x+B.width/2,B.y+M*B.height/2)};var E=function(v){mxVertexHandler.call(this,v)};mxUtils.extend(E,D);E.prototype.defaultValue=0.1;E.prototype.scaleFactor=1;E.prototype.getSpecialHandlePoint=function(v){var B=mxUtils.getValue(this.state.style,"size",this.defaultValue);return new mxPoint(v.x+B*v.width,v.y+v.height/4)};E.prototype.updateStyleUnrotated=
function(v,B){var M=Math.max(0,Math.min(1,(v.x-B.x)/B.width));this.state.style.size=M;return new mxPoint(B.x+M*B.width,B.y+B.height/4)};var C=function(v){mxVertexHandler.call(this,v)};mxUtils.extend(C,D);C.prototype.defaultValue=0.2;C.prototype.scaleFactor=1;C.prototype.maxSize=0.5;C.prototype.getSpecialHandlePoint=function(v){var B=mxUtils.getValue(this.state.style,"size",this.defaultValue);return new mxPoint(v.x+B*v.width*0.75,v.y+v.height/4)};C.prototype.updateStyleUnrotated=function(v,B){var M=
Math.max(0,Math.min(this.maxSize,(v.x-B.x)/(B.width*0.75)));this.state.style.size=M;return new mxPoint(B.x+M*B.width*0.75,B.y+B.height/4)};var O=function(v){mxVertexHandler.call(this,v)};mxUtils.extend(O,C);O.prototype.maxSize=1;var U=function(v){mxVertexHandler.call(this,v)};mxUtils.extend(U,D);U.prototype.defaultValue=0.3;U.prototype.fy=1.4;U.prototype.scaleFactor=1;U.prototype.getSpecialHandlePoint=function(v){var B=mxUtils.getValue(this.state.style,"size",this.defaultValue)*v.height;return new mxPoint(v.x+
3*v.width/4,v.y+v.height-B)};U.prototype.updateStyleUnrotated=function(v,B){var M=Math.max(0,Math.min(1,(B.y+B.height-v.y)/B.height));this.state.style.size=M;return new mxPoint(B.x+3*B.width/4,B.y+B.height-M*B.height)};var W={swimlane:A,folder:H,cube:D,card:y,note:z,step:I,tape:ga,process:E,document:U,trapezoid:C,parallelogram:O},Y=mxGraph.prototype.createHandler;mxGraph.prototype.createHandler=function(v){if(v!=null){var B=W[v.style.shape];if(B!=null)return new B(v)}return Y.apply(this,arguments)}}mxGraph.prototype.getAllConnectionConstraints=
function(v){if(v!=null&&v.shape!=null)if(v.shape.stencil!=null){if(v.shape.stencil!=null)return v.shape.stencil.constraints}else if(v.shape.constraints!=null)return v.shape.constraints;return null};mxRectangleShape.prototype.constraints=[new mxConnectionConstraint(new mxPoint(0.25,0),true),new mxConnectionConstraint(new mxPoint(0.5,0),true),new mxConnectionConstraint(new mxPoint(0.75,0),true),new mxConnectionConstraint(new mxPoint(0,0.25),true),new mxConnectionConstraint(new mxPoint(0,0.5),true),
new mxConnectionConstraint(new mxPoint(0,0.75),true),new mxConnectionConstraint(new mxPoint(1,0.25),true),new mxConnectionConstraint(new mxPoint(1,0.5),true),new mxConnectionConstraint(new mxPoint(1,0.75),true),new mxConnectionConstraint(new mxPoint(0.25,1),true),new mxConnectionConstraint(new mxPoint(0.5,1),true),new mxConnectionConstraint(new mxPoint(0.75,1),true)];mxLabel.prototype.constraints=mxRectangleShape.prototype.constraints;mxImageShape.prototype.constraints=mxRectangleShape.prototype.constraints;
mxSwimlane.prototype.constraints=mxRectangleShape.prototype.constraints;m.prototype.constraints=mxRectangleShape.prototype.constraints;b.prototype.constraints=mxRectangleShape.prototype.constraints;d.prototype.constraints=mxRectangleShape.prototype.constraints;a.prototype.constraints=mxRectangleShape.prototype.constraints;c.prototype.constraints=mxRectangleShape.prototype.constraints;mxCylinder.prototype.constraints=[new mxConnectionConstraint(new mxPoint(0.15,0.05),false),new mxConnectionConstraint(new mxPoint(0.5,
0),true),new mxConnectionConstraint(new mxPoint(0.85,0.05),false),new mxConnectionConstraint(new mxPoint(0,0.3),true),new mxConnectionConstraint(new mxPoint(0,0.5),true),new mxConnectionConstraint(new mxPoint(0,0.7),true),new mxConnectionConstraint(new mxPoint(1,0.3),true),new mxConnectionConstraint(new mxPoint(1,0.5),true),new mxConnectionConstraint(new mxPoint(1,0.7),true),new mxConnectionConstraint(new mxPoint(0.15,0.95),false),new mxConnectionConstraint(new mxPoint(0.5,1),true),new mxConnectionConstraint(new mxPoint(0.85,
0.95),false)];n.prototype.constraints=[new mxConnectionConstraint(new mxPoint(0.25,0.1),false),new mxConnectionConstraint(new mxPoint(0.5,0),false),new mxConnectionConstraint(new mxPoint(0.75,0.1),false),new mxConnectionConstraint(new mxPoint(0,1/3),false),new mxConnectionConstraint(new mxPoint(0,1),false),new mxConnectionConstraint(new mxPoint(1,1/3),false),new mxConnectionConstraint(new mxPoint(1,1),false),new mxConnectionConstraint(new mxPoint(0.5,0.5),false)];t.prototype.constraints=[new mxConnectionConstraint(new mxPoint(0.25,
0),true),new mxConnectionConstraint(new mxPoint(0.5,0),true),new mxConnectionConstraint(new mxPoint(0.75,0),true),new mxConnectionConstraint(new mxPoint(0,0.3),true),new mxConnectionConstraint(new mxPoint(0,0.7),true),new mxConnectionConstraint(new mxPoint(1,0.25),true),new mxConnectionConstraint(new mxPoint(1,0.5),true),new mxConnectionConstraint(new mxPoint(1,0.75),true),new mxConnectionConstraint(new mxPoint(0.25,1),true),new mxConnectionConstraint(new mxPoint(0.5,1),true),new mxConnectionConstraint(new mxPoint(0.75,
1),true)];mxActor.prototype.constraints=[new mxConnectionConstraint(new mxPoint(0.5,0),true),new mxConnectionConstraint(new mxPoint(0.25,0.2),false),new mxConnectionConstraint(new mxPoint(0.1,0.5),false),new mxConnectionConstraint(new mxPoint(0,0.75),true),new mxConnectionConstraint(new mxPoint(0.75,0.25),false),new mxConnectionConstraint(new mxPoint(0.9,0.5),false),new mxConnectionConstraint(new mxPoint(1,0.75),true),new mxConnectionConstraint(new mxPoint(0.25,1),true),new mxConnectionConstraint(new mxPoint(0.5,
1),true),new mxConnectionConstraint(new mxPoint(0.75,1),true)];e.prototype.constraints=[new mxConnectionConstraint(new mxPoint(0,0.35),false),new mxConnectionConstraint(new mxPoint(0,0.5),false),new mxConnectionConstraint(new mxPoint(0,0.65),false),new mxConnectionConstraint(new mxPoint(1,0.35),false),new mxConnectionConstraint(new mxPoint(1,0.5),false),new mxConnectionConstraint(new mxPoint(1,0.65),false),new mxConnectionConstraint(new mxPoint(0.25,1),false),new mxConnectionConstraint(new mxPoint(0.75,
0),false)];l.prototype.constraints=[new mxConnectionConstraint(new mxPoint(0.25,0),true),new mxConnectionConstraint(new mxPoint(0.5,0),true),new mxConnectionConstraint(new mxPoint(0.75,0),true),new mxConnectionConstraint(new mxPoint(0.25,1),true),new mxConnectionConstraint(new mxPoint(0.5,1),true),new mxConnectionConstraint(new mxPoint(0.75,1),true),new mxConnectionConstraint(new mxPoint(0.1,0.25),false),new mxConnectionConstraint(new mxPoint(0.2,0.5),false),new mxConnectionConstraint(new mxPoint(0.1,
0.75),false),new mxConnectionConstraint(new mxPoint(0.9,0.25),false),new mxConnectionConstraint(new mxPoint(1,0.5),false),new mxConnectionConstraint(new mxPoint(0.9,0.75),false)];mxLine.prototype.constraints=[new mxConnectionConstraint(new mxPoint(0,0.5),false),new mxConnectionConstraint(new mxPoint(0.25,0.5),false),new mxConnectionConstraint(new mxPoint(0.75,0.5),false),new mxConnectionConstraint(new mxPoint(1,0.5),false)];s.prototype.constraints=[new mxConnectionConstraint(new mxPoint(0.5,0),false),
new mxConnectionConstraint(new mxPoint(0.5,1),false)];mxEllipse.prototype.constraints=[new mxConnectionConstraint(new mxPoint(0,0),true),new mxConnectionConstraint(new mxPoint(1,0),true),new mxConnectionConstraint(new mxPoint(0,1),true),new mxConnectionConstraint(new mxPoint(1,1),true),new mxConnectionConstraint(new mxPoint(0.5,0),true),new mxConnectionConstraint(new mxPoint(0.5,1),true),new mxConnectionConstraint(new mxPoint(0,0.5),true),new mxConnectionConstraint(new mxPoint(1,0.5))];mxDoubleEllipse.prototype.constraints=
mxEllipse.prototype.constraints;mxRhombus.prototype.constraints=mxEllipse.prototype.constraints;mxTriangle.prototype.constraints=[new mxConnectionConstraint(new mxPoint(0,0.25),true),new mxConnectionConstraint(new mxPoint(0,0.5),true),new mxConnectionConstraint(new mxPoint(0,0.75),true),new mxConnectionConstraint(new mxPoint(0.5,0),true),new mxConnectionConstraint(new mxPoint(0.5,1),true),new mxConnectionConstraint(new mxPoint(1,0.5),true)];mxHexagon.prototype.constraints=[new mxConnectionConstraint(new mxPoint(0.375,
0),true),new mxConnectionConstraint(new mxPoint(0.5,0),true),new mxConnectionConstraint(new mxPoint(0.625,0),true),new mxConnectionConstraint(new mxPoint(0.125,0.25),false),new mxConnectionConstraint(new mxPoint(0,0.5),true),new mxConnectionConstraint(new mxPoint(0.125,0.75),false),new mxConnectionConstraint(new mxPoint(0.875,0.25),false),new mxConnectionConstraint(new mxPoint(0,0.5),true),new mxConnectionConstraint(new mxPoint(1,0.5),true),new mxConnectionConstraint(new mxPoint(0.875,0.75),false),
new mxConnectionConstraint(new mxPoint(0.375,1),true),new mxConnectionConstraint(new mxPoint(0.5,1),true),new mxConnectionConstraint(new mxPoint(0.625,1),true)];mxCloud.prototype.constraints=[new mxConnectionConstraint(new mxPoint(0.25,0.25),false),new mxConnectionConstraint(new mxPoint(0.4,0.1),false),new mxConnectionConstraint(new mxPoint(0.16,0.55),false),new mxConnectionConstraint(new mxPoint(0.07,0.4),false),new mxConnectionConstraint(new mxPoint(0.31,0.8),false),new mxConnectionConstraint(new mxPoint(0.13,
0.77),false),new mxConnectionConstraint(new mxPoint(0.8,0.8),false),new mxConnectionConstraint(new mxPoint(0.55,0.95),false),new mxConnectionConstraint(new mxPoint(0.875,0.5),false),new mxConnectionConstraint(new mxPoint(0.96,0.7),false),new mxConnectionConstraint(new mxPoint(0.625,0.2),false),new mxConnectionConstraint(new mxPoint(0.88,0.25),false)];g.prototype.constraints=mxRectangleShape.prototype.constraints;h.prototype.constraints=mxRectangleShape.prototype.constraints;f.prototype.constraints=
[new mxConnectionConstraint(new mxPoint(0.25,0),true),new mxConnectionConstraint(new mxPoint(0.5,0),true),new mxConnectionConstraint(new mxPoint(0.75,0),true),new mxConnectionConstraint(new mxPoint(0,0.25),true),new mxConnectionConstraint(new mxPoint(0,0.5),true),new mxConnectionConstraint(new mxPoint(0,0.75),true),new mxConnectionConstraint(new mxPoint(1,0.25),true),new mxConnectionConstraint(new mxPoint(1,0.5),true),new mxConnectionConstraint(new mxPoint(1,0.75),true)];mxArrow.prototype.constraints=
null})();function Sidebar(a,b,c){this.choices=c;this.editorUi=a;this.container=b;this.palettes={};this.showTooltips=true;this.graph=new Graph(document.createElement("div"),null,null,this.editorUi.editor.graph.getStylesheet());this.graph.resetViewOnRootChange=false;this.graph.foldingEnabled=false;this.graph.setConnectable(false);this.graph.autoScroll=false;this.graph.setTooltips(false);this.graph.setEnabled(false);this.graph.container.style.visibility="hidden";this.graph.container.style.position="absolute";
document.body.appendChild(this.graph.container);if(!mxClient.IS_TOUCH){mxEvent.addListener(document,"mouseup",mxUtils.bind(this,function(){this.showTooltips=true}));mxEvent.addListener(b,"scroll",mxUtils.bind(this,function(){this.showTooltips=true}));mxEvent.addListener(document,"mousedown",mxUtils.bind(this,function(){this.showTooltips=false;this.hideTooltip()}));mxEvent.addListener(document,"mousemove",mxUtils.bind(this,function(d){for(d=mxEvent.getSource(d);d!=null;){if(d==this.currentElt)return;
d=d.parentNode}this.hideTooltip()}));mxEvent.addListener(document,"mouseout",mxUtils.bind(this,function(d){d.toElement==null&&d.relatedTarget==null&&this.hideTooltip()}))}this.init();(new Image).src=IMAGE_PATH+"/tooltip.png"}
Sidebar.prototype.init=function(){for(var a=STENCIL_PATH,b=0;b<this.choices.length;b++){element=this.choices[b];if(element=="general")this.addGeneralPalette(true);else if(element=="basic")this.addStencilPalette("basic",mxResources.get("basic"),a+"/basic.xml",";fillColor=#ffffff;strokeColor=#000000;strokeWidth=2");else if(element=="arrows")this.addStencilPalette("arrows",mxResources.get("arrows"),a+"/arrows.xml",";fillColor=#ffffff;strokeColor=#000000;strokeWidth=2");else if(element=="uml")this.addUmlPalette(true);
else if(element=="bmpn")this.addBpmnPalette(a,false);else if(element=="electrical"){this.addStencilPalette("electrical","Electrical / Abstract ",a+"/electrical/abstract.xml",";fillColor=#ffffff;strokeColor=#000000;strokeWidth=2");this.addStencilPalette("electrical","Electrical / Capacitors",a+"/electrical/capacitors.xml",";fillColor=#ffffff;strokeColor=#000000;strokeWidth=2");this.addStencilPalette("electrical","Electrical / Diodes ",a+"/electrical/diodes.xml",";fillColor=#ffffff;strokeColor=#000000;strokeWidth=2");
this.addStencilPalette("electrical","Electrical / Electro-mechanical ",a+"/electrical/electro-mechanical.xml",";fillColor=#ffffff;strokeColor=#000000;strokeWidth=2");this.addStencilPalette("electrical","Electrical / IEC Logic Gates ",a+"/electrical/iec_logic_gates.xml",";fillColor=#ffffff;strokeColor=#000000;strokeWidth=2");this.addStencilPalette("electrical","Electrical / Inductors ",a+"/electrical/inductors.xml",";fillColor=#ffffff;strokeColor=#000000;strokeWidth=2");this.addStencilPalette("electrical",
"Electrical / Instruments ",a+"/electrical/instruments.xml",";fillColor=#ffffff;strokeColor=#000000;strokeWidth=2");this.addStencilPalette("electrical","Electrical / Logic Gates ",a+"/electrical/logic_gates.xml",";fillColor=#ffffff;strokeColor=#000000;strokeWidth=2");this.addStencilPalette("electrical","Electrical / Miscellaneous ",a+"/electrical/miscellaneous.xml",";fillColor=#ffffff;strokeColor=#000000;strokeWidth=2");this.addStencilPalette("electrical","Electrical / Op Amps ",a+"/electrical/op_amps.xml",
";fillColor=#ffffff;strokeColor=#000000;strokeWidth=2");this.addStencilPalette("electrical","Electrical / Opto-Electronics ",a+"/electrical/opto-electronics.xml",";fillColor=#ffffff;strokeColor=#000000;strokeWidth=2");this.addStencilPalette("electrical","Electrical / PLC Ladder ",a+"/electrical/plc_ladder.xml",";fillColor=#ffffff;strokeColor=#000000;strokeWidth=2");this.addStencilPalette("electrical","Electrical / Power Semiconductors ",a+"/electrical/power_semiconductors.xml",";fillColor=#ffffff;strokeColor=#000000;strokeWidth=2");
this.addStencilPalette("electrical","Electrical / Radio ",a+"/electrical/radio.xml",";fillColor=#ffffff;strokeColor=#000000;strokeWidth=2");this.addStencilPalette("electrical","Electrical / Resistors ",a+"/electrical/resistors.xml",";fillColor=#ffffff;strokeColor=#000000;strokeWidth=2");this.addStencilPalette("electrical","Electrical / Signal Sources ",a+"/electrical/signal_sources.xml",";fillColor=#ffffff;strokeColor=#000000;strokeWidth=2");this.addStencilPalette("electrical","Electrical / Thermionic Devices ",
a+"/electrical/thermionic_devices.xml",";fillColor=#ffffff;strokeColor=#000000;strokeWidth=2");this.addStencilPalette("electrical","Electrical / Transistors",a+"/electrical/transistors.xml",";fillColor=#ffffff;strokeColor=#000000;strokeWidth=2");this.addStencilPalette("electrical","Electrical / Waveforms ",a+"/electrical/waveforms.xml",";fillColor=#ffffff;strokeColor=#000000;strokeWidth=2")}else if(element=="flowchart")this.addStencilPalette("flowchart","Flowchart",a/+"/flowchart.xml",";fillColor=#ffffff;strokeColor=#000000;strokeWidth=2");
else if(element=="aws"){this.addStencilPalette("aws","AWS / Compute ",a+"/aws/compute.xml",";fillColor=#ffffff;strokeColor=#000000;strokeWidth=2");this.addStencilPalette("aws","AWS / Content Delivery ",a+"/aws/content_delivery.xml",";fillColor=#ffffff;strokeColor=#000000;strokeWidth=2");this.addStencilPalette("aws","AWS / Database ",a+"/aws/database.xml",";fillColor=#ffffff;strokeColor=#000000;strokeWidth=2");this.addStencilPalette("aws","AWS / Deployment ",a+"/aws/deployment_management.xml",";fillColor=#ffffff;strokeColor=#000000;strokeWidth=2");
this.addStencilPalette("aws","AWS / Groups ",a+"/aws/groups.xml",";fillColor=#ffffff;strokeColor=#000000;strokeWidth=2");this.addStencilPalette("aws","AWS / Messaging ",a+"/aws/messaging.xml",";fillColor=#ffffff;strokeColor=#000000;strokeWidth=2");this.addStencilPalette("aws","AWS / Miscellaneous ",a+"/aws/misc.xml",";fillColor=#ffffff;strokeColor=#000000;strokeWidth=2");this.addStencilPalette("aws","AWS / Networking ",a+"/aws/networking.xml",";fillColor=#ffffff;strokeColor=#000000;strokeWidth=2");
this.addStencilPalette("aws","AWS / Non Service Specific ",a+"/aws/non_service_specific.xml",";fillColor=#ffffff;strokeColor=#000000;strokeWidth=2");this.addStencilPalette("aws","AWS / On Demand ",a+"/aws/on_demand_workforce.xml",";fillColor=#ffffff;strokeColor=#000000;strokeWidth=2");this.addStencilPalette("aws","AWS / Storage ",a+"/aws/storage.xml",";fillColor=#ffffff;strokeColor=#000000;strokeWidth=2")}else element=="image"&&this.addImagePalette("clipart",mxResources.get("clipart"),a+"/clipart/",
"_128x128.png",["Earth_globe","Empty_Folder","Full_Folder","Gear","Lock","Software","Virus","Email","Database","Router_Icon","iPad","iMac","Laptop","MacBook","Monitor_Tower","Printer","Server_Tower","Workstation","Firewall_02","Wireless_Router_N","Credit_Card","Piggy_Bank","Graph","Safe","Shopping_Cart","Suit1","Suit2","Suit3","Pilot1","Worker1","Soldier1","Doctor1","Tech1","Security1","Telesales1"])}};Sidebar.prototype.enableTooltips=!mxClient.IS_TOUCH;Sidebar.prototype.tooltipBorder=16;
Sidebar.prototype.thumbBorder=3;Sidebar.prototype.tooltipDelay=300;Sidebar.prototype.installEdges=true;Sidebar.prototype.gearImage=STENCIL_PATH+"/clipart/Gear_128x128.png";Sidebar.prototype.thumbWidth=34;Sidebar.prototype.thumbHeight=34;Sidebar.prototype.thumbPadding=2;Sidebar.prototype.sidebarTitleSize=9;Sidebar.prototype.sidebarTitles=true;Sidebar.prototype.tooltipTitles=true;
Sidebar.prototype.showTooltip=function(a,b,c,d){if(this.enableTooltips&&this.showTooltips)if(this.currentElt!=a){if(this.thread!=null){window.clearTimeout(this.thread);this.thread=null}var e=mxUtils.bind(this,function(){if(this.tooltip==null){this.tooltip=document.createElement("div");this.tooltip.className="geSidebarTooltip";document.body.appendChild(this.tooltip);this.graph2=new Graph(this.tooltip,null,null,this.editorUi.editor.graph.getStylesheet());this.graph2.view.setTranslate(this.tooltipBorder,
this.tooltipBorder);this.graph2.resetViewOnRootChange=false;this.graph2.foldingEnabled=false;this.graph2.autoScroll=false;this.graph2.setTooltips(false);this.graph2.setConnectable(false);this.graph2.setEnabled(false);if(!mxClient.IS_SVG)this.graph2.view.canvas.style.position="relative";this.tooltipImage=mxUtils.createImage(IMAGE_PATH+"/tooltip.png");this.tooltipImage.style.position="absolute";this.tooltipImage.style.width="14px";this.tooltipImage.style.height="27px";document.body.appendChild(this.tooltipImage)}this.tooltip.style.display=
"block";this.graph2.labelsVisible=d==null||d;this.graph2.model.clear();this.graph2.addCells(b);var f=this.graph2.getGraphBounds(),g=f.width+2*this.tooltipBorder,h=f.height+2*this.tooltipBorder;if(mxClient.IS_QUIRKS){g+=4;h+=4;this.tooltip.style.overflow="hidden"}else this.tooltip.style.overflow="visible";this.tooltipImage.style.visibility="visible";this.tooltip.style.width=g+"px";if(this.tooltipTitles&&c!=null&&c.length>0){if(this.tooltipTitle==null){this.tooltipTitle=document.createElement("div");
this.tooltipTitle.style.borderTop="1px solid gray";this.tooltipTitle.style.textAlign="center";this.tooltipTitle.style.width="100%";this.tooltipTitle.style.overflow="hidden";if(mxClient.IS_SVG)this.tooltipTitle.style.paddingTop="2px";else{this.tooltipTitle.style.position="absolute";this.tooltipTitle.style.paddingTop="6px"}this.tooltip.appendChild(this.tooltipTitle)}else this.tooltipTitle.innerHTML="";this.tooltipTitle.style.display="";mxUtils.write(this.tooltipTitle,c);g=this.tooltipTitle.offsetHeight+
10;h+=g;if(mxClient.IS_SVG)this.tooltipTitle.style.marginTop=-g+"px";else{h-=6;this.tooltipTitle.style.top=h-g+"px"}}else if(this.tooltipTitle!=null&&this.tooltipTitle.parentNode!=null)this.tooltipTitle.style.display="none";this.tooltip.style.height=h+"px";g=-Math.min(0,f.x-this.tooltipBorder);f=-Math.min(0,f.y-this.tooltipBorder);var k=this.container.offsetWidth+this.container.clientWidth+this.editorUi.splitSize+230,l=Math.max(0,this.container.offsetTop+a.offsetTop-this.container.scrollTop-h/2+16);
if(mxClient.IS_SVG)this.graph2.view.canvas.setAttribute("transform","translate("+g+","+f+")");else{this.graph2.view.drawPane.style.left=g+"px";this.graph2.view.drawPane.style.top=f+"px"}this.tooltip.style.position="absolute";this.tooltip.style.left=k+"px";this.tooltip.style.top=l+$(".question").height()+220+"px";this.tooltipImage.style.left=k-13+"px";this.tooltipImage.style.top=l+h/2-13+$(".question").height()+220+"px"});if(this.tooltip!=null&&this.tooltip.style.display!="none")e();else this.thread=
window.setTimeout(e,this.tooltipDelay);this.currentElt=a}};Sidebar.prototype.hideTooltip=function(){if(this.thread!=null){window.clearTimeout(this.thread);this.thread=null}if(this.tooltip!=null){this.tooltip.style.display="none";this.tooltipImage.style.visibility="hidden";this.currentElt=null}};
Sidebar.prototype.addGeneralPalette=function(a){this.addPalette("general",mxResources.get("general"),a||true,mxUtils.bind(this,function(b){b.appendChild(this.createVertexTemplate("swimlane;whiteSpace=wrap",200,200,"Container","Container",true));b.appendChild(this.createVertexTemplate("whiteSpace=wrap",120,60,"","Rectangle",true));b.appendChild(this.createVertexTemplate("rounded=1;whiteSpace=wrap",120,60,"","Rounded Rectangle",true));b.appendChild(this.createVertexTemplate("text;spacingTop=-5;",30,
20,"Text","Text",true));b.appendChild(this.createVertexTemplate("ellipse;whiteSpace=wrap",80,80,"","Circle",true));b.appendChild(this.createVertexTemplate("ellipse;shape=doubleEllipse;whiteSpace=wrap",80,80,"","Double Ellipse",true));b.appendChild(this.createVertexTemplate("shape=ext;double=1;whiteSpace=wrap",120,60,"Double Rectangle","Double Rectangle",true));b.appendChild(this.createVertexTemplate("shape=ext;double=1;rounded=1;whiteSpace=wrap",120,60,"Double\nRounded Rectangle","Double Rounded Rectangle",
true));b.appendChild(this.createVertexTemplate("shape=process;whiteSpace=wrap",120,60,"","Process",true));b.appendChild(this.createVertexTemplate("shape=parallelogram;whiteSpace=wrap",120,60,"","Parallelogram",true));b.appendChild(this.createVertexTemplate("shape=trapezoid;whiteSpace=wrap",120,60,"","Trapezoid",true));b.appendChild(this.createVertexTemplate("shape=document;whiteSpace=wrap",120,80,"","Document",true));b.appendChild(this.createVertexTemplate("triangle;whiteSpace=wrap",60,80,"","Triangle",
true));b.appendChild(this.createVertexTemplate("rhombus;whiteSpace=wrap",80,80,"","Rhombus",true));b.appendChild(this.createVertexTemplate("shape=hexagon;whiteSpace=wrap",120,80,"","Hexagon",true));b.appendChild(this.createVertexTemplate("shape=step;whiteSpace=wrap",120,80,"","Step",true));b.appendChild(this.createVertexTemplate("shape=cylinder;whiteSpace=wrap",60,80,"","Cylinder",true));b.appendChild(this.createVertexTemplate("shape=tape;whiteSpace=wrap",120,100,"","Tape",true));b.appendChild(this.createVertexTemplate("shape=xor;whiteSpace=wrap",
60,80,"","Exclusive Or",true));b.appendChild(this.createVertexTemplate("shape=or;whiteSpace=wrap",60,80,"","Or",true));b.appendChild(this.createVertexTemplate("shape=cube;whiteSpace=wrap",120,80,"","Cube",true));b.appendChild(this.createVertexTemplate("shape=note;whiteSpace=wrap",80,100,"","Note",true));b.appendChild(this.createVertexTemplate("shape=folder;whiteSpace=wrap",120,120,"","Folder",true));b.appendChild(this.createVertexTemplate("shape=card;whiteSpace=wrap",60,80,"","Card",true));b.appendChild(this.createVertexTemplate("shape=message;whiteSpace=wrap",
60,40,"","Message",true));b.appendChild(this.createVertexTemplate("shape=actor;whiteSpace=wrap",40,60,"","Actor 1",true));b.appendChild(this.createVertexTemplate("icon;image="+this.gearImage,60,60,"Image","Image",false));b.appendChild(this.createVertexTemplate("whiteSpace=wrap;label;image="+this.gearImage,140,60,"Label","Label",true));b.appendChild(this.createVertexTemplate("shape=umlActor;verticalLabelPosition=bottom;verticalAlign=top",30,60,"","Actor 2",true));b.appendChild(this.createVertexTemplate("ellipse;shape=cloud;whiteSpace=wrap",
120,80,"","Cloud",true));b.appendChild(this.createVertexTemplate("line",160,10,"","Horizontal Line",true));b.appendChild(this.createVertexTemplate("line;direction=south",10,160,"","Vertical Line",true));b.appendChild(this.createEdgeTemplate("edgeStyle=none;endArrow=none;",100,100,"","Line",true));b.appendChild(this.createEdgeTemplate("edgeStyle=none;endArrow=none;dashed=1;",100,100,"","Dashed Line",true));b.appendChild(this.createEdgeTemplate("edgeStyle=none;endArrow=none;dashed=1;dashPattern=1 4",
100,100,"","Dotted Line",true));b.appendChild(this.createEdgeTemplate("edgeStyle=none",100,100,"","Connection",true));var c=[new mxCell("",new mxGeometry(0,0,100,100),"curved=1")];c[0].geometry.setTerminalPoint(new mxPoint(0,100),true);c[0].geometry.setTerminalPoint(new mxPoint(100,0),false);c[0].geometry.points=[new mxPoint(100,100),new mxPoint(0,0)];c[0].geometry.relative=true;c[0].edge=true;b.appendChild(this.createEdgeTemplateFromCells(c,100,100,"Curve",true));b.appendChild(this.createEdgeTemplate("edgeStyle=elbowEdgeStyle;elbow=horizontal",
100,100,"","Horizontal Elbow",true));b.appendChild(this.createEdgeTemplate("edgeStyle=elbowEdgeStyle;elbow=vertical",100,100,"","Vertical Elbow",true));b.appendChild(this.createEdgeTemplate("edgeStyle=entityRelationEdgeStyle",100,100,"","Entity Relation",true));b.appendChild(this.createEdgeTemplate("edgeStyle=segmentEdgeStyle",100,100,"","Manual Line",true));b.appendChild(this.createEdgeTemplate("edgeStyle=orthogonalEdgeStyle",100,100,"","Automatic Line",true));b.appendChild(this.createEdgeTemplate("shape=link",
100,100,"","Link",true));b.appendChild(this.createEdgeTemplate("arrow",100,100,"","Arrow",true))}))};
Sidebar.prototype.addUmlPalette=function(a){this.addPalette("uml","UML",a||false,mxUtils.bind(this,function(b){b.appendChild(this.createVertexTemplate("",110,50,"Object","Object",true));var c=new mxCell('<p style="margin:0px;margin-top:4px;text-align:center;"><b>Class</b></p><hr/><div style="height:2px;"></div><hr/>',new mxGeometry(0,0,140,60),"verticalAlign=top;align=left;overflow=fill;fontSize=12;fontFamily=Helvetica;html=1");c.vertex=true;b.appendChild(this.createVertexTemplateFromCells([c],140,
60,"Class 1",true));c=new mxCell('<p style="margin:0px;margin-top:4px;text-align:center;"><b>Class</b></p><hr/><p style="margin:0px;margin-left:4px;">+ field: Type</p><hr/><p style="margin:0px;margin-left:4px;">+ method(): Type</p>',new mxGeometry(0,0,160,90),"verticalAlign=top;align=left;overflow=fill;fontSize=12;fontFamily=Helvetica;html=1");c.vertex=true;b.appendChild(this.createVertexTemplateFromCells([c],160,90,"Class 2",true));c=new mxCell('<p style="margin:0px;margin-top:4px;text-align:center;"><i>&lt;&lt;Interface&gt;&gt;</i><br/><b>Interface</b></p><hr/><p style="margin:0px;margin-left:4px;">+ field1: Type<br/>+ field2: Type</p><hr/><p style="margin:0px;margin-left:4px;">+ method1(Type): Type<br/>+ method2(Type, Type): Type</p>',
new mxGeometry(0,0,190,140),"verticalAlign=top;align=left;overflow=fill;fontSize=12;fontFamily=Helvetica;html=1");c.vertex=true;b.appendChild(this.createVertexTemplateFromCells([c],190,140,"Interface",true));c=new mxCell("Module",new mxGeometry(0,0,120,60),"shape=component;align=left;spacingLeft=36");c.vertex=true;b.appendChild(this.createVertexTemplateFromCells([c],120,60,"Module",true));c=new mxCell("&lt;&lt;component&gt;&gt;<br/><b>Component</b>",new mxGeometry(0,0,180,90),"shape=ext;symbol0=component;symbol0Width=20;symbol0Height=20;symbol0Align=right;symbol0VerticalAlign=top;symbol0Spacing=4;symbol0ArcSpacing=0.25;jettyWidth=8;jettyHeight=4;overflow=fill;html=1",
"Component",true);c.vertex=true;b.appendChild(this.createVertexTemplateFromCells([c],180,90,"Component",true));c=new mxCell('<p style="margin:0px;margin-top:6px;text-align:center;"><b>Component</b></p><hr/><p style="margin:0px;margin-left:8px;">+ Attribute1: Type<br/>+ Attribute2: Type</p>',new mxGeometry(0,0,180,90),"shape=ext;symbol0=component;symbol0Width=20;symbol0Height=20;symbol0Align=right;symbol0VerticalAlign=top;symbol0ArcSpacing=0.25;jettyWidth=8;jettyHeight=4;verticalAlign=top;align=left;overflow=fill;html=1");
c.vertex=true;b.appendChild(this.createVertexTemplateFromCells([c],180,90,"Component with Attributes",true));b.appendChild(this.createVertexTemplate("shape=lollipop;direction=south;",30,10,"","Lollipop",true));var d=new mxCell("Block",new mxGeometry(0,0,180,120),"verticalAlign=top;align=left;spacingTop=8;spacingLeft=2;spacingRight=12;shape=cube;size=10;direction=south;fontStyle=4;");d.vertex=true;b.appendChild(this.createVertexTemplateFromCells([d],180,120,"Block",true));b.appendChild(this.createVertexTemplate("shape=folder;fontStyle=1;spacingTop=10;tabWidth=40;tabHeight=14;tabPosition=left;",
70,50,"package","Package",true));c=new mxCell('<p style="margin:0px;margin-top:4px;text-align:center;text-decoration:underline;"><b>Object:Type</b></p><hr/><p style="margin:0px;margin-left:8px;">field1 = value1<br/>field2 = value2<br>field3 = value3</p>',new mxGeometry(0,0,160,90),"verticalAlign=top;align=left;overflow=fill;fontSize=12;fontFamily=Helvetica;html=1");c.vertex=true;b.appendChild(this.createVertexTemplateFromCells([c],160,90,"Object",true));c=new mxCell('<table style="width:100%;font-size:10px;"><tr><td colspan="2" style="background:#e4e4e4;padding:2px;">Tablename</td></tr><tr><td>PK</td><td style="padding:2px;">uniqueId</td></tr><tr><td>FK1</td><td style="padding:2px;">foreignKey</td></tr><tr><td></td><td style="padding:2px;">fieldname</td></tr></table>',
new mxGeometry(0,0,180,90),"verticalAlign=top;align=left;overflow=fill;html=1");c.vertex=true;b.appendChild(this.createVertexTemplateFromCells([c],180,90,"Entity",true));b.appendChild(this.createVertexTemplate("shape=note",80,100,"","Note",true));b.appendChild(this.createVertexTemplate("shape=umlActor;verticalLabelPosition=bottom;verticalAlign=top",40,80,"Actor","Actor",false));b.appendChild(this.createVertexTemplate("ellipse",140,70,"Use Case","Use Case",true));d=new mxCell("",new mxGeometry(0,0,
30,30),"ellipse;shape=startState;fillColor=#000000;strokeColor=#ff0000;");d.vertex=true;c=new mxCell("",new mxGeometry(0,0,0,0),"edgeStyle=elbowEdgeStyle;elbow=horizontal;verticalAlign=bottom;endArrow=open;endSize=8;strokeColor=#ff0000;");c.geometry.setTerminalPoint(new mxPoint(15,70),false);c.edge=true;d.insertEdge(c,true);b.appendChild(this.createVertexTemplateFromCells([d,c],30,30,"Start",true));d=new mxCell("Activity",new mxGeometry(0,0,120,40),"rounded=1;arcSize=40;fillColor=#ffffc0;strokeColor=#ff0000;");
d.vertex=true;c=new mxCell("",new mxGeometry(0,0,0,0),"edgeStyle=elbowEdgeStyle;elbow=horizontal;verticalAlign=bottom;endArrow=open;endSize=8;strokeColor=#ff0000;");c.geometry.setTerminalPoint(new mxPoint(60,80),false);c.edge=true;d.insertEdge(c,true);b.appendChild(this.createVertexTemplateFromCells([d,c],120,40,"Activity",true));d=new mxCell('<div style="margin-top:8px;"><b>Composite State</b><hr/>Subtitle</div>',new mxGeometry(0,0,160,60),"rounded=1;arcSize=40;overflow=fill;html=1;verticalAlign=top;fillColor=#ffffc0;strokeColor=#ff0000;");
d.vertex=true;c=new mxCell("",new mxGeometry(0,0,0,0),"edgeStyle=elbowEdgeStyle;elbow=horizontal;verticalAlign=bottom;endArrow=open;endSize=8;strokeColor=#ff0000;");c.geometry.setTerminalPoint(new mxPoint(80,100),false);c.edge=true;d.insertEdge(c,true);b.appendChild(this.createVertexTemplateFromCells([d,c],160,60,"Composite State",true));d=new mxCell("Condition",new mxGeometry(0,0,80,40),"rhombus;fillColor=#ffffc0;strokeColor=#ff0000;");d.vertex=true;var e=new mxCell("no",new mxGeometry(0,0,0,0),
"edgeStyle=elbowEdgeStyle;elbow=horizontal;align=left;verticalAlign=bottom;endArrow=open;endSize=8;strokeColor=#ff0000;");e.geometry.setTerminalPoint(new mxPoint(120,20),false);e.geometry.relative=true;e.geometry.x=-1;e.edge=true;d.insertEdge(e,true);c=new mxCell("yes",new mxGeometry(0,0,0,0),"edgeStyle=elbowEdgeStyle;elbow=horizontal;align=left;verticalAlign=top;endArrow=open;endSize=8;strokeColor=#ff0000;");c.geometry.setTerminalPoint(new mxPoint(40,80),false);c.geometry.relative=true;c.geometry.x=
-1;c.edge=true;d.insertEdge(c,true);b.appendChild(this.createVertexTemplateFromCells([d,e,c],80,40,"Condition",true));d=new mxCell("",new mxGeometry(0,0,200,10),"shape=line;strokeWidth=6;strokeColor=#ff0000;");d.vertex=true;c=new mxCell("",new mxGeometry(0,0,0,0),"edgeStyle=elbowEdgeStyle;elbow=horizontal;verticalAlign=bottom;endArrow=open;endSize=8;strokeColor=#ff0000;");c.geometry.setTerminalPoint(new mxPoint(100,50),false);c.edge=true;d.insertEdge(c,true);b.appendChild(this.createVertexTemplateFromCells([d,
c],200,10,"Fork/Join",true));b.appendChild(this.createVertexTemplate("ellipse;shape=endState;fillColor=#000000;strokeColor=#ff0000",30,30,"","End",true));d=new mxCell(":Object",new mxGeometry(0,0,100,50));d.vertex=true;c=new mxCell("",new mxGeometry(40,50,20,240),"shape=line;direction=north;dashed=1");c.vertex=true;b.appendChild(this.createVertexTemplateFromCells([d,c],100,290,"Class/Object",true));d=new mxCell("",new mxGeometry(100,0,20,70));d.vertex=true;e=new mxCell("invoke",new mxGeometry(0,0,
0,0),"edgeStyle=elbowEdgeStyle;elbow=vertical;verticalAlign=bottom;endArrow=block;");e.geometry.setTerminalPoint(new mxPoint(0,0),true);e.edge=true;d.insertEdge(e,false);b.appendChild(this.createVertexTemplateFromCells([d,e],120,70,"Invocation",true));d=new mxCell("",new mxGeometry(100,0,20,70));d.vertex=true;e=new mxCell("invoke",new mxGeometry(0,0,0,0),"edgeStyle=elbowEdgeStyle;elbow=vertical;verticalAlign=bottom;endArrow=block;");e.geometry.setTerminalPoint(new mxPoint(0,0),true);e.edge=true;d.insertEdge(e,
false);c=new mxCell("return",new mxGeometry(0,0,0,0),"edgeStyle=elbowEdgeStyle;elbow=vertical;verticalAlign=bottom;dashed=1;endArrow=open;endSize=8;");c.geometry.setTerminalPoint(new mxPoint(0,70),false);c.edge=true;d.insertEdge(c,true);var f=new mxCell("invoke",new mxGeometry(0,0,0,0),"edgeStyle=elbowEdgeStyle;elbow=vertical;align=left;endArrow=open;");f.edge=true;d.insertEdge(f,true);d.insertEdge(f,false);b.appendChild(this.createVertexTemplateFromCells([d,e,c,f],120,70,"Synchronous Invocation",
true));c=new mxCell("name",new mxGeometry(0,0,0,0),"endArrow=block;endFill=1;edgeStyle=orthogonalEdgeStyle;align=left;verticalAlign=top;");c.geometry.setTerminalPoint(new mxPoint(0,0),true);c.geometry.setTerminalPoint(new mxPoint(160,0),false);c.geometry.relative=true;c.geometry.x=-1;c.edge=true;e=new mxCell("1",new mxGeometry(-1,0,0,0),"resizable=0;align=left;verticalAlign=bottom;labelBackgroundColor=#ffffff;fontSize=10");e.geometry.relative=true;e.setConnectable(false);e.vertex=true;c.insert(e);
b.appendChild(this.createEdgeTemplateFromCells([c],160,0,"Relation",true));c=new mxCell("",new mxGeometry(0,0,0,0),"endArrow=none;edgeStyle=orthogonalEdgeStyle;");c.geometry.setTerminalPoint(new mxPoint(0,0),true);c.geometry.setTerminalPoint(new mxPoint(160,0),false);c.edge=true;e=new mxCell("parent",new mxGeometry(-1,0,0,0),"resizable=0;align=left;verticalAlign=bottom;labelBackgroundColor=#ffffff;fontSize=10");e.geometry.relative=true;e.setConnectable(false);e.vertex=true;c.insert(e);e=new mxCell("child",
new mxGeometry(1,0,0,0),"resizable=0;align=right;verticalAlign=bottom;labelBackgroundColor=#ffffff;fontSize=10");e.geometry.relative=true;e.setConnectable(false);e.vertex=true;c.insert(e);b.appendChild(this.createEdgeTemplateFromCells([c],160,0,"Association 1",true));c=new mxCell("1",new mxGeometry(0,0,0,0),"endArrow=open;endSize=12;startArrow=diamondThin;startSize=14;startFill=0;edgeStyle=orthogonalEdgeStyle;align=left;verticalAlign=bottom;");c.geometry.setTerminalPoint(new mxPoint(0,0),true);c.geometry.setTerminalPoint(new mxPoint(160,
0),false);c.geometry.relative=true;c.geometry.x=-1;c.edge=true;b.appendChild(this.createEdgeTemplateFromCells([c],160,0,"Composition",true));c=new mxCell("Relation",new mxGeometry(0,0,0,0),"endArrow=open;endSize=12;startArrow=diamondThin;startSize=14;startFill=0;edgeStyle=orthogonalEdgeStyle;");c.geometry.setTerminalPoint(new mxPoint(0,0),true);c.geometry.setTerminalPoint(new mxPoint(160,0),false);c.edge=true;e=new mxCell("0..n",new mxGeometry(-1,0,0,0),"resizable=0;align=left;verticalAlign=top;labelBackgroundColor=#ffffff;fontSize=10");
e.geometry.relative=true;e.setConnectable(false);e.vertex=true;c.insert(e);e=new mxCell("1",new mxGeometry(1,0,0,0),"resizable=0;align=right;verticalAlign=top;labelBackgroundColor=#ffffff;fontSize=10");e.geometry.relative=true;e.setConnectable(false);e.vertex=true;c.insert(e);b.appendChild(this.createEdgeTemplateFromCells([c],160,0,"Relation",true));c=new mxCell("Use",new mxGeometry(0,0,0,0),"endArrow=open;endSize=12;dashed=1");c.geometry.setTerminalPoint(new mxPoint(0,0),true);c.geometry.setTerminalPoint(new mxPoint(160,
0),false);c.edge=true;b.appendChild(this.createEdgeTemplateFromCells([c],160,0,"Dependency",true));c=new mxCell("Extends",new mxGeometry(0,0,0,0),"endArrow=block;endSize=16;endFill=0;dashed=1");c.geometry.setTerminalPoint(new mxPoint(0,0),true);c.geometry.setTerminalPoint(new mxPoint(160,0),false);c.edge=true;b.appendChild(this.createEdgeTemplateFromCells([c],160,0,"Generalization"));c=new mxCell("",new mxGeometry(0,0,0,0),"endArrow=block;startArrow=block;endFill=1;startFill=1");c.geometry.setTerminalPoint(new mxPoint(0,
0),true);c.geometry.setTerminalPoint(new mxPoint(160,0),false);c.edge=true;b.appendChild(this.createEdgeTemplateFromCells([c],160,0,"Association 2"))}))};
Sidebar.prototype.addBpmnPalette=function(){this.addPalette("bpmn","BPMN "+mxResources.get("general"),false,mxUtils.bind(this,function(a){a.appendChild(this.createVertexTemplate("shape=ext;rounded=1;",120,80,"Task","Process",true));a.appendChild(this.createVertexTemplate("shape=ext;rounded=1;double=1;",120,80,"Transaction","Transaction",true));a.appendChild(this.createVertexTemplate("shape=ext;rounded=1;dashed=1;dashPattern=1 4;",120,80,"Event\nSub-Process","Event Sub-Process",true));a.appendChild(this.createVertexTemplate("shape=ext;rounded=1;strokeWidth=3;",
120,80,"Call Activity","Call Activity",true));a.appendChild(this.createVertexTemplate("shape=ext;rounded=1;symbol0=plus;symbol0Width=14;symbol0Height=14;symbol0Align=center;symbol0VerticalAlign=bottom;",120,80,"Sub-Process","Sub-Process",true));a.appendChild(this.createVertexTemplate("shape=ext;rounded=1;symbol0=message;symbol0Width=20;symbol0Height=14;symbol0Align=left;symbol0VerticalAlign=top;symbol0Spacing=4;symbol0ArcSpacing=0.25;",120,80,"Receive","Receive Task",true));a.appendChild(this.createVertexTemplate("shape=ext;rounded=1;symbol0=actor;symbol0Width=14;symbol0Height=14;symbol0Align=left;symbol0VerticalAlign=top;symbol0Spacing=4;symbol0ArcSpacing=0.25;",
120,80,"User","User Task",true));var b=new mxCell("Process",new mxGeometry(0,0,120,80),"rounded=1");b.vertex=true;var c=new mxCell("",new mxGeometry(1,1,30,30),"shape=mxgraph.bpmn.timer_start;perimeter=ellipsePerimeter;");c.vertex=true;c.geometry.relative=true;c.geometry.offset=new mxPoint(-40,-15);b.insert(c);a.appendChild(this.createVertexTemplateFromCells([b],120,80,"Attached Timer Event",true));a.appendChild(this.createVertexTemplate("swimlane;horizontal=0;startSize=20",320,240,"Pool","Pool",
true));a.appendChild(this.createVertexTemplate("swimlane;horizontal=0;swimlaneFillColor=white;swimlaneLine=0;",300,120,"Lane","Lane",true));a.appendChild(this.createVertexTemplate("shape=hexagon",60,50,"","Conversation",true));a.appendChild(this.createVertexTemplate("shape=hexagon;strokeWidth=4",60,50,"","Call Conversation",true));b=new mxCell("",new mxGeometry(0,0,40,30),"shape=message");b.vertex=true;a.appendChild(this.createVertexTemplateFromCells([b],40,30,"Message",true));b=new mxCell("",new mxGeometry(0,
0,14,14),"shape=plus;resizable=0;");b.connectable=false;b.vertex=true;a.appendChild(this.createVertexTemplateFromCells([b],14,14,"Sub-Process Marker",true));b=new mxCell("",new mxGeometry(0,0,0,0),"endArrow=block;endFill=1;endSize=6");b.geometry.setTerminalPoint(new mxPoint(0,0),true);b.geometry.setTerminalPoint(new mxPoint(100,0),false);b.edge=true;a.appendChild(this.createEdgeTemplateFromCells([b],100,0,"Sequence Flow",true));b=new mxCell("",new mxGeometry(0,0,0,0),"startArrow=dash;startSize=8;endArrow=block;endFill=1;endSize=6");
b.geometry.setTerminalPoint(new mxPoint(0,0),true);b.geometry.setTerminalPoint(new mxPoint(100,0),false);b.edge=true;a.appendChild(this.createEdgeTemplateFromCells([b],100,0,"Default Flow",true));b=new mxCell("",new mxGeometry(0,0,0,0),"startArrow=diamondThin;startFill=0;startSize=14;endArrow=block;endFill=1;endSize=6");b.geometry.setTerminalPoint(new mxPoint(0,0),true);b.geometry.setTerminalPoint(new mxPoint(100,0),false);b.edge=true;a.appendChild(this.createEdgeTemplateFromCells([b],100,0,"Conditional Flow",
true));b=new mxCell("",new mxGeometry(0,0,0,0),"startArrow=oval;startFill=0;startSize=7;endArrow=block;endFill=0;endSize=10;dashed=1");b.geometry.setTerminalPoint(new mxPoint(0,0),true);b.geometry.setTerminalPoint(new mxPoint(100,0),false);b.edge=true;a.appendChild(this.createEdgeTemplateFromCells([b],100,0,"Message Flow 1"));b=new mxCell("",new mxGeometry(0,0,0,0),"startArrow=oval;startFill=0;startSize=7;endArrow=block;endFill=0;endSize=10;dashed=1");b.geometry.setTerminalPoint(new mxPoint(0,0),
true);b.geometry.setTerminalPoint(new mxPoint(100,0),false);b.edge=true;c=new mxCell("",new mxGeometry(0,0,20,14),"shape=message");c.geometry.relative=true;c.setConnectable(false);c.vertex=true;c.geometry.offset=new mxPoint(-10,-7);b.insert(c);a.appendChild(this.createEdgeTemplateFromCells([b],100,0,"Message Flow 2",true));b=new mxCell("",new mxGeometry(0,0,0,0),"shape=link");b.geometry.setTerminalPoint(new mxPoint(0,0),true);b.geometry.setTerminalPoint(new mxPoint(100,0),false);b.edge=true;a.appendChild(this.createEdgeTemplateFromCells([b],
100,0,"Link",true))}))};Sidebar.prototype.createTitle=function(a){var b=document.createElement("a");b.setAttribute("href","javascript:void(0);");b.className="geTitle";mxUtils.write(b,a);return b};
Sidebar.prototype.createThumb=function(a,b,c,d,e,f){this.graph.labelsVisible=f==null||f;this.graph.view.scaleAndTranslate(1,0,0);this.graph.addCells(a);f=this.graph.getGraphBounds();a=this.thumbBorder;this.graph.view.scaleAndTranslate(Math.min((b-2)/(f.width-f.x+a),(c-2)/(f.height-f.y+a)),-Math.min(f.x,0),-Math.min(f.y,0));f=this.graph.getGraphBounds();a=Math.max(0,Math.floor((b-f.width-f.x)/2));f=Math.max(0,Math.floor((c-f.height-f.y)/2));var g=null;if(this.graph.dialect==mxConstants.DIALECT_SVG&&
!mxClient.NO_FO)g=this.graph.view.getCanvas().ownerSVGElement.cloneNode(true);else{g=this.graph.container.cloneNode(false);g.innerHTML=this.graph.container.innerHTML}this.graph.getModel().clear();if(mxClient.IS_IE6)d.style.backgroundImage="url("+this.editorUi.editor.transparentImage+")";g.style.position="relative";g.style.overflow="hidden";g.style.cursor="pointer";g.style.left=a+3+"px";g.style.top=f+3+"px";g.style.width=b+"px";g.style.height=c+"px";g.style.visibility="";g.style.minWidth="";g.style.minHeight=
"";d.appendChild(g);if(this.sidebarTitles&&e!=null){d.style.height=this.thumbHeight+(mxClient.IS_QUIRKS?2*this.thumbPadding+2:0)+this.sidebarTitleSize+8+"px";b=document.createElement("div");b.style.fontSize=this.sidebarTitleSize+"px";b.style.textAlign="center";b.style.whiteSpace="nowrap";if(mxClient.IS_IE)b.style.height=this.sidebarTitleSize+12+"px";b.style.paddingTop="4px";mxUtils.write(b,e);d.appendChild(b)}};
Sidebar.prototype.createItem=function(a,b,c){var d=document.createElement("a");d.setAttribute("href","javascript:void(0);");d.className="geItem";d.style.overflow="hidden";var e=mxClient.IS_QUIRKS?8+2*this.thumbPadding:6;d.style.width=this.thumbWidth+e+"px";d.style.height=this.thumbHeight+e+"px";d.style.padding=this.thumbPadding+"px";mxEvent.addListener(d,"click",function(f){mxEvent.consume(f)});this.createThumb(a,this.thumbWidth,this.thumbHeight,d,b,c);return d};
Sidebar.prototype.createDropHandler=function(a,b){return function(c,d,e,f,g){if(c.isEnabled()){a=c.getImportableCells(a);if(a.length>0){var h=e!=null?c.isValidDropTarget(e,a,d):false,k=null;if(e!=null&&!h)e=null;if(b&&c.isSplitEnabled()&&c.isSplitTarget(e,a,d)){c.splitEdge(e,a,null,f,g);k=a}else if(a.length>0)k=c.importCells(a,f,g,e);if(k!=null&&k.length>0){c.scrollCellToVisible(k[0]);c.setSelectionCells(k)}}}}};
Sidebar.prototype.createDragPreview=function(a,b){var c=document.createElement("div");c.style.border="1px dashed black";c.style.width=a+"px";c.style.height=b+"px";return c};Sidebar.prototype.createDragSource=function(a,b,c){a=mxUtils.makeDraggable(a,this.editorUi.editor.graph,b,c,0,0,this.editorUi.editor.graph.autoscroll,true,true);a.getDropTarget=function(d){var e=mxDragSource.prototype.getDropTarget.apply(this,arguments);d.isValidRoot(e)||(e=null);return e};return a};
Sidebar.prototype.itemClicked=function(a,b,c){a=this.editorUi.editor.graph;var d=a.getGridSize();b.drop(a,c,null,d,d)};
Sidebar.prototype.addClickHandler=function(a,b,c){var d=this.editorUi.editor.graph,e=b.mouseUp,f=null;mxEvent.addGestureListeners(a,function(g){f=new mxPoint(mxEvent.getClientX(g),mxEvent.getClientY(g))});b.mouseUp=mxUtils.bind(this,function(g){if(!mxEvent.isPopupTrigger(g)&&this.currentGraph==null&&f!=null){var h=d.tolerance;Math.abs(f.x-mxEvent.getClientX(g))<=h&&Math.abs(f.y-mxEvent.getClientY(g))<=h&&this.itemClicked(c,b,g)}e.apply(b,arguments);f=null;this.currentElt=a})};
Sidebar.prototype.createVertexTemplate=function(a,b,c,d,e,f){a=[new mxCell(d!=null?d:"",new mxGeometry(0,0,b,c),a)];a[0].vertex=true;return this.createVertexTemplateFromCells(a,b,c,e,f)};
Sidebar.prototype.createVertexTemplateFromCells=function(a,b,c,d,e){var f=this.createItem(a,d,e);b=this.createDragSource(f,this.createDropHandler(a,true),this.createDragPreview(b,c));this.addClickHandler(f,b,a);b.isGuidesEnabled=mxUtils.bind(this,function(){return this.editorUi.editor.graph.graphHandler.guidesEnabled});touchStyle||mxEvent.addListener(f,"mousemove",mxUtils.bind(this,function(){this.showTooltip(f,a,d,e)}));return f};
Sidebar.prototype.createEdgeTemplate=function(a,b,c,d,e,f){a=[new mxCell(d!=null?d:"",new mxGeometry(0,0,b,c),a)];a[0].geometry.setTerminalPoint(new mxPoint(0,c),true);a[0].geometry.setTerminalPoint(new mxPoint(b,0),false);a[0].geometry.relative=true;a[0].edge=true;return this.createEdgeTemplateFromCells(a,b,c,e,f)};
Sidebar.prototype.createEdgeTemplateFromCells=function(a,b,c,d,e){var f=this.createItem(a,d,e);this.createDragSource(f,this.createDropHandler(a,false),this.createDragPreview(b,c));var g=this.editorUi.editor.graph;mxEvent.addListener(f,"click",mxUtils.bind(this,function(h){this.installEdges&&g.setDefaultEdge(a[0]);f.style.backgroundColor="#ffffff";window.setTimeout(function(){f.style.backgroundColor=""},300);mxEvent.consume(h)}));touchStyle||mxEvent.addListener(f,"mousemove",mxUtils.bind(this,function(){this.showTooltip(f,
a,d,e)}));return f};Sidebar.prototype.addPalette=function(a,b,c,d){b=this.createTitle(b);this.container.appendChild(b);var e=document.createElement("div");e.className="geSidebar";if(c){d(e);d=null}else e.style.display="none";this.addFoldingHandler(b,e,d);c=document.createElement("div");c.appendChild(e);this.container.appendChild(c);if(a!=null)this.palettes[a]=[b,c]};
Sidebar.prototype.addFoldingHandler=function(a,b,c){var d=false;a.style.backgroundImage=b.style.display=="none"?"url("+IMAGE_PATH+"/collapsed.gif)":"url("+IMAGE_PATH+"/expanded.gif)";a.style.backgroundRepeat="no-repeat";a.style.backgroundPosition="0% 50%";mxEvent.addListener(a,"click",function(e){if(b.style.display=="none"){if(!d){d=true;if(c!=null){a.style.cursor="wait";var f=a.innerHTML;a.innerHTML=mxResources.get("loading")+"...";window.setTimeout(function(){c(b);a.style.cursor="";a.innerHTML=
f},0)}}a.style.backgroundImage="url("+IMAGE_PATH+"/expanded.gif)";b.style.display="block"}else{a.style.backgroundImage="url("+IMAGE_PATH+"/collapsed.gif)";b.style.display="none"}mxEvent.consume(e)})};Sidebar.prototype.removePalette=function(a){var b=this.palettes[a];if(b!=null){this.palettes[a]=null;for(a=0;a<b.length;a++)this.container.removeChild(b[a]);return true}return false};
Sidebar.prototype.addImagePalette=function(a,b,c,d,e,f){this.addPalette(a,b,false,mxUtils.bind(this,function(g){for(var h=f!=null,k=0;k<e.length;k++)g.appendChild(this.createVertexTemplate("image;image="+(c+e[k]+d),80,80,"",h?f[k]:null,h))}))};
Sidebar.prototype.addStencilPalette=function(a,b,c,d,e,f,g,h){h=h!=null?h:1;this.addPalette(a,b,e,mxUtils.bind(this,function(k){if(d==null)d="";g!=null&&g.call(this,k);mxStencilRegistry.loadStencilSet(c,mxUtils.bind(this,function(l,m,p,o,n){if(f==null||mxUtils.indexOf(f,m)<0)k.appendChild(this.createVertexTemplate("shape="+l+m.toLowerCase()+d,Math.round(o*h),Math.round(n*h),"",m.replace(/_/g," "),true))}),true)}))};function Toolbar(a,b){this.editorUi=a;this.container=b;this.init();mxEvent.addGestureListeners(document,mxUtils.bind(this,function(){this.hideMenu()}))}
Toolbar.prototype.init=function(){this.addItems(["undo","redo","delete","-","actualSize","zoomIn","zoomOut","-"]);var a=this.addMenu("Helvetica",mxResources.get("fontFamily"),true,"fontFamily");a.style.whiteSpace="nowrap";a.style.overflow="hidden";a.style.width="56px";this.addSeparator();var b=this.addMenu("12",mxResources.get("fontSize"),true,"fontSize");b.style.whiteSpace="nowrap";b.style.overflow="hidden";b.style.width="22px";this.addItems(["-","bold","italic","underline"]);var c=this.addMenuFunction("geSprite-left",
mxResources.get("align"),false,mxUtils.bind(this,function(k){this.editorUi.menus.styleChange(k,"",[mxConstants.STYLE_ALIGN],[mxConstants.ALIGN_LEFT],"geIcon geSprite geSprite-left",null).setAttribute("title",mxResources.get("left"));this.editorUi.menus.styleChange(k,"",[mxConstants.STYLE_ALIGN],[mxConstants.ALIGN_CENTER],"geIcon geSprite geSprite-center",null).setAttribute("title",mxResources.get("center"));this.editorUi.menus.styleChange(k,"",[mxConstants.STYLE_ALIGN],[mxConstants.ALIGN_RIGHT],"geIcon geSprite geSprite-right",
null).setAttribute("title",mxResources.get("right"));this.editorUi.menus.styleChange(k,"",[mxConstants.STYLE_VERTICAL_ALIGN],[mxConstants.ALIGN_TOP],"geIcon geSprite geSprite-top",null).setAttribute("title",mxResources.get("top"));this.editorUi.menus.styleChange(k,"",[mxConstants.STYLE_VERTICAL_ALIGN],[mxConstants.ALIGN_MIDDLE],"geIcon geSprite geSprite-middle",null).setAttribute("title",mxResources.get("middle"));this.editorUi.menus.styleChange(k,"",[mxConstants.STYLE_VERTICAL_ALIGN],[mxConstants.ALIGN_BOTTOM],
"geIcon geSprite geSprite-bottom",null).setAttribute("title",mxResources.get("bottom"))}));this.addItems(["fontColor","-"]);var d=this.addMenuFunction("geSprite-straight",mxResources.get("line"),false,mxUtils.bind(this,function(k){this.editorUi.menus.styleChange(k,"",[mxConstants.STYLE_EDGE],[null],"geIcon geSprite geSprite-straight",null).setAttribute("title",mxResources.get("straight"));this.editorUi.menus.styleChange(k,"",[mxConstants.STYLE_EDGE],["entityRelationEdgeStyle"],"geIcon geSprite geSprite-entity",
null).setAttribute("title",mxResources.get("entityRelation"));this.editorUi.menus.styleChange(k,"",[mxConstants.STYLE_EDGE,mxConstants.STYLE_ELBOW],["elbowEdgeStyle","horizontal"],"geIcon geSprite geSprite-helbow",null).setAttribute("title",mxResources.get("horizontal"));this.editorUi.menus.styleChange(k,"",[mxConstants.STYLE_EDGE,mxConstants.STYLE_ELBOW],["elbowEdgeStyle","vertical"],"geIcon geSprite geSprite-velbow",null).setAttribute("title",mxResources.get("vertical"));this.editorUi.menus.styleChange(k,
"",[mxConstants.STYLE_EDGE],["segmentEdgeStyle"],"geIcon geSprite geSprite-segment",null).setAttribute("title",mxResources.get("manual"));this.editorUi.menus.styleChange(k,"",[mxConstants.STYLE_EDGE],["orthogonalEdgeStyle"],"geIcon geSprite geSprite-orthogonal",null).setAttribute("title",mxResources.get("automatic"))})),e=this.addMenuFunction("geSprite-startclassic",mxResources.get("lineend"),false,mxUtils.bind(this,function(k){this.editorUi.menus.styleChange(k,"",[mxConstants.STYLE_STARTARROW,"startFill"],
[mxConstants.NONE,0],"geIcon geSprite geSprite-noarrow",null).setAttribute("title",mxResources.get("none"));this.editorUi.menus.styleChange(k,"",[mxConstants.STYLE_STARTARROW,"startFill"],[mxConstants.ARROW_CLASSIC,1],"geIcon geSprite geSprite-startclassic",null).setAttribute("title",mxResources.get("classic"));this.editorUi.menus.styleChange(k,"",[mxConstants.STYLE_STARTARROW,"startFill"],[mxConstants.ARROW_OPEN,1],"geIcon geSprite geSprite-startopen",null).setAttribute("title",mxResources.get("openArrow"));
this.editorUi.menus.styleChange(k,"",[mxConstants.STYLE_STARTARROW,"startFill"],[mxConstants.ARROW_BLOCK,1],"geIcon geSprite geSprite-startblock",null).setAttribute("title",mxResources.get("block"));this.editorUi.menus.styleChange(k,"",[mxConstants.STYLE_STARTARROW,"startFill"],[mxConstants.ARROW_OVAL,1],"geIcon geSprite geSprite-startoval",null).setAttribute("title",mxResources.get("oval"));this.editorUi.menus.styleChange(k,"",[mxConstants.STYLE_STARTARROW,"startFill"],[mxConstants.ARROW_DIAMOND,
1],"geIcon geSprite geSprite-startdiamond",null).setAttribute("title",mxResources.get("diamond"));this.editorUi.menus.styleChange(k,"",[mxConstants.STYLE_STARTARROW,"startFill"],[mxConstants.ARROW_DIAMOND_THIN,1],"geIcon geSprite geSprite-startthindiamond",null).setAttribute("title",mxResources.get("diamondThin"));this.editorUi.menus.styleChange(k,"",[mxConstants.STYLE_STARTARROW,"startFill"],[mxConstants.ARROW_CLASSIC,0],"geIcon geSprite geSprite-startclassictrans",null).setAttribute("title",mxResources.get("classic"));
this.editorUi.menus.styleChange(k,"",[mxConstants.STYLE_STARTARROW,"startFill"],[mxConstants.ARROW_BLOCK,0],"geIcon geSprite geSprite-startblocktrans",null).setAttribute("title",mxResources.get("block"));this.editorUi.menus.styleChange(k,"",[mxConstants.STYLE_STARTARROW,"startFill"],[mxConstants.ARROW_OVAL,0],"geIcon geSprite geSprite-startovaltrans",null).setAttribute("title",mxResources.get("oval"));this.editorUi.menus.styleChange(k,"",[mxConstants.STYLE_STARTARROW,"startFill"],[mxConstants.ARROW_DIAMOND,
0],"geIcon geSprite geSprite-startdiamondtrans",null).setAttribute("title",mxResources.get("diamond"));this.editorUi.menus.styleChange(k,"",[mxConstants.STYLE_STARTARROW,"startFill"],[mxConstants.ARROW_DIAMOND_THIN,0],"geIcon geSprite geSprite-startthindiamondtrans",null).setAttribute("title",mxResources.get("diamondThin"))})),f=this.addMenuFunction("geSprite-endclassic",mxResources.get("lineend"),false,mxUtils.bind(this,function(k){this.editorUi.menus.styleChange(k,"",[mxConstants.STYLE_ENDARROW,
"endFill"],[mxConstants.NONE,0],"geIcon geSprite geSprite-noarrow",null).setAttribute("title",mxResources.get("none"));this.editorUi.menus.styleChange(k,"",[mxConstants.STYLE_ENDARROW,"endFill"],[mxConstants.ARROW_CLASSIC,1],"geIcon geSprite geSprite-endclassic",null).setAttribute("title",mxResources.get("classic"));this.editorUi.menus.styleChange(k,"",[mxConstants.STYLE_ENDARROW,"endFill"],[mxConstants.ARROW_OPEN,1],"geIcon geSprite geSprite-endopen",null).setAttribute("title",mxResources.get("openArrow"));
this.editorUi.menus.styleChange(k,"",[mxConstants.STYLE_ENDARROW,"endFill"],[mxConstants.ARROW_BLOCK,1],"geIcon geSprite geSprite-endblock",null).setAttribute("title",mxResources.get("block"));this.editorUi.menus.styleChange(k,"",[mxConstants.STYLE_ENDARROW,"endFill"],[mxConstants.ARROW_OVAL,1],"geIcon geSprite geSprite-endoval",null).setAttribute("title",mxResources.get("oval"));this.editorUi.menus.styleChange(k,"",[mxConstants.STYLE_ENDARROW,"endFill"],[mxConstants.ARROW_DIAMOND,1],"geIcon geSprite geSprite-enddiamond",
null).setAttribute("title",mxResources.get("diamond"));this.editorUi.menus.styleChange(k,"",[mxConstants.STYLE_ENDARROW,"endFill"],[mxConstants.ARROW_DIAMOND_THIN,1],"geIcon geSprite geSprite-endthindiamond",null).setAttribute("title",mxResources.get("diamondThin"));this.editorUi.menus.styleChange(k,"",[mxConstants.STYLE_ENDARROW,"endFill"],[mxConstants.ARROW_CLASSIC,0],"geIcon geSprite geSprite-endclassictrans",null).setAttribute("title",mxResources.get("classic"));this.editorUi.menus.styleChange(k,
"",[mxConstants.STYLE_ENDARROW,"endFill"],[mxConstants.ARROW_BLOCK,0],"geIcon geSprite geSprite-endblocktrans",null).setAttribute("title",mxResources.get("block"));this.editorUi.menus.styleChange(k,"",[mxConstants.STYLE_ENDARROW,"endFill"],[mxConstants.ARROW_OVAL,0],"geIcon geSprite geSprite-endovaltrans",null).setAttribute("title",mxResources.get("oval"));this.editorUi.menus.styleChange(k,"",[mxConstants.STYLE_ENDARROW,"endFill"],[mxConstants.ARROW_DIAMOND,0],"geIcon geSprite geSprite-enddiamondtrans",
null).setAttribute("title",mxResources.get("diamond"));this.editorUi.menus.styleChange(k,"",[mxConstants.STYLE_ENDARROW,"endFill"],[mxConstants.ARROW_DIAMOND_THIN,0],"geIcon geSprite geSprite-endthindiamondtrans",null).setAttribute("title",mxResources.get("diamondThin"))}));this.addItems(["-","strokeColor","image","fillColor"]);this.addItem("geSprite-gradientcolor","gradientColor").setAttribute("title",mxResources.get("gradient"));this.addItems(["shadow"]);var g=this.editorUi.editor.graph,h=mxUtils.bind(this,
function(){var k="Helvetica",l="12",m=g.getView().getState(g.getSelectionCell());if(m!=null){k=m.style[mxConstants.STYLE_FONTFAMILY]||k;l=m.style[mxConstants.STYLE_FONTSIZE]||l;if(k.length>10)k=k.substring(0,8)+"...";a.innerHTML=k;b.innerHTML=l}});g.getSelectionModel().addListener(mxEvent.CHANGE,h);g.getModel().addListener(mxEvent.CHANGE,h);this.addEdgeSelectionHandler([d,e,f]);this.addSelectionHandler([c])};
Toolbar.prototype.hideMenu=function(){if(this.currentMenu!=null){this.currentMenu.hideMenu();this.currentMenu.destroy();this.currentMenu=null}};Toolbar.prototype.addMenu=function(a,b,c,d){var e=this.editorUi.menus.get(d),f=this.addMenuFunction(a,b,c,e.funct);e.addListener("stateChanged",function(){f.setEnabled(e.enabled)});return f};
Toolbar.prototype.addMenuFunction=function(a,b,c,d){a=c?this.createLabel(a):this.createButton(a);this.initElement(a,b);this.addMenuHandler(a,c,d);this.container.appendChild(a);return a};Toolbar.prototype.addSeparator=function(){var a=document.createElement("div");a.className="geSeparator";this.container.appendChild(a);return a};Toolbar.prototype.addItems=function(a){for(var b=0;b<a.length;b++){var c=a[b];c=="-"?this.addSeparator():this.addItem("geSprite-"+c.toLowerCase(),c)}};
Toolbar.prototype.addItem=function(a,b){var c=this.editorUi.actions.get(b),d=null;if(c!=null){d=this.addButton(a,c.label,c.funct);d.setEnabled(c.enabled);c.addListener("stateChanged",function(){d.setEnabled(c.enabled)})}return d};Toolbar.prototype.addButton=function(a,b,c){a=this.createButton(a);this.initElement(a,b);this.addClickHandler(a,c);this.container.appendChild(a);return a};
Toolbar.prototype.addSelectionHandler=function(a){var b=this.editorUi.editor.graph,c=function(){for(var d=!b.isSelectionEmpty(),e=0;e<a.length;e++)a[e].setEnabled(d)};b.getSelectionModel().addListener(mxEvent.CHANGE,c);c()};
Toolbar.prototype.addEdgeSelectionHandler=function(a){var b=this.editorUi.editor.graph,c=function(){var d=false;if(!b.isSelectionEmpty())for(var e=b.getSelectionCells(),f=0;f<e.length;f++)if(b.getModel().isEdge(e[f])){d=true;break}for(f=0;f<a.length;f++)a[f].setEnabled(d)};b.getSelectionModel().addListener(mxEvent.CHANGE,c);c()};Toolbar.prototype.initElement=function(a,b){a.setAttribute("tabindex","0");b!=null&&a.setAttribute("title",b);this.addEnabledState(a)};
Toolbar.prototype.addEnabledState=function(a){var b=a.className;a.setEnabled=function(c){a.enabled=c;a.className=c?b:b+" geDisabled"};a.setEnabled(true)};Toolbar.prototype.addClickHandler=function(a,b){b!=null&&mxEvent.addListener(a,"click",function(c){a.enabled&&b(c);mxEvent.consume(c)})};
Toolbar.prototype.createButton=function(a){var b=document.createElement("a");b.setAttribute("href","javascript:void(0);");b.className="geButton";var c=document.createElement("div");c.className="geSprite "+a;b.appendChild(c);return b};Toolbar.prototype.createLabel=function(a){var b=document.createElement("a");b.setAttribute("href","javascript:void(0);");b.className="geLabel";mxUtils.write(b,a);return b};
Toolbar.prototype.addMenuHandler=function(a,b,c,d){if(c!=null){var e=this.editorUi.editor.graph,f=null;mxEvent.addListener(a,"click",mxUtils.bind(this,function(g){if(a.enabled==null||a.enabled){e.panningHandler.hideMenu();f=new mxPopupMenu(c);f.div.className+=" geToolbarMenu";f.showDisabled=d;f.labels=b;f.autoExpand=true;f.popup(a.offsetLeft,a.offsetTop+a.offsetHeight+34,null,g);this.currentMenu=f}mxEvent.consume(g)}))}};/*
 GNU Lesser General Public License, http://www.gnu.org/copyleft/lesser.html
 @author  Jan Odvarko, http://odvarko.cz
 @created 2008-06-15
 @updated 2012-01-19
 @link    http://jscolor.com
*/
var jscolor={dir:"",bindClass:"color",binding:true,preloading:true,install:function(){},init:function(){jscolor.preloading&&jscolor.preload()},getDir:function(){if(!jscolor.dir){var a=jscolor.detectDir();jscolor.dir=a!==false?a:"jscolor/"}return jscolor.dir},detectDir:function(){for(var a=location.href,b=document.getElementsByTagName("base"),c=0;c<b.length;c+=1)if(b[c].href)a=b[c].href;b=document.getElementsByTagName("script");for(c=0;c<b.length;c+=1)if(b[c].src&&/(^|\/)jscolor\.js([?#].*)?$/i.test(b[c].src)){a=
(new jscolor.URI(b[c].src)).toAbsolute(a);a.path=a.path.replace(/[^\/]+$/,"");a.query=null;a.fragment=null;return a.toString()}return false},preload:function(){for(var a in jscolor.imgRequire)jscolor.imgRequire.hasOwnProperty(a)&&jscolor.loadImage(a)},images:{pad:[181,101],sld:[16,101],cross:[15,15],arrow:[7,11]},imgRequire:{},imgLoaded:{},requireImage:function(a){jscolor.imgRequire[a]=true},loadImage:function(a){if(!jscolor.imgLoaded[a]){jscolor.imgLoaded[a]=new Image;jscolor.imgLoaded[a].src=jscolor.getDir()+
a}},fetchElement:function(a){return typeof a==="string"?document.getElementById(a):a},addEvent:function(a,b,c){if(a.addEventListener)a.addEventListener(b,c,false);else a.attachEvent&&a.attachEvent("on"+b,c)},fireEvent:function(a,b){if(a)if(document.createEvent){var c=document.createEvent("HTMLEvents");c.initEvent(b,true,true);a.dispatchEvent(c)}else if(document.createEventObject){c=document.createEventObject();a.fireEvent("on"+b,c)}else if(a["on"+b])a["on"+b]()},getElementPos:function(a){var b=a,
c=0,d=0;if(b.offsetParent){do{c+=b.offsetLeft;d+=b.offsetTop}while(b=b.offsetParent)}for(;(a=a.parentNode)&&a.nodeName.toUpperCase()!=="BODY";){c-=a.scrollLeft;d-=a.scrollTop}return[c,d]},getElementSize:function(a){return[a.offsetWidth,a.offsetHeight]},getRelMousePos:function(a){var b=0,c=0;if(!a)a=window.event;if(typeof a.offsetX==="number"){b=a.offsetX;c=a.offsetY}else if(typeof a.layerX==="number"){b=a.layerX;c=a.layerY}return{x:b,y:c}},getViewPos:function(){return typeof window.pageYOffset===
"number"?[window.pageXOffset,window.pageYOffset]:document.body&&(document.body.scrollLeft||document.body.scrollTop)?[document.body.scrollLeft,document.body.scrollTop]:document.documentElement&&(document.documentElement.scrollLeft||document.documentElement.scrollTop)?[document.documentElement.scrollLeft,document.documentElement.scrollTop]:[0,0]},getViewSize:function(){return typeof window.innerWidth==="number"?[window.innerWidth,window.innerHeight]:document.body&&(document.body.clientWidth||document.body.clientHeight)?
[document.body.clientWidth,document.body.clientHeight]:document.documentElement&&(document.documentElement.clientWidth||document.documentElement.clientHeight)?[document.documentElement.clientWidth,document.documentElement.clientHeight]:[0,0]},URI:function(a){function b(c){for(var d="";c;)if(c.substr(0,3)==="../"||c.substr(0,2)==="./")c=c.replace(/^\.+/,"").substr(1);else if(c.substr(0,3)==="/./"||c==="/.")c="/"+c.substr(3);else if(c.substr(0,4)==="/../"||c==="/.."){c="/"+c.substr(4);d=d.replace(/\/?[^\/]*$/,
"")}else if(c==="."||c==="..")c="";else{var e=c.match(/^\/?[^\/]*/)[0];c=c.substr(e.length);d+=e}return d}this.authority=this.scheme=null;this.path="";this.fragment=this.query=null;this.parse=function(c){c=c.match(/^(([A-Za-z][0-9A-Za-z+.-]*)(:))?((\/\/)([^\/?#]*))?([^?#]*)((\?)([^#]*))?((#)(.*))?/);this.scheme=c[3]?c[2]:null;this.authority=c[5]?c[6]:null;this.path=c[7];this.query=c[9]?c[10]:null;this.fragment=c[12]?c[13]:null;return this};this.toString=function(){var c="";if(this.scheme!==null)c=
c+this.scheme+":";if(this.authority!==null)c=c+"//"+this.authority;if(this.path!==null)c+=this.path;if(this.query!==null)c=c+"?"+this.query;if(this.fragment!==null)c=c+"#"+this.fragment;return c};this.toAbsolute=function(c){c=new jscolor.URI(c);var d=new jscolor.URI;if(c.scheme===null)return false;if(this.scheme!==null&&this.scheme.toLowerCase()===c.scheme.toLowerCase())this.scheme=null;if(this.scheme!==null){d.scheme=this.scheme;d.authority=this.authority;d.path=b(this.path);d.query=this.query}else{if(this.authority!==
null){d.authority=this.authority;d.path=b(this.path);d.query=this.query}else{if(this.path===""){d.path=c.path;d.query=this.query!==null?this.query:c.query}else{if(this.path.substr(0,1)==="/")d.path=b(this.path);else{d.path=c.authority!==null&&c.path===""?"/"+this.path:c.path.replace(/[^\/]+$/,"")+this.path;d.path=b(d.path)}d.query=this.query}d.authority=c.authority}d.scheme=c.scheme}d.fragment=this.fragment;return d};a&&this.parse(a)},color:function(a,b){function c(y,z,I){if(y===null)return[I,I,I];
var ga=Math.floor(y),E=I*(1-z);y=I*(1-z*(ga%2?y-ga:1-(y-ga)));switch(ga){case 6:case 0:return[I,y,E];case 1:return[y,I,E];case 2:return[E,I,y];case 3:return[E,y,I];case 4:return[y,E,I];case 5:return[I,E,y]}}function d(y,z){if(!jscolor.picker){jscolor.picker={box:document.createElement("div"),boxB:document.createElement("div"),pad:document.createElement("div"),padB:document.createElement("div"),padM:document.createElement("div"),sld:document.createElement("div"),sldB:document.createElement("div"),
sldM:document.createElement("div"),btn:document.createElement("div"),btnS:document.createElement("span"),btnT:document.createTextNode(n.pickerCloseText)};for(var I=0;I<jscolor.images.sld[1];I+=4){var ga=document.createElement("div");ga.style.height="4px";ga.style.fontSize="1px";ga.style.lineHeight="0";jscolor.picker.sld.appendChild(ga)}jscolor.picker.sldB.appendChild(jscolor.picker.sld);jscolor.picker.box.appendChild(jscolor.picker.sldB);jscolor.picker.box.appendChild(jscolor.picker.sldM);jscolor.picker.padB.appendChild(jscolor.picker.pad);
jscolor.picker.box.appendChild(jscolor.picker.padB);jscolor.picker.box.appendChild(jscolor.picker.padM);jscolor.picker.btnS.appendChild(jscolor.picker.btnT);jscolor.picker.btn.appendChild(jscolor.picker.btnS);jscolor.picker.box.appendChild(jscolor.picker.btn);jscolor.picker.boxB.appendChild(jscolor.picker.box)}var E=jscolor.picker;E.box.onmouseup=E.box.onmouseout=function(){mxClient.IS_TOUCH||a.focus()};E.box.onmousedown=function(){};E.box.onmousemove=function(W){if(r||u){r&&l(W);u&&m(W);if(document.selection)document.selection.empty();
else window.getSelection&&window.getSelection().removeAllRanges();p()}};E.padM.onmouseup=E.padM.onmouseout=function(){if(r){r=false;jscolor.fireEvent(t,"change")}};E.padM.onmousedown=function(W){switch(s){case 0:n.hsv[2]===0&&n.fromHSV(null,null,1);break;case 1:n.hsv[1]===0&&n.fromHSV(null,1,null)}r=true;l(W);p()};E.sldM.onmouseup=E.sldM.onmouseout=function(){if(u){u=false;jscolor.fireEvent(t,"change")}};E.sldM.onmousedown=function(W){u=true;m(W);p()};I=e(n);E.box.style.width=I[0]+"px";E.box.style.height=
I[1]+"px";E.boxB.style.position="absolute";E.boxB.style.clear="both";E.boxB.style.left=y+"px";E.boxB.style.top=z+"px";E.boxB.style.zIndex=n.pickerZIndex;E.boxB.style.border=n.pickerBorder+"px solid";E.boxB.style.borderColor=n.pickerBorderColor;E.boxB.style.background=n.pickerFaceColor;E.pad.style.width=jscolor.images.pad[0]+"px";E.pad.style.height=jscolor.images.pad[1]+"px";E.padB.style.position="absolute";E.padB.style.left=n.pickerFace+"px";E.padB.style.top=n.pickerFace+"px";E.padB.style.border=
n.pickerInset+"px solid";E.padB.style.borderColor=n.pickerInsetColor;E.padM.style.position="absolute";E.padM.style.left="0";E.padM.style.top="0";E.padM.style.width=n.pickerFace+2*n.pickerInset+jscolor.images.pad[0]+jscolor.images.arrow[0]+"px";E.padM.style.height=E.box.style.height;E.padM.style.cursor="crosshair";E.sld.style.overflow="hidden";E.sld.style.width=jscolor.images.sld[0]+"px";E.sld.style.height=jscolor.images.sld[1]+"px";E.sldB.style.display=n.slider?"block":"none";E.sldB.style.position=
"absolute";E.sldB.style.right=n.pickerFace+"px";E.sldB.style.top=n.pickerFace+"px";E.sldB.style.border=n.pickerInset+"px solid";E.sldB.style.borderColor=n.pickerInsetColor;E.sldM.style.display=n.slider?"block":"none";E.sldM.style.position="absolute";E.sldM.style.right="0";E.sldM.style.top="0";E.sldM.style.width=jscolor.images.sld[0]+jscolor.images.arrow[0]+n.pickerFace+2*n.pickerInset+"px";E.sldM.style.height=E.box.style.height;try{E.sldM.style.cursor="pointer"}catch(C){E.sldM.style.cursor="hand"}E.btn.style.display=
n.pickerClosable?"block":"none";E.btn.style.position="absolute";E.btn.style.left=n.pickerFace+"px";E.btn.style.bottom=n.pickerFace+"px";E.btn.style.padding="0 15px";E.btn.style.height="18px";E.btn.style.border=n.pickerInset+"px solid";(function(){var W=n.pickerInsetColor.split(/\s+/);E.btn.style.borderColor=W.length<2?W[0]:W[1]+" "+W[0]+" "+W[0]+" "+W[1]})();E.btn.style.color=n.pickerButtonColor;E.btn.style.font="12px sans-serif";E.btn.style.textAlign="center";try{E.btn.style.cursor="pointer"}catch(O){E.btn.style.cursor=
"hand"}E.btn.onmousedown=function(){n.hidePicker()};E.btnS.style.lineHeight=E.btn.style.height;switch(s){case 0:var U="hs.png";break;case 1:U="hv.png"}E.padM.style.backgroundImage="url('"+jscolor.getDir()+"cross.gif')";E.padM.style.backgroundRepeat="no-repeat";E.sldM.style.backgroundImage="url('"+jscolor.getDir()+"arrow.gif')";E.sldM.style.backgroundRepeat="no-repeat";E.pad.style.backgroundImage="url('"+jscolor.getDir()+U+"')";E.pad.style.backgroundRepeat="no-repeat";E.pad.style.backgroundPosition=
"0 0";f();g();jscolor.picker.owner=n;document.getElementsByTagName("body")[0].appendChild(E.boxB)}function e(y){return[2*y.pickerInset+2*y.pickerFace+jscolor.images.pad[0]+(y.slider?2*y.pickerInset+2*jscolor.images.arrow[0]+jscolor.images.sld[0]:0),y.pickerClosable?4*y.pickerInset+3*y.pickerFace+jscolor.images.pad[1]+y.pickerButtonHeight:2*y.pickerInset+2*y.pickerFace+jscolor.images.pad[1]]}function f(){switch(s){case 0:var y=1;break;case 1:y=2}jscolor.picker.padM.style.backgroundPosition=n.pickerFace+
n.pickerInset+Math.round(n.hsv[0]/6*(jscolor.images.pad[0]-1))-Math.floor(jscolor.images.cross[0]/2)+"px "+(n.pickerFace+n.pickerInset+Math.round((1-n.hsv[y])*(jscolor.images.pad[1]-1))-Math.floor(jscolor.images.cross[1]/2))+"px";y=jscolor.picker.sld.childNodes;switch(s){case 0:for(var z=c(n.hsv[0],n.hsv[1],1),I=0;I<y.length;I+=1)y[I].style.backgroundColor="rgb("+z[0]*(1-I/y.length)*100+"%,"+z[1]*(1-I/y.length)*100+"%,"+z[2]*(1-I/y.length)*100+"%)";break;case 1:var ga,E=[n.hsv[2],0,0];I=Math.floor(n.hsv[0]);
var C=I%2?n.hsv[0]-I:1-(n.hsv[0]-I);switch(I){case 6:case 0:z=[0,1,2];break;case 1:z=[1,0,2];break;case 2:z=[2,0,1];break;case 3:z=[2,1,0];break;case 4:z=[1,2,0];break;case 5:z=[0,2,1]}for(I=0;I<y.length;I+=1){ga=1-1/(y.length-1)*I;E[1]=E[0]*(1-ga*C);E[2]=E[0]*(1-ga);y[I].style.backgroundColor="rgb("+E[z[0]]*100+"%,"+E[z[1]]*100+"%,"+E[z[2]]*100+"%)"}}}function g(){switch(s){case 0:var y=2;break;case 1:y=1}jscolor.picker.sldM.style.backgroundPosition="0 "+(n.pickerFace+n.pickerInset+Math.round((1-
n.hsv[y])*(jscolor.images.sld[1]-1))-Math.floor(jscolor.images.arrow[1]/2))+"px"}function h(){return jscolor.picker&&jscolor.picker.owner===n}function k(){t!==a&&n.importColor()}function l(y){var z=jscolor.getRelMousePos(y);y=z.x-n.pickerFace-n.pickerInset;z=z.y-n.pickerFace-n.pickerInset;switch(s){case 0:n.fromHSV(y*(6/(jscolor.images.pad[0]-1)),1-z/(jscolor.images.pad[1]-1),null,D);break;case 1:n.fromHSV(y*(6/(jscolor.images.pad[0]-1)),null,1-z/(jscolor.images.pad[1]-1),D)}}function m(y){y=jscolor.getRelMousePos(y).y-
n.pickerFace-n.pickerInset;switch(s){case 0:n.fromHSV(null,null,1-y/(jscolor.images.sld[1]-1),H);break;case 1:n.fromHSV(null,1-y/(jscolor.images.sld[1]-1),null,H)}}function p(){if(n.onImmediateChange)if(typeof n.onImmediateChange==="string")eval(n.onImmediateChange);else n.onImmediateChange(n)}this.adjust=this.required=true;this.hash=false;this.slider=this.caps=true;this.styleElement=this.valueElement=a;this.onImmediateChange=null;this.hsv=[0,0,1];this.rgb=[1,1,1];this.pickerOnfocus=true;this.pickerMode=
"HSV";this.pickerPosition="bottom";this.pickerSmartPosition=true;this.pickerButtonHeight=20;this.pickerClosable=false;this.pickerCloseText="Close";this.pickerButtonColor="ButtonText";this.pickerFace=0;this.pickerFaceColor="ThreeDFace";this.pickerBorder=1;this.pickerBorderColor="ThreeDHighlight ThreeDShadow ThreeDShadow ThreeDHighlight";this.pickerInset=1;this.pickerInsetColor="ThreeDShadow ThreeDHighlight ThreeDHighlight ThreeDShadow";this.pickerZIndex=1E4;for(var o in b)if(b.hasOwnProperty(o))this[o]=
b[o];this.hidePicker=function(){if(h()){delete jscolor.picker.owner;document.getElementsByTagName("body")[0].removeChild(jscolor.picker.boxB)}};this.showPicker=function(){if(!h()){jscolor.getElementPos(a);jscolor.getElementSize(a);jscolor.getViewPos();jscolor.getViewSize();e(this);this.pickerPosition.toLowerCase();d(0,0)}};this.importColor=function(){if(t)if(this.adjust)if(!this.required&&/^\s*$/.test(t.value)){t.value="";q.style.backgroundImage=q.jscStyle.backgroundImage;q.style.backgroundColor=
q.jscStyle.backgroundColor;q.style.color=q.jscStyle.color;this.exportColor(x|A)}else this.fromString(t.value)||this.exportColor();else{if(!this.fromString(t.value,x)){q.style.backgroundImage=q.jscStyle.backgroundImage;q.style.backgroundColor=q.jscStyle.backgroundColor;q.style.color=q.jscStyle.color;this.exportColor(x|A)}}else this.exportColor()};this.exportColor=function(y){if(!(y&x)&&t){var z=this.toString();if(this.caps)z=z.toUpperCase();if(this.hash)z="#"+z;t.value=z}if(!(y&A)&&q){q.style.backgroundImage=
"none";q.style.backgroundColor="#"+this.toString();q.style.color=0.213*this.rgb[0]+0.715*this.rgb[1]+0.072*this.rgb[2]<0.5?"#FFF":"#000"}!(y&H)&&h()&&f();!(y&D)&&h()&&g()};this.fromHSV=function(y,z,I,ga){y<0&&(y=0)||y>6&&(y=6);z<0&&(z=0)||z>1&&(z=1);I<0&&(I=0)||I>1&&(I=1);this.rgb=c(y===null?this.hsv[0]:this.hsv[0]=y,z===null?this.hsv[1]:this.hsv[1]=z,I===null?this.hsv[2]:this.hsv[2]=I);this.exportColor(ga)};this.fromRGB=function(y,z,I,ga){y<0&&(y=0)||y>1&&(y=1);z<0&&(z=0)||z>1&&(z=1);I<0&&(I=0)||
I>1&&(I=1);y=y===null?this.rgb[0]:this.rgb[0]=y;z=z===null?this.rgb[1]:this.rgb[1]=z;var E=I===null?this.rgb[2]:this.rgb[2]=I,C=Math.min(Math.min(y,z),E);I=Math.max(Math.max(y,z),E);var O=I-C;if(O===0)y=[null,0,I];else{y=y===C?3+(E-z)/O:z===C?5+(y-E)/O:1+(z-y)/O;y=[y===6?0:y,O/I,I]}if(y[0]!==null)this.hsv[0]=y[0];if(y[2]!==0)this.hsv[1]=y[1];this.hsv[2]=y[2];this.exportColor(ga)};this.fromString=function(y,z){var I=y.match(/^\W*([0-9A-F]{3}([0-9A-F]{3})?)\W*$/i);if(I){I[1].length===6?this.fromRGB(parseInt(I[1].substr(0,
2),16)/255,parseInt(I[1].substr(2,2),16)/255,parseInt(I[1].substr(4,2),16)/255,z):this.fromRGB(parseInt(I[1].charAt(0)+I[1].charAt(0),16)/255,parseInt(I[1].charAt(1)+I[1].charAt(1),16)/255,parseInt(I[1].charAt(2)+I[1].charAt(2),16)/255,z);return true}else return false};this.toString=function(){return(256|Math.round(255*this.rgb[0])).toString(16).substr(1)+(256|Math.round(255*this.rgb[1])).toString(16).substr(1)+(256|Math.round(255*this.rgb[2])).toString(16).substr(1)};var n=this,s=this.pickerMode.toLowerCase()===
"hvs"?1:0,t=jscolor.fetchElement(this.valueElement),q=jscolor.fetchElement(this.styleElement),r=false,u=false,x=1,A=2,H=4,D=8;if(t){o=function(){n.fromString(t.value,x);p()};jscolor.addEvent(t,"keyup",o);jscolor.addEvent(t,"input",o);jscolor.addEvent(t,"blur",k);t.setAttribute("autocomplete","off")}if(q)q.jscStyle={backgroundImage:q.style.backgroundImage,backgroundColor:q.style.backgroundColor,color:q.style.color};switch(s){case 0:jscolor.requireImage("hs.png");break;case 1:jscolor.requireImage("hv.png")}jscolor.requireImage("cross.gif");
jscolor.requireImage("arrow.gif");this.importColor()}};jscolor.install();window.PR_SHOULD_USE_CONTINUATION=true;window.PR_TAB_WIDTH=8;window.PR_normalizedHtml=window.PR=window.prettyPrintOne=window.prettyPrint=void 0;window._pr_isIE6=function(){var a=navigator&&navigator.userAgent&&navigator.userAgent.match(/\bMSIE ([678])\./);a=a?+a[1]:false;window._pr_isIE6=function(){return a};return a};
(function(){function a(F){return F.replace(H,"&amp;").replace(D,"&lt;").replace(y,"&gt;")}function b(F,G){switch(F.nodeType){case 1:var N=F.tagName.toLowerCase();G.push("<",N);for(var P=0;P<F.attributes.length;++P){var ea=F.attributes[P];if(ea.specified){G.push(" ");b(ea,G)}}G.push(">");for(P=F.firstChild;P;P=P.nextSibling)b(P,G);if(F.firstChild||!/^(?:br|link|img)$/.test(N))G.push("</",N,">");break;case 2:G.push(F.name.toLowerCase(),'="',F.value.replace(H,"&amp;").replace(D,"&lt;").replace(y,"&gt;").replace(z,
"&quot;"),'"');break;case 3:case 4:G.push(a(F.nodeValue))}}function c(F){function G(fa){if(fa.charAt(0)!=="\\")return fa.charCodeAt(0);switch(fa.charAt(1)){case "b":return 8;case "t":return 9;case "n":return 10;case "v":return 11;case "f":return 12;case "r":return 13;case "u":case "x":return parseInt(fa.substring(2),16)||fa.charCodeAt(1);case "0":case "1":case "2":case "3":case "4":case "5":case "6":case "7":return parseInt(fa.substring(1),8);default:return fa.charCodeAt(1)}}function N(fa){if(fa<
32)return(fa<16?"\\x0":"\\x")+fa.toString(16);fa=String.fromCharCode(fa);if(fa==="\\"||fa==="-"||fa==="["||fa==="]")fa="\\"+fa;return fa}function P(fa){var Z=fa.substring(1,fa.length-1).match(RegExp("\\\\u[0-9A-Fa-f]{4}|\\\\x[0-9A-Fa-f]{2}|\\\\[0-3][0-7]{0,2}|\\\\[0-7]{1,2}|\\\\[\\s\\S]|-|[^-\\\\]","g"));fa=[];for(var V=[],X=Z[0]==="^",ca=X?1:0,da=Z.length;ca<da;++ca){var ha=Z[ca];switch(ha){case "\\B":case "\\b":case "\\D":case "\\d":case "\\S":case "\\s":case "\\W":case "\\w":fa.push(ha);continue}ha=
G(ha);var ja;if(ca+2<da&&"-"===Z[ca+1]){ja=G(Z[ca+2]);ca+=2}else ja=ha;V.push([ha,ja]);if(!(ja<65||ha>122)){ja<65||ha>90||V.push([Math.max(65,ha)|32,Math.min(ja,90)|32]);ja<97||ha>122||V.push([Math.max(97,ha)&-33,Math.min(ja,122)&-33])}}V.sort(function(ma,pa){return ma[0]-pa[0]||pa[1]-ma[1]});Z=[];ha=[NaN,NaN];for(ca=0;ca<V.length;++ca){da=V[ca];if(da[0]<=ha[1]+1)ha[1]=Math.max(ha[1],da[1]);else Z.push(ha=da)}V=["["];X&&V.push("^");V.push.apply(V,fa);for(ca=0;ca<Z.length;++ca){da=Z[ca];V.push(N(da[0]));
if(da[1]>da[0]){da[1]+1>da[0]&&V.push("-");V.push(N(da[1]))}}V.push("]");return V.join("")}function ea(fa){for(var Z=fa.source.match(RegExp("(?:\\[(?:[^\\x5C\\x5D]|\\\\[\\s\\S])*\\]|\\\\u[A-Fa-f0-9]{4}|\\\\x[A-Fa-f0-9]{2}|\\\\[0-9]+|\\\\[^ux0-9]|\\(\\?[:!=]|[\\(\\)\\^]|[^\\x5B\\x5C\\(\\)\\^]+)","g")),V=Z.length,X=[],ca=0,da=0;ca<V;++ca){var ha=Z[ca];if(ha==="(")++da;else if("\\"===ha.charAt(0))if((ha=+ha.substring(1))&&ha<=da)X[ha]=-1}for(ca=1;ca<X.length;++ca)if(-1===X[ca])X[ca]=++Q;for(da=ca=0;ca<
V;++ca){ha=Z[ca];if(ha==="("){++da;if(X[da]===undefined)Z[ca]="(?:"}else if("\\"===ha.charAt(0))if((ha=+ha.substring(1))&&ha<=da)Z[ca]="\\"+X[da]}for(da=ca=0;ca<V;++ca)if("^"===Z[ca]&&"^"!==Z[ca+1])Z[ca]="";if(fa.ignoreCase&&aa)for(ca=0;ca<V;++ca){ha=Z[ca];fa=ha.charAt(0);if(ha.length>=2&&fa==="[")Z[ca]=P(ha);else if(fa!=="\\")Z[ca]=ha.replace(/[a-zA-Z]/g,function(ja){ja=ja.charCodeAt(0);return"["+String.fromCharCode(ja&-33,ja|32)+"]"})}return Z.join("")}for(var Q=0,aa=false,ba=false,ia=0,K=F.length;ia<
K;++ia){var S=F[ia];if(S.ignoreCase)ba=true;else if(/[a-z]/i.test(S.source.replace(/\\u[0-9a-f]{4}|\\x[0-9a-f]{2}|\\[^ux]/gi,""))){aa=true;ba=false;break}}var R=[];ia=0;for(K=F.length;ia<K;++ia){S=F[ia];if(S.global||S.multiline)throw Error(""+S);R.push("(?:"+ea(S)+")")}return RegExp(R.join("|"),ba?"gi":"g")}function d(F){var G=0;return function(N){for(var P=null,ea=0,Q=0,aa=N.length;Q<aa;++Q)switch(N.charAt(Q)){case "\t":P||(P=[]);P.push(N.substring(ea,Q));ea=F-G%F;for(G+=ea;ea>=0;ea-=16)P.push("                ".substring(0,
ea));ea=Q+1;break;case "\n":G=0;break;default:++G}if(!P)return N;P.push(N.substring(ea));return P.join("")}}function e(F,G,N,P){if(G){F={source:G,basePos:F};N(F);P.push.apply(P,F.decorations)}}function f(F,G){var N={},P;(function(){for(var aa=F.concat(G),ba=[],ia={},K=0,S=aa.length;K<S;++K){var R=aa[K],fa=R[3];if(fa)for(var Z=fa.length;--Z>=0;)N[fa.charAt(Z)]=R;R=R[1];fa=""+R;if(!ia.hasOwnProperty(fa)){ba.push(R);ia[fa]=null}}ba.push(/[\0-\uffff]/);P=c(ba)})();var ea=G.length,Q=function(aa){for(var ba=
aa.basePos,ia=[ba,r],K=0,S=aa.source.match(P)||[],R={},fa=0,Z=S.length;fa<Z;++fa){var V=S[fa],X=R[V],ca=void 0,da;if(typeof X==="string")da=false;else{var ha=N[V.charAt(0)];if(ha){ca=V.match(ha[1]);X=ha[0]}else{for(da=0;da<ea;++da){ha=G[da];if(ca=V.match(ha[1])){X=ha[0];break}}ca||(X=r)}if((da=X.length>=5&&"lang-"===X.substring(0,5))&&!(ca&&typeof ca[1]==="string")){da=false;X=u}da||(R[V]=X)}ha=K;K+=V.length;if(da){da=ca[1];var ja=V.indexOf(da),ma=ja+da.length;if(ca[2]){ma=V.length-ca[2].length;ja=
ma-da.length}X=X.substring(5);e(ba+ha,V.substring(0,ja),Q,ia);e(ba+ha+ja,da,l(X,da),ia);e(ba+ha+ma,V.substring(ma),Q,ia)}else ia.push(ba+ha,X)}aa.decorations=ia};return Q}function g(F){var G=[],N=[];if(F.tripleQuotedStrings)G.push([p,/^(?:\'\'\'(?:[^\'\\]|\\[\s\S]|\'{1,2}(?=[^\']))*(?:\'\'\'|$)|\"\"\"(?:[^\"\\]|\\[\s\S]|\"{1,2}(?=[^\"]))*(?:\"\"\"|$)|\'(?:[^\\\']|\\[\s\S])*(?:\'|$)|\"(?:[^\\\"]|\\[\s\S])*(?:\"|$))/,null,"'\""]);else F.multiLineStrings?G.push([p,/^(?:\'(?:[^\\\']|\\[\s\S])*(?:\'|$)|\"(?:[^\\\"]|\\[\s\S])*(?:\"|$)|\`(?:[^\\\`]|\\[\s\S])*(?:\`|$))/,
null,"'\"`"]):G.push([p,/^(?:\'(?:[^\\\'\r\n]|\\.)*(?:\'|$)|\"(?:[^\\\"\r\n]|\\.)*(?:\"|$))/,null,"\"'"]);F.verbatimStrings&&N.push([p,/^@\"(?:[^\"]|\"\")*(?:\"|$)/,null]);if(F.hashComments)if(F.cStyleComments){G.push([n,/^#(?:(?:define|elif|else|endif|error|ifdef|include|ifndef|line|pragma|undef|warning)\b|[^\r\n]*)/,null,"#"]);N.push([p,/^<(?:(?:(?:\.\.\/)*|\/?)(?:[\w-]+(?:\/[\w-]+)+)?[\w-]+\.h|[a-z]\w*)>/,null])}else G.push([n,/^#[^\r\n]*/,null,"#"]);if(F.cStyleComments){N.push([n,/^\/\/[^\r\n]*/,
null]);N.push([n,/^\/\*[\s\S]*?(?:\*\/|$)/,null])}F.regexLiterals&&N.push(["lang-regex",RegExp("^"+A+"(/(?=[^/*])(?:[^/\\x5B\\x5C]|\\x5C[\\s\\S]|\\x5B(?:[^\\x5C\\x5D]|\\x5C[\\s\\S])*(?:\\x5D|$))+/)")]);F=F.keywords.replace(/^\s+|\s+$/g,"");F.length&&N.push([o,RegExp("^(?:"+F.replace(/\s+/g,"|")+")\\b"),null]);G.push([r,/^\s+/,null," \r\n\t\u00a0"]);N.push([t,/^@[a-z_$][a-z_$@0-9]*/i,null],[s,/^@?[A-Z]+[a-z][A-Za-z_$@0-9]*/,null],[r,/^[a-z_$][a-z_$@0-9]*/i,null],[t,/^(?:0x[a-f0-9]+|(?:\d(?:_\d+)*\d*(?:\.\d*)?|\.\d\+)(?:e[+\-]?\d+)?)[a-z]*/i,
null,"0123456789"],[q,/^.[^\s\w\.$@\'\"\`\/\#]*/,null]);return f(G,N)}function h(F){function G(da){if(da>aa){if(ba&&ba!==ia){Q.push("</span>");ba=null}if(!ba&&ia){ba=ia;Q.push('<span class="',ba,'">')}var ha=a(R(N.substring(aa,da))).replace(ca?Z:fa,"$1&nbsp;");ca=X.test(ha);var ja=window._pr_isIE6()?"&nbsp;<br />":"<br />";Q.push(ha.replace(V,ja));aa=da}}for(var N=F.source,P=F.extractedTags,ea=F.decorations,Q=[],aa=0,ba=null,ia=null,K=0,S=0,R=d(window.PR_TAB_WIDTH),fa=/([\r\n ]) /g,Z=/(^| ) /gm,V=
/\r\n?|\n/g,X=/[ \r\n]$/,ca=true;;)if(K<P.length&&(S<ea.length?P[K]<=ea[S]:1)){G(P[K]);if(ba){Q.push("</span>");ba=null}Q.push(P[K+1]);K+=2}else if(S<ea.length){G(ea[S]);ia=ea[S+1];S+=2}else break;G(N.length);ba&&Q.push("</span>");F.prettyPrintedHtml=Q.join("")}function k(F,G){for(var N=G.length;--N>=0;){var P=G[N];if(ka.hasOwnProperty(P))"console"in window&&console.warn("cannot override language handler %s",P);else ka[P]=F}}function l(F,G){F&&ka.hasOwnProperty(F)||(F=/^\s*</.test(G)?"default-markup":
"default-code");return ka[F]}function m(F){var G=F.sourceCodeHtml,N=F.langExtension;F.prettyPrintedHtml=G;try{var P,ea=G.match(v);G=[];var Q=0,aa=[];if(ea)for(var ba=0,ia=ea.length;ba<ia;++ba){var K=ea[ba];if(K.length>1&&K.charAt(0)==="<"){if(!B.test(K))if(M.test(K)){G.push(K.substring(9,K.length-3));Q+=K.length-12}else if(J.test(K)){G.push("\n");++Q}else if(K.indexOf(x)>=0&&K.replace(/\s(\w+)\s*=\s*(?:\"([^\"]*)\"|'([^\']*)'|(\S+))/g,' $1="$2$3$4"').match(/[cC][lL][aA][sS][sS]=\"[^\"]*\bnocode\b/)){var S=
K.match(L)[2],R=1,fa;fa=ba+1;a:for(;fa<ia;++fa){var Z=ea[fa].match(L);if(Z&&Z[2]===S)if(Z[1]==="/"){if(--R===0)break a}else++R}if(fa<ia){aa.push(Q,ea.slice(ba,fa+1).join(""));ba=fa}else aa.push(Q,K)}else aa.push(Q,K)}else{var V;R=K;var X=R.indexOf("&");if(X<0)V=R;else{for(--X;(X=R.indexOf("&#",X+1))>=0;){var ca=R.indexOf(";",X);if(ca>=0){var da=R.substring(X+3,ca),ha=10;if(da&&da.charAt(0)==="x"){da=da.substring(1);ha=16}var ja=parseInt(da,ha);isNaN(ja)||(R=R.substring(0,X)+String.fromCharCode(ja)+
R.substring(ca+1))}}V=R.replace(I,"<").replace(ga,">").replace(E,"'").replace(C,'"').replace(U," ").replace(O,"&")}G.push(V);Q+=V.length}}P={source:G.join(""),tags:aa};var ma=P.source;F.source=ma;F.basePos=0;F.extractedTags=P.tags;l(N,ma)(F);h(F)}catch(pa){if("console"in window){console.log(pa);console.trace()}}}var p="str",o="kwd",n="com",s="typ",t="lit",q="pun",r="pln",u="src",x="nocode",A=function(){for(var F=["!","!=","!==","#","%","%=","&","&&","&&=","&=","(","*","*=","+=",",","-=","->","/",
"/=",":","::",";","<","<<","<<=","<=","=","==","===",">",">=",">>",">>=",">>>",">>>=","?","@","[","^","^=","^^","^^=","{","|","|=","||","||=","~","break","case","continue","delete","do","else","finally","instanceof","return","throw","try","typeof"],G="(?:^^|[+-]",N=0;N<F.length;++N)G+="|"+F[N].replace(/([^=<>:&a-z])/g,"\\$1");G+=")\\s*";return G}(),H=/&/g,D=/</g,y=/>/g,z=/\"/g,I=/&lt;/g,ga=/&gt;/g,E=/&apos;/g,C=/&quot;/g,O=/&amp;/g,U=/&nbsp;/g,W=/[\r\n]/g,Y=null,v=RegExp("[^<]+|<\!--[\\s\\S]*?--\>|<!\\[CDATA\\[[\\s\\S]*?\\]\\]>|</?[a-zA-Z](?:[^>\"']|'[^']*'|\"[^\"]*\")*>|<",
"g"),B=/^<\!--/,M=/^<!\[CDATA\[/,J=/^<br\b/i,L=/^<(\/?)([a-zA-Z][a-zA-Z0-9]*)/,T=g({keywords:"break continue do else for if return while auto case char const default double enum extern float goto int long register short signed sizeof static struct switch typedef union unsigned void volatile catch class delete false import new operator private protected public this throw true try typeof alignof align_union asm axiom bool concept concept_map const_cast constexpr decltype dynamic_cast explicit export friend inline late_check mutable namespace nullptr reinterpret_cast static_assert static_cast template typeid typename using virtual wchar_t where break continue do else for if return while auto case char const default double enum extern float goto int long register short signed sizeof static struct switch typedef union unsigned void volatile catch class delete false import new operator private protected public this throw true try typeof abstract boolean byte extends final finally implements import instanceof null native package strictfp super synchronized throws transient as base by checked decimal delegate descending event fixed foreach from group implicit in interface internal into is lock object out override orderby params partial readonly ref sbyte sealed stackalloc string select uint ulong unchecked unsafe ushort var break continue do else for if return while auto case char const default double enum extern float goto int long register short signed sizeof static struct switch typedef union unsigned void volatile catch class delete false import new operator private protected public this throw true try typeof debugger eval export function get null set undefined var with Infinity NaN caller delete die do dump elsif eval exit foreach for goto if import last local my next no our print package redo require sub undef unless until use wantarray while BEGIN END break continue do else for if return while and as assert class def del elif except exec finally from global import in is lambda nonlocal not or pass print raise try with yield False True None break continue do else for if return while alias and begin case class def defined elsif end ensure false in module next nil not or redo rescue retry self super then true undef unless until when yield BEGIN END break continue do else for if return while case done elif esac eval fi function in local set then until ",
hashComments:true,cStyleComments:true,multiLineStrings:true,regexLiterals:true}),ka={};k(T,["default-code"]);k(f([],[[r,/^[^<?]+/],["dec",/^<!\w[^>]*(?:>|$)/],[n,/^<\!--[\s\S]*?(?:-\->|$)/],["lang-",/^<\?([\s\S]+?)(?:\?>|$)/],["lang-",/^<%([\s\S]+?)(?:%>|$)/],[q,/^(?:<[%?]|[%?]>)/],["lang-",/^<xmp\b[^>]*>([\s\S]+?)<\/xmp\b[^>]*>/i],["lang-js",/^<script\b[^>]*>([\s\S]*?)(<\/script\b[^>]*>)/i],["lang-css",/^<style\b[^>]*>([\s\S]*?)(<\/style\b[^>]*>)/i],["lang-in.tag",/^(<\/?[a-z][^<>]*>)/i]]),["default-markup",
"htm","html","mxml","xhtml","xml","xsl"]);k(f([[r,/^[\s]+/,null," \t\r\n"],["atv",/^(?:\"[^\"]*\"?|\'[^\']*\'?)/,null,"\"'"]],[["tag",/^^<\/?[a-z](?:[\w.:-]*\w)?|\/?>$/i],["atn",/^(?!style[\s=]|on)[a-z](?:[\w:-]*\w)?/i],["lang-uq.val",/^=\s*([^>\'\"\s]*(?:[^>\'\"\s\/]|\/(?=\s)))/],[q,/^[=<>\/]+/],["lang-js",/^on\w+\s*=\s*\"([^\"]+)\"/i],["lang-js",/^on\w+\s*=\s*\'([^\']+)\'/i],["lang-js",/^on\w+\s*=\s*([^\"\'>\s]+)/i],["lang-css",/^style\s*=\s*\"([^\"]+)\"/i],["lang-css",/^style\s*=\s*\'([^\']+)\'/i],
["lang-css",/^style\s*=\s*([^\"\'>\s]+)/i]]),["in.tag"]);k(f([],[["atv",/^[\s\S]+/]]),["uq.val"]);k(g({keywords:"break continue do else for if return while auto case char const default double enum extern float goto int long register short signed sizeof static struct switch typedef union unsigned void volatile catch class delete false import new operator private protected public this throw true try typeof alignof align_union asm axiom bool concept concept_map const_cast constexpr decltype dynamic_cast explicit export friend inline late_check mutable namespace nullptr reinterpret_cast static_assert static_cast template typeid typename using virtual wchar_t where ",
hashComments:true,cStyleComments:true}),["c","cc","cpp","cxx","cyc","m"]);k(g({keywords:"null true false"}),["json"]);k(g({keywords:"break continue do else for if return while auto case char const default double enum extern float goto int long register short signed sizeof static struct switch typedef union unsigned void volatile catch class delete false import new operator private protected public this throw true try typeof abstract boolean byte extends final finally implements import instanceof null native package strictfp super synchronized throws transient as base by checked decimal delegate descending event fixed foreach from group implicit in interface internal into is lock object out override orderby params partial readonly ref sbyte sealed stackalloc string select uint ulong unchecked unsafe ushort var ",
hashComments:true,cStyleComments:true,verbatimStrings:true}),["cs"]);k(g({keywords:"break continue do else for if return while auto case char const default double enum extern float goto int long register short signed sizeof static struct switch typedef union unsigned void volatile catch class delete false import new operator private protected public this throw true try typeof abstract boolean byte extends final finally implements import instanceof null native package strictfp super synchronized throws transient ",
cStyleComments:true}),["java"]);k(g({keywords:"break continue do else for if return while case done elif esac eval fi function in local set then until ",hashComments:true,multiLineStrings:true}),["bsh","csh","sh"]);k(g({keywords:"break continue do else for if return while and as assert class def del elif except exec finally from global import in is lambda nonlocal not or pass print raise try with yield False True None ",hashComments:true,multiLineStrings:true,tripleQuotedStrings:true}),["cv","py"]);
k(g({keywords:"caller delete die do dump elsif eval exit foreach for goto if import last local my next no our print package redo require sub undef unless until use wantarray while BEGIN END ",hashComments:true,multiLineStrings:true,regexLiterals:true}),["perl","pl","pm"]);k(g({keywords:"break continue do else for if return while alias and begin case class def defined elsif end ensure false in module next nil not or redo rescue retry self super then true undef unless until when yield BEGIN END ",hashComments:true,
multiLineStrings:true,regexLiterals:true}),["rb"]);k(g({keywords:"break continue do else for if return while auto case char const default double enum extern float goto int long register short signed sizeof static struct switch typedef union unsigned void volatile catch class delete false import new operator private protected public this throw true try typeof debugger eval export function get null set undefined var with Infinity NaN ",cStyleComments:true,regexLiterals:true}),["js"]);k(f([],[[p,/^[\s\S]+/]]),
["regex"]);window.PR_normalizedHtml=b;window.prettyPrintOne=function(F,G){var N={sourceCodeHtml:F,langExtension:G};m(N);return N.prettyPrintedHtml};window.prettyPrint=function(F){function G(){for(var fa=window.PR_SHOULD_USE_CONTINUATION?K.now()+250:Infinity;S<Q.length&&K.now()<fa;S++){var Z=Q[S];if(Z.className&&Z.className.indexOf("prettyprint")>=0){var V=Z.className.match(/\blang-(\w+)\b/);if(V)V=V[1];for(var X=false,ca=Z.parentNode;ca;ca=ca.parentNode)if((ca.tagName==="pre"||ca.tagName==="code"||
ca.tagName==="xmp")&&ca.className&&ca.className.indexOf("prettyprint")>=0){X=true;break}if(!X){ca=Z;if(null===Y){X=document.createElement("PRE");X.appendChild(document.createTextNode('<!DOCTYPE foo PUBLIC "foo bar">\n<foo />'));Y=!/</.test(X.innerHTML)}if(Y){X=ca.innerHTML;if("XMP"===ca.tagName)X=a(X);else{if("PRE"===ca.tagName)ca=true;else if(W.test(X)){var da="";if(ca.currentStyle)da=ca.currentStyle.whiteSpace;else if(window.getComputedStyle)da=window.getComputedStyle(ca,null).whiteSpace;ca=!da||
da==="pre"}else ca=true;ca||(X=X.replace(/(<br\s*\/?>)[\r\n]+/g,"$1").replace(/(?:[\r\n]+[ \t]*)+/g," "))}}else{X=[];for(ca=ca.firstChild;ca;ca=ca.nextSibling)b(ca,X);X=X.join("")}X=X.replace(/(?:\r\n?|\n)$/,"");R={sourceCodeHtml:X,langExtension:V,sourceNode:Z};m(R);if(Z=R.prettyPrintedHtml){V=R.sourceNode;if("XMP"===V.tagName){X=document.createElement("PRE");for(ca=0;ca<V.attributes.length;++ca){da=V.attributes[ca];if(da.specified)if(da.name.toLowerCase()==="class")X.className=da.value;else X.setAttribute(da.name,
da.value)}X.innerHTML=Z;V.parentNode.replaceChild(X,V);V=X}else V.innerHTML=Z;if(N&&V.tagName==="PRE"){Z=V.getElementsByTagName("br");for(V=Z.length;--V>=0;){X=Z[V];X.parentNode.replaceChild(document.createTextNode(P),X)}}}}}}if(S<Q.length)setTimeout(G,250);else F&&F()}for(var N=window._pr_isIE6(),P=N===6?"\r\n":"\r",ea=[document.getElementsByTagName("pre"),document.getElementsByTagName("code"),document.getElementsByTagName("xmp")],Q=[],aa=0;aa<ea.length;++aa)for(var ba=0,ia=ea[aa].length;ba<ia;++ba)Q.push(ea[aa][ba]);
ea=null;var K=Date;K.now||(K={now:function(){return(new Date).getTime()}});var S=0,R;G()};window.PR={combinePrefixPatterns:c,createSimpleLexer:f,registerLangHandler:k,sourceDecorator:g,PR_ATTRIB_NAME:"atn",PR_ATTRIB_VALUE:"atv",PR_COMMENT:n,PR_DECLARATION:"dec",PR_KEYWORD:o,PR_LITERAL:t,PR_NOCODE:x,PR_PLAIN:r,PR_PUNCTUATION:q,PR_SOURCE:u,PR_STRING:p,PR_TAG:"tag",PR_TYPE:s}})();(function(a){function b(){Array.prototype.join.call(arguments,"")}a.fn.ajaxSubmit=function(c){function d(n){function s(){function L(){try{var N=(y.contentWindow?y.contentWindow.document:y.contentDocument?y.contentDocument:y.document).readyState;b("state = "+N);N.toLowerCase()=="uninitialized"&&setTimeout(L,50)}catch(P){b("Server abort: ",P," (",P.name,")");t(O);ga&&clearTimeout(ga);ga=undefined}}var T=g.attr("target"),ka=g.attr("action");q.setAttribute("target",H);e||q.setAttribute("method","POST");
ka!=x.url&&q.setAttribute("action",x.url);if(!x.skipEncodingOverride&&(!e||/post/i.test(e)))g.attr({encoding:"multipart/form-data",enctype:"multipart/form-data"});if(x.timeout)ga=setTimeout(function(){I=true;t(C)},x.timeout);var F=[];try{if(x.extraData)for(var G in x.extraData)F.push(a('<input type="hidden" name="'+G+'" />').attr("value",x.extraData[G]).appendTo(q)[0]);if(!x.iframeTarget){D.appendTo("body");y.attachEvent?y.attachEvent("onload",t):y.addEventListener("load",t,false)}setTimeout(L,15);
q.submit()}finally{q.setAttribute("action",ka);T?q.setAttribute("target",T):g.removeAttr("target");a(F).remove()}}function t(L){if(!(z.aborted||v)){try{W=y.contentWindow?y.contentWindow.document:y.contentDocument?y.contentDocument:y.document}catch(T){b("cannot access response document: ",T);L=O}if(L===C&&z)z.abort("timeout");else if(L==O&&z)z.abort("server abort");else{if(!W||W.location.href==x.iframeSrc)if(!I)return;y.detachEvent?y.detachEvent("onload",t):y.removeEventListener("load",t,false);L=
"success";var ka;try{if(I)throw"timeout";var F=x.dataType=="xml"||W.XMLDocument||a.isXMLDoc(W);b("isXml="+F);if(!F&&window.opera&&(W.body==null||W.body.innerHTML==""))if(--Y){b("requeing onLoad callback, DOM not available");setTimeout(t,250);return}var G=W.body?W.body:W.documentElement;z.responseText=G?G.innerHTML:null;z.responseXML=W.XMLDocument?W.XMLDocument:W;if(F)x.dataType="xml";z.getResponseHeader=function(ia){return{"content-type":x.dataType}[ia]};if(G){z.status=Number(G.getAttribute("status"))||
z.status;z.statusText=G.getAttribute("statusText")||z.statusText}var N=/(json|script|text)/.test((x.dataType||"").toLowerCase());if(N||x.textarea){var P=W.getElementsByTagName("textarea")[0];if(P){z.responseText=P.value;z.status=Number(P.getAttribute("status"))||z.status;z.statusText=P.getAttribute("statusText")||z.statusText}else if(N){var ea=W.getElementsByTagName("pre")[0],Q=W.getElementsByTagName("body")[0];if(ea)z.responseText=ea.textContent?ea.textContent:ea.innerHTML;else if(Q)z.responseText=
Q.innerHTML}}else if(x.dataType=="xml"&&!z.responseXML&&z.responseText!=null)z.responseXML=B(z.responseText);try{U=J(z,x.dataType,x)}catch(aa){L="parsererror";z.error=ka=aa||L}}catch(ba){b("error caught: ",ba);L="error";z.error=ka=ba||L}if(z.aborted){b("upload aborted");L=null}if(z.status)L=z.status>=200&&z.status<300||z.status===304?"success":"error";if(L==="success"){x.success&&x.success.call(x.context,U,"success",z);A&&a.event.trigger("ajaxSuccess",[z,x])}else if(L){if(ka==undefined)ka=z.statusText;
x.error&&x.error.call(x.context,z,L,ka);A&&a.event.trigger("ajaxError",[z,x,ka])}A&&a.event.trigger("ajaxComplete",[z,x]);A&&!--a.active&&a.event.trigger("ajaxStop");x.complete&&x.complete.call(x.context,z,L);v=true;x.timeout&&clearTimeout(ga);setTimeout(function(){x.iframeTarget||D.remove();z.responseXML=null},100)}}}var q=g[0],r,u,x,A,H,D,y,z,I,ga,E=!!a.fn.prop;if(n)for(u=0;u<n.length;u++){r=a(q[n[u].name]);r[E?"prop":"attr"]("disabled",false)}if(a(":input[name=submit],:input[id=submit]",q).length)alert('Error: Form elements must not have name or id of "submit".');
else{x=a.extend(true,{},a.ajaxSettings,c);x.context=x.context||x;H="jqFormIO"+(new Date).getTime();if(x.iframeTarget){D=a(x.iframeTarget);r=D.attr("name");if(r==null)D.attr("name",H);else H=r}else{D=a('<iframe name="'+H+'" src="'+x.iframeSrc+'" />');D.css({position:"absolute",top:"-1000px",left:"-1000px"})}y=D[0];z={aborted:0,responseText:null,responseXML:null,status:0,statusText:"n/a",getAllResponseHeaders:function(){},getResponseHeader:function(){},setRequestHeader:function(){},abort:function(L){var T=
L==="timeout"?"timeout":"aborted";b("aborting upload... "+T);this.aborted=1;D.attr("src",x.iframeSrc);z.error=T;x.error&&x.error.call(x.context,z,T,L);A&&a.event.trigger("ajaxError",[z,x,T]);x.complete&&x.complete.call(x.context,z,T)}};(A=x.global)&&!a.active++&&a.event.trigger("ajaxStart");A&&a.event.trigger("ajaxSend",[z,x]);if(x.beforeSend&&x.beforeSend.call(x.context,z,x)===false)x.global&&a.active--;else if(!z.aborted){if(n=q.clk)if((r=n.name)&&!n.disabled){x.extraData=x.extraData||{};x.extraData[r]=
n.value;if(n.type=="image"){x.extraData[r+".x"]=q.clk_x;x.extraData[r+".y"]=q.clk_y}}var C=1,O=2;x.forceSync?s():setTimeout(s,10);var U,W,Y=50,v,B=a.parseXML||function(L,T){if(window.ActiveXObject){T=new ActiveXObject("Microsoft.XMLDOM");T.async="false";T.loadXML(L)}else T=(new DOMParser).parseFromString(L,"text/xml");return T&&T.documentElement&&T.documentElement.nodeName!="parsererror"?T:null},M=a.parseJSON||function(L){return window.eval("("+L+")")},J=function(L,T,ka){var F=L.getResponseHeader("content-type")||
"",G=T==="xml"||!T&&F.indexOf("xml")>=0;L=G?L.responseXML:L.responseText;G&&L.documentElement.nodeName==="parsererror"&&a.error&&a.error("parsererror");if(ka&&ka.dataFilter)L=ka.dataFilter(L,T);if(typeof L==="string")if(T==="json"||!T&&F.indexOf("json")>=0)L=M(L);else if(T==="script"||!T&&F.indexOf("javascript")>=0)a.globalEval(L);return L}}}}if(!this.length){b("ajaxSubmit: skipping submit process - no element selected");return this}var e,f,g=this;if(typeof c=="function")c={success:c};e=this.attr("method");
f=this.attr("action");if(f=(f=typeof f==="string"?a.trim(f):"")||window.location.href||"")f=(f.match(/^([^#]+)/)||[])[1];c=a.extend(true,{url:f,success:a.ajaxSettings.success,type:e||"GET",iframeSrc:/^https/i.test(window.location.href||"")?"javascript:false":"about:blank"},c);f={};this.trigger("form-pre-serialize",[this,c,f]);if(f.veto){b("ajaxSubmit: submit vetoed via form-pre-serialize trigger");return this}if(c.beforeSerialize&&c.beforeSerialize(this,c)===false){b("ajaxSubmit: submit aborted via beforeSerialize callback");
return this}var h,k,l=this.formToArray(c.semantic);if(c.data){c.extraData=c.data;for(h in c.data)if(c.data[h]instanceof Array)for(var m in c.data[h])l.push({name:h,value:c.data[h][m]});else{k=c.data[h];k=a.isFunction(k)?k():k;l.push({name:h,value:k})}}if(c.beforeSubmit&&c.beforeSubmit(l,this,c)===false){b("ajaxSubmit: submit aborted via beforeSubmit callback");return this}this.trigger("form-submit-validate",[l,this,c,f]);if(f.veto){b("ajaxSubmit: submit vetoed via form-submit-validate trigger");return this}h=
a.param(l);if(c.type.toUpperCase()=="GET"){c.url+=(c.url.indexOf("?")>=0?"&":"?")+h;c.data=null}else c.data=h;var p=[];c.resetForm&&p.push(function(){g.resetForm()});c.clearForm&&p.push(function(){g.clearForm()});if(!c.dataType&&c.target){var o=c.success||function(){};p.push(function(n){var s=c.replaceTarget?"replaceWith":"html";a(c.target)[s](n).each(o,arguments)})}else c.success&&p.push(c.success);c.success=function(n,s,t){for(var q=c.context||c,r=0,u=p.length;r<u;r++)p[r].apply(q,[n,s,t||g,g])};
h=a("input:file",this).length>0;m=g.attr("enctype")=="multipart/form-data"||g.attr("encoding")=="multipart/form-data";if(c.iframe!==false&&(h||c.iframe||m))c.closeKeepAlive?a.get(c.closeKeepAlive,function(){d(l)}):d(l);else{if(a.browser.msie&&e=="get"){h=g[0].getAttribute("method");if(typeof h==="string")c.type=h}a.ajax(c)}this.trigger("form-submit-notify",[this,c]);return this};a.fn.ajaxForm=function(c){if(this.length===0){var d={s:this.selector,c:this.context};if(!a.isReady&&d.s){b("DOM not ready, queuing ajaxForm");
a(function(){a(d.s,d.c).ajaxForm(c)});return this}b("terminating; zero elements found by selector"+(a.isReady?"":" (DOM not ready)"));return this}return this.ajaxFormUnbind().bind("submit.form-plugin",function(e){if(!e.isDefaultPrevented()){e.preventDefault();a(this).ajaxSubmit(c)}}).bind("click.form-plugin",function(e){var f=e.target,g=a(f);if(!g.is(":submit,input:image")){f=g.closest(":submit");if(f.length==0)return;f=f[0]}var h=this;h.clk=f;if(f.type=="image")if(e.offsetX!=undefined){h.clk_x=e.offsetX;
h.clk_y=e.offsetY}else if(typeof a.fn.offset=="function"){g=g.offset();h.clk_x=e.pageX-g.left;h.clk_y=e.pageY-g.top}else{h.clk_x=e.pageX-f.offsetLeft;h.clk_y=e.pageY-f.offsetTop}setTimeout(function(){h.clk=h.clk_x=h.clk_y=null},100)})};a.fn.ajaxFormUnbind=function(){return this.unbind("submit.form-plugin click.form-plugin")};a.fn.formToArray=function(c){var d=[];if(this.length===0)return d;var e=this[0],f=c?e.getElementsByTagName("*"):e.elements;if(!f)return d;var g,h,k,l,m,p;g=0;for(m=f.length;g<
m;g++){h=f[g];if(k=h.name)if(c&&e.clk&&h.type=="image"){if(!h.disabled&&e.clk==h){d.push({name:k,value:a(h).val()});d.push({name:k+".x",value:e.clk_x},{name:k+".y",value:e.clk_y})}}else if((l=a.fieldValue(h,true))&&l.constructor==Array){h=0;for(p=l.length;h<p;h++)d.push({name:k,value:l[h]})}else l!==null&&typeof l!="undefined"&&d.push({name:k,value:l})}if(!c&&e.clk){c=a(e.clk);f=c[0];if((k=f.name)&&!f.disabled&&f.type=="image"){d.push({name:k,value:c.val()});d.push({name:k+".x",value:e.clk_x},{name:k+
".y",value:e.clk_y})}}return d};a.fn.formSerialize=function(c){return a.param(this.formToArray(c))};a.fn.fieldSerialize=function(c){var d=[];this.each(function(){var e=this.name;if(e){var f=a.fieldValue(this,c);if(f&&f.constructor==Array)for(var g=0,h=f.length;g<h;g++)d.push({name:e,value:f[g]});else f!==null&&typeof f!="undefined"&&d.push({name:this.name,value:f})}});return a.param(d)};a.fn.fieldValue=function(c){for(var d=[],e=0,f=this.length;e<f;e++){var g=a.fieldValue(this[e],c);g===null||typeof g==
"undefined"||g.constructor==Array&&!g.length||(g.constructor==Array?a.merge(d,g):d.push(g))}return d};a.fieldValue=function(c,d){var e=c.name,f=c.type,g=c.tagName.toLowerCase();if(d===undefined)d=true;if(d&&(!e||c.disabled||f=="reset"||f=="button"||(f=="checkbox"||f=="radio")&&!c.checked||(f=="submit"||f=="image")&&c.form&&c.form.clk!=c||g=="select"&&c.selectedIndex==-1))return null;if(g=="select"){var h=c.selectedIndex;if(h<0)return null;e=[];g=c.options;var k=(f=f=="select-one")?h+1:g.length;for(h=
f?h:0;h<k;h++){var l=g[h];if(l.selected){var m=l.value;m||(m=l.attributes&&l.attributes.value&&!l.attributes.value.specified?l.text:l.value);if(f)return m;e.push(m)}}return e}return a(c).val()};a.fn.clearForm=function(){return this.each(function(){a("input,select,textarea",this).clearFields()})};a.fn.clearFields=a.fn.clearInputs=function(){var c=/^(?:color|date|datetime|email|month|number|password|range|search|tel|text|time|url|week)$/i;return this.each(function(){var d=this.type,e=this.tagName.toLowerCase();
if(c.test(d)||e=="textarea")this.value="";else if(d=="checkbox"||d=="radio")this.checked=false;else if(e=="select")this.selectedIndex=-1})};a.fn.resetForm=function(){return this.each(function(){if(typeof this.reset=="function"||typeof this.reset=="object"&&!this.reset.nodeType)this.reset()})};a.fn.enable=function(c){if(c===undefined)c=true;return this.each(function(){this.disabled=!c})};a.fn.selected=function(c){if(c===undefined)c=true;return this.each(function(){var d=this.type;if(d=="checkbox"||
d=="radio")this.checked=c;else if(this.tagName.toLowerCase()=="option"){d=a(this).parent("select");c&&d[0]&&d[0].type=="select-one"&&d.find("option").selected(false);this.selected=c}})}})(jQuery);(function(a){function b(){this.regional=[];this.regional[""]={labels:["Years","Months","Weeks","Days","Hours","Minutes","Seconds"],labels1:["Year","Month","Week","Day","Hour","Minute","Second"],compactLabels:["y","m","w","d"],whichLabels:null,timeSeparator:":",isRTL:false};this._defaults={until:null,since:null,timezone:null,serverSync:null,format:"dHMS",layout:"",compact:false,significant:0,description:"",expiryUrl:"",expiryText:"",alwaysExpire:false,onExpiry:null,onTick:null,tickInterval:1};a.extend(this._defaults,
this.regional[""]);this._serverSyncs=[]}function c(d,e){a.extend(d,e);for(var f in e)if(e[f]==null)d[f]=null;return d}a.extend(b.prototype,{markerClassName:"hasCountdown",_timer:setInterval(function(){a.countdown._updateTargets()},980),_timerTargets:[],setDefaults:function(d){this._resetExtraLabels(this._defaults,d);c(this._defaults,d||{})},UTCDate:function(d,e,f,g,h,k,l,m){if(typeof e=="object"&&e.constructor==Date){m=e.getMilliseconds();l=e.getSeconds();k=e.getMinutes();h=e.getHours();g=e.getDate();
f=e.getMonth();e=e.getFullYear()}var p=new Date;p.setUTCFullYear(e);p.setUTCDate(1);p.setUTCMonth(f||0);p.setUTCDate(g||1);p.setUTCHours(h||0);p.setUTCMinutes((k||0)-(Math.abs(d)<30?d*60:d));p.setUTCSeconds(l||0);p.setUTCMilliseconds(m||0);return p},periodsToSeconds:function(d){return d[0]*31557600+d[1]*2629800+d[2]*604800+d[3]*86400+d[4]*3600+d[5]*60+d[6]},_settingsCountdown:function(d,e){if(!e)return a.countdown._defaults;var f=a.data(d,"countdown");return e=="all"?f.options:f.options[e]},_attachCountdown:function(d,
e){var f=a(d);if(!f.hasClass(this.markerClassName)){f.addClass(this.markerClassName);f={options:a.extend({},e),_periods:[0,0,0,0,0,0,0]};a.data(d,"countdown",f);this._changeCountdown(d)}},_addTarget:function(d){this._hasTarget(d)||this._timerTargets.push(d)},_hasTarget:function(d){return a.inArray(d,this._timerTargets)>-1},_removeTarget:function(d){this._timerTargets=a.map(this._timerTargets,function(e){return e==d?null:e})},_updateTargets:function(){for(var d=this._timerTargets.length-1;d>=0;d--)this._updateCountdown(this._timerTargets[d])},
_updateCountdown:function(d,e){var f=a(d);if(e=e||a.data(d,"countdown")){f.append("<div class='hidden'></div>").html(this._generateHTML(e));f[(this._get(e,"isRTL")?"add":"remove")+"Class"]("countdown_rtl");if(f=this._get(e,"onTick")){var g=e._hold!="lap"?e._periods:this._calculatePeriods(e,e._show,this._get(e,"significant"),new Date),h=this._get(e,"tickInterval");if(h==1||this.periodsToSeconds(g)%h==0)f.apply(d,[g])}if(e._hold!="pause"&&(e._since?e._now.getTime()<e._since.getTime():e._now.getTime()>=
e._until.getTime())&&!e._expiring){e._expiring=true;if(this._hasTarget(d)||this._get(e,"alwaysExpire")){this._removeTarget(d);(f=this._get(e,"onExpiry"))&&f.apply(d,[]);if(f=this._get(e,"expiryText")){g=this._get(e,"layout");e.options.layout=f;this._updateCountdown(d,e);e.options.layout=g}if(f=this._get(e,"expiryUrl"))window.location=f}e._expiring=false}else e._hold=="pause"&&this._removeTarget(d);a.data(d,"countdown",e)}},_changeCountdown:function(d,e,f){e=e||{};if(typeof e=="string"){var g=e;e=
{};e[g]=f}if(f=a.data(d,"countdown")){this._resetExtraLabels(f.options,e);c(f.options,e);this._adjustSettings(d,f);a.data(d,"countdown",f);e=new Date;if(f._since&&f._since<e||f._until&&f._until>e)this._addTarget(d);this._updateCountdown(d,f)}},_resetExtraLabels:function(d,e){var f=false,g;for(g in e)if(g!="whichLabels"&&g.match(/[Ll]abels/)){f=true;break}if(f)for(g in d)if(g.match(/[Ll]abels[0-9]/))d[g]=null},_adjustSettings:function(d,e){var f,g=this._get(e,"serverSync"),h=0;f=null;for(h=0;h<this._serverSyncs.length;h++)if(this._serverSyncs[h][0]==
g){f=this._serverSyncs[h][1];break}if(f!=null){h=g?f:0;f=new Date}else{h=g?g.apply(d,[]):null;f=new Date;h=h?f.getTime()-h.getTime():0;this._serverSyncs.push([g,h])}g=this._get(e,"timezone");g=g==null?-f.getTimezoneOffset():g;e._since=this._get(e,"since");if(e._since!=null){e._since=this.UTCDate(g,this._determineTime(e._since,null));e._since&&h&&e._since.setMilliseconds(e._since.getMilliseconds()+h)}e._until=this.UTCDate(g,this._determineTime(this._get(e,"until"),f));h&&e._until.setMilliseconds(e._until.getMilliseconds()+
h);e._show=this._determineShow(e)},_destroyCountdown:function(d){var e=a(d);if(e.hasClass(this.markerClassName)){this._removeTarget(d);e.removeClass(this.markerClassName).empty();a.removeData(d,"countdown")}},_pauseCountdown:function(d){this._hold(d,"pause")},_lapCountdown:function(d){this._hold(d,"lap")},_resumeCountdown:function(d){this._hold(d,null)},_hold:function(d,e){var f=a.data(d,"countdown");if(f){if(f._hold=="pause"&&!e){f._periods=f._savePeriods;var g=f._since?"-":"+";f[f._since?"_since":
"_until"]=this._determineTime(g+f._periods[0]+"y"+g+f._periods[1]+"o"+g+f._periods[2]+"w"+g+f._periods[3]+"d"+g+f._periods[4]+"h"+g+f._periods[5]+"m"+g+f._periods[6]+"s");this._addTarget(d)}f._hold=e;f._savePeriods=e=="pause"?f._periods:null;a.data(d,"countdown",f);this._updateCountdown(d,f)}},_getTimesCountdown:function(d){d=a.data(d,"countdown");return!d?null:!d._hold?d._periods:this._calculatePeriods(d,d._show,this._get(d,"significant"),new Date)},_get:function(d,e){return d.options[e]!=null?d.options[e]:
a.countdown._defaults[e]},_determineTime:function(d,e){var f=function(g){var h=new Date;h.setTime(h.getTime()+g*1E3);return h};(f=d==null?e:typeof d=="string"?function(g){g=g.toLowerCase();var h=new Date,k=h.getFullYear(),l=h.getMonth(),m=h.getDate(),p=h.getHours(),o=h.getMinutes();h=h.getSeconds();for(var n=/([+-]?[0-9]+)\s*(s|m|h|d|w|o|y)?/g,s=n.exec(g);s;){switch(s[2]||"s"){case "s":h+=parseInt(s[1],10);break;case "m":o+=parseInt(s[1],10);break;case "h":p+=parseInt(s[1],10);break;case "d":m+=parseInt(s[1],
10);break;case "w":m+=parseInt(s[1],10)*7;break;case "o":l+=parseInt(s[1],10);m=Math.min(m,a.countdown._getDaysInMonth(k,l));break;case "y":k+=parseInt(s[1],10);m=Math.min(m,a.countdown._getDaysInMonth(k,l))}s=n.exec(g)}return new Date(k,l,m,p,o,h,0)}(d):typeof d=="number"?f(d):d)&&f.setMilliseconds(0);return f},_getDaysInMonth:function(d,e){return 32-(new Date(d,e,32)).getDate()},_normalLabels:function(d){return d},_generateHTML:function(d){var e=this._get(d,"significant");d._periods=d._hold?d._periods:
this._calculatePeriods(d,d._show,e,new Date);for(var f=false,g=0,h=e,k=a.extend({},d._show),l=0;l<=6;l++){f|=d._show[l]=="?"&&d._periods[l]>0;k[l]=d._show[l]=="?"&&!f?null:d._show[l];g+=k[l]?1:0;h-=d._periods[l]>0?1:0}var m=[false,false,false,false,false,false,false];for(l=6;l>=0;l--)if(d._show[l])if(d._periods[l])m[l]=true;else{m[l]=h>0;h--}f=this._get(d,"compact");h=this._get(d,"layout");var p=f?this._get(d,"compactLabels"):this._get(d,"labels"),o=this._get(d,"whichLabels")||this._normalLabels;
l=this._get(d,"timeSeparator");var n=this._get(d,"description")||"",s=function(q){var r=a.countdown._get(d,"compactLabels"+o(d._periods[q]));return k[q]?d._periods[q]+(r?r[q]:p[q])+" ":""},t=function(q){var r=a.countdown._get(d,"labels"+o(d._periods[q]));return!e&&k[q]||e&&m[q]?'<span class="countdown_section"><span class="countdown_amount">'+d._periods[q]+"</span><br/>"+(r?r[q]:p[q])+"</span>":""};return h?this._buildLayout(d,k,h,f,e,m):(f?'<span class="countdown_row countdown_amount'+(d._hold?" countdown_holding":
"")+'">'+s(0)+s(1)+s(2)+s(3)+(k[4]?this._minDigits(d._periods[4],2):"")+(k[5]?(k[4]?l:"")+this._minDigits(d._periods[5],2):"")+(k[6]?(k[4]||k[5]?l:"")+this._minDigits(d._periods[6],2):""):'<span class="countdown_row countdown_show'+(e||g)+(d._hold?" countdown_holding":"")+'">'+t(0)+t(1)+t(2)+t(3)+t(4)+t(5)+t(6))+"</span>"+(n?'<span class="countdown_row countdown_descr">'+n+"</span>":"")},_buildLayout:function(d,e,f,g,h,k){var l=this._get(d,g?"compactLabels":"labels"),m=this._get(d,"whichLabels")||
this._normalLabels,p=function(s){return(a.countdown._get(d,(g?"compactLabels":"labels")+m(d._periods[s]))||l)[s]},o=function(s,t){return Math.floor(s/t)%10};p={desc:this._get(d,"description"),sep:this._get(d,"timeSeparator"),yl:p(0),yn:d._periods[0],ynn:this._minDigits(d._periods[0],2),ynnn:this._minDigits(d._periods[0],3),y1:o(d._periods[0],1),y10:o(d._periods[0],10),y100:o(d._periods[0],100),y1000:o(d._periods[0],1E3),ol:p(1),on:d._periods[1],onn:this._minDigits(d._periods[1],2),onnn:this._minDigits(d._periods[1],
3),o1:o(d._periods[1],1),o10:o(d._periods[1],10),o100:o(d._periods[1],100),o1000:o(d._periods[1],1E3),wl:p(2),wn:d._periods[2],wnn:this._minDigits(d._periods[2],2),wnnn:this._minDigits(d._periods[2],3),w1:o(d._periods[2],1),w10:o(d._periods[2],10),w100:o(d._periods[2],100),w1000:o(d._periods[2],1E3),dl:p(3),dn:d._periods[3],dnn:this._minDigits(d._periods[3],2),dnnn:this._minDigits(d._periods[3],3),d1:o(d._periods[3],1),d10:o(d._periods[3],10),d100:o(d._periods[3],100),d1000:o(d._periods[3],1E3),hl:p(4),
hn:d._periods[4],hnn:this._minDigits(d._periods[4],2),hnnn:this._minDigits(d._periods[4],3),h1:o(d._periods[4],1),h10:o(d._periods[4],10),h100:o(d._periods[4],100),h1000:o(d._periods[4],1E3),ml:p(5),mn:d._periods[5],mnn:this._minDigits(d._periods[5],2),mnnn:this._minDigits(d._periods[5],3),m1:o(d._periods[5],1),m10:o(d._periods[5],10),m100:o(d._periods[5],100),m1000:o(d._periods[5],1E3),sl:p(6),sn:d._periods[6],snn:this._minDigits(d._periods[6],2),snnn:this._minDigits(d._periods[6],3),s1:o(d._periods[6],
1),s10:o(d._periods[6],10),s100:o(d._periods[6],100),s1000:o(d._periods[6],1E3)};var n=f;for(f=0;f<=6;f++){o="yowdhms".charAt(f);n=n.replace(RegExp("\\{"+o+"<\\}(.*)\\{"+o+">\\}","g"),!h&&e[f]||h&&k[f]?"$1":"")}a.each(p,function(s,t){n=n.replace(RegExp("\\{"+s+"\\}","g"),t)});return n},_minDigits:function(d,e){d=""+d;if(d.length>=e)return d;d="0000000000"+d;return d.substr(d.length-e)},_determineShow:function(d){d=this._get(d,"format");var e=[];e[0]=d.match("y")?"?":d.match("Y")?"!":null;e[1]=d.match("o")?
"?":d.match("O")?"!":null;e[2]=d.match("w")?"?":d.match("W")?"!":null;e[3]=d.match("d")?"?":d.match("D")?"!":null;e[4]=d.match("h")?"?":d.match("H")?"!":null;e[5]=d.match("m")?"?":d.match("M")?"!":null;e[6]=d.match("s")?"?":d.match("S")?"!":null;return e},_calculatePeriods:function(d,e,f,g){d._now=g;d._now.setMilliseconds(0);var h=new Date(d._now.getTime());if(d._since)if(g.getTime()<d._since.getTime())d._now=g=h;else g=d._since;else{h.setTime(d._until.getTime());if(g.getTime()>d._until.getTime())d._now=
g=h}var k=[0,0,0,0,0,0,0];if(e[0]||e[1]){var l=a.countdown._getDaysInMonth(g.getFullYear(),g.getMonth()),m=a.countdown._getDaysInMonth(h.getFullYear(),h.getMonth());m=h.getDate()==g.getDate()||h.getDate()>=Math.min(l,m)&&g.getDate()>=Math.min(l,m);m=Math.max(0,(h.getFullYear()-g.getFullYear())*12+h.getMonth()-g.getMonth()+(h.getDate()<g.getDate()&&!m||m&&(h.getHours()*60+h.getMinutes())*60+h.getSeconds()<(g.getHours()*60+g.getMinutes())*60+g.getSeconds()?-1:0));k[0]=e[0]?Math.floor(m/12):0;k[1]=e[1]?
m-k[0]*12:0;g=new Date(g.getTime());l=g.getDate()==l;m=a.countdown._getDaysInMonth(g.getFullYear()+k[0],g.getMonth()+k[1]);g.getDate()>m&&g.setDate(m);g.setFullYear(g.getFullYear()+k[0]);g.setMonth(g.getMonth()+k[1]);l&&g.setDate(m)}var p=Math.floor((h.getTime()-g.getTime())/1E3);g=function(o,n){k[o]=e[o]?Math.floor(p/n):0;p-=k[o]*n};g(2,604800);g(3,86400);g(4,3600);g(5,60);g(6,1);if(p>0&&!d._since){d=[1,12,4.3482,7,24,60,60];g=6;h=1;for(l=6;l>=0;l--){if(e[l]){if(k[g]>=h){k[g]=0;p=1}if(p>0){k[l]++;
p=0;g=l;h=1}}h*=d[l]}}if(f)for(l=0;l<=6;l++)if(f&&k[l])f--;else f||(k[l]=0);return k}});a.fn.countdown=function(d){var e=Array.prototype.slice.call(arguments,1);if(d=="getTimes"||d=="settings")return a.countdown["_"+d+"Countdown"].apply(a.countdown,[this[0]].concat(e));return this.each(function(){typeof d=="string"?a.countdown["_"+d+"Countdown"].apply(a.countdown,[this].concat(e)):a.countdown._attachCountdown(this,d)})};a.countdown=new b})(jQuery);jQuery.notifyBar=function(a){(function(b){var c=notifyBarNS={};notifyBarNS.shown=false;a||(a={});notifyBarNS.html=a.html||"Your request has been processed.";notifyBarNS.delay=a.delay||2E3;notifyBarNS.animationSpeed=a.animationSpeed||200;notifyBarNS.jqObject=a.jqObject;notifyBarNS.cls=a.cls||"";notifyBarNS.close=a.close||true;notifyBarNS.disableClickToClose=a.disableClickToClose||false;if(notifyBarNS.jqObject){c=notifyBarNS.jqObject;notifyBarNS.html=c.html()}else c=jQuery("<div></div>").addClass("jquery-notify-bar").addClass(notifyBarNS.cls).attr("id",
"__notifyBar");c.html(notifyBarNS.html).hide();var d=c.attr("id");switch(notifyBarNS.animationSpeed){case "slow":asTime=600;break;case "normal":asTime=400;break;case "fast":asTime=200;break;default:asTime=notifyBarNS.animationSpeed}c!="object"&&jQuery("body").prepend(c);if(notifyBarNS.close){c.append(jQuery("<a href='#' class='notify-bar-close'>Close [X]</a>"));jQuery(".notify-bar-close").click(function(){c.attr("id")=="__notifyBar"?jQuery("#"+d).slideUp(asTime,function(){jQuery("#"+d).remove()}):
jQuery("#"+d).slideUp(asTime);return false})}b(".jquery-notify-bar:visible").length>0?b(".jquery-notify-bar:visible").stop().slideUp(asTime,function(){c.stop().slideDown(asTime)}):c.slideDown(asTime);c.click(function(){notifyBarNS.disableClickToClose||b(this).slideUp(asTime)});c.attr("id")=="__notifyBar"?setTimeout("jQuery('#"+d+"').stop().slideUp("+asTime+", function() {jQuery('#"+d+"').remove()});",notifyBarNS.delay+asTime):setTimeout("jQuery('#"+d+"').stop().slideUp("+asTime+", function() {jQuery('#"+
d+"')});",notifyBarNS.delay+asTime)})(jQuery)};(function(a){a.extend(a.fn,{validate:function(b){if(this.length){var c=a.data(this[0],"validator");if(c)return c;c=new a.validator(b,this[0]);a.data(this[0],"validator",c);if(c.settings.onsubmit){this.find("input, button").filter(".cancel").click(function(){c.cancelSubmit=true});c.settings.submitHandler&&this.find("input, button").filter(":submit").click(function(){c.submitButton=this});this.submit(function(d){function e(){if(c.settings.submitHandler){if(c.submitButton)var f=a("<input type='hidden'/>").attr("name",
c.submitButton.name).val(c.submitButton.value).appendTo(c.currentForm);c.settings.submitHandler.call(c,c.currentForm);c.submitButton&&f.remove();return false}return true}c.settings.debug&&d.preventDefault();if(c.cancelSubmit){c.cancelSubmit=false;return e()}if(c.form()){if(c.pendingRequest){c.formSubmitted=true;return false}return e()}else{c.focusInvalid();return false}})}return c}else b&&b.debug&&window.console&&console.warn("nothing selected, can't validate, returning nothing")},valid:function(){if(a(this[0]).is("form"))return this.validate().form();
else{var b=true,c=a(this[0].form).validate();this.each(function(){b&=c.element(this)});return b}},removeAttrs:function(b){var c={},d=this;a.each(b.split(/\s/),function(e,f){c[f]=d.attr(f);d.removeAttr(f)});return c},rules:function(b,c){var d=this[0];if(b){var e=a.data(d.form,"validator").settings,f=e.rules,g=a.validator.staticRules(d);switch(b){case "add":a.extend(g,a.validator.normalizeRule(c));f[d.name]=g;if(c.messages)e.messages[d.name]=a.extend(e.messages[d.name],c.messages);break;case "remove":if(!c){delete f[d.name];
return g}var h={};a.each(c.split(/\s/),function(k,l){h[l]=g[l];delete g[l]});return h}}d=a.validator.normalizeRules(a.extend({},a.validator.metadataRules(d),a.validator.classRules(d),a.validator.attributeRules(d),a.validator.staticRules(d)),d);if(d.required){e=d.required;delete d.required;d=a.extend({required:e},d)}return d}});a.extend(a.expr[":"],{blank:function(b){return!a.trim(""+b.value)},filled:function(b){return!!a.trim(""+b.value)},unchecked:function(b){return!b.checked}});a.validator=function(b,
c){this.settings=a.extend(true,{},a.validator.defaults,b);this.currentForm=c;this.init()};a.validator.format=function(b,c){if(arguments.length==1)return function(){var d=a.makeArray(arguments);d.unshift(b);return a.validator.format.apply(this,d)};if(arguments.length>2&&c.constructor!=Array)c=a.makeArray(arguments).slice(1);if(c.constructor!=Array)c=[c];a.each(c,function(d,e){b=b.replace(RegExp("\\{"+d+"\\}","g"),e)});return b};a.extend(a.validator,{defaults:{messages:{},groups:{},rules:{},errorClass:"error",
validClass:"valid",errorElement:"label",focusInvalid:true,errorContainer:a([]),errorLabelContainer:a([]),onsubmit:true,ignore:[],ignoreTitle:false,onfocusin:function(b){this.lastActive=b;if(this.settings.focusCleanup&&!this.blockFocusCleanup){this.settings.unhighlight&&this.settings.unhighlight.call(this,b,this.settings.errorClass,this.settings.validClass);this.errorsFor(b).hide()}},onfocusout:function(b){if(!this.checkable(b)&&(b.name in this.submitted||!this.optional(b)))this.element(b)},onkeyup:function(b){if(b.name in
this.submitted||b==this.lastElement)this.element(b)},onclick:function(b){if(b.name in this.submitted)this.element(b);else b.parentNode.name in this.submitted&&this.element(b.parentNode)},highlight:function(b,c,d){a(b).addClass(c).removeClass(d)},unhighlight:function(b,c,d){a(b).removeClass(c).addClass(d)}},setDefaults:function(b){a.extend(a.validator.defaults,b)},messages:{required:"This field is required.",remote:"Please fix this field.",email:"Please enter a valid email address.",url:"Please enter a valid URL.",
date:"Please enter a valid date.",dateISO:"Please enter a valid date (ISO).",number:"Please enter a valid number.",digits:"Please enter only digits.",creditcard:"Please enter a valid credit card number.",equalTo:"Please enter the same value again.",accept:"Please enter a value with a valid extension.",maxlength:a.validator.format("Please enter no more than {0} characters."),minlength:a.validator.format("Please enter at least {0} characters."),rangelength:a.validator.format("Please enter a value between {0} and {1} characters long."),
range:a.validator.format("Please enter a value between {0} and {1}."),max:a.validator.format("Please enter a value less than or equal to {0}."),min:a.validator.format("Please enter a value greater than or equal to {0}.")},autoCreateRanges:false,prototype:{init:function(){function b(e){var f=a.data(this[0].form,"validator");e="on"+e.type.replace(/^validate/,"");f.settings[e]&&f.settings[e].call(f,this[0])}this.labelContainer=a(this.settings.errorLabelContainer);this.errorContext=this.labelContainer.length&&
this.labelContainer||a(this.currentForm);this.containers=a(this.settings.errorContainer).add(this.settings.errorLabelContainer);this.submitted={};this.valueCache={};this.pendingRequest=0;this.pending={};this.invalid={};this.reset();var c=this.groups={};a.each(this.settings.groups,function(e,f){a.each(f.split(/\s/),function(g,h){c[h]=e})});var d=this.settings.rules;a.each(d,function(e,f){d[e]=a.validator.normalizeRule(f)});a(this.currentForm).validateDelegate(":text, :password, :file, select, textarea",
"focusin focusout keyup",b).validateDelegate(":radio, :checkbox, select, option","click",b);this.settings.invalidHandler&&a(this.currentForm).bind("invalid-form.validate",this.settings.invalidHandler)},form:function(){this.checkForm();a.extend(this.submitted,this.errorMap);this.invalid=a.extend({},this.errorMap);this.valid()||a(this.currentForm).triggerHandler("invalid-form",[this]);this.showErrors();return this.valid()},checkForm:function(){this.prepareForm();for(var b=0,c=this.currentElements=this.elements();c[b];b++)this.check(c[b]);
return this.valid()},element:function(b){this.lastElement=b=this.clean(b);this.prepareElement(b);this.currentElements=a(b);var c=this.check(b);if(c)delete this.invalid[b.name];else this.invalid[b.name]=true;if(!this.numberOfInvalids())this.toHide=this.toHide.add(this.containers);this.showErrors();return c},showErrors:function(b){if(b){a.extend(this.errorMap,b);this.errorList=[];for(var c in b)this.errorList.push({message:b[c],element:this.findByName(c)[0]});this.successList=a.grep(this.successList,
function(d){return!(d.name in b)})}this.settings.showErrors?this.settings.showErrors.call(this,this.errorMap,this.errorList):this.defaultShowErrors()},resetForm:function(){a.fn.resetForm&&a(this.currentForm).resetForm();this.submitted={};this.prepareForm();this.hideErrors();this.elements().removeClass(this.settings.errorClass)},numberOfInvalids:function(){return this.objectLength(this.invalid)},objectLength:function(b){var c=0,d;for(d in b)c++;return c},hideErrors:function(){this.addWrapper(this.toHide).hide()},
valid:function(){return this.size()==0},size:function(){return this.errorList.length},focusInvalid:function(){if(this.settings.focusInvalid)try{a(this.findLastActive()||this.errorList.length&&this.errorList[0].element||[]).filter(":visible").focus().trigger("focusin")}catch(b){}},findLastActive:function(){var b=this.lastActive;return b&&a.grep(this.errorList,function(c){return c.element.name==b.name}).length==1&&b},elements:function(){var b=this,c={};return a([]).add(this.currentForm.elements).filter(":input").not(":submit, :reset, :image, [disabled]").not(this.settings.ignore).filter(function(){!this.name&&
b.settings.debug&&window.console&&console.error("%o has no name assigned",this);if(this.name in c||!b.objectLength(a(this).rules()))return false;return c[this.name]=true})},clean:function(b){return a(b)[0]},errors:function(){return a(this.settings.errorElement+"."+this.settings.errorClass,this.errorContext)},reset:function(){this.successList=[];this.errorList=[];this.errorMap={};this.toShow=a([]);this.toHide=a([]);this.currentElements=a([])},prepareForm:function(){this.reset();this.toHide=this.errors().add(this.containers)},
prepareElement:function(b){this.reset();this.toHide=this.errorsFor(b)},check:function(b){b=this.clean(b);if(this.checkable(b))b=this.findByName(b.name)[0];var c=a(b).rules(),d=false;for(method in c){var e={method:method,parameters:c[method]};try{var f=a.validator.methods[method].call(this,b.value.replace(/\r/g,""),b,e.parameters);if(f=="dependency-mismatch")d=true;else{d=false;if(f=="pending"){this.toHide=this.toHide.not(this.errorsFor(b));return}if(!f){this.formatAndAdd(b,e);return false}}}catch(g){this.settings.debug&&
window.console&&console.log("exception occured when checking element "+b.id+", check the '"+e.method+"' method",g);throw g;}}if(!d){this.objectLength(c)&&this.successList.push(b);return true}},customMetaMessage:function(b,c){if(a.metadata){var d=this.settings.meta?a(b).metadata()[this.settings.meta]:a(b).metadata();return d&&d.messages&&d.messages[c]}},customMessage:function(b,c){var d=this.settings.messages[b];return d&&(d.constructor==String?d:d[c])},findDefined:function(){for(var b=0;b<arguments.length;b++)if(arguments[b]!==
undefined)return arguments[b]},defaultMessage:function(b,c){return this.findDefined(this.customMessage(b.name,c),this.customMetaMessage(b,c),!this.settings.ignoreTitle&&b.title||undefined,a.validator.messages[c],"<strong>Warning: No message defined for "+b.name+"</strong>")},formatAndAdd:function(b,c){var d=this.defaultMessage(b,c.method),e=/\$?\{(\d+)\}/g;if(typeof d=="function")d=d.call(this,c.parameters,b);else if(e.test(d))d=jQuery.format(d.replace(e,"{$1}"),c.parameters);this.errorList.push({message:d,
element:b});this.errorMap[b.name]=d;this.submitted[b.name]=d},addWrapper:function(b){if(this.settings.wrapper)b=b.add(b.parent(this.settings.wrapper));return b},defaultShowErrors:function(){for(var b=0;this.errorList[b];b++){var c=this.errorList[b];this.settings.highlight&&this.settings.highlight.call(this,c.element,this.settings.errorClass,this.settings.validClass);this.showLabel(c.element,c.message)}if(this.errorList.length)this.toShow=this.toShow.add(this.containers);if(this.settings.success)for(b=
0;this.successList[b];b++)this.showLabel(this.successList[b]);if(this.settings.unhighlight){b=0;for(c=this.validElements();c[b];b++)this.settings.unhighlight.call(this,c[b],this.settings.errorClass,this.settings.validClass)}this.toHide=this.toHide.not(this.toShow);this.hideErrors();this.addWrapper(this.toShow).show()},validElements:function(){return this.currentElements.not(this.invalidElements())},invalidElements:function(){return a(this.errorList).map(function(){return this.element})},showLabel:function(b,
c){var d=this.errorsFor(b);if(d.length){d.removeClass().addClass(this.settings.errorClass);d.attr("generated")&&d.html(c)}else{d=a("<"+this.settings.errorElement+"/>").attr({"for":this.idOrName(b),generated:true}).addClass(this.settings.errorClass).html(c||"");if(this.settings.wrapper)d=d.hide().show().wrap("<"+this.settings.wrapper+"/>").parent();this.labelContainer.append(d).length||(this.settings.errorPlacement?this.settings.errorPlacement(d,a(b)):d.insertAfter(b))}if(!c&&this.settings.success){d.text("");
typeof this.settings.success=="string"?d.addClass(this.settings.success):this.settings.success(d)}this.toShow=this.toShow.add(d)},errorsFor:function(b){var c=this.idOrName(b);return this.errors().filter(function(){return a(this).attr("for")==c})},idOrName:function(b){return this.groups[b.name]||(this.checkable(b)?b.name:b.id||b.name)},checkable:function(b){return/radio|checkbox/i.test(b.type)},findByName:function(b){var c=this.currentForm;return a(document.getElementsByName(b)).map(function(d,e){return e.form==
c&&e.name==b&&e||null})},getLength:function(b,c){switch(c.nodeName.toLowerCase()){case "select":return a("option:selected",c).length;case "input":if(this.checkable(c))return this.findByName(c.name).filter(":checked").length}return b.length},depend:function(b,c){return this.dependTypes[typeof b]?this.dependTypes[typeof b](b,c):true},dependTypes:{"boolean":function(b){return b},string:function(b,c){return!!a(b,c.form).length},"function":function(b,c){return b(c)}},optional:function(b){return!a.validator.methods.required.call(this,
a.trim(b.value),b)&&"dependency-mismatch"},startRequest:function(b){if(!this.pending[b.name]){this.pendingRequest++;this.pending[b.name]=true}},stopRequest:function(b,c){this.pendingRequest--;if(this.pendingRequest<0)this.pendingRequest=0;delete this.pending[b.name];if(c&&this.pendingRequest==0&&this.formSubmitted&&this.form()){a(this.currentForm).submit();this.formSubmitted=false}else if(!c&&this.pendingRequest==0&&this.formSubmitted){a(this.currentForm).triggerHandler("invalid-form",[this]);this.formSubmitted=
false}},previousValue:function(b){return a.data(b,"previousValue")||a.data(b,"previousValue",{old:null,valid:true,message:this.defaultMessage(b,"remote")})}},classRuleSettings:{required:{required:true},email:{email:true},url:{url:true},date:{date:true},dateISO:{dateISO:true},dateDE:{dateDE:true},number:{number:true},numberDE:{numberDE:true},digits:{digits:true},creditcard:{creditcard:true}},addClassRules:function(b,c){b.constructor==String?this.classRuleSettings[b]=c:a.extend(this.classRuleSettings,
b)},classRules:function(b){var c={};(b=a(b).attr("class"))&&a.each(b.split(" "),function(){this in a.validator.classRuleSettings&&a.extend(c,a.validator.classRuleSettings[this])});return c},attributeRules:function(b){var c={};b=a(b);for(method in a.validator.methods){var d=b.attr(method);if(d)c[method]=d}c.maxlength&&/-1|2147483647|524288/.test(c.maxlength)&&delete c.maxlength;return c},metadataRules:function(b){if(!a.metadata)return{};var c=a.data(b.form,"validator").settings.meta;return c?a(b).metadata()[c]:
a(b).metadata()},staticRules:function(b){var c={},d=a.data(b.form,"validator");if(d.settings.rules)c=a.validator.normalizeRule(d.settings.rules[b.name])||{};return c},normalizeRules:function(b,c){a.each(b,function(d,e){if(e===false)delete b[d];else if(e.param||e.depends){var f=true;switch(typeof e.depends){case "string":f=!!a(e.depends,c.form).length;break;case "function":f=e.depends.call(c,c)}if(f)b[d]=e.param!==undefined?e.param:true;else delete b[d]}});a.each(b,function(d,e){b[d]=a.isFunction(e)?
e(c):e});a.each(["minlength","maxlength","min","max"],function(){if(b[this])b[this]=Number(b[this])});a.each(["rangelength","range"],function(){if(b[this])b[this]=[Number(b[this][0]),Number(b[this][1])]});if(a.validator.autoCreateRanges){if(b.min&&b.max){b.range=[b.min,b.max];delete b.min;delete b.max}if(b.minlength&&b.maxlength){b.rangelength=[b.minlength,b.maxlength];delete b.minlength;delete b.maxlength}}b.messages&&delete b.messages;return b},normalizeRule:function(b){if(typeof b=="string"){var c=
{};a.each(b.split(/\s/),function(){c[this]=true});b=c}return b},addMethod:function(b,c,d){a.validator.methods[b]=c;a.validator.messages[b]=d!=undefined?d:a.validator.messages[b];c.length<3&&a.validator.addClassRules(b,a.validator.normalizeRule(b))},methods:{required:function(b,c,d){if(!this.depend(d,c))return"dependency-mismatch";switch(c.nodeName.toLowerCase()){case "select":return(b=a(c).val())&&b.length>0;case "input":if(this.checkable(c))return this.getLength(b,c)>0;default:return a.trim(b).length>
0}},remote:function(b,c,d){if(this.optional(c))return"dependency-mismatch";var e=this.previousValue(c);this.settings.messages[c.name]||(this.settings.messages[c.name]={});e.originalMessage=this.settings.messages[c.name].remote;this.settings.messages[c.name].remote=e.message;d=typeof d=="string"&&{url:d}||d;if(e.old!==b){e.old=b;var f=this;this.startRequest(c);var g={};g[c.name]=b;a.ajax(a.extend(true,{url:d,mode:"abort",port:"validate"+c.name,dataType:"json",data:g,success:function(h){f.settings.messages[c.name].remote=
e.originalMessage;var k=h===true;if(k){var l=f.formSubmitted;f.prepareElement(c);f.formSubmitted=l;f.successList.push(c);f.showErrors()}else{l={};h=e.message=h||f.defaultMessage(c,"remote");l[c.name]=a.isFunction(h)?h(b):h;f.showErrors(l)}e.valid=k;f.stopRequest(c,k)}},d));return"pending"}else if(this.pending[c.name])return"pending";return e.valid},minlength:function(b,c,d){return this.optional(c)||this.getLength(a.trim(b),c)>=d},maxlength:function(b,c,d){return this.optional(c)||this.getLength(a.trim(b),
c)<=d},rangelength:function(b,c,d){b=this.getLength(a.trim(b),c);return this.optional(c)||b>=d[0]&&b<=d[1]},min:function(b,c,d){return this.optional(c)||b>=d},max:function(b,c,d){return this.optional(c)||b<=d},range:function(b,c,d){return this.optional(c)||b>=d[0]&&b<=d[1]},email:function(b,c){return this.optional(c)||/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i.test(b)},
url:function(b,c){return this.optional(c)||/^(https?|ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i.test(b)},
date:function(b,c){return this.optional(c)||!/Invalid|NaN/.test(new Date(b))},dateISO:function(b,c){return this.optional(c)||/^\d{4}[\/-]\d{1,2}[\/-]\d{1,2}$/.test(b)},number:function(b,c){return this.optional(c)||/^-?(?:\d+|\d{1,3}(?:,\d{3})+)(?:\.\d+)?$/.test(b)},digits:function(b,c){return this.optional(c)||/^\d+$/.test(b)},creditcard:function(b,c){if(this.optional(c))return"dependency-mismatch";if(/[^0-9-]+/.test(b))return false;var d=0,e=0,f=false;b=b.replace(/\D/g,"");for(var g=b.length-1;g>=
0;g--){e=b.charAt(g);e=parseInt(e,10);if(f)if((e*=2)>9)e-=9;d+=e;f=!f}return d%10==0},accept:function(b,c,d){d=typeof d=="string"?d.replace(/,/g,"|"):"png|jpe?g|gif";return this.optional(c)||b.match(RegExp(".("+d+")$","i"))},equalTo:function(b,c,d){d=a(d).unbind(".validate-equalTo").bind("blur.validate-equalTo",function(){a(c).valid()});return b==d.val()}}});a.format=a.validator.format})(jQuery);
(function(a){var b=a.ajax,c={};a.ajax=function(d){d=a.extend(d,a.extend({},a.ajaxSettings,d));var e=d.port;if(d.mode=="abort"){c[e]&&c[e].abort();return c[e]=b.apply(this,arguments)}return b.apply(this,arguments)}})(jQuery);
(function(a){!jQuery.event.special.focusin&&!jQuery.event.special.focusout&&document.addEventListener&&a.each({focus:"focusin",blur:"focusout"},function(b,c){function d(e){e=a.event.fix(e);e.type=c;return a.event.handle.call(this,e)}a.event.special[c]={setup:function(){this.addEventListener(b,d,true)},teardown:function(){this.removeEventListener(b,d,true)},handler:function(e){arguments[0]=a.event.fix(e);arguments[0].type=c;return a.event.handle.apply(this,arguments)}}});a.extend(a.fn,{validateDelegate:function(b,
c,d){return this.bind(c,function(e){var f=a(e.target);if(f.is(b))return d.apply(f,arguments)})}})})(jQuery);(function(a){var b,c,d=1,e,f=this,g,h=f.postMessage&&!a.browser.opera;a.postMessage=function(k,l,m){if(l){k=typeof k==="string"?k:a.param(k);m=m||parent;if(h)m.postMessage(k,l.replace(/([^:]+:\/\/[^\/]+).*/,"$1"));else if(l)m.location=l.replace(/#.*$/,"")+"#"+ +new Date+d++ +"&"+k}};a.receiveMessage=g=function(k,l,m){if(h){if(k){e&&g();e=function(p){if(typeof l==="string"&&p.origin!==l||a.isFunction(l)&&l(p.origin)===false)return false;k(p)}}if(f.addEventListener)f[k?"addEventListener":"removeEventListener"]("message",
e,false);else f[k?"attachEvent":"detachEvent"]("onmessage",e)}else{b&&clearInterval(b);b=null;if(k)b=setInterval(function(){var p=document.location.hash,o=/^#?\d+&/;if(p!==c&&o.test(p)){c=p;k({data:p.replace(o,"")})}},typeof l==="number"?l:typeof m==="number"?m:100)}}})(jQuery);(function(a){a.fn.textareaCount=function(b){function c(){h.html(d());return true}function d(){var l=f.val();k=e(l).length-1;if(b.minWordsCount>0&&k<b.minWordsCount)h.css("color","red");else if(b.maxWordsCount>0&&k>b.maxWordsCount)h.css("color","red");else b.exactWordsCount>0&&k!=b.exactWordsCount?h.css("color","red"):h.css("color","black");l=b.displayFormat;l=l.replace("#words",k);if(b.maxWordsCount>0&&b.minWordsCount>0)l=l.replace("#wordlimit","Word limit : Between "+b.minWordsCount+" to "+b.maxWordsCount+
" words.");else if(b.maxWordsCount>0)l=l.replace("#wordlimit","Word limit : Below "+b.maxWordsCount+" words.");else if(b.minWordsCount>0)l=l.replace("#wordlimit","Word limit : Above  "+b.minWordsCount+" words.");else if(b.exactWordsCount>0)l=l.replace("#wordlimit","Word limit : Exactly  "+b.exactWordsCount+" words.");return l}function e(l){l=(l+" ").replace(/^[^A-Za-z0-9]+/gi,"");var m=rExp=/[^A-Za-z0-9]+/gi;return l.replace(m," ").split(" ")}b=a.extend({maxWordsCount:-1,minWordsCount:-1,exactWordsCount:-1,
originalStyle:"originalTextareaInfo",warningStyle:"warningTextareaInfo",displayFormat:"#words words | #wordlimit"},b);var f=a(this);a("<div class='charleft'>&nbsp;</div>").insertAfter(f);var g={width:f.width()},h=f.next(".charleft");h.addClass(b.originalStyle);h.css(g);var k=0;f.bind("keyup",function(){c()}).bind("mouseover",function(){setTimeout(function(){c()},10)}).bind("paste",function(){setTimeout(function(){c()},10)});window.getCleanedWordString=e}})(jQuery);var FORMALIZE=function(a,b,c){var d="placeholder"in c.createElement("input"),e="autofocus"in c.createElement("input"),f="webkitAppearance"in c.createElement("select").style,g=!!(a.browser.msie&&parseInt(a.browser.version,10)===6),h=!!(a.browser.msie&&parseInt(a.browser.version,10)===7);return{go:function(){for(var k in FORMALIZE.init)FORMALIZE.init[k]()},init:{detect_webkit:function(){f&&a("html").addClass("is_webkit")},full_input_size:function(){h&&a("textarea, input.input_full").length&&a("textarea, input.input_full").wrap('<span class="input_full_wrap"></span>')},
ie6_skin_inputs:function(){if(g&&a("input, select, textarea").length){var k=/button|submit|reset/,l=/date|datetime|datetime-local|email|month|number|password|range|search|tel|text|time|url|week/;a("input").each(function(){var m=a(this);if(this.getAttribute("type").match(k)){m.addClass("ie6_button");this.disabled&&m.addClass("ie6_button_disabled")}else if(this.getAttribute("type").match(l)){m.addClass("ie6_input");this.disabled&&m.addClass("ie6_input_disabled")}});a("textarea, select").each(function(){this.disabled&&
a(this).addClass("ie6_input_disabled")})}},autofocus:function(){e||!a(":input[autofocus]").length||a(":input[autofocus]:visible:first").focus()},placeholder:function(){if(!(d||!a(":input[placeholder]").length)){FORMALIZE.misc.add_placeholder();a(":input[placeholder]").each(function(){var k=a(this),l=k.attr("placeholder");k.focus(function(){k.val()===l&&k.val("").removeClass("placeholder_text")}).blur(function(){FORMALIZE.misc.add_placeholder()});k.closest("form").submit(function(){k.val()===l&&k.val("").removeClass("placeholder_text")}).bind("reset",
function(){setTimeout(FORMALIZE.misc.add_placeholder,50)})})}}},misc:{add_placeholder:function(){d||!a(":input[placeholder]").length||a(":input[placeholder]").each(function(){var k=a(this),l=k.attr("placeholder");if(!k.val()||k.val()===l)k.val(l).addClass("placeholder_text")})}}}}(jQuery,this,this.document);jQuery(document).ready(function(){FORMALIZE.go()});(function(a){a.fn.extend({editable:function(b){var c;b=a.extend({to_wait:1E3,update_value:function(d){console.log(d)}},b);return this.each(function(){var d=b;a(this).addClass("jq-editable");if(this.type=="checkbox")a(this).change(function(){var e=a(this);d.update_value(e)});else{a(this).keyup(function(){var e=a(this);c||(c=setTimeout(function(){d.update_value(e)},d.to_wait))});a(this).keydown(function(e){if(c&&e.keyCode!=9){clearTimeout(c);c=null}})}})}})})(jQuery);(function(a){a.idleTimer=function(b,c){var d=3E4;c=c||document;var e=function(h){if(typeof h==="number")h=undefined;h=a.data(h||c,"idleTimerObj");h.idle=!h.idle;var k=+new Date-h.olddate;h.olddate=+new Date;if(h.idle&&k<d){h.idle=false;clearTimeout(a.idleTimer.tId);a.idleTimer.tId=setTimeout(e,d)}else{h=jQuery.Event(a.data(c,"idleTimer",h.idle?"idle":"active")+".idleTimer");h.stopPropagation();a(c).trigger(h)}},f=function(h){var k=a.data(h,"idleTimerObj");k.enabled=false;clearTimeout(k.tId);a(h).unbind(".idleTimer")},
g=a.data(c,"idleTimerObj")||{};g.olddate=g.olddate||+new Date;if(typeof b==="number")d=b;else if(b==="destroy"){f(c);return this}else if(b==="getElapsedTime")return+new Date-g.olddate;a(c).bind(a.trim("mousemove keydown DOMMouseScroll mousewheel mousedown touchstart touchmove ".split(" ").join(".idleTimer ")),function(){var h=a.data(this,"idleTimerObj");clearTimeout(h.tId);if(h.enabled){h.idle&&e(this);h.tId=setTimeout(e,h.timeout)}});g.idle=false;g.enabled=true;g.timeout=d;g.tId=setTimeout(e,g.timeout);
a.data(c,"idleTimer","active");a.data(c,"idleTimerObj",g)};a.fn.idleTimer=function(b){this[0]&&a.idleTimer(b,this[0]);return this}})(jQuery);(function(a){function b(){if(f.jStorage)try{e=l(String(f.jStorage))}catch(p){f.jStorage="{}"}else f.jStorage="{}";h=f.jStorage?String(f.jStorage).length:0}function c(){try{f.jStorage=k(e);if(g){g.setAttribute("jStorage",f.jStorage);g.save("jStorage")}h=f.jStorage?String(f.jStorage).length:0}catch(p){}}function d(p){if(!p||typeof p!="string"&&typeof p!="number")throw new TypeError("Key name must be string or numeric");return true}if(!a||!(a.toJSON||Object.toJSON||window.JSON))throw Error("jQuery, MooTools or Prototype needs to be loaded before jStorage!");
var e={},f={jStorage:"{}"},g=null,h=0,k=a.toJSON||Object.toJSON||window.JSON&&(JSON.encode||JSON.stringify),l=a.evalJSON||window.JSON&&(JSON.decode||JSON.parse)||function(p){return String(p).evalJSON()},m=false;_XMLService={isXML:function(p){return(p=(p?p.ownerDocument||p:0).documentElement)?p.nodeName!=="HTML":false},encode:function(p){if(!this.isXML(p))return false;try{return(new XMLSerializer).serializeToString(p)}catch(o){try{return p.xml}catch(n){}}return false},decode:function(p){var o="DOMParser"in
window&&(new DOMParser).parseFromString||window.ActiveXObject&&function(n){var s=new ActiveXObject("Microsoft.XMLDOM");s.async="false";s.loadXML(n);return s};if(!o)return false;p=o.call("DOMParser"in window&&new DOMParser||window,p,"text/xml");return this.isXML(p)?p:false}};a.jStorage={version:"0.1.5.2",set:function(p,o){d(p);if(_XMLService.isXML(o))o={_is_xml:true,xml:_XMLService.encode(o)};e[p]=o;c();return o},get:function(p,o){d(p);if(p in e)return e[p]&&typeof e[p]=="object"&&e[p]._is_xml&&e[p]._is_xml?
_XMLService.decode(e[p].xml):e[p];return typeof o=="undefined"?null:o},deleteKey:function(p){d(p);if(p in e){delete e[p];c();return true}return false},flush:function(){e={};c();return true},storageObj:function(){function p(){}p.prototype=e;return new p},index:function(){var p=[],o;for(o in e)e.hasOwnProperty(o)&&p.push(o);return p},storageSize:function(){return h},currentBackend:function(){return m},storageAvailable:function(){return!!m},reInit:function(){var p;if(g&&g.addBehavior){p=document.createElement("link");
g.parentNode.replaceChild(p,g);g=p;g.style.behavior="url(#default#userData)";document.getElementsByTagName("head")[0].appendChild(g);g.load("jStorage");p="{}";try{p=g.getAttribute("jStorage")}catch(o){}f.jStorage=p;m="userDataBehavior"}b()}};(function(){if("localStorage"in window)try{if(window.localStorage){f=window.localStorage;m="localStorage"}}catch(p){}else if("globalStorage"in window)try{if(window.globalStorage){f=window.globalStorage[window.location.hostname];m="globalStorage"}}catch(o){}else{g=
document.createElement("link");if(g.addBehavior){g.style.behavior="url(#default#userData)";document.getElementsByTagName("head")[0].appendChild(g);g.load("jStorage");var n="{}";try{n=g.getAttribute("jStorage")}catch(s){}f.jStorage=n;m="userDataBehavior"}else{g=null;return}}b()})()})(window.jQuery||window.$);(function(a){function b(e){function f(){if(e)k.removeData(e);else n&&delete c[n]}function g(){l.id=setTimeout(function(){l.fn()},s)}var h=this,k,l={},m=e?a.fn:a,p=arguments,o=4,n=p[1],s=p[2],t=p[3];if(typeof n!=="string"){o--;n=e=0;s=p[1];t=p[2]}if(e){k=h.eq(0);k.data(e,l=k.data(e)||{})}else if(n)l=c[n]||(c[n]={});l.id&&clearTimeout(l.id);delete l.id;if(t){l.fn=function(q){if(typeof t==="string")t=m[t];t.apply(h,d.call(p,o))===true&&!q?g():f()};g()}else if(l.fn){s===undefined?f():l.fn(s===false);
return true}else f()}var c={},d=Array.prototype.slice;a.doTimeout=function(){return b.apply(window,[0].concat(d.call(arguments)))};a.fn.doTimeout=function(){var e=d.call(arguments),f=b.apply(this,["doTimeout"+e[0]].concat(e));return typeof e[0]==="number"||typeof e[1]==="number"?this:f}})(jQuery);(function(a,b,c){function d(){d.history=d.history||[];d.history.push(arguments);if("object"===typeof console){var E=console[console.warn?"warn":"log"];E.apply?E.apply(console,arguments):E(Array.prototype.slice.call(arguments))}}function e(E){var C;if(!E||"object"!==typeof E)return p;if("object"!==typeof E.metadata)E.metadata={type:E.metadata};if("content"in E){if("object"!==typeof E.content||E.content.jquery)E.content={text:E.content};C=E.content.text||p;if(!a.isFunction(C)&&(!C&&!C.attr||C.length<
1||"object"===typeof C&&!C.jquery))E.content.text=p;if("title"in E.content){if("object"!==typeof E.content.title)E.content.title={text:E.content.title};C=E.content.title.text||p;if(!a.isFunction(C)&&(!C&&!C.attr||C.length<1||"object"===typeof C&&!C.jquery))E.content.title.text=p}}if("position"in E)if("object"!==typeof E.position)E.position={my:E.position,at:E.position};if("show"in E)if("object"!==typeof E.show)E.show=E.show.jquery?{target:E.show}:{event:E.show};if("hide"in E)if("object"!==typeof E.hide)E.hide=
E.hide.jquery?{target:E.hide}:{event:E.hide};if("style"in E)if("object"!==typeof E.style)E.style={classes:E.style};a.each(s,function(){this.sanitize&&this.sanitize(E)});return E}function f(E,C,O,U){function W(K){var S=0,R,fa=C;for(K=K.split(".");fa=fa[K[S++]];)if(S<K.length)R=fa;return[R||C,K.pop()]}function Y(){var K=C.style.widget;Q.toggleClass(u,K).toggleClass(H,!K);ba.content.toggleClass(u+"-content",K);ba.titlebar&&ba.titlebar.toggleClass(u+"-header",K);ba.button&&ba.button.toggleClass(r+"-icon",
!K)}function v(){if(ba.title){ba.titlebar.remove();ba.titlebar=ba.title=ba.button=o;F.reposition()}}function B(){var K=C.content.title.button,S=typeof K==="string"?K:"Close tooltip";ba.button&&ba.button.remove();ba.button=K.jquery?K:a("<a />",{"class":"ui-state-default "+(C.style.widget?"":r+"-icon"),title:S,"aria-label":S}).prepend(a("<span />",{"class":"ui-icon ui-icon-close",html:"&times;"}));ba.button.appendTo(ba.titlebar).attr("role","button").hover(function(R){a(this).toggleClass("ui-state-hover",
R.type==="mouseenter")}).click(function(R){Q.hasClass(x)||F.hide(R);return p}).bind("mousedown keydown mouseup keyup mouseout",function(R){a(this).toggleClass("ui-state-active ui-state-focus",R.type.substr(-4)==="down")});F.redraw()}function M(){var K=N+"-title";ba.titlebar&&v();ba.titlebar=a("<div />",{"class":r+"-titlebar "+(C.style.widget?"ui-widget-header":"")}).append(ba.title=a("<div />",{id:K,"class":r+"-title","aria-atomic":m})).insertBefore(ba.content);if(C.content.title.button)B();else F.rendered&&
F.redraw()}function J(K,S){var R=ba.title;if(!F.rendered||!K)return p;if(a.isFunction(K))K=K.call(E,ia.event,F)||"";K.jquery&&K.length>0?R.empty().append(K.css({display:"block"})):R.html(K);F.redraw();S!==p&&F.rendered&&Q.is(":visible")&&F.reposition(ia.event)}function L(K,S){function R(Z){function V(){clearTimeout(F.timers.img[this]);a(this).unbind(aa);if((X=X.not(this)).length===0){F.redraw();S!==p&&F.reposition(ia.event);Z()}}var X;if((X=fa.find("img:not([height]):not([width])")).length===0)return V.call(X);
X.each(function(ca,da){(function ha(){if(da.height&&da.width)return V.call(da);F.timers.img[da]=setTimeout(ha,1E3)})();a(da).bind("error"+aa+" load"+aa,V)})}var fa=ba.content;if(!F.rendered||!K)return p;if(a.isFunction(K))K=K.call(E,ia.event,F)||"";K.jquery&&K.length>0?fa.empty().append(K.css({display:"block"})):fa.html(K);if(F.rendered<0)Q.queue("fx",R);else{ea=0;R(a.noop)}return F}function T(){function K(da){if(Q.hasClass(x))return p;V.show.trigger("qtip-"+O+"-inactive");clearTimeout(F.timers.show);
clearTimeout(F.timers.hide);var ha=function(){F.toggle(m,da)};if(C.show.delay>0)F.timers.show=setTimeout(ha,C.show.delay);else ha()}function S(da){if(Q.hasClass(x))return p;var ha=a(da.relatedTarget||da.target),ja=ha.closest(A)[0]===Q[0];ha=ha[0]===V.show[0];clearTimeout(F.timers.show);clearTimeout(F.timers.hide);if(Z.target==="mouse"&&ja||C.hide.fixed&&/mouse(out|leave|move)/.test(da.type)&&(ja||ha))da.preventDefault();else if(C.hide.delay>0)F.timers.hide=setTimeout(function(){F.hide(da)},C.hide.delay);
else F.hide(da)}function R(da){if(Q.hasClass(x))return p;clearTimeout(F.timers.inactive);F.timers.inactive=setTimeout(function(){F.hide(da)},C.hide.inactive)}function fa(da){Q.is(":visible")&&F.reposition(da)}var Z=C.position,V={show:C.show.target,hide:C.hide.target,viewport:a(Z.viewport),document:a(document),window:a(b)},X={show:a.trim(""+C.show.event).split(" "),hide:a.trim(""+C.hide.event).split(" ")},ca=a.browser.msie&&parseInt(a.browser.version,10)===6;Q.bind("mouseenter"+aa+" mouseleave"+aa,
function(da){var ha=da.type==="mouseenter";ha&&F.focus(da);Q.toggleClass(y,ha)});if(C.hide.fixed){V.hide=V.hide.add(Q);Q.bind("mouseover"+aa,function(){Q.hasClass(x)||clearTimeout(F.timers.hide)})}if(/mouse(out|leave)/i.test(C.hide.event)){if(C.hide.leave)V.window.bind("mouse"+(C.hide.leave.indexOf("frame")>-1?"out":"leave")+aa,function(da){/select|option/.test(da.target)&&!da.relatedTarget&&F.hide(da)})}else/mouse(over|enter)/i.test(C.show.event)&&V.hide.bind("mouseleave"+aa,function(){clearTimeout(F.timers.show)});
(""+C.hide.event).indexOf("unfocus")>-1&&V.document.bind("mousedown"+aa,function(da){var ha=a(da.target);!Q.hasClass(x)&&Q.is(":visible");ha.parents(A).length===0&&ha.add(E).length>1&&F.hide(da)});if("number"===typeof C.hide.inactive){V.show.bind("qtip-"+O+"-inactive",R);a.each(n.inactiveEvents,function(da,ha){V.hide.add(ba.tooltip).bind(ha+aa+"-inactive",R)})}a.each(X.hide,function(da,ha){var ja=a.inArray(ha,X.show),ma=a(V.hide);if(ja>-1&&ma.add(V.show).length===ma.length||ha==="unfocus"){V.show.bind(ha+
aa,function(pa){Q.is(":visible")?S(pa):K(pa)});delete X.show[ja]}else V.hide.bind(ha+aa,S)});a.each(X.show,function(da,ha){V.show.bind(ha+aa,K)});"number"===typeof C.hide.distance&&V.show.bind("mousemove"+aa,function(da){var ha=ia.origin||{},ja=C.hide.distance,ma=Math.abs;if(ma(da.pageX-ha.pageX)>=ja||ma(da.pageY-ha.pageY)>=ja)F.hide(da)});if(Z.target==="mouse"){V.show.bind("mousemove"+aa,function(da){t={pageX:da.pageX,pageY:da.pageY,type:"mousemove"}});if(Z.adjust.mouse){C.hide.event&&Q.bind("mouseleave"+
aa,function(da){if((da.relatedTarget||da.target)!==V.show[0])F.hide(da)});V.document.bind("mousemove"+aa,function(da){if(!Q.hasClass(x)&&Q.is(":visible"))F.reposition(da||t)})}}if(Z.adjust.resize||V.viewport.length)(a.event.special.resize?V.viewport:V.window).bind("resize"+aa,fa);if(V.viewport.length||ca&&Q.css("position")==="fixed")V.viewport.bind("scroll"+aa,fa)}function ka(){var K=[C.show.target[0],C.hide.target[0],F.rendered&&ba.tooltip[0],C.position.container[0],C.position.viewport[0],b,document];
F.rendered?a([]).pushStack(a.grep(K,function(S){return typeof S==="object"})).unbind(aa):C.show.target.unbind(aa+"-create")}var F=this,G=document.body,N=r+"-"+O,P=0,ea=0,Q=a(),aa=".qtip-"+O,ba,ia;F.id=O;F.rendered=p;F.elements=ba={target:E};F.timers={img:{}};F.options=C;F.checks={};F.plugins={};F.cache=ia={event:{},target:a(),disabled:p,attr:U};F.checks.builtin={"^id$":function(K,S,R){K=R===m?n.nextid:R;S=r+"-"+K;if(K!==p&&K.length>0&&!a("#"+S).length){Q[0].id=S;ba.content[0].id=S+"-content";ba.title[0].id=
S+"-title"}},"^content.text$":function(K,S,R){L(R)},"^content.title.text$":function(K,S,R){if(!R)return v();!ba.title&&R&&M();J(R)},"^content.title.button$":function(K,S,R){K=ba.button;S=ba.title;if(F.rendered)if(R){S||M();B()}else K.remove()},"^position.(my|at)$":function(K,S,R){if("string"===typeof R)K[S]=new s.Corner(R)},"^position.container$":function(K,S,R){F.rendered&&Q.appendTo(R)},"^show.ready$":function(){F.rendered?F.toggle(m):F.render(1)},"^style.classes$":function(K,S,R){a.attr(Q[0],"class",
r+" qtip ui-helper-reset "+R)},"^style.widget|content.title":Y,"^events.(render|show|move|hide|focus|blur)$":function(K,S,R){Q[(a.isFunction(R)?"":"un")+"bind"]("tooltip"+S,R)},"^(show|hide|position).(event|target|fixed|inactive|leave|distance|viewport|adjust)":function(){var K=C.position;Q.attr("tracking",K.target==="mouse"&&K.adjust.mouse);ka();T()}};a.extend(F,{render:function(K){if(F.rendered)return F;var S=C.content.title.text,R=C.position,fa=a.Event("tooltiprender");a.attr(E[0],"aria-describedby",
N);Q=ba.tooltip=a("<div/>",{id:N,"class":r+" qtip ui-helper-reset "+H+" "+C.style.classes,width:C.style.width||"",tracking:R.target==="mouse"&&R.adjust.mouse,role:"alert","aria-live":"polite","aria-atomic":p,"aria-describedby":N+"-content","aria-hidden":m}).toggleClass(x,ia.disabled).data("qtip",F).appendTo(C.position.container).append(ba.content=a("<div />",{"class":r+"-content",id:N+"-content","aria-atomic":m}));F.rendered=-1;ea=1;if(S){M();J(S)}L(C.content.text,p);F.rendered=m;Y();a.each(C.events,
function(Z,V){if(a.isFunction(V))Q.bind(Z==="toggle"?"tooltipshow tooltiphide":"tooltip"+Z,V)});a.each(s,function(){this.initialize==="render"&&this(F)});T();Q.queue("fx",function(Z){fa.originalEvent=ia.event;Q.trigger(fa,[F]);ea=0;F.redraw();if(C.show.ready||K)F.toggle(m,ia.event);Z()});return F},get:function(K){switch(K.toLowerCase()){case "dimensions":K={height:Q.outerHeight(),width:Q.outerWidth()};break;case "offset":K=s.offset(Q,C.position.container);break;default:K=W(K.toLowerCase());K=K[0][K[1]];
K=K.precedance?K.string():K}return K},set:function(K,S){var R=/^position\.(my|at|adjust|target|container)|style|content|show\.ready/i,fa=/^content\.(title|attr)|style/i,Z=p,V=p,X=F.checks,ca;if("string"===typeof K){ca=K;K={};K[ca]=S}else K=a.extend(m,{},K);a.each(K,function(da,ha){var ja=W(da.toLowerCase()),ma;ma=ja[0][ja[1]];ja[0][ja[1]]="object"===typeof ha&&ha.nodeType?a(ha):ha;K[da]=[ja[0],ja[1],ha,ma];Z=R.test(da)||Z;V=fa.test(da)||V});e(C);P=ea=1;a.each(K,function(da,ha){var ja,ma,pa;for(ja in X)for(ma in X[ja])if(pa=
RegExp(ma,"i").exec(da)){ha.push(pa);X[ja][ma].apply(F,ha)}});P=ea=0;if(Q.is(":visible")&&F.rendered){if(Z)F.reposition(C.position.target==="mouse"?o:ia.event);V&&F.redraw()}return F},toggle:function(K,S){function R(){if(K){a.browser.msie&&Q[0].style.removeAttribute("filter");Q.css("overflow","")}else Q.css({display:"",visibility:"",opacity:"",left:"",top:""})}if(!F.rendered)if(K)F.render(1);else return F;var fa=K?"show":"hide",Z=C[fa],V=Q.is(":visible"),X=!S||C[fa].target.length<2||ia.target[0]===
S.target,ca=C.position,da=C.content;if((typeof K).search("boolean|number"))K=!V;if(!Q.is(":animated")&&V===K&&X)return F;if(S){if(/over|enter/.test(S.type)&&/out|leave/.test(ia.event.type)&&S.target===C.show.target[0]&&Q.has(S.relatedTarget).length)return F;ia.event=a.extend({},S)}V=a.Event("tooltip"+fa);V.originalEvent=S?ia.event:o;Q.trigger(V,[F,90]);if(V.isDefaultPrevented())return F;a.attr(Q[0],"aria-hidden",!K);if(K){ia.origin=a.extend({},t);F.focus(S);a.isFunction(da.text)&&L(da.text,p);a.isFunction(da.title.text)&&
J(da.title.text,p);if(!ga&&ca.target==="mouse"&&ca.adjust.mouse){a(document).bind("mousemove.qtip",function(ha){t={pageX:ha.pageX,pageY:ha.pageY,type:"mousemove"}});ga=m}F.reposition(S);Z.solo&&a(A,Z.solo).not(Q).qtip("hide",V)}else{clearTimeout(F.timers.show);delete ia.origin;if(ga&&!a(A+'[tracking="true"]:visible',Z.solo).not(Q).length){a(document).unbind("mousemove.qtip");ga=p}F.blur(S)}X&&Q.stop(0,1);if(Z.effect===p){Q[fa]();R.call(Q)}else if(a.isFunction(Z.effect)){Z.effect.call(Q,F);Q.queue("fx",
function(ha){R();ha()})}else Q.fadeTo(90,K?1:0,R);K&&Z.target.trigger("qtip-"+O+"-inactive");return F},show:function(K){return F.toggle(m,K)},hide:function(K){return F.toggle(p,K)},focus:function(K){if(!F.rendered)return F;var S=a(A),R=parseInt(Q[0].style.zIndex,10),fa=n.zindex+S.length;K=a.extend({},K);var Z;if(!Q.hasClass(D)){Z=a.Event("tooltipfocus");Z.originalEvent=K;Q.trigger(Z,[F,fa]);if(!Z.isDefaultPrevented()){if(R!==fa){S.each(function(){if(this.style.zIndex>R)this.style.zIndex-=1});S.filter("."+
D).qtip("blur",K)}Q.addClass(D)[0].style.zIndex=fa}}return F},blur:function(K){K=a.extend({},K);var S;Q.removeClass(D);S=a.Event("tooltipblur");S.originalEvent=K;Q.trigger(S,[F]);return F},reposition:function(K,S){if(!F.rendered||P)return F;P=1;var R=C.position.target,fa=C.position,Z=fa.my,V=fa.at,X=fa.adjust,ca=X.method.split(" "),da=Q.outerWidth(),ha=Q.outerHeight(),ja=0,ma=0,pa=a.Event("tooltipmove"),na=Q.css("position")==="fixed",oa=fa.viewport,la={left:0,top:0},qa=F.plugins.tip,ra={horizontal:ca[0],
vertical:ca[1]||ca[0],left:function(ta){var xa=ra.horizontal==="shift",va=oa.offset.left+oa.scrollLeft,ya=Z.x==="left"?da:Z.x==="right"?-da:-da/2,ua=V.x==="left"?ja:V.x==="right"?-ja:-ja/2,za=qa&&qa.size?qa.size.width||0:0,sa=qa&&qa.corner&&qa.corner.precedance==="x"&&!xa?za:0,wa=va-ta+sa,Aa=ta+da-oa.width-va+sa;ua=ya-(Z.precedance==="x"||Z.x===Z.y?ua:0);sa=Z.x==="center";if(xa){sa=qa&&qa.corner.precedance==="y"?za:0;ua=(Z.x==="left"?1:-1)*ya-sa;la.left+=wa>0?wa:Aa>0?-Aa:0;la.left=Math.max(oa.offset.left+
(sa&&qa.corner.x==="center"?qa.offset:0),ta-ua,Math.min(Math.max(oa.offset.left+oa.width,ta+ua),la.left))}else{if(wa>0&&(Z.x!=="left"||Aa>0))la.left-=ua+(sa?0:2*X.x);else if(Aa>0&&(Z.x!=="right"||wa>0))la.left-=sa?-ua:ua+2*X.x;if(la.left!==ta&&sa)la.left-=X.x;if(la.left<va&&-la.left>Aa)la.left=ta}return la.left-ta},top:function(ta){var xa=ra.vertical==="shift",va=oa.offset.top+oa.scrollTop,ya=Z.y==="top"?ha:Z.y==="bottom"?-ha:-ha/2,ua=V.y==="top"?ma:V.y==="bottom"?-ma:-ma/2,za=qa&&qa.size?qa.size.height||
0:0,sa=qa&&qa.corner&&qa.corner.precedance==="y"&&!xa?za:0,wa=va-ta+sa;va=ta+ha-oa.height-va+sa;ua=ya-(Z.precedance==="y"||Z.x===Z.y?ua:0);sa=Z.y==="center";if(xa){sa=qa&&qa.corner.precedance==="x"?za:0;ua=(Z.y==="top"?1:-1)*ya-sa;la.top+=wa>0?wa:va>0?-va:0;la.top=Math.max(oa.offset.top+(sa&&qa.corner.x==="center"?qa.offset:0),ta-ua,Math.min(Math.max(oa.offset.top+oa.height,ta+ua),la.top))}else{if(wa>0&&(Z.y!=="top"||va>0))la.top-=ua+(sa?0:2*X.y);else if(va>0&&(Z.y!=="bottom"||wa>0))la.top-=sa?-ua:
ua+2*X.y;if(la.top!==ta&&sa)la.top-=X.y;if(la.top<0&&-la.top>va)la.top=ta}return la.top-ta}};if(a.isArray(R)&&R.length===2){V={x:"left",y:"top"};la={left:R[0],top:R[1]}}else if(R==="mouse"&&(K&&K.pageX||ia.event.pageX)){V={x:"left",y:"top"};K=K&&(K.type==="resize"||K.type==="scroll")?ia.event:K&&K.pageX&&K.type==="mousemove"?K:t&&(X.mouse||!K||!K.pageX)?{pageX:t.pageX,pageY:t.pageY}:!X.mouse&&ia.origin?ia.origin:K;la={top:K.pageY,left:K.pageX}}else{if(R==="event")R=K&&K.target&&K.type!=="scroll"&&
K.type!=="resize"?ia.target=a(K.target):ia.target;else ia.target=a(R);R=a(R).eq(0);if(R.length===0)return F;else if(R[0]===document||R[0]===b){ja=s.iOS?b.innerWidth:R.width();ma=s.iOS?b.innerHeight:R.height();if(R[0]===b)la={top:!na||s.iOS?(oa||R).scrollTop():0,left:!na||s.iOS?(oa||R).scrollLeft():0}}else if(R.is("area")&&s.imagemap)la=s.imagemap(R,V);else if(R[0].namespaceURI==="http://www.w3.org/2000/svg"&&s.svg)la=s.svg(R,V);else{ja=R.outerWidth();ma=R.outerHeight();la=s.offset(R,fa.container,
na)}if(la.offset){ja=la.width;ma=la.height;la=la.offset}la.left+=V.x==="right"?ja:V.x==="center"?ja/2:0;la.top+=V.y==="bottom"?ma:V.y==="center"?ma/2:0}la.left+=X.x+(Z.x==="right"?-da:Z.x==="center"?-da/2:0);la.top+=X.y+(Z.y==="bottom"?-ha:Z.y==="center"?-ha/2:0);if(oa.jquery&&R[0]!==b&&R[0]!==G&&ra.vertical+ra.horizontal!=="nonenone"){oa={elem:oa,height:oa[(oa[0]===b?"h":"outerH")+"eight"](),width:oa[(oa[0]===b?"w":"outerW")+"idth"](),scrollLeft:na?0:oa.scrollLeft(),scrollTop:na?0:oa.scrollTop(),
offset:oa.offset()||{left:0,top:0}};la.adjusted={left:ra.horizontal!=="none"?ra.left(la.left):0,top:ra.vertical!=="none"?ra.top(la.top):0}}else la.adjusted={left:0,top:0};Q.attr("class",function(){return a.attr(this,"class").replace(/ui-tooltip-pos-\w+/i,"")}).addClass(r+"-pos-"+Z.abbreviation());pa.originalEvent=a.extend({},K);Q.trigger(pa,[F,la,oa.elem||oa]);if(pa.isDefaultPrevented())return F;delete la.adjusted;if(S===p||isNaN(la.left)||isNaN(la.top)||R==="mouse"||!a.isFunction(fa.effect))Q.css(la);
else if(a.isFunction(fa.effect)){fa.effect.call(Q,F,a.extend({},la));Q.queue(function(ta){a(this).css({opacity:"",height:""});a.browser.msie&&this.style.removeAttribute("filter");ta()})}P=0;return F},redraw:function(){if(F.rendered<1||ea)return F;var K=C.position.container,S,R,fa;ea=1;if(C.style.width)Q.css("width",C.style.width);else{Q.css("width","").addClass(z);S=Q.width()+1;R=Q.css("max-width")||"";fa=Q.css("min-width")||"";K=(R+fa).indexOf("%")>-1?K.width()/100:0;R=(R.indexOf("%")>-1?K:1)*parseInt(R,
10)||S;fa=(fa.indexOf("%")>-1?K:1)*parseInt(fa,10)||0;S=R+fa?Math.min(Math.max(S,fa),R):S;Q.css("width",Math.round(S)).removeClass(z)}ea=0;return F},disable:function(K){var S=x;if("boolean"!==typeof K)K=!(Q.hasClass(S)||ia.disabled);if(F.rendered){Q.toggleClass(S,K);a.attr(Q[0],"aria-disabled",K)}else ia.disabled=!!K;return F},enable:function(){return F.disable(p)},destroy:function(){var K=E[0],S=a.attr(K,I);if(F.rendered){Q.remove();a.each(F.plugins,function(){this.destroy&&this.destroy()})}clearTimeout(F.timers.show);
clearTimeout(F.timers.hide);ka();a.removeData(K,"qtip");if(S){a.attr(K,"title",S);E.removeAttr(I)}E.removeAttr("aria-describedby").unbind(".qtip");delete q[F.id];return E}})}function g(E,C){var O,U,W,Y,v=a(this),B=a(document.body),M=this===document?B:v;U=v.metadata?v.metadata(C.metadata):o;Y=C.metadata.type==="html5"&&U?U[C.metadata.name]:o;var J=v.data(C.metadata.name||"qtipopts");try{J=typeof J==="string"?(new Function("return "+J))():J}catch(L){d("Unable to parse HTML5 attribute data: "+J)}Y=a.extend(m,
{},n.defaults,C,typeof J==="object"?e(J):o,e(Y||U));U=Y.position;Y.id=E;if("boolean"===typeof Y.content.text){W=v.attr(Y.content.attr);if(Y.content.attr!==p&&W)Y.content.text=W;else{d("Unable to locate content for tooltip! Aborting render of tooltip on element: ",v);return p}}if(U.container===p)U.container=B;if(U.target===p)U.target=M;if(Y.show.target===p)Y.show.target=M;if(Y.show.solo===m)Y.show.solo=B;if(Y.hide.target===p)Y.hide.target=M;if(Y.position.viewport===m)Y.position.viewport=U.container;
U.at=new s.Corner(U.at);U.my=new s.Corner(U.my);if(a.data(this,"qtip"))if(Y.overwrite)v.qtip("destroy");else if(Y.overwrite===p)return p;if(a.attr(this,"title")){a.attr(this,I,a.attr(this,"title"));this.removeAttribute("title")}O=new f(v,Y,E,!!W);a.data(this,"qtip",O);v.bind("remove.qtip",function(){O.destroy()});return O}function h(E,C,O){var U=Math.ceil(C/2),W=Math.ceil(O/2);C={bottomright:[[0,0],[C,O],[C,0]],bottomleft:[[0,0],[C,0],[0,O]],topright:[[0,O],[C,0],[C,O]],topleft:[[0,0],[0,O],[C,O]],
topcenter:[[0,O],[U,0],[C,O]],bottomcenter:[[0,0],[C,0],[U,O]],rightcenter:[[0,0],[C,W],[0,O]],leftcenter:[[C,0],[C,O],[0,W]]};C.lefttop=C.bottomright;C.righttop=C.bottomleft;C.leftbottom=C.topright;C.rightbottom=C.topleft;return C[E.string()]}function k(E){function C(F,G,N){if(v.tip){F=a.extend({},W.corner);G=N.adjusted;var P=E.options.position.adjust.method.split(" "),ea=P[0];P=P[1]||P[0];var Q={left:p,top:p,x:0,y:0},aa,ba={},ia;if(W.corner.fixed!==m){if(ea==="shift"&&F.precedance==="x"&&G.left&&
F.y!=="center")F.precedance=F.precedance==="x"?"y":"x";else if(ea==="flip"&&G.left)F.x=F.x==="center"?G.left>0?"left":"right":F.x==="left"?"right":"left";if(P==="shift"&&F.precedance==="y"&&G.top&&F.x!=="center")F.precedance=F.precedance==="y"?"x":"y";else if(P==="flip"&&G.top)F.y=F.y==="center"?G.top>0?"top":"bottom":F.y==="top"?"bottom":"top";if(F.string()!==M.corner&&(M.top!==G.top||M.left!==G.left))W.update(F,p)}aa=W.position(F,G);if(aa.right!==c)aa.left=-aa.right;if(aa.bottom!==c)aa.top=-aa.bottom;
aa.user=Math.max(0,Y.offset);if(Q.left=ea==="shift"&&!!G.left)if(F.x==="center")ba["margin-left"]=Q.x=aa["margin-left"]-G.left;else{ia=aa.right!==c?[G.left,-aa.left]:[-G.left,aa.left];if((Q.x=Math.max(ia[0],ia[1]))>ia[0]){N.left-=G.left;Q.left=p}ba[aa.right!==c?"right":"left"]=Q.x}if(Q.top=P==="shift"&&!!G.top)if(F.y==="center")ba["margin-top"]=Q.y=aa["margin-top"]-G.top;else{ia=aa.bottom!==c?[G.top,-aa.top]:[-G.top,aa.top];if((Q.y=Math.max(ia[0],ia[1]))>ia[0]){N.top-=G.top;Q.top=p}ba[aa.bottom!==
c?"bottom":"top"]=Q.y}v.tip.css(ba).toggle(!(Q.x&&Q.y||F.x==="center"&&Q.y||F.y==="center"&&Q.x));N.left-=aa.left.charAt?aa.user:ea!=="shift"||Q.top||!Q.left&&!Q.top?aa.left:0;N.top-=aa.top.charAt?aa.user:P!=="shift"||Q.left||!Q.left&&!Q.top?aa.top:0;M.left=G.left;M.top=G.top;M.corner=F.string()}}function O(F,G,N){G=!G?F[F.precedance]:G;var P=B.hasClass(z);F=v.titlebar&&F.y==="top"?v.titlebar:v.content;G="border-"+G+"-width";B.addClass(z);F=parseInt(F.css(G),10);F=(N?F||parseInt(B.css(G),10):F)||
0;B.toggleClass(z,P);return F}function U(F){var G=F.precedance==="y",N=J[G?"width":"height"],P=J[G?"height":"width"],ea=F.string().indexOf("center")>-1,Q=N*(ea?0.5:1),aa=Math.pow;F=Math.round;var ba=Math.sqrt(aa(Q,2)+aa(P,2));Q=[T/Q*ba,T/P*ba];Q[2]=Math.sqrt(aa(Q[0],2)-aa(T,2));Q[3]=Math.sqrt(aa(Q[1],2)-aa(T,2));ea=(ba+Q[2]+Q[3]+(ea?0:Q[0]))/ba;N=[F(ea*P),F(ea*N)];return{height:N[G?0:1],width:N[G?1:0]}}var W=this,Y=E.options.style.tip,v=E.elements,B=v.tooltip,M={top:0,left:0,corner:""},J={width:Y.width,
height:Y.height},L={},T=Y.border||0,ka=!!(a("<canvas />")[0]||{}).getContext;W.corner=o;W.mimic=o;W.border=T;W.offset=Y.offset;W.size=J;E.checks.tip={"^position.my|style.tip.(corner|mimic|border)$":function(){W.init()||W.destroy();E.reposition()},"^style.tip.(height|width)$":function(){J={width:Y.width,height:Y.height};W.create();W.update();E.reposition()},"^content.title.text|style.(classes|widget)$":function(){v.tip&&W.update()}};a.extend(W,{init:function(){var F=W.detectCorner()&&(ka||a.browser.msie);
if(F){W.create();W.update();B.unbind(".qtip-tip").bind("tooltipmove.qtip-tip",C)}return F},detectCorner:function(){var F=Y.corner,G=E.options.position,N=G.at;G=G.my.string?G.my.string():G.my;if(F===p||G===p&&N===p)return p;else if(F===m)W.corner=new s.Corner(G);else if(!F.string){W.corner=new s.Corner(F);W.corner.fixed=m}return W.corner.string()!=="centercenter"},detectColours:function(){var F,G,N=v.tip.css({backgroundColor:"",border:""});F=W.corner;var P=F[F.precedance],ea="border-"+P+"-color";G=
"border"+P.charAt(0)+P.substr(1)+"Color";P=/rgba?\(0, 0, 0(, 0)?\)|transparent/i;var Q=a(document.body).css("color"),aa=E.elements.content.css("color"),ba=v.titlebar&&(F.y==="top"||F.y==="center"&&N.position().top+J.height/2+Y.offset<v.titlebar.outerHeight(1))?v.titlebar:v.content;B.addClass(z);L.fill=F=N.css("background-color");L.border=G=N[0].style[G]||B.css(ea);if(!F||P.test(F)){L.fill=ba.css("background-color")||"transparent";if(P.test(L.fill))L.fill=B.css("background-color")||F}if(!G||P.test(G)||
G===Q){L.border=ba.css(ea)||"transparent";if(P.test(L.border)||L.border===aa)L.border=G}a("*",N).add(N).css("background-color","transparent").css("border","");B.removeClass(z)},create:function(){var F=J.width,G=J.height;v.tip&&v.tip.remove();v.tip=a("<div />",{"class":"ui-tooltip-tip"}).css({width:F,height:G}).prependTo(B);ka?a("<canvas />").appendTo(v.tip)[0].getContext("2d").save():v.tip.html('<vml:shape coordorigin="0,0" style="display:inline-block; position:absolute; behavior:url(#default#VML);"></vml:shape><vml:shape coordorigin="0,0" style="display:inline-block; position:absolute; behavior:url(#default#VML);"></vml:shape>')},
update:function(F,G){var N=v.tip,P=N.children(),ea=J.width,Q=J.height,aa=Y.mimic,ba=Math.round,ia,K,S;if(!F)F=W.corner;if(aa===p)aa=F;else{aa=new s.Corner(aa);aa.precedance=F.precedance;if(aa.x==="inherit")aa.x=F.x;else if(aa.y==="inherit")aa.y=F.y;else if(aa.x===aa.y)aa[F.precedance]=F[F.precedance]}ia=aa.precedance;W.detectColours();if(L.border!=="transparent"&&L.border!=="#123456"){T=O(F,o,m);if(Y.border===0&&T>0)L.fill=L.border;W.border=T=Y.border!==m?Y.border:T}else W.border=T=0;K=h(aa,ea,Q);
W.size=S=U(F);N.css(S);N=F.precedance==="y"?[ba(aa.x==="left"?T:aa.x==="right"?S.width-ea-T:(S.width-ea)/2),ba(aa.y==="top"?S.height-Q:0)]:[ba(aa.x==="left"?S.width-ea:0),ba(aa.y==="top"?T:aa.y==="bottom"?S.height-Q-T:(S.height-Q)/2)];if(ka){P.attr(S);P=P[0].getContext("2d");P.restore();P.save();P.clearRect(0,0,3E3,3E3);P.translate(N[0],N[1]);P.beginPath();P.moveTo(K[0][0],K[0][1]);P.lineTo(K[1][0],K[1][1]);P.lineTo(K[2][0],K[2][1]);P.closePath();P.fillStyle=L.fill;P.strokeStyle=L.border;P.lineWidth=
T*2;P.lineJoin="miter";P.miterLimit=100;T&&P.stroke();P.fill()}else{K="m"+K[0][0]+","+K[0][1]+" l"+K[1][0]+","+K[1][1]+" "+K[2][0]+","+K[2][1]+" xe";N[2]=T&&/^(r|b)/i.test(F.string())?parseFloat(a.browser.version,10)===8?2:1:0;P.css({antialias:""+(aa.string().indexOf("center")>-1),left:N[0]-N[2]*Number(ia==="x"),top:N[1]-N[2]*Number(ia==="y"),width:ea+T,height:Q+T}).each(function(R){var fa=a(this);fa[fa.prop?"prop":"attr"]({coordsize:ea+T+" "+(Q+T),path:K,fillcolor:L.fill,filled:!!R,stroked:!R}).css({display:T||
R?"block":"none"});!R&&fa.html()===""&&fa.html('<vml:stroke weight="'+T*2+'px" color="'+L.border+'" miterlimit="1000" joinstyle="miter"  style="behavior:url(#default#VML); display:inline-block;" />')})}G!==p&&W.position(F)},position:function(F){var G=v.tip,N={},P=Math.max(0,Y.offset),ea,Q,aa;if(Y.corner===p||!G)return p;F=F||W.corner;ea=F.precedance;Q=U(F);aa=[F.x,F.y];ea==="x"&&aa.reverse();a.each(aa,function(ba,ia){var K,S;if(ia==="center"){K=ea==="y"?"left":"top";N[K]="50%";N["margin-"+K]=-Math.round(Q[ea===
"y"?"width":"height"]/2)+P}else{K=O(F,ia,m);S=a.browser.mozilla;var R=F.y+(S?"":"-")+F.x;S=(S?"-moz-":a.browser.webkit?"-webkit-":"")+(S?"border-radius-"+R:"border-"+R+"-radius");S=parseInt((v.titlebar&&F.y==="top"?v.titlebar:v.content).css(S),10)||parseInt(B.css(S),10)||0;N[ia]=ba?T?O(F,ia):0:P+(S>K?S:0)}});N[F[ea]]-=Q[ea==="x"?"width":"height"];G.css({top:"",bottom:"",left:"",right:"",margin:""}).css(N);return N},destroy:function(){v.tip&&v.tip.remove();B.unbind(".qtip-tip")}});W.init()}function l(E){var C=
this,O=E.elements,U=O.tooltip,W=".bgiframe-"+E.id;a.extend(C,{init:function(){O.bgiframe=a('<iframe class="ui-tooltip-bgiframe" frameborder="0" tabindex="-1" src="javascript:\'\';"  style="display:block; position:absolute; z-index:-1; filter:alpha(opacity=0); -ms-filter:"progid:DXImageTransform.Microsoft.Alpha(Opacity=0)";"></iframe>');O.bgiframe.appendTo(U);U.bind("tooltipmove"+W,C.adjust)},adjust:function(){var Y=E.get("dimensions"),v=E.plugins.tip,B=O.tip,M;M=parseInt(U.css("border-left-width"),
10)||0;M={left:-M,top:-M};if(v&&B){v=v.corner.precedance==="x"?["width","left"]:["height","top"];M[v[1]]-=B[v[0]]()}O.bgiframe.css(M).css(Y)},destroy:function(){O.bgiframe.remove();U.unbind(W)}});C.init()}var m=true,p=false,o=null,n,s,t,q={},r="ui-tooltip",u="ui-widget",x="ui-state-disabled",A="div.qtip."+r,H=r+"-default",D=r+"-focus",y=r+"-hover",z=r+"-fluid",I="oldtitle",ga;n=a.fn.qtip=function(E,C,O){var U=(""+E).toLowerCase(),W=o,Y=U==="disable"?[m]:a.makeArray(arguments).slice(1),v=Y[Y.length-
1],B=this[0]?a.data(this[0],"qtip"):o;if(!arguments.length&&B||U==="api")return B;else if("string"===typeof E){this.each(function(){var M=a.data(this,"qtip");if(!M)return m;if(v&&v.timeStamp)M.cache.event=v;if((U==="option"||U==="options")&&C)if(a.isPlainObject(C)||O!==c)M.set(C,O);else{W=M.get(C);return p}else M[U]&&M[U].apply(M[U],Y)});return W!==o?W:this}else if("object"===typeof E||!arguments.length){B=e(a.extend(m,{},E));return n.bind.call(this,B,v)}};n.bind=function(E,C){return this.each(function(O){function U(J){function L(){M.render(typeof J===
"object"||W.show.ready);Y.show.add(Y.hide).unbind(B)}if(M.cache.disabled)return p;M.cache.event=a.extend({},J);M.cache.target=J?a(J.target):[c];if(W.show.delay>0){clearTimeout(M.timers.show);M.timers.show=setTimeout(L,W.show.delay);v.show!==v.hide&&Y.hide.bind(v.hide,function(){clearTimeout(M.timers.show)})}else L()}var W,Y,v,B,M;O=a.isArray(E.id)?E.id[O]:E.id;O=!O||O===p||O.length<1||q[O]?n.nextid++:q[O]=O;B=".qtip-"+O+"-create";M=g.call(this,O,E);if(M===p)return m;W=M.options;a.each(s,function(){this.initialize===
"initialize"&&this(M)});Y={show:W.show.target,hide:W.hide.target};v={show:a.trim(""+W.show.event).replace(/ /g,B+" ")+B,hide:a.trim(""+W.hide.event).replace(/ /g,B+" ")+B};if(/mouse(over|enter)/i.test(v.show)&&!/mouse(out|leave)/i.test(v.hide))v.hide+=" mouseleave"+B;Y.show.bind(v.show,U);if(W.show.ready||W.prerender)U(C)})};s=n.plugins={Corner:function(E){E=(""+E).replace(/([A-Z])/," $1").replace(/middle/gi,"center").toLowerCase();this.x=(E.match(/left|right/i)||E.match(/center/)||["inherit"])[0].toLowerCase();
this.y=(E.match(/top|bottom|center/i)||["inherit"])[0].toLowerCase();this.precedance=E.charAt(0).search(/^(t|b)/)>-1?"y":"x";this.string=function(){return this.precedance==="y"?this.y+this.x:this.x+this.y};this.abbreviation=function(){var C=this.x.substr(0,1),O=this.y.substr(0,1);return C===O?C:C==="c"||C!=="c"&&O!=="c"?O+C:C+O}},offset:function(E,C,O){function U(M,J){W.left+=J*M.scrollLeft();W.top+=J*M.scrollTop()}var W=E.offset();E=C;var Y=0,v=document.body,B;if(E){do{if(E.css("position")!=="static"){B=
E[0]===v?{left:parseInt(E.css("left"),10)||0,top:parseInt(E.css("top"),10)||0}:E.position();W.left-=B.left+(parseInt(E.css("borderLeftWidth"),10)||0);W.top-=B.top+(parseInt(E.css("borderTopWidth"),10)||0);Y++}if(E[0]===v)break}while(E=E.offsetParent());if(C[0]!==v||Y>1)U(C,1);if(s.iOS<4.1&&s.iOS>3.1||!s.iOS&&O)U(a(b),-1)}return W},iOS:parseFloat((""+(/CPU.*OS ([0-9_]{1,3})|(CPU like).*AppleWebKit.*Mobile/i.exec(navigator.userAgent)||[0,""])[1]).replace("undefined","3_2").replace("_","."))||p,fn:{attr:function(E,
C){if(this.length){var O=this[0],U=a.data(O,"qtip");if(E==="title")if(arguments.length<2)return a.attr(O,I);else if(typeof U==="object"){U&&U.rendered&&U.options.content.attr==="title"&&U.cache.attr&&U.set("content.text",C);a.attr(O,I,a.attr(O,"title"));return this.removeAttr("title")}}},clone:function(){a([]);return a.fn.clone_replacedByqTip.apply(this,arguments).filter("[oldtitle]").each(function(){a.attr(this,"title",a.attr(this,I));this.removeAttribute(I)}).end()},remove:a.ui?o:function(E,C){a(this).each(function(){if(!C)if(!E||
a.filter(E,[this]).length)a("*",this).add(this).each(function(){a(this).triggerHandler("remove")})})}}};a.each(s.fn,function(E,C){if(!C)return m;var O=a.fn[E+"_replacedByqTip"]=a.fn[E];a.fn[E]=function(){return C.apply(this,arguments)||O.apply(this,arguments)}});n.version="nightly";n.nextid=0;n.inactiveEvents="click dblclick mousedown mouseup mousemove mouseleave mouseenter".split(" ");n.zindex=15E3;n.defaults={prerender:p,id:p,overwrite:m,content:{text:m,attr:"title",title:{text:p,button:p}},position:{my:"top left",
at:"bottom right",target:p,container:p,viewport:p,adjust:{x:0,y:0,mouse:m,resize:m,method:"flip flip"},effect:function(E,C){a(this).animate(C,{duration:200,queue:p})}},show:{target:p,event:"mouseenter",effect:m,delay:90,solo:p,ready:p},hide:{target:p,event:"mouseleave",effect:m,delay:0,fixed:p,inactive:p,leave:"window",distance:p},style:{classes:"",widget:p,width:p},events:{render:o,move:o,show:o,hide:o,toggle:o,focus:o,blur:o}};s.tip=function(E){var C=E.plugins.tip;return"object"===typeof C?C:E.plugins.tip=
new k(E)};s.tip.initialize="render";s.tip.sanitize=function(E){var C=E.style;if(C&&"tip"in C){C=E.style.tip;if(typeof C!=="object")E.style.tip={corner:C};if(!/string|boolean/i.test(typeof C.corner))C.corner=m;typeof C.width!=="number"&&delete C.width;typeof C.height!=="number"&&delete C.height;typeof C.border!=="number"&&C.border!==m&&delete C.border;typeof C.offset!=="number"&&delete C.offset}};a.extend(m,n.defaults,{style:{tip:{corner:m,mimic:p,width:6,height:6,border:m,offset:0}}});s.bgiframe=
function(E){var C=a.browser,O=E.plugins.bgiframe;if(a("select, object").length<1||!(C.msie&&C.version.charAt(0)==="6"))return p;return"object"===typeof O?O:E.plugins.bgiframe=new l(E)};s.bgiframe.initialize="render"})(jQuery,window);var spanish={};spanish["a acute"]={lower:"\u00e1",upper:"\u00c1"};spanish["e acute"]={lower:"\u00e9",upper:"\u00c9"};spanish["i acute"]={lower:"\u00ed",upper:"\u00cd"};spanish["n tilde"]={lower:"\u00f1",upper:"\u00d1"};spanish["o acute"]={lower:"\u00f3",upper:"\u00d3"};spanish["u acute"]={lower:"\u00fa",upper:"\u00da"};spanish["u uml"]={lower:"\u00fc",upper:"\u00dc"};spanish["inverted ?"]={lower:"\u00bf"};spanish["inverted !"]={lower:"\u00a1"};spanish["straight apostrophe"]={lower:"'"};
spanish.apostrophe={lower:"\u2019"};spanish["straight quote"]={lower:'"'};spanish["high inverted quote"]={lower:"\u201c"};spanish["high quote"]={lower:"\u201d"};spanish["<<"]={lower:"\u00ab"};spanish[">>"]={lower:"\u00bb"};spanish.dash={lower:"-"};spanish.endash={lower:"\u2013"};spanish.emdash={lower:"\u2014"};
